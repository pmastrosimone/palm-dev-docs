<html>
<head>
<title>(68K) Localized Applications | Palm OS&#174; Programmer's Companion</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 10:43:17">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="1053137"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="CompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SystemFeatures.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Security.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CompanionIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">12 &nbsp;&nbsp;
Localized Applications</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Palm OS&#174; Programmer's Companion</p>
<p class="SubTitle">Volume I </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1"><a href="Localization.html">12  Localized Applications</a></h1>

   <h2 class="SideTOC2"><a href="#1053185">
   Localization Guidelines</a></h2>

   <h2 class="SideTOC2"><a href="#1053212">
   Using Overlays to Localize Resources</a></h2>

   <h2 class="SideTOC2"><a href="#1053254">
   Dates</a></h2>

   <h2 class="SideTOC2"><a href="#1053351">
   Numbers</a></h2>

   <h2 class="SideTOC2"><a href="#1053393">
   Obtaining Locale Information</a></h2>

   <h2 class="SideTOC2"><a href="#1053514">
   Notes on the Japanese Implementation</a></h2>

      <h3 class="SideTOC3"><a href="#1053537">
      Japanese Character Encoding</a></h3>

      <h3 class="SideTOC3"><a href="#1053540">
      Japanese Character Input</a></h3>

      <h3 class="SideTOC3"><a href="#1053556">
      The Calculator Button</a></h3>

      <h3 class="SideTOC3"><a href="#1053559">
      Displaying Japanese Strings on UI Objects</a></h3>

      <h3 class="SideTOC3"><a href="#1053562">
      Displaying Error Messages</a></h3>

      <h3 class="SideTOC3"><a href="#1053642">
      Chinese Fonts</a></h3>

   <h2 class="SideTOC2"><a href="#1053645">
   Summary of Localization</a></h2>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1053139"> </a>When you write an application, or any other type of software, you need to take special care when working with characters, strings, numbers, and dates, as different countries represent these items in different ways. This chapter describes how to write code that works properly for any language that is supported by Palm OS<sup>&#174;</sup>. The chapter covers:</p>
<ul type="disc">
  <li><a name="1053143"> </a><a href="Localization.html#1053185">Localization Guidelines</a>
  <li><a name="1053147"> </a><a href="Localization.html#1053212">Using Overlays to Localize Resources</a>
  <li><a name="1053151"> </a><a href="Localization.html#1053254">Dates</a>
  <li><a name="1053155"> </a><a href="Localization.html#1053351">Numbers</a>
  <li><a name="1053159"> </a><a href="Localization.html#1053393">Obtaining Locale Information</a>
  <li><a name="1053163"> </a><a href="Localization.html#1053514">Notes on the Japanese Implementation</a>
  <li><a name="1053171"> </a><a href="Localization.html#1053645">Summary of Localization</a>
</ul>

<p><a name="1053175"> </a>In addition to this chapter, also see <a href="Text.html#1036996">Chapter 8, "Text,"</a> which describes how to work with text and characters in a way that makes your application easily localizable. </p>

<div><hr>
  <a name="1053176"> </a> <b>NOTE: </b> PalmOSGlue provides backward compatibility for many of the functions described in this chapter. When a function has a PalmOSGlue equivalent, that equivalent is shown in parentheses following the function name. See <a href="Nutshell.html#996095">"Backward Compatibility with PalmOSGlue"</a> for more information on PalmOSGlue. 
<hr>
</div>

<p><a name="1053180"> </a>This chapter does not cover how to actually perform localization of resources. For more information on this subject, see the <i>Palm OS Programming Development Tools Guide</i>.</p>

<h2 class="haH2">
  <a name="1053185"> </a>Localization Guidelines <a href="#1053137"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1053187"> </a>If there is a possibility that your application is going to be localized, you should follow these guidelines when you start planning the application. It's a good idea to follow these guidelines even if you don't think your application is going to be localized. </p>
<ul type="disc">
  <li><a name="1053188"> </a>If you use the English language version of the software as a guide when designing the layout of the screen, try to allow:
  <ul type="disc">
    <li><a name="1053189"> </a>extra space for strings 
    <li><a name="1053190"> </a>larger dialogs than the English version requires
  </ul>
  <li><a name="1053191"> </a>Don't put language-dependent strings in code. If you have to display text directly on the screen, remember that a one-line warning or message in one language may need more than one line in another language. See the section <a href="Text.html#1037178">"Strings"</a> in <a href="Text.html#1036996">Chapter 8, "Text,"</a> for further discussion. 
  <li><a name="1053198"> </a>Don't depend on the physical characteristics of a string, such as the number of characters, the fact that it contains a particular substring, or any other attribute that might disappear in translation. 
  <li><a name="1053199"> </a>Database names must use only 7-bit ASCII characters (0x20 through 0x7E). If an actual PDB name is displayed to the user, the application should have a way of associating a localizable name (resource based, if possible) with each database.
  <li><a name="1053200"> </a>Use the functions described in this chapter when working with characters, strings, numbers, and dates. 
  <li><a name="1053201"> </a>Consider using string templates as described in the section <a href="Text.html#1037449">"Dynamically Creating String Content"</a> in <a href="Text.html#1036996">Chapter 8</a>. Use as many parameters as possible to give localizers greater flexibility. Avoid building sentences by concatenating substrings together, as this often causes translation problems. 
  <li><a name="1053208"> </a>Abbreviations may be the best way to accommodate the particularly scarce screen real estate on the Palm Powered<sup>&#8482;</sup> handheld. 
  <li><a name="1053209"> </a>Remember that user interface elements such as lists, fields, and tips scroll if you need more space. 
</ul>

<p><a name="1053210"> </a>The book <i>Palm OS User Interface Guidelines</i> provides further user interface guidelines. </p>

<h2 class="haH2">
  <a name="1053212"> </a>Using Overlays to Localize Resources <a href="#1053137"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1053214"> </a>Palm OS version 3.5 adds support for localizing resource databases through <b>overlays</b>. Localization overlays provide a method for localizing a software module without requiring a recompile or modification of the software. Each overlay database is a separate resource database that provides an appropriately localized set of resources for a single software module (the PRC file, or <b>base database</b>) and a single target <b>locale</b> (language and country). </p>

<p><a name="1053215"> </a>No requirements are placed on the base database, so for example, third parties can construct localization overlays for existing applications without forcing any modifications by the original application developer. In rare cases, you might want to disable the use of overlays to prevent third parties from creating overlays for your application. To do so, you should include an <code>'xprf'=0</code> resource (symbolically named <code>sysResTExtPrefs</code>) in the database and set its <code>disableOverlays</code> flag. This resource is defined in <code>UIResources.r</code>. </p>

<p><a name="1053218"> </a>An overlay database has the same creator as the base database, but its type is <code>'ovly'</code>, and a suffix identifying the target locale is appended to its name. For example, <code>Datebook.prc</code> might be overlaid with a database named <code>Datebook_jpJP</code>, which indicates that this overlay is for Japan. Each overlay database has an <code>'ovly'</code>=1000 resource specifying the base database's type, the target locale, and information necessary to identify the correct version of the base database for which it was designed. </p>

<p><a name="1053219"> </a>The Palm OS SDK provides tools that you can use to create overlays. See the "PRC to Overlay Tool" chapter in the <i>Palm OS Programming Development Tools Guide</i> for more information on creating overlays. </p>

<p><a name="1053224"> </a>When a PRC file is opened on a system that supports overlays, the Overlay Manager determines what the current locale is for this handheld, and it looks for an overlay matching the base database and the locale. The overlay database's name must match the base database's name, its suffix must match the locale's suffix, and it must have an <code>'ovly'</code>=1000 resource that matches the base database. If the name, suffix, and overlay resource are all correct, the overlay is opened in addition to the PRC file. When the PRC file is closed, its overlay is closed as well. </p>

<p><a name="1053225"> </a>The overlay is opened in read-only mode and is hidden from the programmer. When you open a database, you'll receive a reference to the base database, not the overlay. You can simply make Resource Manager calls like you normally would, and the Resource Manager accesses the overlay where appropriate. </p>

<p><a name="1053226"> </a>When accessing a localizable resource, do not use functions that search for a resource only in the database you specify. For example: </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// WRONG! searches only one database. <a name="1053227"> </a>
DmOpenRef dbP = DmNextOpenResDatabase(NULL);<a name="1053229"> </a>
UInt16 resIndex = DmFindResource(dpP, strRsc, <a name="1053231"> </a>
  strRscID);<a name="1053232"> </a>
MemHandle resH = DmGetResourceIndex(dbP, <a name="1053234"> </a>
  resIndex);<a name="1053235"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1053236"> </a>In the example above, <code>dbP</code> is a reference to the most recently opened database, which is typically the overlay version of the database. Passing this reference to <code>DmFindDatabase</code> means that you are searching only the overlay database for the resource. If you're searching for a non-localized resource, <code>DmFindResource</code> won't be able to locate it. Instead, you should use <code>DmGet1Resource</code>, which searches the most recently opened database and its overlay for a resource, or <code>DmGetResource</code>, which searches all open databases and their overlays. </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// Right. DmGet1Resource searches both <a name="1053237"> </a>
// databases. <a name="1053238"> </a>
MemHandle resH = DmGet1Resource(strRsc, <a name="1053240"> </a>
  strRscID);<a name="1053241"> </a>
// Or use DmGetResource to search all open <a name="1053242"> </a>
// databases.<a name="1053243"> </a>
MemHandle resH = DmGetResource(strRsc, <a name="1053245"> </a>
  strRscID);<a name="1053246"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1053247"> </a>The Data Manager only opens an overlay if the resource database is opened in read-only mode. If you open a resource database in read-write mode, the associated overlay is not opened. What's more, if you modify an overlaid resource in the base database, the checksum in the overlay's <code>'ovly'</code> resource becomes invalid, which prevents the overlay from being used at all. Thus if you change the resource database, you must also change the overlay database. </p>

<p><a name="1053248"> </a>You typically don't work with the Overlay Manager directly although it does provide a few public functions. One potentially useful function is <a href="../PalmOSReference/OverlayMgr.html#1026798"><code>OmGetCurrentLocale</code></a> (or <code>OmGlueGetCurrentLocale</code>), which returns a structure identifying the locale on this handheld. </p>

<h2 class="haH2">
  <a name="1053254"> </a>Dates <a href="#1053137"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1053255"> </a>If your application deals with dates and times, it should abide by the values the user has set in the system preference for date and time display. The default preferences at startup vary among locales, and the default values can be overridden by the user. </p>

<p><a name="1053260"> </a>To check the system preferences call <a href="../PalmOSReference/Preferences.html#1031531"><code>PrefGetPreference</code></a> with one of the values listed in the second column of <a href="Localization.html#1053270">Table 12.1</a>. The third column lists an enumerated type that helps you interpret the value. </p>

<p class="caption"><a name="1053270"> </a><b>Table 12.1&nbsp;&nbsp;Date and time preferences </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1053276"> </a><b>Preference</b></p>
    </th>
    <th><p class="tt"><a name="1053278"> </a><b>Name</b></p>
    </th>
    <th><p class="tt"><a name="1053280"> </a><b>Returns a value of type</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053282"> </a>Date formats (i.e., month first or day first)</p>
    </td>
    <td><p class="tt"><a name="1053285"> </a><code>prefDateFormat</code>, <code>prefLongDateFormat</code> </p>
    </td>
    <td><p class="tt"><a name="1053290"> </a><a href="../PalmOSReference/DateAndTimeManager.html#1097305"><code>DateFormatType</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053292"> </a>Time formats (i.e., use a 12-hour clock or use a 24-hour clock)</p>
    </td>
    <td><p class="tt"><a name="1053295"> </a><code>prefTimeFormat</code> </p>
    </td>
    <td><p class="tt"><a name="1053300"> </a><a href="../PalmOSReference/DateAndTimeManager.html#1097759"><code>TimeFormatType</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053302"> </a>Start day of week (i.e., Sunday or Monday)</p>
    </td>
    <td><p class="tt"><a name="1053305"> </a><code>prefWeekStartDay</code> </p>
    </td>
    <td><p class="tt"><a name="1053307"> </a>0 (Sunday) or 1 (Monday)</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053309"> </a>Local time zone</p>
    </td>
    <td><p class="tt"><a name="1053312"> </a><code>prefMinutesWestOfGMT</code> </p>
<p class="tt"><a name="1053313"> </a>(before Palm OS 4.0), </p>
<p class="tt"><a name="1053315"> </a><code>prefTimeZone</code> (Palm OS 4.0 and higher) </p>
    </td>
    <td><p class="tt"><a name="1053317"> </a>Minutes east<a href="#1056798"><sup>1</sup></a> of Greenwich Mean Time (GMT), also known as Universal Coordinated Time (UTC). </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053319"> </a>Daylight savings time adjustment </p>
    </td>
    <td><p class="tt"><a name="1053321"> </a><code>prefDaylightSavings</code> (before Palm OS 4.0), </p>
<p class="tt"><a name="1053322"> </a><code>prefDaylightSavingAdjustment </code>(Palm OS 4.0 and higher)</p>
    </td>
    <td><p class="tt"><a name="1053324"> </a>Before 4.0, the <a href="../PalmOSReference/DateAndTimeManager.html#1097521"><code>DaylightSavingsTypes</code></a> described the daylight savings adjustment. In Palm OS 4.0 and higher, the preference is stored as the number of minutes by which to adjust the current time. </p>
    </td>
  </tr>
</table>
<div class="tablediv"><table cellspacing="0" class="tTableNR">
   <tr>
     <td><div class="FNTFootnoteTable">
<a name="1056798"> </a><a href="#1053317">1</a>. The previous name of this preference notwithstanding, a positive value indicates minutes <i>east</i> of GMT, while a negative value indicates minutes west of GMT.</div>
</td>
   </tr>
</table></div>

</div>


<div><hr>
  <a name="1053330"> </a> <b>IMPORTANT: </b> The <code>prefMinutesWestOfGMT</code> preference mentioned above is not the same as the <code>prefTimeZone</code> preference. The <code>prefMinutesWestOfGMT</code> returns an unsigned value ranging from 0 to 1440. The <code>prefTimeZone</code> preference ranges from -720 to 720. 
<hr>
</div>

<p><a name="1053334"> </a>To work with dates in your code, use the Date and Time Manager API. It contains functions such as <a href="../PalmOSReference/DateAndTimeManager.html#1098231"><code>DateToAscii</code></a>, <a href="../PalmOSReference/DateAndTimeManager.html#1098371"><code>DayOfMonth</code></a>, <a href="../PalmOSReference/DateAndTimeManager.html#1098396"><code>DayOfWeek</code></a>, <a href="../PalmOSReference/DateAndTimeManager.html#1098450"><code>DaysInMonth</code></a>, and <a href="../PalmOSReference/DateAndTimeManager.html#1097986"><code>DateTemplateToAscii</code></a>, which allow you to work with dates independent of the user's preference settings. </p>

<h2 class="haH2">
  <a name="1053351"> </a>Numbers <a href="#1053137"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1053352"> </a>If your application displays large numbers or floating-point numbers, you must check and make sure you are using the appropriate thousands separator and decimal separator for the handheld's country by doing the following (see <a href="Localization.html#1053374">Listing 12.1</a>):</p>
<ol type="1">
  <li value="1"><a name="1053356"> </a>Store numbers using US conventions, which means using a "," as the thousands separator and a decimal point (.) as the decimal separator. 
  <li value="2"><a name="1053358"> </a>Use <code>PrefGetPreference</code> and <a href="../PalmOSReference/MiscSys.html#1038304"><code>LocGetNumberSeparators</code></a> to retrieve information about how the number should be displayed.
  <li value="3"><a name="1053367"> </a>Use <a href="../PalmOSReference/StringManager.html#1065393"><code>StrLocalizeNumber</code></a> to perform the localization. 
  <li value="4"><a name="1053368"> </a>If a user enters a number that you need to manipulate in some way, convert it to the US conventions using <a href="../PalmOSReference/StringManager.html#1065268"><code>StrDelocalizeNumber</code></a>. 
</ol>
<p class="CCodeCaption">
  <a name="1053374"> </a><b>Listing 12.1&nbsp;&nbsp;Working with numbers</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// store numbers using US conventions. <a name="1053375"> </a>
Char *jackpot = "20,000,000.00";<a name="1053376"> </a>
Char thou; // thousand separator<a name="1053377"> </a>
Char dp; // decimal separator<a name="1053378"> </a>
 <a name="1053379"> </a>
// Retrieve user's preferred number format. <a name="1053380"> </a>
LocGetNumberSeparators((NumberFormatType)<a name="1053381"> </a>
   PrefGetPreference(prefNumberFormat), &amp;thou, <a name="1053382"> </a>
      &amp;dp);<a name="1053383"> </a>
// Localize jackpot number. Converts "," to thou <a name="1053384"> </a>
// and "." to dp. <a name="1053385"> </a>
StrLocalizeNumber(jackpot, thou, dp);<a name="1053386"> </a>
// Display string. <a name="1053387"> </a>
// Assume inputString is a number user entered, <a name="1053388"> </a>
// convert it to US conventions this way. Converts <a name="1053389"> </a>
// thou to "," and dp to "."<a name="1053390"> </a>
StrDelocalizeNumber(inputNumber, thou, dp);<a name="1053391"> </a>
</pre><div class="CodeRule"><hr></div>


<h2 class="haH2">
  <a name="1053393"> </a>Obtaining Locale Information <a href="#1053137"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1053394"> </a>Some applications may require information about the current locale. For example, many applications need to know the format for displaying dates or numbers, which is determined in part by the current locale (and described in more detail in the section <a href="Localization.html#1053254">"Dates"</a> and <a href="Localization.html#1053351">"Numbers"</a> in this chapter). Other applications may need other information, such as the country name. </p>

<p><a name="1053401"> </a>The information that most applications require is stored in the system preferences structure and can be obtained using <a href="../PalmOSReference/Preferences.html#1031531"><code>PrefGetPreference</code></a>. This is the recommended way of obtaining locale-specific settings because the user can override many of these settings. Applications should always honor the user's preferences rather than the locale defaults. </p>

<p><a name="1053406"> </a>Other locale-specific settings can not be set by the user and are not stored in the system preferences. Instead, these settings are stored in a private resource that contains information about several possible locales, including the locale currently used by the system. For example, the user cannot change the symbol used for the local currency. If your application needs this information, it must use the Locale Manager function <a href="../PalmOSReference/LocaleMgr.html#1013735"><code>LmGetLocaleSetting</code></a> to retrieve it. The Locale Manager is new in Palm OS 4.0, but for backwards compatibility you can use the corresponding PalmOSGlue function <code>LmGlueGetLocaleSetting</code>. <a href="Localization.html#1053416">Listing 12.2</a> shows how to use <code>LmGlueGetLocaleSetting</code>. </p>
<p class="CCodeCaption">
  <a name="1053416"> </a><b>Listing 12.2&nbsp;&nbsp;Retrieving a locale setting using Locale Manager</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
LmLocaleType locale;<a name="1053417"> </a>
Char currencySymbol[kMaxCurrencySymbolLen+1];<a name="1053418"> </a>
UInt16 index;<a name="1053419"> </a>
 <a name="1053420"> </a>
// Find out what the current locale is. <a name="1053421"> </a>
OmGlueGetCurrentLocale(&amp;locale);<a name="1053422"> </a>
 <a name="1053423"> </a>
// Find out which index in the locale resource <a name="1053424"> </a>
// contains info about that locale. <a name="1053425"> </a>
LmGlueLocaleToIndex(&amp;locale, &amp;index);<a name="1053426"> </a>
 <a name="1053427"> </a>
// Get the currency symbol stored in the locale at <a name="1053428"> </a>
// that index. <a name="1053429"> </a>
LmGlueGetLocaleSetting(index, lmChoiceCurrencySymbol, <a name="1053430"> </a>
   currencySymbol, sizeof(currencySymbol));<a name="1053431"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1053435"> </a><a href="Localization.html#1053442">Table 12.2</a> shows which types of information about the current locale should be retrieved from the system preferences and which types should be retrieved from the locale resource. Of course, if you want to retrieve information about a different locale or if you want to look up the default used for the current locale, you would always use the Locale Manager instead of the Preferences Manager. </p>

<p class="caption"><a name="1053442"> </a><b>Table 12.2&nbsp;&nbsp;Obtaining locale information  </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1053446"> </a><b>Value</b></p>
    </th>
    <th><p class="tt"><a name="1053448"> </a><b>Function used to retrieve value</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053450"> </a>Language code </p>
    </td>
    <td><p class="tt"><a name="1053452"> </a><code>PrefGetPreference(prefLanguage)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053454"> </a>Locale description </p>
    </td>
    <td><p class="tt"><a name="1053456"> </a><code>PrefGetPreference(prefLocale)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053458"> </a>Country code</p>
    </td>
    <td><p class="tt"><a name="1053460"> </a><code>PrefGetPreference(prefCountry)</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053462"> </a>Country name </p>
    </td>
    <td><p class="tt"><a name="1053464"> </a><code>LmGlueGetLocaleSetting(..., lmChoiceCountryName, ...)</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053466"> </a>Currency name </p>
    </td>
    <td><p class="tt"><a name="1053468"> </a><code>LmGlueGetLocaleSetting(..., lmChoiceCurrencyName, ...)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053470"> </a>Currency symbol </p>
    </td>
    <td><p class="tt"><a name="1053472"> </a><code>LmGlueGetLocaleSetting(..., lmChoiceCurrencySymbol, ...)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053474"> </a>Unique currency symbol </p>
    </td>
    <td><p class="tt"><a name="1053476"> </a><code>LmGlueGetLocaleSetting(..., lmChoiceUniqueCurrencySymbol, ...)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053478"> </a>Measurement system (metric or English) </p>
    </td>
    <td><p class="tt"><a name="1053480"> </a><code>PrefGetPreference(prefMeasurementSystem)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053482"> </a>Number formats </p>
    </td>
    <td><p class="tt"><a name="1053484"> </a><code>PrefGetPreference(prefNumberFormat)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053486"> </a>Number of decimal places for monetary values</p>
    </td>
    <td><p class="tt"><a name="1053488"> </a><code>LmGlueGetLocaleSetting(..., lmChoiceCurrencyDecimalPlaces, ...)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053490"> </a>Starting day of the week </p>
    </td>
    <td><p class="tt"><a name="1053492"> </a><code>PrefGetPreference(prefWeekStartDay)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053494"> </a>Date formats </p>
    </td>
    <td><p class="tt"><a name="1053496"> </a><code>PrefGetPreference(prefDateFormat)</code> </p>
<p class="tt"><a name="1053497"> </a><code>PrefGetPreference(prefLongDateFormat)</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053499"> </a>Time format </p>
    </td>
    <td><p class="tt"><a name="1053501"> </a><code>PrefGetPreference(prefTimeFormat)</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053503"> </a>Time zone </p>
    </td>
    <td><p class="tt"><a name="1053505"> </a><code>PrefGetPreference(prefMinutesWestOfGMT)</code> (pre 4.0)</p>
<p class="tt"><a name="1053506"> </a><code>PrefGetPreference(prefTimeZone)</code> (4.0 and higher)</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053508"> </a>Daylight savings time </p>
    </td>
    <td><p class="tt"><a name="1053510"> </a><code>PrefGetPreference(prefDaylightSavings)</code> (pre 4.0)</p>
<p class="tt"><a name="1053511"> </a><code>PrefGetPreference(prefDaylightSavingAdjustment) </code>(4.0 and higher)</p>
    </td>
  </tr>
</table>

</div>


<h2 class="haH2">
  <a name="1053514"> </a>Notes on the Japanese Implementation <a href="#1053137"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1053515"> </a>This section describes programming practices for applications that are to be localized for Japanese use. It covers:</p>
<ul type="disc">
  <li><a name="1053519"> </a><a href="Localization.html#1053537">Japanese Character Encoding</a>
  <li><a name="1053523"> </a><a href="Localization.html#1053540">Japanese Character Input</a>
  <li><a name="1053527"> </a><a href="Localization.html#1053556">The Calculator Button</a>
  <li><a name="1053531"> </a><a href="Localization.html#1053559">Displaying Japanese Strings on UI Objects</a>
  <li><a name="1053535"> </a><a href="Localization.html#1053562">Displaying Error Messages</a>
</ul>
<h3 class="hbH3">
  <a name="1053537"> </a>Japanese Character Encoding <a href="#1053137"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1053538"> </a>The character encoding used on Japanese systems is based on Microsoft code page 932. The complete 932 character set (JIS level 1 and 2) is supported in both the standard and large font sizes. The bold versions of these two fonts contain bolded versions of the glyphs found in the 7-bit ASCII range, but on some handhelds, the single-byte Katakana characters and the multi-byte characters are not bolded. </p>
<h3 class="hbH3">
  <a name="1053540"> </a>Japanese Character Input <a href="#1053137"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1053541"> </a>On current Japanese handhelds, users enter Japanese text using Latin (ASCII) characters, and special software called a front-end processor (FEP) transliterates this text into Hiragana or Katakana characters. The user can then ask the FEP to phonetically convert Hiragana characters into a mixture of Hiragana and Kanji (Kana-Kanji conversion).</p>

<p class="FFigureCaption">
  <a name="1053542"> </a><b>Figure 12.1&nbsp;&nbsp;Input area on a Japanese handheld</b>
</p>
<div align="left"><img src="images/jpInputArea.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="1053551"> </a>Japanese handhelds have four additional buttons that control the FEP transliteration and conversion process. These four FEP buttons are arranged vertically between the left-most icons and the handwriting recognition area. The top-most FEP button tells the FEP to attempt Kana-Kanji conversion on the inline text. The next button confirms the inline text and terminates the inline conversion session. The third button toggles the transliteration mode between Hiragana and Katakana. The last button toggles the FEP on and off.</p>

<p><a name="1053552"> </a>Japanese text entry is always inline, which means that transliteration and conversion happen directly inside of a field. The field code passes events to the FEP, which then returns information about the appropriate text to display. </p>

<p><a name="1053553"> </a>During inline conversion, the Graffiti<sup>&#174;</sup> or Graffiti<sup>&#174;</sup> 2 space stroke acts as a shortcut for the conversion FEP button and the return stroke acts as a shortcut for the confirm FEP button. </p>
<h3 class="hbH3">
  <a name="1053556"> </a>The Calculator Button <a href="#1053137"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1053557"> </a>On current Japanese handhelds, the Calculator silkscreen button doesn't generate a <code>calcChr</code>. Instead, it generates a <code>keyDown</code> event with the event's <code>data.keyDown.chr</code> field set to <code>keyboardChr</code> and it's <code>data.keyDown.modifiers</code> field set to <code>commandKeyMask</code>.</p>
<h3 class="hbH3">
  <a name="1053559"> </a>Displaying Japanese Strings on UI Objects <a href="#1053137"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1053560"> </a>To conserve screen space, you should use half-width Katakana characters on user interface elements (such as buttons, menu items, labels, and pop-up lists) whenever the string contains only Katakana characters. If the string contains a mix of Katakana and either Hiragana, Kanji, or Romaji, then use the full-width Katakana characters instead. </p>
<h3 class="hbH3">
  <a name="1053562"> </a>Displaying Error Messages <a href="#1053137"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1053567"> </a>You may have code that uses the macros <a href="../PalmOSReference/ErrorManager.html#1027916"><code>ErrFatalDisplayIf</code></a> and <a href="../PalmOSReference/ErrorManager.html#1027946"><code>ErrNonFatalDisplayIf</code></a> to determine error conditions. If the error condition occurs, the system displays the file name and line number at which the error occurred along with the message that you passed to the macro. Often these messages are hard-coded strings. On Japanese systems, the Palm OS traps the messages passed to these two macros and displays a generic message explaining that an error has occurred. </p>

<p><a name="1053572"> </a>You should only use <code>ErrFatalDisplayIf</code> and <code>ErrNonFatalDisplayIf</code> for totally unexpected errors. Do not use them for errors that you believe your end users will see. If you wish to inform your users of an error, use a localizable resource to display the error message instead of <code>ErrFatalDisplayIf</code> or <code>ErrNonFatalDisplayIf</code>. </p>
<ul type="disc">
  <li><a name="1053599"> </a><a href="Localization.html#1053642">Chinese Fonts</a>
</ul>
<h3 class="hbH3">
  <a name="1053642"> </a>Chinese Fonts <a href="#1053137"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1053643"> </a>Some Chinese fonts&#8212;especially 9 point on a standard display&#8212;use all of the available vertical space. Because of this the layout of form elements might need to be tweaked for proper vertical spacing.</p>

<h2 class="haH2">
  <a name="1053645"> </a>Summary of Localization <a href="#1053137"><span class="nav">^TOP^</span></a>
</h2>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1053648"> </a><b>Localizing Numbers</b></p>
    </th>
    <th><p class="tt"><a name="1053650"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053655"> </a><a href="../PalmOSReference/StringManager.html#1065393">StrLocalizeNumber</a><br><a href="../PalmOSReference/MiscSys.html#1038304">LocGetNumberSeparators</a></p>
    </td>
    <td><p class="tt"><a name="1053663"> </a><a href="../PalmOSReference/StringManager.html#1065268">StrDelocalizeNumber</a></p>
    </td>
  </tr>
</table>

</div>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1053667"> </a><b>Locale Manager</b></p>
    </th>
    <th><p class="tt"><a name="1053669"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053674"> </a><a href="../PalmOSReference/LocaleMgr.html#1013735">LmGetLocaleSetting</a></p>
<p class="tt"><a name="1053678"> </a><a href="../PalmOSReference/LocaleMgr.html#1013998">LmLocaleToIndex</a></p>
    </td>
    <td><p class="tt"><a name="1053683"> </a><a href="../PalmOSReference/LocaleMgr.html#1013967">LmGetNumLocales</a></p>
    </td>
  </tr>
</table>

</div>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1053687"> </a><b>International Manager</b></p>
    </th>
    <th><p class="tt"><a name="1053689"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053694"> </a><a href="../PalmOSReference/MiscSys.html#1038233">IntlGetRoutineAddress</a></p>
    </td>
    <td><p class="tt"><a name="1053699"> </a><a href="../PalmOSReference/MiscSys.html#1038266">IntlSetRoutineAddress</a></p>
    </td>
  </tr>
</table>

</div>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1053703"> </a><b>Overlay Manager</b></p>
    </th>
    <th><p class="tt"><a name="1053705"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1053710"> </a><a href="../PalmOSReference/OverlayMgr.html#1026798">OmGetCurrentLocale</a><br><a href="../PalmOSReference/OverlayMgr.html#1026832">OmGetIndexedLocale</a><br><a href="../PalmOSReference/OverlayMgr.html#1026909">OmGetRoutineAddress</a><br><a href="../PalmOSReference/OverlayMgr.html#1027058">OmSetSystemLocale</a> </p>
    </td>
    <td><p class="tt"><a name="1053724"> </a><a href="../PalmOSReference/OverlayMgr.html#1026940">OmGetSystemLocale</a><br><a href="../PalmOSReference/OverlayMgr.html#1026981">OmLocaleToOverlayDBName</a><br><a href="../PalmOSReference/OverlayMgr.html#1027026">OmOverlayDBNameToLocale</a></p>
<p class="tt"><a name="1053734"> </a><a href="../PalmOSReference/OverlayMgr.html#1026876">OmGetNextSystemLocale</a></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1053736"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996-2004, PalmSource, Inc. and its affiliates.  All rights reserved. <br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="Companion_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="CompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SystemFeatures.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Security.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CompanionIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>