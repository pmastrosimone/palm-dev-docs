<html>
<head>
<title>(68K) Applications and the Dynamic Input Area | Palm OS&#174; Programmer's Companion</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 10:43:15">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="995795"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="CompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Text.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="AttnsAndAlarms.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CompanionIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">9 &nbsp;&nbsp;
Applications and the Dynamic Input Area</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Palm OS&#174; Programmer's Companion</p>
<p class="SubTitle">Volume I </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1"><a href="PIMConcept.html">9  Applications and the Dynamic Input Area</a></h1>

   <h2 class="SideTOC2"><a href="#995881">
   The Dynamic Input Area Feature</a></h2>

   <h2 class="SideTOC2"><a href="#995896">
   Size Constraints</a></h2>

   <h2 class="SideTOC2"><a href="#995962">
   Input Area Policy</a></h2>

      <h3 class="SideTOC3"><a href="#995986">
      Setting the Input Area Policy</a></h3>

      <h3 class="SideTOC3"><a href="#996016">
      Enabling the Input Trigger</a></h3>

      <h3 class="SideTOC3"><a href="#996042">
      Setting an Input Area State</a></h3>

   <h2 class="SideTOC2"><a href="#996069">
   Resizing a Form</a></h2>

   <h2 class="SideTOC2"><a href="#996165">
   Hiding and Showing the Control Bar</a></h2>

   <h2 class="SideTOC2"><a href="#996180">
   Pen Input Manager Compatibility</a></h2>

      <h3 class="SideTOC3"><a href="#996211">
      New sysFtrNumInputAreaFlags Support</a></h3>

      <h3 class="SideTOC3"><a href="#996221">
      Additional winDisplayChangedEvent</a></h3>

      <h3 class="SideTOC3"><a href="#996228">
      Restoration of Input Trigger State</a></h3>

      <h3 class="SideTOC3"><a href="#996236">
      New pinInputAreaUser Input Area State</a></h3>

      <h3 class="SideTOC3"><a href="#996239">
      New Stat... Functions</a></h3>

      <h3 class="SideTOC3"><a href="#996253">
      New Support for Changing Display Orientation</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="995796"> </a>On most existing Palm Powered<sup>&#8482;</sup> handhelds, Palm OS<sup>&#174;</sup> applications are drawn in a fixed space that is 160 X 160 pixels or 320 X 320 pixels in size, depending on the device's screen density. The input area, where the user enters characters, is silkscreened onto such devices. Some Palm Powered handhelds have <b>dynamic input areas</b>, as shown in <a href="PIMConcept.html#995802">Figure 9.1</a>, that users can close when they do not need to enter characters. (Tapping the arrow in the lower right closes the input area, leaving a smaller control bar visible.)</p>

<p><a name="995800"> </a>On these devices, the application area is not fixed&#8212;it is the traditional square size while the input area is opened, and it is a rectangular size when the input area is closed, giving more space to the application. </p>

<p class="FFigureCaption">
  <a name="995802"> </a><b>Figure 9.1&nbsp;&nbsp;Closable Dynamic Input Area</b>
</p>
<div align="left"><img src="images/InputAreawithClose.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="995810"> </a>A control bar at the bottom of the screen, shown in <a href="PIMConcept.html#995812">Figure 9.2</a>, contains various buttons, including one called the trigger (the arrow at the right in this example), that opens the input area when it is closed. A trigger also typically appears in the input area to provide a way for the user to close the input area.</p>

<p class="FFigureCaption">
  <a name="995812"> </a><b>Figure 9.2&nbsp;&nbsp;Control Bar</b>
</p>
<div align="left"><img src="images/ControlBar.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="995817"> </a>The control bar is typically closed when the input area is open, except on double density screens, when it is always shown; however, licensees can change this behavior.</p>

<p><a name="995818"> </a>To take advantage of the additional screen space, your application must respond when the input area is opened or closed and redraw the current form in the available application space. This chapter describes how to do so. </p>

<p><a name="995821"> </a>To make your application work with a dynamic input area, do the following: </p>
<ol type="1">
  <li value="1"><a name="995822"> </a>Check the feature to make sure that the API described in this document is available. (See <a href="PIMConcept.html#995881">"The Dynamic Input Area Feature."</a>)
  <li value="2"><a name="995829"> </a>Call <a href="../PalmOSReference/Window.html#1074517"><code>WinSetConstraintsSize</code></a> to set the size constraints for each form in response to the <code>frmLoadEvent</code> or <code>frmOpenEvent</code>. (See <a href="PIMConcept.html#995896">"Size Constraints."</a>)
  <li value="3"><a name="995833"> </a>Set up each form in your application to work with the Pen Input Manager in response to the <code>frmLoadEvent</code> or <code>frmOpenEvent</code>, and the <code>winEnterEvent</code>. This involves calling <a href="../PalmOSReference/Form.html#1085883"><code>FrmSetDIAPolicyAttr</code></a>, <a href="../PalmOSReference/PenInputManager.html#999861"><code>PINSetInputTriggerState</code></a>, and <a href="../PalmOSReference/PenInputManager.html#999819"><code>PINSetInputAreaState</code></a>. (See <a href="PIMConcept.html#995962">"Input Area Policy."</a>)
  <li value="4"><a name="995846"> </a>Respond to the <code>sysNotifyDisplayResizedEvent</code> notification by posting a <code>winDisplayChangedEvent</code> and then in this event handler, redraw the form in the available space. (See <a href="PIMConcept.html#996069">"Resizing a Form."</a>)
</ol>

<div><hr>
  <a name="995850"> </a> <b>NOTE: </b> If an application does not call <code>FrmSetDIAPolicyAttr</code> before a form is drawn, the system assumes it is a legacy form that doesn't support a closable input area. In this case, the input area is drawn without a trigger.
<hr>
</div>

<h2 class="haH2">
  <a name="995881"> </a>The Dynamic Input Area Feature <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="995882"> </a>Before you can use any of the API described in this chapter, you must make sure that the dynamic input area API is available. Test the <code>pinFtrAPIVersion</code> feature as shown in <a href="PIMConcept.html#995888">Listing 9.1</a></p>
<p class="CCodeCaption">
  <a name="995888"> </a><b>Listing 9.1&nbsp;&nbsp;Checking the dynamic input area feature</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
err = FtrGet(pinCreator, pinFtrAPIVersion, &amp;version);<a name="995889"> </a>
if (!err &amp;&amp; version) {<a name="995890"> </a>
   //PINS exists<a name="995891"> </a>
}<a name="995892"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="995893"> </a>If this feature is defined, a new manager called the <b>Pen Input Manager</b> controls the input area and notifies the application of any changes in the input area state. </p>

<div><hr>
  <a name="995894"> </a> <b>NOTE: </b> Version 1.1 (<code>pinAPIVersion1_1</code>) of the Pen Input Manager is slightly different from version 1.0 (<code>pinAPIVersion1_0</code>). It doesn't matter which version you find; you should write your application to be compatible with both, as described in the following sections.
<hr>
</div>

<h2 class="haH2">
  <a name="995896"> </a>Size Constraints <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="995897"> </a>After you've determined that the Pen Input Manager is available, you need to let it know the <b>size constraints</b> for each form in your application. You do so by calling the function <a href="../PalmOSReference/Window.html#1074517"><code>WinSetConstraintsSize</code></a> when the form is loaded; that is, in response to the <code>frmLoadEvent</code>. (Alternately, you can do this on a <code>frmOpenEvent</code>.)</p>

<p><a name="995905"> </a>The <code>WinSetConstraintsSize</code> function takes seven parameters: the handle to the form's window, the minimum, preferred, and maximum heights for the form, and the minimum, preferred, and maximum widths for the form. The Pen Input Manager uses this information to determine whether the form supports a closed input form. </p>

<p><a name="995906"> </a>If you don't specify size constraints, the Pen Input Manager assumes that the minimum, maximum, and preferred height and width are all 160 standard coordinates. In this way, legacy applications are always sized appropriately when the input area is open. </p>

<p><a name="995912"> </a><a href="PIMConcept.html#995918">Listing 9.2</a> shows how you might call <code>WinSetConstraintsSize</code> for an application with three forms: a main form, an edit form, and a password dialog. <code>WinSetConstraintsSize</code> must be called in response to the <code>frmLoadEvent</code> or <code>frmOpenEvent</code>. You typically handle the <code>frmLoadEvent</code> in your application's <code>AppHandleEvent</code>, so you would place this code in your application's <code>AppHandleEvent</code> function. </p>
<p class="CCodeCaption">
  <a name="995918"> </a><b>Listing 9.2&nbsp;&nbsp;Setting the size constraints</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
if (eventP-&gt;eType == frmLoadEvent) {<a name="995919"> </a>
   // Load the form resource.<a name="995920"> </a>
   formId = eventP-&gt;data.frmLoad.formID;<a name="995921"> </a>
   frmP = FrmInitForm(formId);<a name="995922"> </a>
   FrmSetActiveForm(frmP);<a name="995923"> </a>
<a name="995924"> </a>
   // Set the same policy for each form in application. <a name="995925"> </a>
   err = FrmSetDIAPolicyAttr(frmP, frmDIAPolicyCustom);<a name="995926"> </a>
<a name="995927"> </a>
   // Enable the input trigger<a name="995928"> </a>
   err = PINSetInputTriggerState(pinInputTriggerEnabled);<a name="995929"> </a>
<a name="995930"> </a>
   formWinH = FrmGetWindowHandle (frmP);<a name="995931"> </a>
// Set the event handler for the form, and set each form's <a name="995932"> </a>
// size requirements. <a name="995933"> </a>
   switch (formId) {<a name="995934"> </a>
      case MainForm:<a name="995935"> </a>
         FrmSetEventHandler(frmP, MainFormHandleEvent);<a name="995936"> </a>
         WinSetConstraintsSize(formWinH, 80, 160, 225, <a name="995937"> </a>
            160, 160, 160);<a name="995938"> </a>
         break;<a name="995939"> </a>
<a name="995940"> </a>
      case EditForm:<a name="995941"> </a>
         FrmSetEventHandle(frmP, EditFormHandleEvent);<a name="995942"> </a>
         WinSetConstraintsSize(formWinH, 100, 160, 225, <a name="995943"> </a>
            160, 160, 160);<a name="995944"> </a>
         break;<a name="995945"> </a>
<a name="995946"> </a>
      case PasswordDialog:<a name="995947"> </a>
         FrmSetEventHandler(frmP, PasswordDialogHandleEvent);<a name="995948"> </a>
         FrmSetDIAPolicyAttr(frmPolicyStayOpen);<a name="995949"> </a>
         break;<a name="995950"> </a>
<a name="995951"> </a>
      default:<a name="995952"> </a>
         break;<a name="995953"> </a>
   }<a name="995954"> </a>
   return true;<a name="995955"> </a>
}<a name="995956"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="995960"> </a>In <a href="PIMConcept.html#995918">Listing 9.2</a>, <code>WinSetConstraintsSize</code> is called once for each form in the application. There is currently nothing that should resize a form's width, so each of these calls uses 160 for all of the width parameters. The full-screen forms prefer to be 160 pixels high because the application uses these same forms when running on older devices that use static input areas; however, it's acceptable for the main form to be as short as 80 pixels and the Edit form to be as short as 100 pixels if the input area needs more space. Finally, the input area should not be closable for the password dialog because it is needed to enter the password.</p>

<h2 class="haH2">
  <a name="995962"> </a>Input Area Policy <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="995963"> </a>To set up your application's forms to work with the Pen Input Manager, you must do the following for each form: </p>
<ul type="disc">
  <li><a name="995964"> </a>Set an <b>input area policy</b> using the function <a href="../PalmOSReference/Form.html#1085883"><code>FrmSetDIAPolicyAttr</code></a> to let the system know that the form will resize itself when the input area is opened and closed. Do so in response to the <code>frmLoadEvent</code> or <code>frmOpenEvent</code>. 
  <li><a name="995971"> </a>Enable the <b>input trigger</b>, which is what the user uses to open and close the input area, using the function <a href="../PalmOSReference/PenInputManager.html#999861"><code>PINSetInputTriggerState</code></a>. An example of the trigger is the lower right arrow shown in <a href="PIMConcept.html#995802">Figure 9.1</a> and <a href="PIMConcept.html#995812">Figure 9.2</a>. 
</ul>
<h3 class="hbH3">
  <a name="995986"> </a>Setting the Input Area Policy <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="995991"> </a>The input area policy that you set with <a href="../PalmOSReference/Form.html#1085883"><code>FrmSetDIAPolicyAttr</code></a> specifies whether your form supports a dynamic input area. <a href="PIMConcept.html#995918">Listing 9.2</a> shows how you might call <code>FrmSetDIAPolicyAttr</code> in your application's <code>AppHandleEvent</code>. </p>

<p><a name="996012"> </a>Most forms should use a policy of <code>frmDIAPolicyCustom</code>. If not, the system treats your form as it does all forms in a legacy application. It opens the input area when the form is opened so that the form has the normal square area in which to draw, and it disables the input trigger so that the user cannot close the input area while your form is being displayed. </p>

<div><hr>
  <a name="996013"> </a> <b>NOTE: </b> Future Palm OS versions might not disable the input trigger for legacy applications or forms. 
<hr>
</div>

<p><a name="996014"> </a>The input area policy is set on a form-by-form basis rather than an application-by-application basis because each form might have different requirements for the input area. A form that relies heavily on user input might need to ensure that the input area is opened while the form is active. However, a form that has no editable fields, like an address list, may want to keep the input area closed so that more information is visible. </p>
<h3 class="hbH3">
  <a name="996016"> </a>Enabling the Input Trigger <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996017"> </a>For each form in your application that uses the policy <code>frmDIAPolicyCustom</code>, you can enable the input area's input trigger. Use the function <a href="../PalmOSReference/PenInputManager.html#999861"><code>PINSetInputTriggerState</code></a> to enable the trigger (see <a href="PIMConcept.html#995918">Listing 9.2</a>). </p>

<p><a name="996035"> </a>You must enable the input trigger for each form because a system dialog might disable it. System dialogs appear on top of your application's forms. When the dialog is dismissed and control returns to your application, the input trigger may be disabled. You won't receive a <code>frmLoadEvent</code> or <code>frmOpenEvent</code> because your form is already loaded and opened. Instead, you get the <code>winEnterEvent</code>. Therefore, to make sure your users can open and close the input area while your application is active, even after a system dialog is displayed, you must enable the trigger in response to the <code>winEnterEvent</code>.</p>

<p><a name="996040"> </a>Note that the key code associated with the input trigger button is <code>vchrInputAreaControl</code>, so a <code>keyDownEvent</code> with this character is enqueued whenever the trigger is tapped.</p>
<h3 class="hbH3">
  <a name="996042"> </a>Setting an Input Area State <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1000521"> </a>You can set the input area state with the function <a href="../PalmOSReference/PenInputManager.html#999819"><code>PINSetInputAreaState</code></a>. Most forms should set the input area state to <code>pinInputAreaUser</code>, which lets the user decide whether the input area is open or closed, in response to the <code>frmOpenEvent</code>. </p>

<p><a name="996044"> </a>In rare cases, it may be beneficial for the form to decide whether the input area is opened or closed. For example, you might have a tall form that closes the input area so that the user can see the entire form without scrolling. f you explicitly set the input area state to opened or closed, you may need to do so in <code>winEnterEvent</code> because a system dialog may appear on top of your form and reset the input area state. </p>

<p><a name="996067"> </a>Be careful not to set the input area state too much. If the input area is opened and closed automatically in too many instances, the result may be a jumpy user interface that produces a jarring user experience. It is probably best to let your users decide what they want to do. </p>

<h2 class="haH2">
  <a name="996069"> </a>Resizing a Form <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996070"> </a>When the Pen Input Manager opens or closes the input area or control bar or changes the display orientation, it broadcasts the <a href="../PalmOSReference/Notifications.html#1069319"><code>sysNotifyDisplayResizedEvent</code></a> notification to all applications that have registered for it. </p>

<p><a name="996075"> </a>When the application receives the <code>sysNotifyDisplayResizedEvent</code>, it must post a <code>winDisplayChangedEvent</code> (using <code>EvtAddUniqueEventToQueue</code>), which forms can handle to resize themselves.</p>
<p class="CCodeCaption">
  <a name="996078"> </a><b>Listing 9.3&nbsp;&nbsp;Posting a winDisplayChangedEvent</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
case sysAppLaunchCmdNotify:<a name="996079"> </a>
   if (((SysNotifyParamType*) cmdPBP)-&gt;notifyType == <a name="996080"> </a>
         sysNotifyDisplayResizedEvent)<a name="996081"> </a>
      {<a name="996082"> </a>
      EventType resizedEvent;
      MemSet(&amp;resizedEvent, sizeof(EventType), 0);<a name="996083"> </a>
      //add winDisplayChangedEvent to the event queue<a name="996084"> </a>
      resizedEvent.eType = winDisplayChangedEvent;<a name="996085"> </a>
      EvtAddUniqueEventToQueue(&amp;resizedEvent, 0, true);<a name="996086"> </a>
      }<a name="996087"> </a>
   break;<a name="996088"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996089"> </a>It's possible for the input area to change state while a menu is open. To handle this case, an application should also enqueue a <code>winDisplayChangedEvent</code> (using code similar to <a href="PIMConcept.html#996078">Listing 9.3</a>) when it receives a <code>winEnterEvent</code>.</p>

<p><a name="996093"> </a>The notification contains a rectangle specifying the new bounds for the current form. In general, forms should respond to the closing of the input area by moving any command buttons to the bottom of the new rectangle and by resizing the data area of the display. </p>

<p><a name="996097"> </a><a href="PIMConcept.html#996100">Listing 9.4</a> shows a simple example of handling the <code>winDisplayChangedEvent</code>.</p>
<p class="CCodeCaption">
  <a name="996100"> </a><b>Listing 9.4&nbsp;&nbsp;Handling winDisplayChangedEvent</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// Input area was opened or was closed. Must resize form. <a name="996101"> </a>
case winDisplayChangedEvent:<a name="996102"> </a>
   // get the current bounds for the form<a name="996103"> </a>
   frmP = FrmGetActiveForm();<a name="996104"> </a>
   WinGetBounds (FrmGetWindowHandle(frmP), &amp;curBounds);<a name="996105"> </a>
<a name="996106"> </a>
   // get the new display window bounds<a name="996107"> </a>
   WinGetBounds(WinGetDisplayWindow(), &amp;displayBounds);<a name="996108"> </a>
<a name="996109"> </a>
   EditFormResizeForm(frmP, &amp;curBounds, &amp;displayBounds);<a name="996110"> </a>
   WinSetBounds(FrmGetWindowHandle(frmP), &amp;displayBounds);<a name="1002106"> </a>
   FrmDrawForm(frmP);<a name="996111"> </a>
   handled = true;<a name="996112"> </a>
   break;<a name="996113"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996114"> </a>This example is for a form containing one multi-line text field, a scroll bar, and several command buttons at the bottom of the form. It responds to the <code>winDisplayChangedEvent</code> by passing the form's current bounds and new bounds to a function named <code>EditFormResizeForm</code>, which is shown in <a href="PIMConcept.html#996121">Listing 9.5</a>. This function determines the difference between the current height and width and the new height and width and then applies that difference to the objects in the form. For the command buttons, it changes their position so that they always appear at the bottom of the form. For the text field and scroll bar, it resizes them so that more text lines are displayed on the screen. </p>

<p><a name="996119"> </a>Note that after resizing a form with a text field, it is a good idea to call <code>FldRecalculateField</code> to update the word-wrapping for the field's new size.</p>
<p class="CCodeCaption">
  <a name="996121"> </a><b>Listing 9.5&nbsp;&nbsp;Resizing a form</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
void EditFormResizeForm(FormType *frmP, <a name="996122"> </a>
RectangleType* fromBoundsP, RectangleType* toBoundsP) <a name="996123"> </a>
{<a name="996124"> </a>
   Int16 heightDelta, widthDelta; <a name="996125"> </a>
   UInt16 numObjects, i;<a name="996126"> </a>
   Coord x, y;<a name="996127"> </a>
   RectangleType objBounds;<a name="996128"> </a>
<a name="996129"> </a>
   heightDelta = widthDelta = 0;<a name="996130"> </a>
   numObjects = 0;<a name="996131"> </a>
   x = y = 0;<a name="996132"> </a>
   FieldType* fldP;<a name="996133"> </a>
<a name="996134"> </a>
   // Determine the amount of the change<a name="996135"> </a>
   heightDelta=(toBoundsP-&gt;extent.y - toBoundsP-&gt;topLeft.y) - <a name="996136"> </a>
      (fromBoundsP-&gt;extent.y - fromBoundsP-&gt;topLeft.y);<a name="996137"> </a>
   widthDelta=(toBoundsP-&gt;extent.x - toBoundsP-&gt;topLeft.x) - <a name="996138"> </a>
      (fromBoundsP-&gt;extent.x - fromBoundsP-&gt;topLeft.x);<a name="996139"> </a>
<a name="996140"> </a>
   // Iterate through objects and re-position them. <a name="996141"> </a>
   // This form consists of a big text field and <a name="996142"> </a>
   // command buttons. We move the command buttons to the <a name="996143"> </a>
   // bottom and resize the text field to display more data.<a name="996144"> </a>
   numObjects = FrmGetNumberOfObjects(frmP);<a name="996145"> </a>
   for (i = 0; i &lt; numObjects; i++) {<a name="996146"> </a>
      switch (FrmGetObjectType(frmP, i)) {<a name="996147"> </a>
         case frmControlObj:<a name="996148"> </a>
            FrmGetObjectPosition(frmP, i, &amp;x, &amp;y);<a name="996149"> </a>
            FrmSetObjectPosition(frmP, i, x + widthDelta, y + <a name="996150"> </a>
               heightDelta);<a name="996151"> </a>
            break;<a name="996152"> </a>
         case frmFieldObj:<a name="996153"> </a>
         case frmScrollBarObj:<a name="996154"> </a>
            FrmGetObjectBounds(frmP, i, &amp;objBounds);<a name="996155"> </a>
            objBounds.extent.x += widthDelta;<a name="996156"> </a>
            objBounds.extent.y += heightDelta;<a name="996157"> </a>
            FrmSetObjectBounds(frmP, i, &amp;objBounds);<a name="996158"> </a>
            fldP = (FieldType*) FrmGetObjectPtr(frmP, i);<a name="996159"> </a>
            FldRecalculateField(fldP, false);<a name="996160"> </a>
            break;<a name="996161"> </a>
      }<a name="996162"> </a>
   }<a name="996163"> </a>
}<a name="996164"> </a>
</pre><div class="CodeRule"><hr></div>


<h2 class="haH2">
  <a name="996165"> </a>Hiding and Showing the Control Bar <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996166"> </a>There are two functions that applications can use to hide and show the control bar: <a href="../PalmOSReference/PenInputManager.html#999974"><code>StatHide</code></a> and <a href="../PalmOSReference/PenInputManager.html#999999"><code>StatShow</code></a>.</p>

<p><a name="996173"> </a>It's best not to manually hide or show the control bar, but there may be some situations in which an application needs to draw to the entire display area and thus must hide the control bar. However, if the control bar is hidden, this prevents users from exiting to the Launcher or opening the input area. If the control bar is hidden, you must provide a mechanism for the user to exit the application or to show the control bar.</p>

<p><a name="996174"> </a>To determine if the control bar is hidden or showing, you can call <a href="../PalmOSReference/PenInputManager.html#999949"><code>StatGetAttribute</code></a> with the <code>statAttrBarVisible</code> selector. You can obtain the bounds of the control bar by using the <code>statAttrDimension</code> selector.</p>

<p><a name="996178"> </a>Note that the <code>Stat</code>... functions are available only in Pen Input Manager version 1.1.</p>

<h2 class="haH2">
  <a name="996180"> </a>Pen Input Manager Compatibility <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996181"> </a>Pen Input Manager version 1.1 was introduced with Palm OS Garnet version 5.3SC. There are some differences between Pen Input Manager version 1.1 and version 1.0. </p>

<p><a name="996182"> </a>The version of the Pen Input Manager is returned in the <code>version</code> parameter of the following <code>FtrGet</code> call:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
err = FtrGet(pinCreator, pinFtrAPIVersion, &amp;version);<a name="996183"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996184"> </a>We recommend writing your application to be compatible with all versions of the Pen Input Manager. It will be compatible if you follow the guidelines in this book.</p>

<p><a name="996185"> </a>This section documents the differences in version 1.1 so that you know the details. They include: </p>
<ul type="disc">
  <li><a name="996189"> </a><a href="PIMConcept.html#996211">New sysFtrNumInputAreaFlags Support</a>
  <li><a name="996193"> </a><a href="PIMConcept.html#996221">Additional winDisplayChangedEvent</a>
  <li><a name="996197"> </a><a href="PIMConcept.html#996228">Restoration of Input Trigger State</a>
  <li><a name="996201"> </a><a href="PIMConcept.html#996236">New pinInputAreaUser Input Area State</a>
  <li><a name="996205"> </a><a href="PIMConcept.html#996239">New Stat... Functions</a>
  <li><a name="996209"> </a><a href="PIMConcept.html#996253">New Support for Changing Display Orientation</a>
</ul>
<h3 class="hbH3">
  <a name="996211"> </a>New sysFtrNumInputAreaFlags Support <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996212"> </a>The presence of the Pen Input Manager in version 1.1 does not indicate the capabilities of the device. In version 1.0, the device supports all of the features in the following sections (listed immediately above), and the flags are not implemented.</p>

<p><a name="996213"> </a>In version 1.1, you must test another feature, <code>sysFtrNumInputAreaFlags</code>, to determine if the device supports a dynamic input area, live ink, and a closable dynamic input area.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
err = FtrGet(sysFtrCreator, sysFtrNumInputAreaFlags, &amp;flags)<a name="996214"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996215"> </a>A selector is available to determine if the OS supports the dynamic input area. If the <code>grfFtrInputAreaFlagDynamic</code> flag is set to 0, or <code>FtrGet</code> returns an error, then the dynamic input area is not supported. Likewise, if the <code>grfFtrInputAreaFlagCollapsible</code> flag is set to 0, or if <code>FtrGet</code> returns an error, then a closable dynamic input area is not supported.</p>

<p><a name="996216"> </a>The <code>flags</code> argument is initialized using bits defined in <code>Graffiti.h</code>:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
#define grfFtrInputAreaFlagDynamic 0x00000001<a name="996217"> </a>
#define grfFtrInputAreaFlagLiveInk 0x00000002<a name="996218"> </a>
#define grfFtrInputAreaFlagCollapsible 0x00000004<a name="996219"> </a>
</pre><div class="CodeRule"><hr></div>

<h3 class="hbH3">
  <a name="996221"> </a>Additional winDisplayChangedEvent <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996222"> </a>Version 1.1 of the Pen Input Manager uses an additional mechanism for notifying applications that the input area or control bar has opened or closed. Version 1.0 sends the <code>sysNotifyDisplayResizedEvent</code> notification, while version 1.1 sends this notification and also the <code>winDisplayChangedEvent</code>.</p>

<p><a name="996223"> </a>To be compatible with both versions, an application should post a <code>winDisplayChangedEvent</code> (using <code>EvtAddUniqueEventToQueue</code>) when the <code>sysNotifyDisplayResizedEvent</code> notification is received. <a href="PIMConcept.html#996078">Listing 9.3</a> shows how to do this.</p>
<h3 class="hbH3">
  <a name="996228"> </a>Restoration of Input Trigger State <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996229"> </a>With Pen Input Manager version 1.1, if you set an input area policy of <code>frmDIAPolicyCustom</code> but don't call <code>PINSetInputTriggerState</code> to enable or disable the trigger or call <code>PINSetInputAreaState</code> to open or close the input area, then the system automatically restores the last user-selected input area state and enables the trigger (1.0 doesn't do this). If <code>PINSetInputAreaState</code> and/or <code>PINSetInputTriggerState</code> is called by the application, however, then the form's resulting state is restored when the form is updated due to a call to <code>FrmDrawForm</code> or a <code>WinEnterEvent</code>.</p>

<p><a name="996230"> </a>With Pen Input Manager version 1.0, you must enable the input trigger for each form because a system dialog might disable it. System dialogs appear on top of your application's forms. System dialogs use the same input area policy as legacy applications do: the input area is opened and the user is not allowed to close it. When the dialog is dismissed and control returns to your application, the input trigger will still be disabled. You won't receive a <code>frmLoadEvent</code> or <code>frmOpenEvent</code> because your form is already loaded and opened. Instead, you get the <code>winEnterEvent</code>. Therefore, to make sure your users can open and close the input area while your application is active, even after a system dialog is displayed, you must enable the trigger in response to the <code>winEnterEvent</code>. </p>
<h3 class="hbH3">
  <a name="996236"> </a>New pinInputAreaUser Input Area State <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996237"> </a>Pen Input Manager version 1.1 implements a new input area state: <code>pinInputAreaUser</code>. However, you can use this state in applications designed to run in both 1.0 and 1.1 environments, because it will simply be ignored in 1.0.</p>
<h3 class="hbH3">
  <a name="996239"> </a>New Stat... Functions <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996240"> </a>The following new functions are implemented in Pen Input Manager version 1.1, but not in version 1.0:</p>

<p><a name="996250"> </a><a href="../PalmOSReference/PenInputManager.html#999949"><code>StatGetAttribute</code></a>, <a href="../PalmOSReference/PenInputManager.html#999974"><code>StatHide</code></a>, and <a href="../PalmOSReference/PenInputManager.html#999999"><code>StatShow</code></a></p>

<p><a name="996251"> </a>It's best not to use these functions in order to be compatible with devices running Pen Input Manager version 1.0.</p>
<h3 class="hbH3">
  <a name="996253"> </a>New Support for Changing Display Orientation <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996254"> </a>Pen Input Manager version 1.1 implements support for changing the display orientation between portrait, landscape, and the reverse of each. This allows the display to be rotated to any of the four possible directions.</p>

<p><a name="996255"> </a>The following functions support the display orientation feature: <a href="../PalmOSReference/PenInputManager.html#1000022"><code>SysGetOrientation</code></a>, <a href="../PalmOSReference/PenInputManager.html#1000046"><code>SysSetOrientation</code></a>, <a href="../PalmOSReference/PenInputManager.html#1009260"><code>SysGetOrientationTriggerState</code></a>, <a href="../PalmOSReference/PenInputManager.html#1000098"><code>SysSetOrientationTriggerState</code></a>.</p>

<p><a name="996268"> </a>Not all devices support changing the display orientation. For devices that don't support changing the display orientation, the only valid orientation is portrait.</p>

<div><hr>
  <a name="996269"> </a> <b>NOTE: </b> Orientation support is implemented only in Pen Input Manager version 1.1 in Palm OS Garnet version 5.3 and later. Pen Input Manager version 1.1 is available on earlier OS versions, but depending on licensee support, it may or may not include this feature. To check if this function is implemented in Pen Input Manager 1.1 in a Palm OS version earlier than 5.3, you must use <code>SysGlueTrapExists</code>.
<hr>
</div>

<p><a name="996503"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996-2004, PalmSource, Inc. and its affiliates.  All rights reserved. <br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="Companion_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="CompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Text.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="AttnsAndAlarms.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CompanionIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>