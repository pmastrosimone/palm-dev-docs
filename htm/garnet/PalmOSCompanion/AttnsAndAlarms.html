<html>
<head>
<title>(68K) Attentions and Alarms | Palm OS&#174; Programmer's Companion</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 10:43:16">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="1042539"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="CompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="PIMConcept.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SystemFeatures.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CompanionIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">10 &nbsp;&nbsp;
Attentions and Alarms</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Palm OS&#174; Programmer's Companion</p>
<p class="SubTitle">Volume I </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1"><a href="AttnsAndAlarms.html">10  Attentions and Alarms</a></h1>

   <h2 class="SideTOC2"><a href="#1042551">
   Getting the User's Attention</a></h2>

      <h3 class="SideTOC3"><a href="#1042554">
      The Role of the Attention Manager</a></h3>

      <h3 class="SideTOC3"><a href="#1042574">
      Attention Manager Operation</a></h3>

      <h3 class="SideTOC3"><a href="#1042657">
      Getting the User's Attention</a></h3>

      <h3 class="SideTOC3"><a href="#1042901">
      Attentions and Alarms</a></h3>

      <h3 class="SideTOC3"><a href="#1042934">
      Detecting and Updating Pending Attentions</a></h3>

      <h3 class="SideTOC3"><a href="#1042998">
      Detecting Device Capabilities</a></h3>

      <h3 class="SideTOC3"><a href="#1043019">
      Controlling the Attention Indicator</a></h3>

   <h2 class="SideTOC2"><a href="#1043036">
   Alarms</a></h2>

      <h3 class="SideTOC3"><a href="#1043058">
      Setting an Alarm</a></h3>

      <h3 class="SideTOC3"><a href="#1043122">
      Alarm Scenario</a></h3>

      <h3 class="SideTOC3"><a href="#1043168">
      Setting a Procedure Alarm</a></h3>

   <h2 class="SideTOC2"><a href="#1043230">
   Summary of Attentions and Alarms</a></h2>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1042540"> </a>In this chapter you learn how to get the user's attention and how to set real-time alarms that can be used to either perform some periodic activity or display a reminder to the user.</p>

<p><a name="1042541"> </a>This chapter is divided into the following broad topics: </p>
<ul type="disc">
  <li><a name="1042545"> </a><a href="AttnsAndAlarms.html#1042551">Getting the User's Attention</a> begins with an introduction to the Attention Manager. This is followed by a detailed description of the Attention Manager from a user's perspective. Finally, it details what developers need to do in order to use the Attention Manager in their applications.
  <li><a name="1042549"> </a><a href="AttnsAndAlarms.html#1043036">Alarms</a> covers the Alarm Manager, which can notify your programs when a specified point in time is reached.
</ul>

<h2 class="haH2">
  <a name="1042551"> </a>Getting the User's Attention <a href="#1042539"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1042552"> </a>Palm OS<sup>&#174;</sup> 4.0 introduces a standard mechanism that manages competing demands for the user's attention by both applications and drivers. This mechanism is known as the Attention Manager. </p>
<h3 class="hbH3">
  <a name="1042554"> </a>The Role of the Attention Manager <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1042555"> </a>This section provides a brief introduction to the Attention Manager. It covers the relationship between the Attention, Alarm and Notification Managers, and then discusses when it is appropriate to make use of the Attention Manager.</p>

<p><a name="1042556"> </a>The Attention Manager provides a standard mechanism by which applications can tell the user that something of significance has occurred. It is designed to support communications devices which can receive data without explicit user interaction. The Attention Manager is responsible only for interacting with the user; it is not responsible for generating those events. In particular, the Alarm Manager can be used in conjunction with the Attention Manager to inform the user that a particular point in time has been reached.</p>

<p><a name="1042558"> </a>By maintaining a single list of all "alarm-like" things, the Attention Manager also improves the user's experience when returning to the handheld after being gone for a while: he no longer has to click through a series of old alarm dialogs. Often the user doesn't care about most of the missed appointments&#8212;although he might care about a few of them. Without the Attention Manager, the user cannot selectively dismiss or follow up on dialogs.</p>

<p><a name="1042559"> </a>Applications have complete control over the types of attention they can ask for. They can query the handheld for the set of special effects available&#8212;possibly including sound, vibration, and an LED&#8212;and then act on that set. The default option is to beep. All other options are either on or off; different vibrating patterns or multicolored LEDs are currently not supported. Note that the set of special effects is extensible; manufacturers may choose to add other means to get the user's attention beyond the anticipated LED and vibration.</p>

<div><hr>
  <a name="1042560"> </a> <b>IMPORTANT: </b> The Attention Manager was introduced in Palm OS 4.0. Applications running on earlier versions of the Palm OS need to use the techniques described under <a href="AttnsAndAlarms.html#1043036">"Alarms"</a>. 
<hr>
</div>

<p><a name="1042564"> </a>In Palm OS 4.0, the Datebook, SMS, and Clock applications use the Attention Manager. Refer to the Datebook application's source code for real-world examples of how you might use the Attention and Alarm Managers.</p>

<h4 class="hcH4">
  <a name="1042565"> </a>Attentions, Alarms and Notifications
</h4>

<p><a name="1042566"> </a>The Attention, Alarm, and Notification Managers are distinct subsystems that are often used in combination. </p>
<ul type="disc">
  <li><a name="1042567"> </a>The Attention Manager is designed solely to interact with the user when an event must be brought to the user's attention. 
  <li><a name="1042568"> </a>The Alarm Manager simply sends an event to an application when a particular point in time is reached. The application can then use the Attention Manager or some other mechanism to bring the alarm to the user's attention, if appropriate.
  <li><a name="1042569"> </a>The Notification Manager informs those applications that have registered their interest whenever certain system-level or application-level events occur. If the user is to be informed of the event, the executable can use the Attention Manager. The Attention Manager itself uses the Notification Manager to broadcast notifications when getting the user's attention or nagging him about an existing attention item. 
</ul>

<h4 class="hcH4">
  <a name="1042570"> </a>When the Attention Manager Isn't Appropriate
</h4>

<p><a name="1042571"> </a>The Attention Manager is only designed for attempts to get attention that can be effectively suspended. It is not suitable for anything requiring an immediate response, such as a request to connect to another user or the "put away" dialog that is used during beaming. The Attention Manager also doesn't attempt to replace error messages. Applications must use modal dialogs and other existing OS facilities to handle these cases.</p>

<p><a name="1042572"> </a>The Attention Manager is also not intended to replace the ToDo application, or to act as a universal inbox. Applications must make it clear that an item appearing in the Attention Manager is simply a reminder, and that dismissing it does not delete the item itself. That is, saying "OK" to an alarm does not delete the appointment, and dismissing an SMS reminder does not delete the SMS message from the SMS inbox.</p>
<h3 class="hbH3">
  <a name="1042574"> </a>Attention Manager Operation <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1042575"> </a>This section provides a detailed introduction to the Attention Manager from a user's point of view, introducing some of the terminology used throughout the rest of the chapter and pointing out operational subtleties that you should be aware of when developing applications that use the Attention Manager.</p>

<p><a name="1042577"> </a>Attention-getting attempts can either be <b>insistent</b> or <b>subtle</b>. They differ only in the lengths to which each goes to get your attention. Insistent attempts get "in your face" by popping up a dialog and triggering other visible and audible special effects in an effort to bring important events to your attention. A meeting reminder or incoming high-priority email message might warrant interrupting your work in this fashion. Subtle attentions substitute a small on-screen <b>attention indicator</b> for the dialog, allowing you to be made aware of less-critical events without interrupting your current work flow. Although they can also trigger various special effects, subtle attentions don't typically do so. Examples of subtle events might include a reminder of an upcoming birthday or holiday, or an incoming SMS message.</p>

<h4 class="hcH4">
  <a name="1042580"> </a>Insistent Attentions
</h4>

<p><a name="1042581"> </a>When an application makes an insistent attempt to get the user's attention, the <b>detail dialog</b> opens:</p>

<p class="FFigureCaption">
  <a name="1042584"> </a><b>Figure 10.1&nbsp;&nbsp;Detail Dialog<div align="left"><img src="images/DetailView.gif" border="0" hspace="0" vspace="0">
</div></b>
</p>


<p><a name="1042595"> </a>The Attention Manager draws the title and the buttons. The application is responsible for drawing the rest. Most applications draw text and an appropriate icon, as shown in <a href="AttnsAndAlarms.html#1042584">Figure 10.1</a>.</p>

<p><a name="1042599"> </a>When a second application attempts to get attention, or when the first application makes a second attempt, and the first has not yet been dismissed or snoozed, the window changes to the <b>list dialog</b>, presenting a list of things that require the user's attention:</p>

<p class="FFigureCaption">
  <a name="1042601"> </a><b>Figure 10.2&nbsp;&nbsp;List Dialog<div align="left"><img src="images/ListView.gif" border="0" hspace="0" vspace="0">
</div></b>
</p>


<p><a name="1042612"> </a>In this dialog, the Attention Manager draws the title and the buttons, and manages the list of items including the checkbox in the left-hand column. Items are listed in order of occurrence, with the newest at the top. The application is responsible for drawing some part of each line, giving it some flexibility over what to display. Applications have space to draw an icon and two lines of text in the standard font on the right-hand side of the list area.</p>

<p><a name="1042614"> </a>In the detail dialog the OK button dismisses the item. In the list dialog, tapping the checkbox to the left of the item dismisses it. The Clear All button can be used to dismiss all items in the list view. Dismissing an item removes it from the list or closes the detail dialog. Note that although it is gone from the Attention Manager, the item itself remains in the application.</p>

<p><a name="1042615"> </a>Unique to the list view is a "Done" button which simply closes the list view. It makes no changes to items in the Attention Manager list, nor to any snooze timer.</p>

<p><a name="1042617"> </a>In either dialog, the "Snooze" button temporarily dismisses the Attention Manager dialog. The attention indicator remains visible and the user can redisplay the dialog at any time. After an interval of five minutes, if any attempts to get attention are still pending the Attention Manager redisplays the dialog. Snooze does not remove attempts to get attention.</p>

<p><a name="1042619"> </a>There is just one "Snooze" timer, and the snooze operation applies to the Attention Manager as a whole. This can lead to seemingly odd behavior when new attention items are coming in while there is currently a snooze in progress. This situation should be rare, however.</p>

<p><a name="1042621"> </a>To "go to" an individual item, tap the text or icon of the item in the list dialog or tap the "Go To" button in the detail dialog. This temporarily dismisses the Attention Manager and launches the appropriate application to display details about the item. For an SMS message, this could take you to the detail dialog showing the message, or, if there are more than one, it could take you to the list of pending SMS messages. For an alarm, this could take you to the Datebook view for the current day, with the current meeting scrolled into view. A successful "go to" also removes the attention item from the list.</p>

<p><a name="1042623"> </a>Note that while the Attention Manager dialogs are displayed, hard and soft buttons are ignored. This is to prevent you from missing an attention item when you turn on the handheld by pressing one of the hard keys.</p>

<h4 class="hcH4">
  <a name="1042625"> </a>Subtle Attentions
</h4>

<p><a name="1042626"> </a>When an application makes a subtle attempt to get the users attention, no dialog appears. Instead, the title bar of all applications that use the standard form title object show a blinking indicator.</p>

<p class="FFigureCaption">
  <a name="1042628"> </a><b>Figure 10.3&nbsp;&nbsp;Attention indicator</b>
</p>
<div align="left"><img src="images/AttentionIndicator.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="1042633"> </a>When the list contains one or more items, all of which have been seen by the user, the "star" indicator blinks on and off until the list is empty. When the list contains one or more unseen items, the attention indicator performs an "exploding star" animation.</p>

<p><a name="1042634"> </a>Tapping this indicator opens the Attention Manager in the list mode, even if there is only one item. Tapping to the right of the indicator, or tapping in the indicator's area when there are no pending attention attempts opens the menu bar as expected.</p>

<p><a name="1042636"> </a>The attention indicator only functions with applications which use a standard form title object. The indicator doesn't appear when:</p>
<ul type="disc">
  <li><a name="1042637"> </a>there are no items in the Attention Manager's queue.
  <li><a name="1042638"> </a>the current application uses a custom title.
  <li><a name="1042639"> </a>the current application draws in the title area.
  <li><a name="1042640"> </a>the current form uses the Dialog title style.
  <li><a name="1042641"> </a>the current application's form title is too narrow to include the attention indicator.
</ul>

<h4 class="hcH4">
  <a name="1042642"> </a>Special Effects
</h4>

<p><a name="1042643"> </a>When a new attention item is added, the Attention Manager performs some combination of special effects, which can include playing sounds, flashing a LED, and triggering vibration. The exact combination of effects depends on user settings and on the application itself.</p>

<p><a name="1042645"> </a>The Attention Manager attempts to open the dialog before performing any special effects so you know immediately why it is trying to get your attention. However, it may not be possible to open the Attention Manager dialog. If this is the case, the Attention Manager performs the special effects as soon as possible. It's better for the user to be made aware that something is happening, even if the handheld cannot say exactly what it is.</p>

<p><a name="1042646"> </a>System-wide user preferences control the special effects: the volume at which to play alarms, whether or not to flash the LED (if any), whether or not to vibrate (if equipped). Applications can override these system-wide settings in either a positive or a negative way. For instance, an application could always blink the LED, even if the user said not to, or never blink the LED, even if the user desires it in general.</p>

<h4 class="hcH4">
  <a name="1042647"> </a>Nagging
</h4>

<p><a name="1042648"> </a>As with Datebook alarms in Palm OS 3.5 and earlier, if you don't explicitly dismiss or snooze an attention item it continues to "nag" you at predefined intervals, using the item's specified special effects. Applications control how frequently the user should be reminded, and how many times before the Attention Manager gives up. </p>

<p><a name="1042650"> </a>When there are multiple attention items competing for nagging, the Attention Manager respects the nag settings for the most recent insistent item, or if there are none then for the most recent subtle item. Each special effect is handled separately; if one reminder wants sound but no vibration, and another wants vibration but no sound, the combination results in the sound from the first one and the vibration from the second one.</p>

<h4 class="hcH4">
  <a name="1042652"> </a>Attention Manager and Existing Applications
</h4>

<p><a name="1042653"> </a>The Attention Manager makes no attempt to override existing application behavior. If an application written for Palm OS 3.5 or earlier puts up a dialog to get the user's attention, the Attention Manager doesn't get involved. Applications must be specifically written to use the Attention Manager in order to take advantage of its features and seamless integration with the Palm<sup>&#8482;</sup> user experience.</p>

<p><a name="1042654"> </a>Some existing third-party applications put up modal alarm-like dialogs. These dialogs can potentially interfere with the Attention Manager. However, issuing of the UI launch code by the Alarm Manager is deferred until after the Attention Manager is closed. This prevents existing applications from putting up their dialogs while the Attention Manager is being displayed. If the reverse happens, and the Attention Manager pops up while an existing application is displaying an alarm-like dialog, only a "go to" becomes problematic: the third-party dialog may consume events required to perform the "go to," preventing it from taking place. This is acceptable, however, since the attention item remains in the Attention Manager's queue. Once the third-party dialog has been dismissed, you can then re-open the Attention Manager and re-initiate the "go to."</p>

<p><a name="1042655"> </a>Effectively, this means the Attention Manager always shows up on top of any existing application's alarm dialogs that use the Alarm Manager. This ensures that you'll most likely be greeted by the Attention Manager's list after a prolonged period of inactivity.</p>
<h3 class="hbH3">
  <a name="1042657"> </a>Getting the User's Attention <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1042658"> </a>This section shows how your applications request the user's attention through the Attention Manager.</p>

<p><a name="1042659"> </a>Getting the user's attention is simply a matter of calling <a href="../PalmOSReference/AttentionMgr.html#996555"><code>AttnGetAttention</code></a> with the appropriate parameters and then handling various callbacks made by the Attention Manager. These callbacks allow your application to control what is displayed in the Attention Manager dialogs, to play sounds or perform other special effects, and to do any necessary processing when the user takes action on an existing attention item.</p>

<p><a name="1042664"> </a>The <code>AttnGetAttention</code> prototype looks like this:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Err AttnGetAttention (UInt16 cardNo,
LocalID dbID, UInt32 userData,
AttnCallbackProc *callbackFnP,
AttnLevelType level, AttnFlagsType flags,
UInt16 nagRateInSeconds, UInt16 nagRepeatLimit)<a name="1042665"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1042666"> </a>Specify the application requesting the user's attention in the <code>cardNo</code> and <code>dbID</code> arguments. You can use the <a href="../PalmOSReference/DataAndResourceManager.html#1009928"><code>DmGetNextDatabaseByTypeCreator</code></a> function to obtain these values.</p>

<p><a name="1042670"> </a><code>userData</code> is used to distinguish a given attention attempt from others made by the same application; most applications pass the unique ID or other key for the record which caused the attention request. This value is passed to your code through the callback function, and can be an integer, a pointer, or any other 32-bit value as needed by your application. </p>

<p><a name="1042671"> </a>The <code>callbackFnP</code> argument controls whether the Attention Manager invokes a callback function or issues a launch code to request services from your application. Applications typically supply <code>NULL</code> for this parameter, causing launch codes to be sent to the application specified by the <code>cardNo</code> and <code>dbID</code> arguments. See <a href="AttnsAndAlarms.html#1042694">"Callback or Launch Code?"</a> for a discussion of callback functions and launch codes.</p>

<p><a name="1042675"> </a>For the <code>level</code> argument, supply <code>kAttnLevelInsistent</code> or <code>kAttnLevelSubtle</code> depending on whether the given attention attempt is to be insistent or subtle.</p>

<p><a name="1042676"> </a>Regardless of the level of the attention attempt, set the appropriate bits in the <code>flags</code> argument to cause sounds to play, LEDs to blink, or other physical effects to be performed. Depending on which flags you specify, the effect can always occur or can be suppressed by the user. For instance, to trigger a sound while honoring the user's preferences, you need only supply <code>kAttnFlagsSoundBit</code>. Or, to blink the LED but suppress any sounds, regardless of any preferences the user may have set, supply a value of <code>kAttnFlagsAlwaysLED | kattnFlagsNoSound</code>. Finally, to choose only vibrate, do something like:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
flags = kAttnFlagsNothing ^ kAttnFlagsNoVibrate
   | kAttnFlagsAlwaysVibrate;<a name="1042677"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1042678"> </a>While the above is somewhat complex, it does ensure that you override all defaults in the negative except vibration, which is overridden in the positive. See the definition of <a href="../PalmOSReference/AttentionMgr.html#996077"><code>AttnFlagsType</code></a> in the <i>Palm OS Programmer's API Reference</i> for a complete set of constants that can be used in combination for the <code>flags</code> argument.</p>

<div><hr>
  <a name="1042685"> </a> <b>NOTE: </b> Applications may want to verify that the handheld is properly equipped to perform the desired effect. See <a href="AttnsAndAlarms.html#1042998">"Detecting Device Capabilities"</a> for information on how to do this. If the handheld isn't properly equipped to handle a given special effect, the effect isn't performed. For example, if you set the <code>kAttnFlagsLEDBit</code> flag and the Palm Powered&#8482; handheld doesn't have an LED, the attention attempt is processed as if the <code>kAttnFlagsLEDBit</code> had never been set.
<hr>
</div>

<p><a name="1042689"> </a>Assuming that the handheld is capable of getting the user's attention using the requested special effect, the <code>nagRateInSeconds</code> and <code>nagRepeatLimit</code> arguments control how often and how many times the special effect is triggered in an attempt to get the user's attention. As the name implies, specify the amount of time, in seconds, the Attention Manager should wait between special effect triggers with <code>nagRateInSeconds</code>. Indicate the desired number of times the effect should be triggered using <code>nagRepeatLimit</code>. Applications typically supply a value of 300 for <code>nagRateInSeconds</code> and a value of 3 for <code>nagRepeatLimit</code>, indicating that the special effect should be triggered three times after the initial attempt, at five minute intervals. </p>

<p><a name="1042691"> </a>The following line of code shows how the SMS application calls the Attention Manager upon receiving a new SMS message. Note that a subtle attention is generated so that the user isn't interrupted every time an SMS message is received. Also note that the application doesn't override the user's settings when getting his attention. Finally, if the user doesn't respond to the first attention-getting attempt, the special effects are repeated three additional times in five-minute intervals.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
err = AttnGetAttention(cardNo, dbID, NULL,
    NULL, kAttnLevelSubtle,
    kAttnFlagsUseUserSettings, 300, 3);<a name="1042692"> </a>
</pre><div class="CodeRule"><hr></div>


<h4 class="hcH4">
  <a name="1042694"> </a>Callback or Launch Code?
</h4>

<p><a name="1042696"> </a>For a given attention item, the Attention Manager calls back to the code resource that created that item whenever the Attention Manager needs the resource to draw the attention dialog contents or whenever it needs to inform the code resource of activity relating to the attention item. The Attention Manager calls back using one of two mechanisms:</p>
<ul type="disc">
  <li><a name="1042697"> </a>If a callback routine has been specified for a given attention item, the Attention Manager invokes it. This callback routine doesn't have application globals available to it, so it is important that anything necessary to draw or otherwise display be available through <code>commandArgsP</code>. A callback routine is typically used by libraries and system extensions. See the description of the <a href="../PalmOSReference/AttentionMgr.html#996838"><code>AttnCallbackProc</code></a> in the <i>Palm OS Programmer's API Reference</i> for the specifics of the callback routine.
  <li><a name="1042704"> </a>If a callback routine has not been specified for a given attention item, the Attention Manager instead sends a <a href="../PalmOSReference/AppLaunchCodes.html#1011602"><code>sysAppLaunchCmdAttention</code></a> launch code to the application that registered the attention item. Accompanying that launch code is an <a href="../PalmOSReference/AttentionMgr.html#996225"><code>AttnLaunchCodeArgsType</code></a> structure containing the three parameters documented above. Applications typically use the launch-code mechanism due to the restrictions that are placed on callback routines.
</ul>

<div><hr>
  <a name="1042712"> </a> <b>IMPORTANT: </b> It is your responsibility to ensure that the callback procedure is still in the same place when it gets called, dealing with the possibility that the code resource might be unlocked and moved in memory, and with the possibility that the database containing the code resource might be deleted. For the most part, these problems don't exist when using launch codes.
<hr>
</div>

<h4 class="hcH4">
  <a name="1042714"> </a>Attention Manager Commands
</h4>

<p><a name="1042718"> </a>In addition to calling <a href="../PalmOSReference/AttentionMgr.html#996555"><code>AttnGetAttention</code></a>, your code must also respond to commands from the Attention Manager. The Attention Manager issues these commands either by invoking a callback function or issuing a launch code, depending on what you supplied for the <code>callbackFnP</code> argument in the <code>AttnGetAttention</code> call. Among the possible commands are requests for your application to draw the contents of the detail and list dialogs, play application-specific sounds or perform other special effects, navigate to the item in your application that caused the attention item to be posted, and so forth.</p>

<h5 class="hdH5">
  <a name="1042720"> </a>Draw Detail and List Dialogs
</h5>

<p><a name="1042721"> </a>The Attention Manager's detail and list dialogs are drawn as a joint effort between the Attention Manager and applications requesting the user's attention. The shell of each dialog, the title, and the buttons and checkboxes are drawn by the Attention Manager, while the remainder&#8212;text specific to each attention attempt, and frequently an accompanying icon&#8212;is drawn by the application itself. This gives each application full control over what sort of information to display.</p>

<p class="FFigureCaption">
  <a name="1042722"> </a><b>Figure 10.4&nbsp;&nbsp;Attention Manager dialogs<div align="left"><img src="images/DetailAndListView.gif" border="0" hspace="0" vspace="0">
</div></b>
</p>


<p><a name="1042729"> </a>Although your application has full control over the display of its attention items, it may only draw in the designated area; active UI elements, such as scroll bars, custom buttons, or other widgets cannot be included. Users should be encouraged to launch the application with the "Go To" button and use the richer UI provided there. The clipping region is appropriately set so that your application cannot accidentally draw outside the designated area.</p>

<p><a name="1042731"> </a>The <code>kAttnCommandDrawDetail</code> command indicates that your application is to draw the contents of the detail dialog. Along with the command, the Attention Manager passes a structure of type <a href="../PalmOSReference/AttentionMgr.html#995966"><code>drawDetail</code></a>. This structure contains the window-relative boundaries of the screen rectangle in which your application is to draw, a flag indicating whether this is the first time the user has seen this attention item, and a set of flags indicating which special effects will also be triggered.</p>

<div><hr>
  <a name="1042736"> </a> <b>NOTE: </b> Unless the <code>firstTime</code> bit is set, the portion of the detail dialog in which your application draws is not guaranteed to be blank. If <code>firstTime</code> is not set, erase the area indicated by the <code>bounds</code> rectangle prior to drawing the contents of the detail dialog.
<hr>
</div>

<p><a name="1042737"> </a>The following code excerpt shows how a simple application might render the contents of the detail dialog in response to <a href="../PalmOSReference/AppLaunchCodes.html#1011602"><code>sysAppLaunchCmdAttention</code></a> launch code accompanied by a <code>kAttnCommandDrawDetail</code> command:</p>
<p class="CCodeCaption">
  <a name="1042741"> </a><b>Listing 10.1&nbsp;&nbsp;Drawing the contents of the detail dialog</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// Draw the icon<a name="1042742"> </a>
resH = DmGetResource(bitmapRsc, MyIconBitmap);<a name="1042743"> </a>
WinDrawBitmap(MemHandleLock(resH), 
    paramsPtr-&gt;drawDetail.bounds.topLeft.x,
    paramsPtr-&gt;drawDetail.bounds.topLeft.y + 4);<a name="1042744"> </a>
MemHandleUnlock(resH);<a name="1042745"> </a>
DmReleaseResource(resH);<a name="1042746"> </a>
 <a name="1042747"> </a>
// Draw the text. The content of the string depends on the<a name="1042748"> </a>
// uniqueID that accompanies the kAttnCommandDrawDetail<a name="1042749"> </a>
// command<a name="1042750"> </a>
curFont = FntSetFont (largeBoldFont);<a name="1042751"> </a>
x = paramsPtr-&gt;drawDetail.bounds.topLeft.x + 37;<a name="1042752"> </a>
y = paramsPtr-&gt;drawDetail.bounds.topLeft.y + 4;<a name="1042753"> </a>
WinDrawChars(alertString, StrLen(alertString), x, y);<a name="1042754"> </a>
FntSetFont(curFont);<a name="1042755"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1042756"> </a>For a more complex, real-world example, see the <code>DrawDetailAlarm</code> function in the Datebook application. In particular, note how that application adjusts the displayed text so that it all fits in the allocated space.</p>

<p><a name="1042757"> </a>Note that because subtle attention items are only shown using the list view, your application doesn't need to respond to <code>kAttnCommandDrawDetail</code> if it doesn't produce insistent attention attempts.</p>

<p><a name="1042759"> </a>The <code>kAttnCommandDrawList</code> command is similar; it indicates that your application is to draw a portion of the contents of the list dialog. Along with this command, the Attention Manager passes a structure of type <a href="../PalmOSReference/AttentionMgr.html#995996"><code>drawList</code></a>, which contains a <code>selected</code> flag in addition to the <code>bounds</code>, <code>firstTime</code>, and <code>flags</code> fields described above. The <code>selected</code> flag indicates whether the item has been selected. Before sending your application the <code>kAttnCommandDrawList</code> command, the Attention Manager sets the background, foreground, and text colors as follows, depending on whether or not the item is selected:</p>


<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1042767"> </a><b><span style="color: #000000;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">Affected Color</span></b></p>
    </th>
    <th><p class="tt"><a name="1042769"> </a><b>Not Selected</b></p>
    </th>
    <th><p class="tt"><a name="1042771"> </a><b>Selected</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1042773"> </a>Background Color</p>
    </td>
    <td><p class="tt"><a name="1042775"> </a><code>UIFieldBackground</code></p>
    </td>
    <td><p class="tt"><a name="1042777"> </a><code>UIObjectSelectedFill</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1042779"> </a>Foreground Color</p>
    </td>
    <td><p class="tt"><a name="1042781"> </a><code>UIObjectForeground</code></p>
    </td>
    <td><p class="tt"><a name="1042783"> </a><code>UIObjectSelectedForeground</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1042785"> </a>Text Color</p>
    </td>
    <td><p class="tt"><a name="1042787"> </a><code>UIObjectForeground</code></p>
    </td>
    <td><p class="tt"><a name="1042789"> </a><code>UIObjectSelectedForeground</code></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1042791"> </a>Particularly if your attention item icon is in color, you may need to draw the attention item differently when it is selected. The <code>selected</code> flag exists to allow you to do this.</p>

<p><a name="1042792"> </a>The code to draw an attention item in the list dialog is very similar to the code you use to draw the same item in the detail dialog. Here is an excerpt:</p>
<p class="CCodeCaption">
  <a name="1042793"> </a><b>Listing 10.2&nbsp;&nbsp;Drawing the contents of the list dialog</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// Draw the icon. Ignore the 'selected' flag for this example<a name="1042794"> </a>
resH = DmGetResource(bitmapRsc, MySmallIconBitmap);<a name="1042795"> </a>
iconP = (BitmapPtr)(MemHandleLock(resH));<a name="1042796"> </a>
// center it in the space allotted<a name="1042797"> </a>
iconOffset = (kAttnListMaxIconWidth - iconP-&gt;width)/2;<a name="1042798"> </a>
x = paramsPtr-&gt;drawList.bounds.topLeft.x;<a name="1042799"> </a>
y = paramsPtr-&gt;drawList.bounds.topLeft.y;<a name="1042800"> </a>
WinDrawBitmap(iconP, x + iconOffset, y);	<a name="1042801"> </a>
MemHandleUnlock(resH);<a name="1042802"> </a>
DmReleaseResource(resH);<a name="1042803"> </a>
 <a name="1042804"> </a>
// Draw the text<a name="1042805"> </a>
curFont = FntSetFont(stdFont);<a name="1042806"> </a>
WinDrawChars(alertString, StrLen(alertString), 
    x + kAttnListTextOffset, y);<a name="1042807"> </a>
FntSetFont(curFont);<a name="1042808"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1042809"> </a>The primary differences arise from the fact that the list dialog provides a smaller, more structured area in which to draw. Also, the area in which you draw will always have been erased before you are asked to draw in it, so you don't ever have to erase it beforehand.</p>

<p><a name="1042810"> </a>The icon should be no wider than <code>kAttnListMaxIconWidth</code> pixels, and should be centered within this width if it is smaller than <code>kAttnListMaxIconWidth</code>. The text should honor a left-hand margin of <code>kAttnListTextOffset</code> pixels. In the above example, the alert string is assumed to fit within the available space; see the <code>DrawListAlarm</code> function in the Datebook application for an example of how that application adjusts the displayed text in the event that it doesn't all fit in the allocated space.</p>

<div><hr>
  <a name="1042811"> </a> <b>NOTE: </b> Applications may, in certain rare circumstances, receive a <code>kAttnCommandDrawDetail</code> or <code>kAttnCommandDrawList</code> command for an item which is no longer valid. Respond by either calling <a href="../PalmOSReference/AttentionMgr.html#996527"><code>AttnForgetIt</code></a>, by drawing nothing, or by drawing an error message.
<hr>
</div>

<h5 class="hdH5">
  <a name="1042817"> </a>Play Sound or Perform a Custom Effect
</h5>

<p><a name="1042818"> </a>Most applications play a sound when attempting to get the user's attention. If the <code>kAttnFlagsAlwaysSound</code> is set when your application calls <a href="../PalmOSReference/AttentionMgr.html#996555"><code>AttnGetAttention</code></a>, the Attention Manager sends a <code>kAttnCommandPlaySound</code> command to your application when attempting to get the user's attention. Your application should simply play the appropriate sound in response to this command. Both the Datebook and SMS applications play sounds based upon the user's preferences when getting the user's attention; see the Datebook application's source code for an example of how to respond to the <code>kAttnCommandPlaySound</code> command.</p>

<p><a name="1042824"> </a>Because the Attention Manager can potentially play a sound, blink an LED, and vibrate in addition to displaying a dialog or blinking the attention indicator, most applications don't request that some other application-specific custom effect be performed. If your application needs to do something different, you can specify <code>kAttnFlagsAlwaysCustomEffect</code> when calling <code>AttnGetAttention</code>. This causes a <code>kAttnCommandCustomEffect</code> command to be sent to your application, at which time it should perform the desired effect. If your application is like most, however, it won't ever receive a <code>kAttnCommandCustomEffect</code> command, so you needn't worry about responding to it.</p>

<p><a name="1042826"> </a>Neither <code>kAttnCommandPlaySound</code> nor <code>kAttnCommandCustomEffect</code> are accompanied by any kind of data structure indicating the sound or effect to be performed. If your application doesn't hard-wire this information, you may want to store it in the application's preferences database.</p>

<h5 class="hdH5">
  <a name="1042828"> </a>Go There
</h5>

<p><a name="1042829"> </a>When the user taps on the "Go To" button in the detail view or on the item text or icon (not the checkbox) in the list view, your application receives a <code>kAttnCommandGoThere</code> command. It then needs to switch to your application and display the information relating to the chosen attention item. The <code>kAttnCommandGoThere</code> command is similar to the <a href="../PalmOSReference/AppLaunchCodes.html#1012140"><code>sysAppLaunchCmdGoTo</code></a> launch code, but you don't have globals when your application receives the <code>kAttnCommandGoThere</code> command and your application is called using <a href="../PalmOSReference/SystemManager.html#1075905"><code>SysAppLaunch</code></a>, rather than <a href="../PalmOSReference/SystemManager.html#1076980"><code>SysUIAppSwitch</code></a>. Because of this, most applications perform a <code>SysUIAppSwitch</code> upon receiving <code>kAttnCommandGoThere</code>.</p>

<p><a name="1042843"> </a>Note that your application should verify that the data that triggered the attention attempt is still relevant. In the Datebook, for instance, the user could:</p>
<ol type="1">
  <li value="1"><a name="1042844"> </a>Be alerted to an appointment by the Attention Manager.
  <li value="2"><a name="1042845"> </a>Tap "Snooze."
  <li value="3"><a name="1042846"> </a>Press the Datebook button and delete the appointment that was just brought to the user's attention.
  <li value="4"><a name="1042847"> </a>Tap the blinking attention indicator.
  <li value="5"><a name="1042848"> </a>Tap the attention item corresponding to the now-deleted appointment.
</ol>

<p><a name="1042849"> </a>In this scenario, the Datebook application could theoretically receive a <code>kAttnCommandGoThere</code> command along with a unique ID referencing a Datebook record that has been deleted. Whenever the Datebook application receives <code>kAttnCommandGoThere</code> along with a unique ID for a deleted Datebook database record, it calls <a href="../PalmOSReference/AttentionMgr.html#996527"><code>AttnForgetIt</code></a> for the now defunct attention item and then returns.</p>

<p><a name="1042854"> </a>In reality, the Datebook calls <code>AttnForgetIt</code> whenever the user deletes an alarm, and whenever an alarm is determined to be no longer valid. It can do this without even checking to see if the alarm is among those that the Attention Manager is currently tracking; if you pass a combination of card number, database ID, and unique ID to <code>AttnForgetIt</code> that doesn't correspond to an item in the Attention Manager's queue, <code>AttnForgetIt</code> does nothing and returns a value of <code>false</code>.</p>

<p><a name="1042855"> </a>Most applications will choose to call <code>AttnForgetIt</code> once the user has viewed the data corresponding to the attention item. This is how the SMS application operates: incoming messages are brought to the user's attention via the Attention Manager, and are removed from the Attention Manager's queue once they've been read.</p>

<h5 class="hdH5">
  <a name="1042857"> </a>Got It
</h5>

<p><a name="1042858"> </a>When the user dismisses a particular attention item, a <code>kAttnCommandGotIt</code> command is sent to the application. Along with this command is a boolean that indicates if the item was explicitly dismissed by the user, since <code>kAttnCommandGotIt</code> is also issued as the result of a successful <a href="../PalmOSReference/AttentionMgr.html#996527"><code>AttnForgetIt</code></a> call. Upon receipt of this command, you may want to clean up memory, delete an alarm, or do other application-specific processing. </p>

<h5 class="hdH5">
  <a name="1042866"> </a>Iterate
</h5>

<p><a name="1042867"> </a>When something happens that may potentially cause an application's attention items to become invalid, that application should call <a href="../PalmOSReference/AttentionMgr.html#996710"><code>AttnIterate</code></a>. <code>AttnIterate</code> generates a series of <code>kAttnCommandIterate</code> commands, one for each of the application's pending attention items. Thus, when your application receives a <code>kAttnCommandIterate</code> command it should validate the indicated attention item and take appropriate action if the item is no longer valid&#8212;up to and including calling <a href="../PalmOSReference/AttentionMgr.html#996527"><code>AttnForgetIt</code></a> for the item.</p>

<p><a name="1042877"> </a>The SMS application does not respond to <code>kAttnCommandIterate</code>. The Datebook does; this command is generated whenever the user updates his preferences. Many applications call <code>AttnIterate</code> after receiving a <a href="../PalmOSReference/AppLaunchCodes.html#1012389"><code>sysAppLaunchCmdSyncNotify</code></a> launch code so that they can update (with <a href="../PalmOSReference/AttentionMgr.html#996773"><code>AttnUpdate</code></a>) or remove (with <code>AttnForgetIt</code>) items which were affected by the HotSync<sup>&#174;</sup> operation.</p>

<p><a name="1042885"> </a>Note that you can safely call <code>AttnForgetIt</code> from within the iteration since <code>AttnForgetIt</code> only marks the record for deletion and thus doesn't confuse the iteration.</p>

<h5 class="hdH5">
  <a name="1042887"> </a>Snooze
</h5>

<p><a name="1042888"> </a>Most applications&#8212;including the Datebook and SMS applications&#8212;ignore <code>kAttnCommandSnooze</code>, which indicates that the user has tapped the Snooze button. Beyond the unique ID that identifies the attention item, nothing accompanies the Snooze command. <code>kAttnCommandSnooze</code> is passed to each and every item currently pending, insistent or subtle. This means that applications with more than one attention item pending receive this command more than once.</p>

<h4 class="hcH4">
  <a name="1042891"> </a>Triggering Special Effects
</h4>

<p><a name="1042892"> </a>The Attention Manager activates any requested special effects for each attention item, but your application might want to activate those special effects without also posting an attention item to the queue. You can do this through a call to <a href="../PalmOSReference/AttentionMgr.html#996502"><code>AttnDoSpecialEffects</code></a>. Supply the appropriate combination of flags to trigger the desired effects. See <a href="../PalmOSReference/AttentionMgr.html#996077"><code>AttnFlagsType</code></a> for a complete list of flags.</p>
<h3 class="hbH3">
  <a name="1042901"> </a>Attentions and Alarms <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1042903"> </a>The Attention Manager is often used in conjunction with the Alarm Manager to get the user's attention at a particular time. The basic use of the Alarm Manager is covered in <a href="AttnsAndAlarms.html#1043036">"Alarms"</a>, but because the Attention Manager handles UI synchronization, do the following when using the Alarm Manager with the Attention Manager:</p>
<ul type="disc">
  <li><a name="1042912"> </a>Call <a href="../PalmOSReference/AttentionMgr.html#996555"><code>AttnGetAttention</code></a> when your application receives the <a href="../PalmOSReference/AppLaunchCodes.html#1011569"><code>sysAppLaunchCmdAlarmTriggered</code></a> launch code.
  <li><a name="1042917"> </a>In your <code>sysAppLaunchCmdAlarmTriggered</code> handling code, set the <code>purgeAlarm</code> field in the launch code's parameter block to <code>true</code> before returning. This removes the alarm from the queue, so your application won't receive the <a href="../PalmOSReference/AppLaunchCodes.html#1011800"><code>sysAppLaunchCmdDisplayAlarm</code></a> launch code.
</ul>

<p><a name="1042923"> </a>Don't wait until the <code>sysAppLaunchCmdDisplayAlarm</code> launch code is received to call <code>AttnGetAttention</code>: <code>sysAppLaunchCmdDisplayAlarm</code> is not issued while another Alarm Manager dialog is open, so the Attention Manager is prevented from doing anything if a "legacy" application is displaying an Alarm Manager dialog.</p>

<div><hr>
  <a name="1042925"> </a> <b>NOTE: </b> If you want to use the Alarm Manager to force periodic updates of your application's attention items, don't call <a href="../PalmOSReference/AttentionMgr.html#996773"><code>AttnUpdate</code></a> after receiving an Alarm Manager launch code since this keeps the handheld from sleeping. Instead, use a procedure alarm a described under <a href="AttnsAndAlarms.html#1043168">"Setting a Procedure Alarm"</a> and call <code>AttnUpdate</code> from within your procedure alarm callback function.
<hr>
</div>
<h3 class="hbH3">
  <a name="1042934"> </a>Detecting and Updating Pending Attentions <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1042935"> </a>Once your application has requested that the Attention Manager get the user's attention, it may later need to update that attention request. For instance, if your application uses a single attention item to indicate that a number of unread messages have been received, it should update that item as additional items are received and read. The Attention Manager provides a handful of functions that allow applications to examine the Attention Manager's queue and update the items within that queue.</p>

<p><a name="1042940"> </a>The <a href="../PalmOSReference/AttentionMgr.html#996624"><code>AttnGetCounts</code></a> function allows you to determine how many items are currently competing for the user's attention. It always returns the total number of items, but can return the number of subtle and/or insistent items as well. It can also return the counts for all applications. For instance, the following would set <code>numItems</code> to the total number of pending attention items from all sources:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
numItems = AttnGetCounts(0, 0, NULL, NULL);<a name="1042941"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1042943"> </a>Or, to get the number of subtle and insistent attention items in addition to the total requested by a single application, use something like:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
numItems = AttnGetCounts(cardNo, dbID,
    &amp;insistentItems, &amp;subtleItems);<a name="1042944"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1042945"> </a>To verify each pending attention item for a given application, use the Attention Manager's <a href="../PalmOSReference/AttentionMgr.html#996710"><code>AttnIterate</code></a> function as described under <a href="AttnsAndAlarms.html#1042866">"Iterate"</a>.</p>

<p><a name="1042953"> </a>After a HotSync is a popular time to invoke <code>AttnIterate</code>; the HotSync operation may have altered the application's underlying data in such a way as to render pending attention items obsolete or invalid. </p>

<h4 class="hcH4">
  <a name="1042955"> </a>Deleting Pending Attention Items
</h4>

<p><a name="1042956"> </a>In many cases you'll need to delete an attention item. For instance, a HotSync may alter the underlying application data in such a way so as to invalidate the attention attempt. Or, the user might switch to your application and manually update the data in a similar way, for example by deleting an appointment for which there is a pending alarm. The <a href="../PalmOSReference/AttentionMgr.html#996527"><code>AttnForgetIt</code></a> function exists for this purpose. Simply invoke this function and supply the card number, database ID, and user data that uniquely identify the attention attempt. You don't even have to verify that the attention attempt is still in the Attention Manager's queue: <code>AttnForgetIt</code> doesn't complain if the attention attempt doesn't exist, merely returning a value of <code>false</code> to indicate this condition.</p>

<h4 class="hcH4">
  <a name="1042962"> </a>Updating Pending Attention Items
</h4>

<p><a name="1042967"> </a>To update an existing attention item, use <a href="../PalmOSReference/AttentionMgr.html#996773"><code>AttnUpdate</code></a>. This function is very similar to <a href="../PalmOSReference/AttentionMgr.html#996555"><code>AttnGetAttention</code></a>, though instead of actual values you pass pointers to those values you want to update. Supply <code>NULL</code> pointers for <code>flagsP</code>, <code>nagRateInSecondsP</code>, and/or <code>nagRepeatLimitP</code> to leave them untouched. For instance, to change the flags that control the special effects used to get the user's attention, do the following:</p>
<p class="CCodeCaption">
  <a name="1042971"> </a><b>Listing 10.3&nbsp;&nbsp;Updating an existing attention item</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// This assumes that cardNo, dbID, and myUserData are<a name="1042972"> </a>
// declared and set elsewhere to values that identify the<a name="1042973"> </a>
// attention item we're trying to update<a name="1042974"> </a>
Boolean updated;<a name="1042975"> </a>
AttnFlagsType newFlags;<a name="1042976"> </a>
 <a name="1042977"> </a>
// set newFlags appropriately<a name="1042978"> </a>
updated = AttnUpdate(cardNo, dbID, myUserData, NULL,
    &amp;newFlags, NULL, NULL);<a name="1042979"> </a>
if (updated){<a name="1042980"> </a>
    // update succeeded<a name="1042981"> </a>
} else {<a name="1042982"> </a>
    // update failed - attention item may no longer exist<a name="1042983"> </a>
}<a name="1042984"> </a>
</pre><div class="CodeRule"><hr></div>


<div><hr>
  <a name="1042985"> </a> <b>NOTE: </b> Although <code>AttnUpdate</code> may cause a given attention item to redraw, it does not rerun the special effects (if any) that occurred when that attention item was added. If you want to trigger Attention Manager effects for a particular item, call <a href="../PalmOSReference/AttentionMgr.html#996527"><code>AttnForgetIt</code></a> followed by <a href="../PalmOSReference/AttentionMgr.html#996555"><code>AttnGetAttention</code></a>.
<hr>
</div>

<p><a name="1042992"> </a>When calling <code>AttnUpdate</code>, note that you must not only supply the card number, database ID, and user data that uniquely identifies the attention attempt; you must also supply a pointer to the callback procedure if one is used.</p>

<p><a name="1042994"> </a>While updating the attention item, if the handheld is on and the Attention Manager dialog is currently showing then <code>AttnUpdate</code> forces the item to be redrawn. This in turn calls back to the client application so that it can update its portion of the dialog. <code>AttnUpdate</code> causes the specified item to be redrawn if it is visible, regardless of the <code>flags</code>, <code>nagRateInSeconds</code>, and <code>nagRepeatLimit</code> parameters.Thus, <code>AttnUpdate</code> isn't limited to updating one or more aspects of an attention item; it also allows an application to update the text of an attention attempt without having to destroy and then rebuild the Attention Manager dialog.</p>

<p><a name="1042996"> </a>Note that if the handheld is off, the update is delayed until the handheld is next turned on; <code>AttnUpdate</code> doesn't itself turn the screen on.</p>
<h3 class="hbH3">
  <a name="1042998"> </a>Detecting Device Capabilities <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1042999"> </a>Although you can blindly request that a given special effect, such as vibration, be used to get the user's attention without checking to see if that special effect is supported on the Palm Powered handheld, you may want your application to behave differently in the absence of a particular device feature. The Attention Manager defines a feature that you use with the <a href="../PalmOSReference/FeatureManager.html#1036943"><code>FtrGet</code></a> function to determine the handheld's physical capabilities. You can also use this feature to determine the user's attention-getting preferences. For example:</p>
<p class="CCodeCaption">
  <a name="1043003"> </a><b>Listing 10.4&nbsp;&nbsp;Checking for vibrate capability</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// See if the device supports vibration<a name="1043004"> </a>
FtrGet(kAttnFtrCreator, kAttnFtrCapabilities, &amp;capabilities);<a name="1043005"> </a>
if (capabilities &amp; kAttnFlagsHasVibrate){<a name="1043006"> </a>
    // Vibrate-specific processing goes here<a name="1043007"> </a>
    ...<a name="1043008"> </a>
}<a name="1043009"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1043015"> </a>See <a href="../PalmOSReference/AttentionMgr.html#996385">"Attention Manager Feature Constants"</a> in the <i>Palm OS Programmer's API Reference</i> for descriptions of all of the relevant flags.</p>
<h3 class="hbH3">
  <a name="1043019"> </a>Controlling the Attention Indicator <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1043020"> </a>For the most part, applications can ignore the attention indicator, which consumes a small portion of a form's title bar. If the currently-displayed form doesn't have a title bar, or if the form is modal, the attention indicator isn't drawn. However, if an application takes over the entire screen or does something special with the form's title bar, it should explicitly disable the attention indicator while the form is displayed.</p>

<p><a name="1043022"> </a>As an example, the Datebook application disables the attention indicator when:</p>
<ul type="disc">
  <li><a name="1043023"> </a>a note associated with a Datebook entry is displayed.
  <li><a name="1043024"> </a>an entry's description is being displayed in the week view.
  <li><a name="1043025"> </a>the time is being displayed in the title bar in place of the date.
</ul>

<p><a name="1043026"> </a>To disable the attention indicator, simply call <a href="../PalmOSReference/AttentionMgr.html#996652"><code>AttnIndicatorEnable</code></a> and supply a value of <code>false</code> for the <code>enableIt</code> argument. To re-enable it, simply call <code>AttnIndicatorEnable</code> again, this time supplying an argument value of <code>true</code>.</p>

<p><a name="1043030"> </a>If your application disables the attention indicator, it may want to provide some means for the user to open the Attention Manager's dialog in list mode. The <a href="../PalmOSReference/AttentionMgr.html#996752"><code>AttnListOpen</code></a> function can be used to do this.</p>

<h2 class="haH2">
  <a name="1043036"> </a>Alarms <a href="#1042539"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1043038"> </a>The Palm OS Alarm Manager provides support for setting real-time alarms, for performing some periodic activity, or for displaying a reminder. The Alarm Manager:</p>
<ul type="disc">
  <li><a name="1043039"> </a>Works closely with the Time Manager to handle real-time alarms.
  <li><a name="1043040"> </a>Sends launch codes to applications that set a specific time alarm to inform the application the alarm is due.
  <li><a name="1043041"> </a>Allows only one alarm to be set per application.
  <li><a name="1043042"> </a>Handles alarms by application in a two cycle operation:
  <ul type="disc">
    <li><a name="1043043"> </a>First, it notifies each application that the alarm has occurred; the application verifies that the alarm is still valid at this point. Applications that don't use the Attention Manager typically play a sound here.
    <li><a name="1043044"> </a>Second, after all pending alarms have received their first notification, it sends another notification to each application, allowing it to display some UI.
  </ul>
</ul>

<p><a name="1043045"> </a>The Alarm Manager doesn't have any UI of its own; applications that need to bring an alarm to the user's attention must do this themselves. It doesn't provide reminder dialog boxes, and it doesn't play the alarm sound. Applications running on Palm OS 4.0 should use the Attention Manager to interact with the user; see <a href="AttnsAndAlarms.html#1042901">"Attentions and Alarms"</a> for tips on doing this. Applications running on earlier versions of the Palm OS need to provide their own UI, as explained in the following sections.</p>

<div><hr>
  <a name="1043052"> </a> <b>IMPORTANT: </b> When the handheld is in sleep mode, alarms can occur almost a minute late. This is particularly important to note when utilizing procedure alarms (discussed in <a href="AttnsAndAlarms.html#1043168">"Setting a Procedure Alarm"</a>); although procedure alarms will continue to fire when the handheld is in sleep mode, they may fire less frequently.
<hr>
</div>
<h3 class="hbH3">
  <a name="1043058"> </a>Setting an Alarm <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1043059"> </a>The most common use of the Alarm Manager is to set a real-time alarm within an application. Often, you set this type of alarm because you want to inform the user of an event. For example, the Datebook application sets alarms to inform users of their appointments. </p>

<p><a name="1043060"> </a>Implementing such an alarm is a two step process. First, use the function <a href="../PalmOSReference/AlarmManager.html#995875"><code>AlmSetAlarm</code></a> to set the alarm. Specify when the alarm should trigger and which application should be informed at that time. </p>

<p><a name="1043068"> </a><a href="AttnsAndAlarms.html#1043070">Listing 10.5</a> shows how the Datebook application sets an alarm. </p>
<p class="CCodeCaption">
  <a name="1043070"> </a><b>Listing 10.5&nbsp;&nbsp;Setting an alarm</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
static void SetTimeOfNextAlarm (UInt32 alarmTime, UInt32 ref)<a name="1043071"> </a>
{<a name="1043072"> </a>
    UInt16 cardNo;<a name="1043073"> </a>
    LocalID dbID;<a name="1043074"> </a>
    DmSearchStateType searchInfo;<a name="1043075"> </a>
 <a name="1043076"> </a>
    DmGetNextDatabaseByTypeCreator (true, &amp;searchInfo,
        sysFileTApplication, sysFileCDatebook, true, &amp;cardNo,
        &amp;dbID);<a name="1043077"> </a>
 <a name="1043078"> </a>
    AlmSetAlarm (cardNo, dbID, ref, alarmTime, true);<a name="1043079"> </a>
}<a name="1043080"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1043084"> </a>Second, have your <a href="../PalmOSReference/SystemManager.html#1077030"><code>PilotMain</code></a> function respond to the launch codes <a href="../PalmOSReference/AppLaunchCodes.html#1011569"><code>sysAppLaunchCmdAlarmTriggered</code></a> and <a href="../PalmOSReference/AppLaunchCodes.html#1011800"><code>sysAppLaunchCmdDisplayAlarm</code></a>. </p>

<p><a name="1043093"> </a>When an alarm is triggered, the Alarm Manager notifies each application that set an alarm for that time via the <code>sysAppLaunchCmdAlarmTriggered</code> launch code. After each application has processed this launch code, the Alarm Manager sends each application <code>sysAppLaunchCmdDisplayAlarm</code> so that the application can display the alarm. The section <a href="AttnsAndAlarms.html#1043122">"Alarm Scenario"</a> gives more information about when these launch codes are received and what actions your application might take. For a specific example of responding to these launch codes, see the Datebook sample code included with Palm OS 3.5. </p>

<p><a name="1043097"> </a>It's important to note the following:</p>
<ul type="disc">
  <li><a name="1043098"> </a>An application can have only one alarm pending at a time. If you call <code>AlmSetAlarm</code> and then call it again before the first alarm has triggered, the Alarm Manager replaces the first alarm with the second alarm. You can use the <a href="../PalmOSReference/AlarmManager.html#995820"><code>AlmGetAlarm</code></a> function to find out if the application has any alarms pending. 
  <li><a name="1043103"> </a>You do not have access to global variables or code outside segment 0 (in a multi-segment application) when you respond to the launch codes. <code>AlmSetAlarm</code> takes a <code>UInt32</code> parameter that you can use to pass a specific value so that you have access to it when the alarm triggers. (This is the <code>ref</code> parameter shown in <a href="AttnsAndAlarms.html#1043070">Listing 10.5</a>.) The parameter blocks for both launch codes provide access to this reference parameter. If the reference parameter isn't sufficient, you can define an application feature. See the <a href="SystemFeatures.html#1045487">"Features"</a> section in the <a href="SystemFeatures.html#1045397">"Palm System Support"</a> chapter. 
  <li><a name="1043114"> </a>The database ID that you pass to <code>AlmSetAlarm</code> is the local ID of the <i>application</i> (the <code>.prc</code> file), not of the record database that the application accesses. You use record database's local ID more frequently than you do the application's local ID, so this is a common mistake to make. 
  <li><a name="1043115"> </a>In <code>AlmSetAlarm</code>, the alarm time is given as the number of seconds since 1/1/1904. If you need to convert a conventional date and time value to the number of seconds since 1/1/1904, use <a href="../PalmOSReference/DateAndTimeManager.html#1098496"><code>TimDateTimeToSeconds</code></a>. 
</ul>

<p><a name="1043120"> </a>If you want to clear a pending alarm, call <code>AlmSetAlarm</code> with 0 specified for the alarm seconds parameter. </p>
<h3 class="hbH3">
  <a name="1043122"> </a>Alarm Scenario <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1043123"> </a>Here's how an application and the Alarm Manager typically interact when processing an alarm:</p>
<ol type="1">
  <li value="1"><a name="1043127"> </a>The application sets an alarm using <a href="../PalmOSReference/AlarmManager.html#995875"><code>AlmSetAlarm</code></a>. 
   <p><a name="1043128"> </a>The Alarm Manager adds the new alarm to its alarm queue. The alarm queue contains all alarm requests. Triggered alarms are queued up until the Alarm Manager can send the launch code to the application that created the alarm. However, if the alarm queue becomes full, the oldest entry that has been both triggered and notified is deleted to make room for a new alarm.</p>
  <li value="2"><a name="1043129"> </a>When the alarm time is reached, the Alarm Manager searches the alarm queue for the first application that set an alarm for this alarm time.
  <li value="3"><a name="1043130"> </a>The Alarm Manager sends this application the <a href="../PalmOSReference/AppLaunchCodes.html#1011569"><code>sysAppLaunchCmdAlarmTriggered</code></a> launch code.
  <li value="4"><a name="1043135"> </a>The application can now:
  <ul type="disc">
    <li><a name="1043136"> </a>Set the next alarm.
    <li><a name="1043137"> </a>Play a short sound.
    <li><a name="1043138"> </a>Perform some quick maintenance activity. 
   <p><a name="1043139"> </a>The application should not perform any lengthy tasks in response to <code>sysAppLaunchCmdAlarmTriggered</code> because doing so delays other applications from receiving alarms that are set to trigger at the same time. </p>
   <p><a name="1043140"> </a>If the application is using the Attention Manager to bring this alarm to the user's attention, call <a href="../PalmOSReference/AttentionMgr.html#996555"><code>AttnGetAttention</code></a> here and set the <code>purgeAlarm</code> field in the launch codes' parameter block to <code>true</code> before returning.</p>
   <p><a name="1043144"> </a>If this alarm requires no further processing, the application should set the <code>purgeAlarm</code> field in the launch code's parameter block to <code>true</code> before returning. Doing so removes the alarm from the queue, which means it won't receive the <a href="../PalmOSReference/AppLaunchCodes.html#1011800"><code>sysAppLaunchCmdDisplayAlarm</code></a> launch code.</p>
  </ul>
  <li value="5"><a name="1043148"> </a>The Alarm Manager finds in the alarm queue the next application that set an alarm and repeats steps 2 and 3. 
  <li value="6"><a name="1043149"> </a>This process is repeated until no more applications are found with this alarm time.
  <li value="7"><a name="1043151"> </a>The Alarm Manager then finds once again the first application in the alarm queue who set an alarm for this alarm time and sends this application the launch code <a href="../PalmOSReference/AppLaunchCodes.html#1011800"><code>sysAppLaunchCmdDisplayAlarm</code></a>. Note that alarms that had their <code>purgeAlarm</code> field set to <code>true</code> during the processing of <code>sysAppLaunchCmdAlarmTriggered</code>&#8212;including all alarms that are being brought to the user's attention through the Attention Manager&#8212;are no longer in the queue at this point.
  <li value="8"><a name="1043153"> </a>The application can now:
  <ul type="disc">
    <li><a name="1043154"> </a>Display a dialog box.
    <li><a name="1043155"> </a>Display some other type of reminder.
   <p><a name="1043156"> </a>Applications typically create a nested event loop at this point to handle the dialog's events. This nested event loop ignores virtually all events that would cause the dialog to go away, causing the dialog to be fixed on the screen; it can't be dismissed until one of the embedded buttons is tapped. Note that the currently active application remains active. You may not be able to see it (if the alarm dialog is full screen) and you cannot interact with it because the dialog's nested event loop is processing all events. It is effectively suspended, waiting for an event to occur.</p>
  </ul>
  <li value="9"><a name="1043157"> </a>The Alarm Manager processes the alarm queue for the next application that set an alarm for the alarm being triggered and steps 7 and 8 are repeated. 
  <li value="10"><a name="1043158"> </a>This process is repeated until no more applications are found with this alarm time.
   <p><a name="1043159"> </a>If a new alarm time is triggered while an older alarm is still being displayed, all applications with alarms scheduled for this second alarm time are sent the <code>sysAppLaunchCmdAlarmTriggered</code> launch code, but the display cycle for the second set of alarms is postponed until all earlier alarms have finished displaying.</p>
</ol>

<p><a name="1043160"> </a>Note that when a second alarm goes off before the first has been dismissed, the alarm manager sends the <a href="../PalmOSReference/AppLaunchCodes.html#1011569"><code>sysAppLaunchCmdAlarmTriggered</code></a> launch code for the second alarm but waits to send the <a href="../PalmOSReference/AppLaunchCodes.html#1011800"><code>sysAppLaunchCmdDisplayAlarm</code></a> launch code until after the first alarm's dialog has been dismissed. For applications that put up dialogs, this typically means that only one dialog at a time will appear on the screen. The Alarm Manager doesn't return to the event loop between the issuing of launch codes, so when the first alarm's dialog has been dismissed, the second alarm's dialog is immediately displayed. The net result for the user is that each alarm dialog in turn must be dismissed before the handheld can be used.</p>
<h3 class="hbH3">
  <a name="1043168"> </a>Setting a Procedure Alarm <a href="#1042539"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1043170"> </a>Beginning with Palm OS version 3.2, the system supports setting procedure alarms in addition to the application-based alarms described in the previous sections. The differences between a procedure alarm and an application-based alarm are:</p>
<ul type="disc">
  <li><a name="1043171"> </a>When you set a procedure alarm, you specify a pointer to a function that should be called when the alarm triggers instead of an application that should be notified. 
  <li><a name="1043172"> </a>When the alarm triggers, the Alarm Manager calls the specified procedure directly instead of using launch codes. 
  <li><a name="1043174"> </a>If the system is in sleep mode, the alarm triggers without causing the LCD display to light up. 
</ul>

<p><a name="1043175"> </a>You might use procedure alarms if:</p>
<ul type="disc">
  <li><a name="1043176"> </a>You want to perform a background task that is completely hidden from the user. 
  <li><a name="1043177"> </a>You are writing a shared library and want to implement an alarm within that library. 
  <li><a name="1043182"> </a>You want to use <a href="../PalmOSReference/AttentionMgr.html#996773"><code>AttnUpdate</code></a> to update an attention item, but you don't want the display to turn on if the handheld is currently sleeping.
</ul>

<p><a name="1043188"> </a>To set a procedure alarm, you call <a href="../PalmOSReference/AlarmManager.html#995927"><code>AlmSetProcAlarm</code></a> instead of <a href="../PalmOSReference/AlarmManager.html#995875"><code>AlmSetAlarm</code></a>. (Similarly, you use the <a href="../PalmOSReference/AlarmManager.html#995845"><code>AlmGetProcAlarm</code></a> function instead of <a href="../PalmOSReference/AlarmManager.html#995820"><code>AlmGetAlarm</code></a> to see if any alarms are pending for this procedure.) </p>

<p><a name="1043199"> </a><code>AlmSetProcAlarm</code> is currently implemented as a macro that calls <code>AlmSetAlarm</code> using a special value for the card number parameter to notify the Alarm Manager that this is a procedure alarm. Instead of specifying the application's local ID and card number, you specify a function pointer. The other rules for <code>AlmSetAlarm</code> still apply. Notably, a given function can only have one alarm pending at a time, and you can clear any pending alarm by passing 0 for the alarm time. </p>

<p><a name="1043200"> </a>When the alarm triggers, the Alarm Manager calls the function you specified. The function should have the prototype:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
void <i>myAlarmFunc</i> (UInt16 almProcCmd,
SysAlarmTriggeredParamType *paramP)<a name="1043201"> </a>
</pre><div class="CodeRule"><hr></div>


<div><hr>
  <a name="1043202"> </a> <b>IMPORTANT: </b> The function pointer must remain valid from the time <code>AlmSetProcAlarm</code> is called to the time the alarm is triggered. If the procedure is in a shared library, you must keep the library open. If the procedure is in a separately-loaded code resource, the resource must remain locked until the alarm fires. When you close a library or unlock a resource, you must remove any pending alarms. If you don't, the system crashes when the alarm is triggered. 
<hr>
</div>

<p><a name="1043203"> </a>The first parameter to your function specifies why the Alarm Manager has called the function. Currently, the Alarm Manager calls the function in two instances:</p>
<ul type="disc">
  <li><a name="1043204"> </a>The alarm has triggered.
  <li><a name="1043205"> </a>The user has changed the system time, so the alarm time should be adjusted. 
</ul>

<p><a name="1043206"> </a>The second parameter is the same structure that is passed with the <a href="../PalmOSReference/AppLaunchCodes.html#1011569"><code>sysAppLaunchCmdAlarmTriggered</code></a> launch code. It provides access to the reference parameter specified when the alarm was set, the time specified when the alarm was set, and the <code>purgeAlarm</code> field, which specifies if the alarm should be removed from the queue. In the case of procedure alarms, the alarm should always be removed from the queue. The system sets the <code>purgeAlarm</code> value to <code>true</code> after calling your function. </p>

<p><a name="1043210"> </a>It is important to note that your procedure alarm function should not access global variables if the alarm could be triggered after the application that contains the procedure alarm function has terminated (even if the code remains locked in memory), since the globals no longer exist at this point.</p>

<h4 class="hcH4">
  <a name="1043213"> </a>Procedure Alarms and Menus
</h4>

<p><a name="1043214"> </a>Procedure alarms are often used to update the handheld's display on a regular basis. Menus aren't automatically informed when an alarm is triggered, so if a menu is open when your procedure alarm code updates the display, your code may overwrite the open menu. To detect an open menu, watch for <a href="../PalmOSReference/EventRef.html#997992"><code>winExitEvent</code></a> and <a href="../PalmOSReference/EventRef.html#1026487"><code>winEnterEvent</code></a> as described in <a href="UserInterface.html#1009635">"Checking Menu Visibility"</a> of the <i>Palm OS Programmer's Companion</i>, vol. I.</p>

<h2 class="haH2">
  <a name="1043230"> </a>Summary of Attentions and Alarms <a href="#1042539"><span class="nav">^TOP^</span></a>
</h2>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1043233"> </a><b>Attention Manager Functions</b></p>
    </th>
    <th><p class="tt"><a name="1043235"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1043240"> </a><a href="../PalmOSReference/AttentionMgr.html#996502">AttnDoSpecialEffects</a><br><a href="../PalmOSReference/AttentionMgr.html#996527">AttnForgetIt</a><br><a href="../PalmOSReference/AttentionMgr.html#996555">AttnGetAttention</a><br><a href="../PalmOSReference/AttentionMgr.html#996624">AttnGetCounts</a><br><a href="../PalmOSReference/AttentionMgr.html#996652">AttnIndicatorEnable</a></p>
    </td>
    <td><p class="tt"><a name="1043257"> </a><a href="../PalmOSReference/AttentionMgr.html#996686">AttnIndicatorEnabled</a><br><a href="../PalmOSReference/AttentionMgr.html#996710">AttnIterate</a><br><a href="../PalmOSReference/AttentionMgr.html#996752">AttnListOpen</a><br><a href="../PalmOSReference/AttentionMgr.html#996773">AttnUpdate</a></p>
    </td>
  </tr>
</table>

</div>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1043271"> </a><b>Alarm Manager Functions</b></p>
    </th>
    <th><p class="tt"><a name="1043273"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1043278"> </a><a href="../PalmOSReference/AlarmManager.html#995875">AlmSetAlarm</a><br><a href="../PalmOSReference/AlarmManager.html#995927">AlmSetProcAlarm</a></p>
    </td>
    <td><p class="tt"><a name="1043286"> </a><a href="../PalmOSReference/AlarmManager.html#995820">AlmGetAlarm</a><br><a href="../PalmOSReference/AlarmManager.html#995845">AlmGetProcAlarm</a></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1043291"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996-2004, PalmSource, Inc. and its affiliates.  All rights reserved. <br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="Companion_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="CompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="PIMConcept.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SystemFeatures.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CompanionIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>