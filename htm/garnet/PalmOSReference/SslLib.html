<html>
<head>
<title>(68K) SSL Library | Palm OS&#174; Programmer's  API Reference</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 10:47:53">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="1100916"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="ReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SmsLib.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SslLibMac.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ReferenceIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">86 &nbsp;&nbsp;
SSL Library</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Palm OS&#174; Programmer's  API Reference</p>
<p class="SubTitle">Palm OS&#174; 68K SDK </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="PartIV.html">Part IV: Libraries</a> </h1>
<h1 class="SideTOC1"><a href="SslLib.html">86  SSL Library</a></h1>

   <h2 class="SideTOC2"><a href="#1100943">
   SSL Library Structures and Types</a></h2>

      <h3 class="SideTOC3"><a href="#1100946">
      SslAttribute</a></h3>

      <h3 class="SideTOC3"><a href="#1100964">
      SslCallback</a></h3>

      <h3 class="SideTOC3"><a href="#1100992">
      SslCipherSuiteInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1101045">
      SslContext</a></h3>

      <h3 class="SideTOC3"><a href="#1101056">
      SslExtendedItem</a></h3>

      <h3 class="SideTOC3"><a href="#1101093">
      SslExtendedItems</a></h3>

      <h3 class="SideTOC3"><a href="#1101123">
      SslIoBuf</a></h3>

      <h3 class="SideTOC3"><a href="#1101153">
      SslLib</a></h3>

      <h3 class="SideTOC3"><a href="#1101165">
      SslSession</a></h3>

      <h3 class="SideTOC3"><a href="#1101210">
      SslSocket</a></h3>

      <h3 class="SideTOC3"><a href="#1101261">
      SslVerify</a></h3>

   <h2 class="SideTOC2"><a href="#1101330">
   SSL Library Constants</a></h2>

      <h3 class="SideTOC3"><a href="#1101332">
      SSL Open Mode Flags</a></h3>

      <h3 class="SideTOC3"><a href="#1101363">
      SSL Close Mode Flags</a></h3>

      <h3 class="SideTOC3"><a href="#1101384">
      Mode Attribute Values</a></h3>

      <h3 class="SideTOC3"><a href="#1101414">
      Protocol Versions</a></h3>

      <h3 class="SideTOC3"><a href="#1101426">
      Compatibility Flags</a></h3>

      <h3 class="SideTOC3"><a href="#1101453">
      SSL Callback Commands</a></h3>

      <h3 class="SideTOC3"><a href="#1101496">
      Cipher Suite Info Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1101536">
      Cipher Suites</a></h3>

      <h3 class="SideTOC3"><a href="#1101559">
      Info Callbacks</a></h3>

      <h3 class="SideTOC3"><a href="#1101614">
      InfoInterest Values</a></h3>

      <h3 class="SideTOC3"><a href="#1101636">
      LastApi Attribute Values</a></h3>

      <h3 class="SideTOC3"><a href="#1101684">
      LastIO Attribute Values</a></h3>

      <h3 class="SideTOC3"><a href="#1101707">
      SSL Protocol States</a></h3>

      <h3 class="SideTOC3"><a href="#1101776">
      SSL Server Alerts</a></h3>

      <h3 class="SideTOC3"><a href="#1101858">
      Verification States</a></h3>

      <h3 class="SideTOC3"><a href="#1101880">
      SSL Library Errors</a></h3>

      <h3 class="SideTOC3"><a href="#1102017">
      SSL Library Traps</a></h3>

      <h3 class="SideTOC3"><a href="#1102049">
      Miscellaneous SSL Library Constants	</a></h3>

   <h2 class="SideTOC2"><a href="#1102074">
   SSL Library Functions and Macros</a></h2>

      <h3 class="SideTOC3"><a href="#1102077">
      SslClose</a></h3>

      <h3 class="SideTOC3"><a href="#1102133">
      SslConsume</a></h3>

      <h3 class="SideTOC3"><a href="#1102183">
      SslContextCreate</a></h3>

      <h3 class="SideTOC3"><a href="#1102227">
      SslContextDestroy</a></h3>

      <h3 class="SideTOC3"><a href="#1102263">
      SslContextGetLong</a></h3>

      <h3 class="SideTOC3"><a href="#1102303">
      SslContextGetPtr</a></h3>

      <h3 class="SideTOC3"><a href="#1102349">
      SslContextSetLong</a></h3>

      <h3 class="SideTOC3"><a href="#1102400">
      SslContextSetPtr</a></h3>

      <h3 class="SideTOC3"><a href="#1102457">
      SslFlush</a></h3>

      <h3 class="SideTOC3"><a href="#1102508">
      SslLibClose</a></h3>

      <h3 class="SideTOC3"><a href="#1102529">
      SslLibCreate</a></h3>

      <h3 class="SideTOC3"><a href="#1102571">
      SslLibDestroy</a></h3>

      <h3 class="SideTOC3"><a href="#1102599">
      SslLibGetLong</a></h3>

      <h3 class="SideTOC3"><a href="#1102637">
      SslLibGetPtr</a></h3>

      <h3 class="SideTOC3"><a href="#1102683">
      SslLibName</a></h3>

      <h3 class="SideTOC3"><a href="#1102704">
      SslLibOpen</a></h3>

      <h3 class="SideTOC3"><a href="#1102725">
      SslLibSetLong</a></h3>

      <h3 class="SideTOC3"><a href="#1102778">
      SslLibSetPtr</a></h3>

      <h3 class="SideTOC3"><a href="#1102835">
      SslLibSleep</a></h3>

      <h3 class="SideTOC3"><a href="#1102856">
      SslLibWake</a></h3>

      <h3 class="SideTOC3"><a href="#1102877">
      SslOpen</a></h3>

      <h3 class="SideTOC3"><a href="#1102933">
      SslPeek</a></h3>

      <h3 class="SideTOC3"><a href="#1102985">
      SslRead</a></h3>

      <h3 class="SideTOC3"><a href="#1103027">
      SslReceive</a></h3>

      <h3 class="SideTOC3"><a href="#1103077">
      SslSend</a></h3>

      <h3 class="SideTOC3"><a href="#1103131">
      SslWrite</a></h3>

   <h2 class="SideTOC2"><a href="#1103172">
   Application-Defined Functions</a></h2>

      <h3 class="SideTOC3"><a href="#1103175">
      SslCallbackFunc</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1100917"> </a>This chapter contains reference documentation for the APIs defined in <code>SslLib.h</code>. The contents of this chapter are organized into the following sections:</p>
   <blockquote class = "bq"><a name="1100921"> </a><a href="SslLib.html#1100943">SSL Library Structures and Types</a></blockquote>
   <blockquote class = "bq"><a name="1100925"> </a><a href="SslLib.html#1101330">SSL Library Constants</a></blockquote>
   <blockquote class = "bq"><a name="1100929"> </a><a href="SslLib.html#1102074">SSL Library Functions and Macros</a></blockquote>
   <blockquote class = "bq"><a name="1100933"> </a><a href="SslLib.html#1103172">Application-Defined Functions</a></blockquote>

<p><a name="1100934"> </a>The header file <code>SslLib.h</code> declares the API that this chapter describes.</p>

<p><a name="1100935"> </a>For information on making use of the APIs documented in this chapter, see <a href="../PalmOSCompanion2/SslConcepts.html#1033035">Chapter 8, "Secure Sockets Layer (SSL),"</a> of <i>Palm OS Programmer's Companion</i>, vol. II, <i>Communications</i>. Much of what you do when working with the SSL Library involves working with attributes; reference documentation for the macros that you use to set and get attribute values can be found in <a href="SslLibMac.html#1140723">Chapter 87, "SSL Library Macros."</a></p>

<h2 class="haH2">
  <a name="1100943"> </a>SSL Library Structures and Types <a href="#1100916"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1100946"> </a>SslAttribute Typedef <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1100948"> </a>Purpose 
</h4>

<p><a name="1100949"> </a>Container for an SslLib or SslContext attribute value.</p>
<h4>
  <a name="1100950"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1100951"> </a></code><h4>
  <a name="1100952"> </a>Prototype 
</h4>
<pre class="proto"><a name="1100953"></a>typedef UInt32 SslAttribute;
</pre>
<h4>
  <a name="1100954"> </a>Comments 
</h4>

<p><a name="1100957"> </a>Attribute values are listed in <a href="SslLibMac.html#1140749">"SSL Library Macro Constants."</a> Descriptions of each attribute can be found under <a href="../PalmOSCompanion2/SslConcepts.html#1033081">"Attributes."</a></p>

<h3 class="hbH3">
  <a name="1100964"> </a>SslCallback Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1100966"> </a>Purpose 
</h4>

<p><a name="1100967"> </a>Structure used when the SSL library transfers control back to the application via a callback function.</p>
<h4>
  <a name="1100968"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1100969"> </a></code><h4>
  <a name="1100970"> </a>Prototype 
</h4>
<pre class="proto"><a name="1100971"></a>struct SslCallback_st {
   void *reserved;
   SslCallbackFunc callback;
   void *data;
   SslContext *ssl;
} 
</pre>
<pre class="proto"><a name="1100972"></a>typedef struct SslCallback_st SslCallback
</pre>
<h4>
  <a name="1100973"> </a>Fields 
</h4>

<dl>
<dt><a name="1100974"> </a><code>reserved</code></dt>
<dd><a name="1100975"> </a>Reserved for internal use by SslLib. </dd>

<dt><a name="1100976"> </a><code>callback</code></dt>
<dd><a name="1100977"> </a>A function pointer of the function to be called. See <a href="SslLib.html#1103175"><code>SslCallbackFunc()</code></a>.</dd>

<dt><a name="1100981"> </a><code>data</code></dt>
<dd><a name="1100982"> </a>Can be set to a value by the application, and will remain unchanged by SslLib.  This value will then be available to the callback function.  Use this field to communicate context information from the application to the callback.  An example of its use is in a 'diagnostic' callback, in which the application could use this field to provide a handle to the logging routines to be used. </dd>

<dt><a name="1100983"> </a><code>ssl</code></dt>
<dd><a name="1100987"> </a>SslLib sets this field to be the <a href="SslLib.html#1101045"><code>SslContext</code></a> if the callback is related to an SslContext.  If it is not (due to being related to a SslLib), it is set to <code>NULL</code>.</dd>

</dl>
<h4>
  <a name="1100988"> </a>Comments 
</h4>

<p><a name="1100989"> </a>This structure is used when the SSL library transfers control back to the application via a callback.  A callback is a function that the application supplies to SslLib that will be called when specific situations occur during the SSL protocol.  The callbacks are specific to the particular SslContext or SslLib they are registered with.  Examples of callbacks used by the SslLib are an 'information' callback and a 'certificate validation' callback.</p>

<h3 class="hbH3">
  <a name="1100992"> </a>SslCipherSuiteInfo Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1100994"> </a>Purpose 
</h4>

<p><a name="1100995"> </a>Encapsulates information about the current cipher suite.</p>
<h4>
  <a name="1100996"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1100997"> </a></code><h4>
  <a name="1100998"> </a>Prototype 
</h4>
<pre class="proto"><a name="1100999"></a>typedef struct SslCipherSuiteInfo_st {
   UInt8 cipherSuite[2];
   UInt16 cipher;
   UInt16 digest;
   UInt16 keyExchange;
   UInt16 authentication;
   UInt16 version;
   UInt16 cipherBitLength;
   UInt16 cipherKeyLength;
   UInt16 keyExchangeLength;
   UInt16 authenticationLength;
   UInt16 export;
} SslCipherSuiteInfo
</pre>
<h4>
  <a name="1101000"> </a>Fields 
</h4>

<dl>
<dt><a name="1101001"> </a><code>cipherSuite</code></dt>
<dd><a name="1101002"> </a>The two bye cipher suite value for the current cipher suite. See the <a href="../PalmOSCompanion2/SslConcepts.html#1033434"><code>CipherSuite</code></a> attribute description in the <i>Palm OS Programmer's Companion</i>, vol. II, <i>Communications</i> for more details.</dd>

<dt><a name="1101006"> </a><code>cipher</code></dt>
<dd><a name="1101007"> </a>A number indicating which cipher is being used for this connection. One of the <code>sslCsiCipher...</code> constants listed under <a href="SslLib.html#1101496">"Cipher Suite Info Constants."</a></dd>

<dt><a name="1101011"> </a><code>digest</code></dt>
<dd><a name="1101012"> </a>The digest value. One of the <code>sslCsiDigest...</code> constants listed under <a href="SslLib.html#1101496">"Cipher Suite Info Constants."</a></dd>

<dt><a name="1101016"> </a><code>keyExchange</code></dt>
<dd><a name="1101017"> </a>The key exchange type which was used. One of the <code>sslCsiKeyExch...</code> constants listed under <a href="SslLib.html#1101496">"Cipher Suite Info Constants."</a></dd>

<dt><a name="1101021"> </a><code>authentication</code></dt>
<dd><a name="1101022"> </a>The authenticaiton type used. One of the <code>sslCsiAuth...</code> constants listed under <a href="SslLib.html#1101496">"Cipher Suite Info Constants."</a></dd>

<dt><a name="1101026"> </a><code>version</code></dt>
<dd><a name="1101027"> </a>The SSL version being used.</dd>

<dt><a name="1101028"> </a><code>cipherBitLength</code></dt>
<dd><a name="1101029"> </a>The number of bits of key material used for encryption key generation.  For export ciphers this will be either 40 or 56 bits.</dd>

<dt><a name="1101030"> </a><code>cipherKeyLength</code></dt>
<dd><a name="1101031"> </a>The length of the key for the underlying cipher.  For an export RC4 cipher, the <code>cipherBitLength</code> would be 40, but the <code>cipherKeyLength</code> would be 128.  This is because while the SSL protocol would be using 128-bit keys to encrypt and decrypt with RC4, only 40 bits of random data would be used to generate the 128-bit key.</dd>

<dt><a name="1101032"> </a><code>keyExchangeLength</code></dt>
<dd><a name="1101033"> </a>The length in bits of the public key used to establish a shared secret.</dd>

<dt><a name="1101034"> </a><code>authenticationLength</code></dt>
<dd><a name="1101035"> </a>The length of the public key used to ensure the key exchange was not tampered with. For export ciphers, the <code>keyExchangeLength</code> is often shorter than the <code>authenticationLength</code>. </dd>

<dt><a name="1101036"> </a><code>export</code></dt>
<dd><a name="1101037"> </a>Set when an export cipher is being used.</dd>

</dl>
<h4>
  <a name="1101038"> </a>Comments 
</h4>

<p><a name="1101039"> </a>This structure differs from most others in that the application passes in a structure to be populated from the <a href="SslLib.html#1101045"><code>SslContext</code></a>.  Normally the <code>SslContext</code> returns a pointer to an internal data structure. </p>

<h3 class="hbH3">
  <a name="1101045"> </a>SslContext Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101047"> </a>Purpose 
</h4>

<p><a name="1101048"> </a>An opaque data structure that represents an SSL connection.</p>
<h4>
  <a name="1101049"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101050"> </a></code><h4>
  <a name="1101051"> </a>Prototype 
</h4>
<pre class="proto"><a name="1101052"></a>typedef struct SslContext_st SslContext
</pre>
<h4>
  <a name="1101053"> </a>Fields 
</h4>

<p><a name="1101054"> </a>None.</p>

<h3 class="hbH3">
  <a name="1101056"> </a>SslExtendedItem Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101058"> </a>Purpose 
</h4>

<p><a name="1101059"> </a>Structure that's used to describe a single certificate-related item.</p>
<h4>
  <a name="1101060"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101061"> </a></code><h4>
  <a name="1101062"> </a>Prototype 
</h4>
<pre class="proto"><a name="1101063"></a>typedef struct SslExtendedItem_st {
   UInt16 type;
   UInt16 field;
   UInt16 dataType;
   UInt16 len;
   UInt32 offset;
} SslExtendedItem
</pre>
<h4>
  <a name="1101064"> </a>Fields 
</h4>

<dl>
<dt><a name="1101065"> </a><code>type</code></dt>
<dd><a name="1101066"> </a>The extended item type, one of:</dd>

<dl>
<dt><a name="1101067"> </a><code><code>sslExItemTypeX509</code></code></dt>
<dd><a name="1101068"> </a>An X.509 certificate.</dd>

<dt><a name="1101069"> </a><code><code>sslExItemTypeRSA</code></code></dt>
<dd><a name="1101070"> </a>An RSA public key.</dd>

<dt><a name="1101071"> </a><code><code>sslExItemTypeRDN</code></code></dt>
<dd><a name="1101072"> </a>An X.509 Relative Distinguished Name (RDN). This is the certificate's name. Each certificate contains two names, the <span style="color: #000000;  font-style: italic; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">Subject</span> of the certificate and the <span style="color: #000000;  font-style: italic; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">Issuer</span> of the certificate. Both are encoded as RDNs that contain multiple fields.</dd>

<dt><a name="1101073"> </a><code><code>sslExItemTypeX509Ex</code></code></dt>
<dd><a name="1101074"> </a>X.509 certificates can contain multiple "extensions." This type is used to specify that the item is a certificate extension.</dd>

</dl>
<dt><a name="1101075"> </a><code>field</code></dt>
<dd><a name="1101076"> </a>Type-specific value.</dd>

<dt><a name="1101077"> </a><code>dataType</code></dt>
<dd><a name="1101078"> </a>The encoding for the item's data. For the SSL library, the value is one of the ASN.1 encoding types, as listed in <code>SslLibAsn1.h</code>. The encoding is relevant if you're trying to display the data bytes.</dd>

<dt><a name="1101079"> </a><code>len</code></dt>
<dd><a name="1101080"> </a>Number of data bytes.</dd>

<dt><a name="1101081"> </a><code>offset</code></dt>
<dd><a name="1101082"> </a>Location of the data itself, as an offset in bytes from the beginning of the <a href="SslLib.html#1101093"><code>SslExtendedItems</code></a> structure that contains this <code>SslExtendedItem</code>.</dd>

</dl>
<h4>
  <a name="1101086"> </a>Comments 
</h4>

<p><a name="1101087"> </a>Every <code>SslExtendedItem</code> has a distinct (pre-defined) "extended item type." The location of the item's data is indicated by the structure&#8212;the data isn't stored in the structure.</p>

<p><a name="1101088"> </a>You never create <code>SslExtendedItem</code> structures yourself. The objects that relate to a particular certificate are collected into an <a href="SslLib.html#1101093"><code>SslExtendedItems</code></a> structure and returned to you (principally) by your verify callback function.</p>

<h3 class="hbH3">
  <a name="1101093"> </a>SslExtendedItems Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101095"> </a>Purpose 
</h4>

<p><a name="1101096"> </a>Structure that contains a set of related data items that pertain to an SSL certificate or other cryptographic entity. </p>
<h4>
  <a name="1101097"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101098"> </a></code><h4>
  <a name="1101099"> </a>Prototype 
</h4>
<pre class="proto"><a name="1101100"></a>typedef struct SslExtendedItems_st {
   UInt32 length;
   UInt32 num;
   SslExtendedItem eitem[1];
} SslExtendedItems
</pre>
<h4>
  <a name="1101101"> </a>Fields 
</h4>

<dl>
<dt><a name="1101102"> </a><code>length</code></dt>
<dd><a name="1101103"> </a>Total length of the structure, in bytes.</dd>

<dt><a name="1101104"> </a><code>num</code></dt>
<dd><a name="1101105"> </a>Number of elements in the <code>eitem</code> array.</dd>

<dt><a name="1101106"> </a><code>eitem</code></dt>
<dd><a name="1101107"> </a>Individual data items (these are the "related data items" mentioned above). The array contains num elements. </dd>

</dl>
<h4>
  <a name="1101108"> </a>Comments 
</h4>

<p><a name="1101109"> </a>The <code>SslExtendedItems</code> structure is used as part of the <a href="SslLib.html#1101261"><code>SslVerify</code></a> structure, and is used as the type of the <a href="../PalmOSCompanion2/SslConcepts.html#1033684"><code>PeerCert</code></a> attribute.</p>

<p><a name="1101116"> </a>The <code>SslExtendedItems</code> structure is used by the SSL library to return information to your application; you never create and populate an <code>SslExtendedItems</code> structure yourself.</p>

<p><a name="1101117"> </a>The items in the eitem array needn't all be the same "extended item type" (as defined in <a href="SslLib.html#1101056"><code>SslExtendedItem</code></a>). For example, the <code>SslExtendedItems</code> structure for a certificate typically contains an <code>sslExItemTypeX509</code> item, an <code>sslExItemTypeRSA</code>, and an <code>sslExItemType</code> (for the subject name).</p>

<h3 class="hbH3">
  <a name="1101123"> </a>SslIoBuf Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101125"> </a>Purpose 
</h4>

<p><a name="1101126"> </a>Passed to the 'info' functions when I/O is being done.</p>
<h4>
  <a name="1101127"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101128"> </a></code><h4>
  <a name="1101129"> </a>Prototype 
</h4>
<pre class="proto"><a name="1101130"></a>typedef struct SslIoBuf_st {
   SslContext *ssl;
   UInt8 *ptr;
   UInt32 outNum;
   UInt32 inNum;
   UInt32 max;
   UInt32 err;
   UInt32 flags;
} SslIoBuf
</pre>
<h4>
  <a name="1101131"> </a>Fields 
</h4>

<dl>
<dt><a name="1101132"> </a><code>ssl</code></dt>
<dd><a name="1101133"> </a>The SslContext for which this callback is being called from.  It should be the same value that is held in the <a href="SslLib.html#1100964"><code>SslCallback</code></a> structure's <code>ssl</code> field.</dd>

<dt><a name="1101137"> </a><code>ptr</code></dt>
<dd><a name="1101138"> </a>The buffer being used to store the bytes. </dd>

<dt><a name="1101139"> </a><code>outNum</code></dt>
<dd><a name="1101140"> </a>The number of bytes read or written; it is 0 in the 'Before' states. </dd>

<dt><a name="1101141"> </a><code>inNum</code></dt>
<dd><a name="1101142"> </a>The number of bytes to be read or written. </dd>

<dt><a name="1101143"> </a><code>max</code></dt>
<dd><a name="1101144"> </a>The maximum read that could be performed.  <code>inNum</code> is the number of bytes that the SSL library needs right now, but <code>max</code> bytes could be read if they are available.  Often the read operation will read more bytes than are needed, so the <code>outNum</code> field which returns the number of bytes read or written, can, for the read case, be larger than <code>inNum</code>. </dd>

<dt><a name="1101145"> </a><code>err</code></dt>
<dd><a name="1101146"> </a>In the 'After' <code class="par">argi</code> states, <code>err</code> will contain the error code from the I/O operation.  If there was no error, it will be 0 (<code>errNone</code>). </dd>

<dt><a name="1101147"> </a><code>flags</code></dt>
<dd><a name="1101148"> </a>The flags field is not currently used and is set to zero.</dd>

</dl>
<h4>
  <a name="1101149"> </a>Comments 
</h4>

<p><a name="1101150"> </a>The 'Before' <code class="par">argi</code> values indicate that the passed <code>SslIoBuf</code> indicates the I/O operation about to be performed.  The 'After' <code class="par">argi</code> values indicate that the <code>SslIoBuf</code> contains the results of the just-performed I/O operation. </p>

<h3 class="hbH3">
  <a name="1101153"> </a>SslLib Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101155"> </a>Purpose 
</h4>

<p><a name="1101156"> </a>An opaque data structure that represents the SSL Library (similar to "NetLib").</p>
<h4>
  <a name="1101157"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101158"> </a></code><h4>
  <a name="1101159"> </a>Prototype 
</h4>
<pre class="proto"><a name="1101160"></a>typedef struct SslLib_st SslLib
</pre>
<h4>
  <a name="1101161"> </a>Fields 
</h4>

<p><a name="1101162"> </a>None.</p>

<h3 class="hbH3">
  <a name="1101165"> </a>SslSession Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101167"> </a>Purpose 
</h4>

<p><a name="1101168"> </a>Holds all the security information associated with a particular SSL connection.</p>
<h4>
  <a name="1101169"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101170"> </a></code><h4>
  <a name="1101171"> </a>Prototype 
</h4>
<pre class="proto"><a name="1101172"></a>typedef struct SslSession_st {
   UInt32 length;
   UInt16 version;
   unsigned char cipherSuite[2];
   unsigned char compression;
   unsigned char sessionId[33];
   unsigned char masterSecret[48];
   unsigned char time[8];
   unsigned char timeout[4];
   UInt16 certificateOffset;
   UInt16 extraData;
} SslSession
</pre>
<h4>
  <a name="1101173"> </a>Fields 
</h4>

<dl>
<dt><a name="1101174"> </a><code>length</code></dt>
<dd><a name="1101175"> </a>The total size of the structure, in bytes.</dd>

<dt><a name="1101176"> </a><code>version</code></dt>
<dd><a name="1101177"> </a>Version number of the SSL protocol that's being used; 0 if the session is using cleartext.</dd>

<dt><a name="1101178"> </a><code>cipherSuite</code></dt>
<dd><a name="1101182"> </a>Cipher suite that's being used. See the <a href="../PalmOSCompanion2/SslConcepts.html#1033434"><code>CipherSuite</code></a> attribute description in <i>Palm OS Programmer's Companion</i>, vol. II, <i>Communications</i>.</dd>

<dt><a name="1101183"> </a><code>compression</code></dt>
<dd><a name="1101184"> </a>The name of the compression scheme that's being used.</dd>

<dt><a name="1101185"> </a><code>sessionId</code></dt>
<dd><a name="1101186"> </a>The session ID. The first byte is the length.</dd>

<dt><a name="1101187"> </a><code>masterSecret</code></dt>
<dd><a name="1101188"> </a>Master secret.</dd>

<dt><a name="1101189"> </a><code>time</code></dt>
<dd><a name="1101190"> </a>Host-specific start time.</dd>

<dt><a name="1101191"> </a><code>timeout</code></dt>
<dd><a name="1101192"> </a>Timeout, in seconds.</dd>

<dt><a name="1101193"> </a><code>certificateOffset</code></dt>
<dd><a name="1101194"> </a>Optional Peer certificate; this is the offset from the front of the structure to a <code>SslExtendedItems</code> structure. If the offset if 0, it does not exist</dd>

<dt><a name="1101195"> </a><code>extraData</code></dt>
<dd><a name="1101196"> </a>Can be used to store anything, such as the hostname of peer. Application defined.</dd>

</dl>
<h4>
  <a name="1101197"> </a>Comments 
</h4>

<p><a name="1101201"> </a>A context's <code>SslSession</code> is populated when you call <a href="SslLib.html#1102877"><code>SslOpen()</code></a>. You can retrieve a context's <code>SslSession</code> structure and modify it directly&#8212;particularly if you want to set the fields that are reserved for application use. To retrieve the <code>SslSession</code>, call the <a href="SslLibMac.html#1142067"><code>SslContextGet_SslSession</code></a> macro. Keep in mind that this gives you a pointer to the context's internal <a href="../PalmOSCompanion2/SslConcepts.html#1033765"><code>SslSession</code></a> attribute. If you want to store the <code>SslSession</code>, you must copy the attribute's data.</p>

<h3 class="hbH3">
  <a name="1101210"> </a>SslSocket Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101212"> </a>Purpose 
</h4>

<p><a name="1101216"> </a>The structure used to hold the <a href="NetLibrary.html#1083561">Net Library</a> arguments to be passed to any Net Library calls.</p>
<h4>
  <a name="1101217"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101218"> </a></code><h4>
  <a name="1101219"> </a>Prototype 
</h4>
<pre class="proto"><a name="1101220"></a>typedef struct SslSocket_st {
   NetSocketRef socket;
   UInt16 flags;
   UInt16 addrLen;
   Err err;
   Int32 timeout;
   NetSocketAddrType addr;
} SslSocket
</pre>
<h4>
  <a name="1101221"> </a>Fields 
</h4>

<dl>
<dt><a name="1101222"> </a><code>socket</code></dt>
<dd><a name="1101223"> </a>Socket identifier, as created and returned by <a href="NetLibrary.html#1087549"><code>NetLibSocketOpen()</code></a>. The SSL library doesn't open or connect the socket for you; all socket operations other than reading and writing data must be done through net library calls. Note that you never set the <code>socket</code> field directly; use the <a href="SslLibMac.html#1143111"><code>SslContextSet_Socket</code></a> macro instead.</dd>

<dt><a name="1101230"> </a><code>flags</code></dt>
<dd><a name="1101233"> </a>Options that control a socket's I/O operations. See <a href="NetLibrary.html#1083964">"I/O Flags"</a> for a description of these options.</dd>

<dt><a name="1101235"> </a><code>addrLen</code></dt>
<dd><a name="1101236"> </a>The length, in bytes, of the <code>addr</code> field.</dd>

<dt><a name="1101237"> </a><code>err</code></dt>
<dd><a name="1101238"> </a>The most recent socket error.</dd>

<dt><a name="1101239"> </a><code>timeout</code></dt>
<dd><a name="1101240"> </a>The socket's I/O operation timeout value, in system ticks.</dd>

<dt><a name="1101241"> </a><code>addr</code></dt>
<dd><a name="1101242"> </a>The most recent address that the socket read from or wrote to.</dd>

</dl>
<h4>
  <a name="1101243"> </a>Comments 
</h4>

<p><a name="1101244"> </a>When setting this structure, the <code>socket</code> field will not be copied in.  To set the socket to use for network connections, see the Socket attribute.  The <code>socket</code>, <code>flags</code>, <code>addrLen</code>, <code>err</code>, <code>timeout</code>, and <code>addr</code> fields all correspond to the arguments passed to <a href="NetLibrary.html#1086663"><code>NetLibSend()</code></a> and <a href="NetLibrary.html#1086371"><code>NetLibReceive()</code></a>.  Read further on those function for more details.  The <code>SslSocket</code> passed into the <a href="SslLib.html#1101045"><code>SslContext</code></a> will be copied into the <code>SslContext</code>'s <code>SslSocket</code> structure and the <code>SslSocket</code> pointer returned refers to an internal <code>SslContext</code> data structure.  When the application calls a function such as <a href="SslLib.html#1103027"><code>SslReceive()</code></a>, the arguments passed to that function will overwrite the internal <code>SslSocket</code> values, so a subsequent call to <a href="SslLibMac.html#1141514"><code>SslContextGet_IoStruct()</code></a> will return the newly updated fields.</p>

<h3 class="hbH3">
  <a name="1101261"> </a>SslVerify Struct <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101263"> </a>Purpose 
</h4>

<p><a name="1101264"> </a>Structure that's passed to a verify callback function to provide information about a certificate that's being verified. This happens when the verification process hits a snag, giving your app a chance to the handle the problem. The callback is also invoked when the process has successfully completed.</p>
<h4>
  <a name="1101265"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101266"> </a></code><h4>
  <a name="1101267"> </a>Prototype 
</h4>
<pre class="proto"><a name="1101268"></a>typedef struct SslVerify_st {
   SslExtendedItems *certificate;
   SslExtendedItems *fieldItems;
   UInt32 field;
   SslExtendedItems *ex;
   UInt32 depth;
   UInt32 state;
} SslVerify
</pre>
<h4>
  <a name="1101269"> </a>Fields 
</h4>

<dl>
<dt><a name="1101270"> </a><code>certificate</code></dt>
<dd><a name="1101271"> </a>Points to the certificate that's being verified.</dd>

<dt><a name="1101272"> </a><code>fieldItems</code></dt>
<dd><a name="1101276"> </a>An array of extended items. The <a href="SslLib.html#1101093"><code>SslExtendedItems</code></a> that's located at <code>fieldItems[field]</code> contains the set of items that's causing the problem.</dd>

<dt><a name="1101277"> </a><code>field</code></dt>
<dd><a name="1101278"> </a>An index into <code>fieldItems</code>.</dd>

<dt><a name="1101279"> </a><code>ex</code></dt>
<dd><a name="1101280"> </a>If this is an extension error, the <code>ex</code> field contains the data element of the X509 extension that failed.</dd>

<dt><a name="1101281"> </a><code>depth</code></dt>
<dd><a name="1101282"> </a>This is the level of the certificate being processed, where 0 is the server's certificate, and higher numbers are certificates along the "certificate chain" that leads to a trusted root certificate.</dd>

<dt><a name="1101283"> </a><code>state</code></dt>
<dd><a name="1101284"> </a>The verification state.</dd>

</dl>
<h4>
  <a name="1101285"> </a>Comments 
</h4>

<p><a name="1101289"> </a>The list of <a href="SslLib.html#1101056"><code>SslExtendedItem</code></a> elements that the <a href="SslLib.html#1101093"><code>SslExtendedItems</code></a> object located at <code>fieldItems[</code> <code>field</code> <code>]</code> contains depends on the verification error:</p>


<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1101295"> </a><b><span style="color: #000000;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">Flavor</span></b></p>
    </th>
    <th><p class="tt"><a name="1101297"> </a><b>Contents</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1101299"> </a><code>sslErrVerifyBadSignature</code></p>
    </td>
    <td><p class="tt"><a name="1101301"> </a>The server's certificate, which contains the public key entries.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1101303"> </a><code>sslErrVerifyNoTrustedRoot</code></p>
    </td>
    <td><p class="tt"><a name="1101305"> </a><code>NULL</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1101307"> </a><code>sslErrVerifyNotAfter</code></p>
    </td>
    <td><p class="tt"><a name="1101309"> </a><code>sslExItemTypeX509</code>, <code>asn1FldX509NotAfter</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1101311"> </a><code>sslErrVerifyNotBefore</code></p>
    </td>
    <td><p class="tt"><a name="1101313"> </a><code>sslExItemTypeX509</code>, <code>asn1FldX509NotBefore</code>.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1101315"> </a><code>sslErrVerifyConstraintViolation</code></p>
    </td>
    <td>
<p><a name="1101317"> </a><code>asn1ExItemTypeX509Ex</code> (but see below)</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1101319"> </a><code>sslErrVerifyUnknownCriticalExtension</code></p>
    </td>
    <td><p class="tt"><a name="1101321"> </a><code>asn1ExItemTypeX509Ex</code> (but see below)</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1101323"> </a><code>sslErrOk </code></p>
    </td>
    <td><p class="tt"><a name="1101325"> </a><code>NULL</code></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1101327"> </a>The <code>asn1ExItemTypeX509Ex</code> item needs to be decoded in order to be used. The item contains the "object identifier" part of a certificate extension. The item in the next field (i.e. <code>fieldItems[</code> <code>field+1</code> <code>]</code>) depends on the item's <code>dataType</code> field: If it's <code>asn1Boolean</code>, than the "+1" item contains the extension's optional <code>Boolean</code> "this is a critical extension" field, otherwise it contains the extension data itself. If "+1" contains the <code>Boolean</code>, than "+2" is the data.</p>

<p><a name="1101328"> </a>The SSL library attempts to interpret only critical extensions, so the critical field should always be present. If a critical extension isn't understood, the certificate should be rejected.</p>

<h2 class="haH2">
  <a name="1101330"> </a>SSL Library Constants <a href="#1100916"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1101332"> </a>SSL Open Mode Flags <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101333"> </a>Purpose 
</h4>

<p><a name="1101334"> </a>Flags used to specify how the connection should be started when calling <a href="SslLib.html#1102877"><code>SslOpen()</code></a>.</p>
<h4>
  <a name="1101338"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101339"> </a></code><h4>
  <a name="1101340"> </a>Constants 
</h4>

<dl>
<dt><a name="1101342"> </a><code>#define sslOpenBufferedReuse 0x0040</code></dt>
<dd><a name="1101343"> </a>This is the same as <code>SslContextSet_BufferedReuse(ssl,1);</code></dd>

<dt><a name="1101345"> </a><code>#define sslOpenDelayHandshake 0x0080</code></dt>
<dd><a name="1101346"> </a>Do not perform the handshake now</dd>

<dt><a name="1101348"> </a><code>#define sslOpenModeClear 0x0001</code></dt>
<dd><a name="1101349"> </a>Turn off the SSL protocol.</dd>

<dt><a name="1101351"> </a><code>#define sslOpenModeSsl 0x0002</code></dt>
<dd><a name="1101352"> </a>Turn on the SSL protocol.</dd>

<dt><a name="1101354"> </a><code>#define sslOpenNewConnection 0x0004</code></dt>
<dd><a name="1101355"> </a>Perform a new SSL handhake, clearing any previous <code>SslSession</code> value.  This is the same as  <code>SslContextSet_SslSession(ssl,NULL)</code>.</dd>

<dt><a name="1101357"> </a><code>#define sslOpenNoAutoFlush 0x0008</code></dt>
<dd><a name="1101358"> </a>This is the same as <code>SslContextSet_AutoFlush(ssl,0);</code></dd>

<dt><a name="1101360"> </a><code>#define sslOpenUseDefaultTimeout 0x0020</code></dt>
<dd><a name="1101361"> </a>Use the <code>SslContext</code> timeout value instead of timeout parameter.</dd>

</dl>

<h3 class="hbH3">
  <a name="1101363"> </a>SSL Close Mode Flags <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101364"> </a>Purpose 
</h4>

<p><a name="1101365"> </a>Flags that allow you to specify how to perform the SSL Protocol shutdown when calling <a href="SslLib.html#1102077"><code>SslClose()</code></a>.</p>
<h4>
  <a name="1101369"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101370"> </a></code><h4>
  <a name="1101371"> </a>Constants 
</h4>

<dl>
<dt><a name="1101373"> </a><code>#define sslCloseDontSendShutdown 0x0001</code></dt>
<dd><a name="1101374"> </a>Do not send the SSL shutdown message to the server.</dd>

<dd><a name="1101375"> </a><code>SslContextSet_DontSendShutdown(ssl,1);</code></dd>

<dt><a name="1101377"> </a><code>#define sslCloseDontWaitForShutdown 0x0002</code></dt>
<dd><a name="1101378"> </a>Don't wait for the server to send a shutdown message.</dd>

<dd><a name="1101379"> </a><code>SslContextSet_DontWaitForShutdown(ssl,1);</code></dd>

<dt><a name="1101381"> </a><code>#define sslCloseUseDefaultTimeout 0x0020</code></dt>
<dd><a name="1101382"> </a>Use the timeout value set against the SslContext, not the <code class="par">timeout</code> parameter.</dd>

</dl>

<h3 class="hbH3">
  <a name="1101384"> </a>Mode Attribute Values <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101385"> </a>Purpose 
</h4>

<p><a name="1101386"> </a>Values that control the SslContext's operating mode.</p>
<h4>
  <a name="1101387"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101388"> </a></code><h4>
  <a name="1101389"> </a>Constants 
</h4>

<dl>
<dt><a name="1101391"> </a><code>#define sslModeClear 0x0000</code></dt>
<dd><a name="1101392"> </a>Causes the SSL protocol to be bypassed.</dd>

<dt><a name="1101394"> </a><code>#define sslModeFlush 0x8000</code></dt>
<dd><a name="1101395"> </a>Causes any data in the internal data buffers to be cleared.</dd>

<dt><a name="1101397"> </a><code>#define sslModeSsl 0x0002</code></dt>
<dd><a name="1101398"> </a>A subset value of <code>sslModeSslClient</code></dd>

<dt><a name="1101400"> </a><code>#define sslModeSslClient 0x000A</code></dt>
<dd><a name="1101401"> </a>SSL is turned on, with this endpoint a client.</dd>

</dl>
<h4>
  <a name="1101402"> </a>Comments 
</h4>

<p><a name="1101403"> </a><code>SslModeSsl</code> is a subset value of <code>sslModeSslClient</code>.  In a future release of SslLib, the server side of the SSL protocol may be supported in which case <code>sslModeSslServer</code> would be added.  The application can use code like the following to determine if the SSL protocol is being used:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
If (SslContextGet_Mode(ssl) &amp; sslModeSsl)<a name="1101404"> </a>
   /* SSL protocol enabled */<a name="1101405"> </a>
else<a name="1101406"> </a>
   /* Using cleartext */<a name="1101407"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1101408"> </a>A comparison with <code>sslModeSslClient</code> could be used to determine if the client or server side of the protocol is being used for that particular SslContext.</p>

<p><a name="1101409"> </a>The <code>sslModeFlush</code> flag is special.  When used in <a href="SslLibMac.html#1142947"><code>SslContextSet_Mode()</code></a>, it causes any data in the internal data buffers to be cleared.  This is normally required when reusing a SslContext for a new connection.  If an application is using a SslContext for cleartext, and then wants to enable SSL on the same connection, this flag should not be used.</p>

<h3 class="hbH3">
  <a name="1101414"> </a>Protocol Versions <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101415"> </a>Purpose 
</h4>

<p><a name="1101416"> </a>The version of the SSL protocol to use.</p>
<h4>
  <a name="1101417"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101418"> </a></code><h4>
  <a name="1101419"> </a>Constants 
</h4>

<dl>
<dt><a name="1101421"> </a><code>#define sslVersionSSLv3 0x0300</code></dt>
<dd><a name="1101422"> </a>Version SSLv3 of the SSL protocol.</dd>

</dl>
<h4>
  <a name="1101423"> </a>Comments 
</h4>

<p><a name="1101424"> </a>SslLib implements only SSLv3 at this point in time, so modification of this value is not a good idea.</p>

<h3 class="hbH3">
  <a name="1101426"> </a>Compatibility Flags <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101427"> </a>Purpose 
</h4>

<p><a name="1101431"> </a><a href="../PalmOSCompanion2/SslConcepts.html#1033474"><code>Compat</code></a> attribute flags that turn on compatiblity with incorrect SSL protocol implementations.</p>
<h4>
  <a name="1101432"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101433"> </a></code><h4>
  <a name="1101434"> </a>Constants 
</h4>

<dl>
<dt><a name="1101436"> </a><code>#define sslCompat1RecordPerMessage 0x0004</code></dt>
<dd><a name="1101437"> </a>Some servers do not like to receive SSL protocol messages separated into multiple SSL records.  This option stops the write buffers being set to a size less than 1024 bytes which ensures this problem will not occur.</dd>

<dt><a name="1101439"> </a><code>#define sslCompatAll 0xffff</code></dt>
<dd><a name="1101440"> </a>This value enables all the bug compatibility flags.</dd>

<dt><a name="1101442"> </a><code>#define sslCompatBigRecords 0x0008</code></dt>
<dd><a name="1101443"> </a>Some old Microsoft servers would send data to the SSL Client in records larger than 16k bytes in size.  This is not legal in the SSLv3 protocol.  This flag makes SslLib tolerate these large records.</dd>

<dt><a name="1101445"> </a><code>#define sslCompatNetscapeCaDnBug 0x0002</code></dt>
<dd><a name="1101446"> </a>Enables support for some old versions of Netscape servers which encoded certificate requests Distinguished names wrongly.  This is not currently a problem for SslLib since it does not support Client certificates.</dd>

<dt><a name="1101448"> </a><code>#define sslCompatReuseCipherBug 0x0001</code></dt>
<dd><a name="1101449"> </a>Enables support for servers that change cipher suites on session-reuse.  They should not be doing this.</dd>

</dl>
<h4>
  <a name="1101450"> </a>Comments 
</h4>

<p><a name="1101451"> </a>These bugs will not normally be encountered while using the SSL protocol, but if desired, it is worth enabling the compatibility in case old buggy servers are being accessed.</p>

<h3 class="hbH3">
  <a name="1101453"> </a>SSL Callback Commands <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101454"> </a>Purpose 
</h4>

<p><a name="1101455"> </a>General 'commands' that all callbacks should expect to receive.  There are normally related to creation and destruction of the structure that holds the callback. These commands are used in conjunction with <a href="SslLib.html#1103175"><code>SslCallbackFunc()</code></a>.</p>
<h4>
  <a name="1101459"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101460"> </a></code><h4>
  <a name="1101461"> </a>Constants 
</h4>

<dl>
<dt><a name="1101463"> </a><code>#define sslCmdFree 0x0002</code></dt>
<dd><a name="1101464"> </a>Called when the callback is 'destroyed', normally due to its parent SslLib or SslContext being destroyed.</dd>

<dt><a name="1101466"> </a><code>#define sslCmdGet 0x0004</code></dt>
<dd><a name="1101467"> </a>Called to return a value from the callback to SslLib.  The <code class="par">argi</code> value for this callback is callback-specific.</dd>

<dt><a name="1101469"> </a><code>#define sslCmdInfo 0x0012</code></dt>
<dd><a name="1101473"> </a>An Info callback. See <a href="SslLib.html#1103219">"The Info Callback"</a> for more information.</dd>

<dt><a name="1101475"> </a><code>#define sslCmdNew 0x0001</code></dt>
<dd><a name="1101476"> </a>Called when the callback is 'copied' into an SslLib or SslContext.</dd>

<dt><a name="1101478"> </a><code>#define sslCmdRead 0x0010</code></dt>
<dd><a name="1101479"> </a></dd>

<dt><a name="1101481"> </a><code>#define sslCmdReset 0x0003</code></dt>
<dd><a name="1101482"> </a>Called when the SslContext has been reset, which occurs when a new connection is being started.  It is called instead of <code>sslCmdNew</code>. <code>sslCmdNew</code> will be called only once; <code>sslCmdReset</code> will be called subsequently to 'reset' the state associated with the callback.</dd>

<dt><a name="1101484"> </a><code>#define sslCmdSet 0x0005</code></dt>
<dd><a name="1101485"> </a>Called to pass a value from SslLib to the callback.  The <code class="par">argi</code> value would specify the <code class="par">argv</code> parameter.  The <code class="par">argi</code> parameter would be callback-specific.</dd>

<dt><a name="1101487"> </a><code>#define sslCmdVerify 0x0013</code></dt>
<dd><a name="1101491"> </a>A Verify callback. See <a href="SslLib.html#1103273">"The Verify Callback"</a> for more information.</dd>

<dt><a name="1101493"> </a><code>#define sslCmdWrite 0x0011</code></dt>
</dl>

<h3 class="hbH3">
  <a name="1101496"> </a>Cipher Suite Info Constants <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101497"> </a>Purpose 
</h4>

<p><a name="1101501"> </a>Constants used with various fields of the <a href="SslLib.html#1100992"><code>SslCipherSuiteInfo</code></a> structure.</p>
<h4>
  <a name="1101502"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101503"> </a></code><h4>
  <a name="1101504"> </a>Constants 
</h4>

<dl>
<dt><a name="1101506"> </a><code>#define sslCsiAuthNULL 0x00</code></dt>
<dd><a name="1101507"> </a>(<code>authentication</code> field) No key exchange.</dd>

<dt><a name="1101509"> </a><code>#define sslCsiAuthRsa 0x01</code></dt>
<dd><a name="1101510"> </a>(<code>authentication</code> field) RSA.</dd>

<dt><a name="1101512"> </a><code>#define sslCsiCipherNull 0x00</code></dt>
<dd><a name="1101513"> </a>(<code>cipher</code> field) No cipher is being used for this connection.</dd>

<dt><a name="1101515"> </a><code>#define sslCsiCipherRc4 0x01</code></dt>
<dd><a name="1101516"> </a>(<code>cipher</code> field) The RSA RC4 cipher is being used for this connection.</dd>

<dt><a name="1101518"> </a><code>#define sslCsiDigestMd2 0x03</code></dt>
<dd><a name="1101519"> </a>(<code>digest</code> field) Rivest Message Digest 2.</dd>

<dt><a name="1101521"> </a><code>#define sslCsiDigestMd5 0x01</code></dt>
<dd><a name="1101522"> </a>(<code>digest</code> field) Rivest Message Digest 5.</dd>

<dt><a name="1101524"> </a><code>#define sslCsiDigestNull 0x00</code></dt>
<dd><a name="1101525"> </a>(<code>digest</code> field) No message digest.</dd>

<dt><a name="1101527"> </a><code>#define sslCsiDigestSha1 0x02</code></dt>
<dd><a name="1101528"> </a>(<code>digest</code> field) Secure Hash Algorithm-1.</dd>

<dt><a name="1101530"> </a><code>#define sslCsiKeyExchNull 0x00</code></dt>
<dd><a name="1101531"> </a>(<code>keyExchange</code> field) No key exchange is being used.</dd>

<dt><a name="1101533"> </a><code>#define sslCsiKeyExchRsa 0x01</code></dt>
<dd><a name="1101534"> </a>(<code>keyExchange</code> field) RSA key exchange.</dd>

</dl>

<h3 class="hbH3">
  <a name="1101536"> </a>Cipher Suites <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101537"> </a>Purpose 
</h4>

<p><a name="1101538"> </a>SSL cipher suites that the SSL protocol can attempt to use.</p>
<h4>
  <a name="1101539"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101540"> </a></code><h4>
  <a name="1101541"> </a>Constants 
</h4>

<dl>
<dt><a name="1101543"> </a><code>#define sslCs_RSA_RC4_128_MD5 0x00,0x04</code></dt>
<dt><a name="1101545"> </a><code>#define sslCs_RSA_RC4_128_SHA1 0x00,0x05</code></dt>
<dt><a name="1101547"> </a><code>#define sslCs_RSA_RC4_40_MD5 0x00,0x03</code></dt>
<dt><a name="1101549"> </a><code>#define sslCs_RSA_RC4_56_SHA1 0x00,0x64</code></dt>
</dl>
<h4>
  <a name="1101550"> </a>Comments 
</h4>

<p><a name="1101554"> </a>Set the cipher suites using either <a href="SslLibMac.html#1144119"><code>SslLibSet_CipherSuites()</code></a> or <a href="SslLibMac.html#1142476"><code>SslContextSet_CipherSuites()</code></a>.</p>

<h3 class="hbH3">
  <a name="1101559"> </a>Info Callbacks <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101560"> </a>Purpose 
</h4>

<p><a name="1101564"> </a>The <a href="SslLib.html#1103175"><code>SslCallbackFunc()</code></a> callback is called when various situations occur during the usage of a SslContext.  It is primarily intended for debugging and feedback purposes.  If the callback returns a non-zero value, this error will be returned back out the SslLib API.  The callback will be called with a command argument of <code>sslCmdInfo</code>. The constants listed in this section represent the possible <code class="par">argi</code> values.</p>
<h4>
  <a name="1101565"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101566"> </a></code><h4>
  <a name="1101567"> </a>Constants 
</h4>

<dl>
<dt><a name="1101569"> </a><code>#define sslArgInfoAlert 0x0002</code></dt>
<dd><a name="1101570"> </a>Notification of an Alert in the SSL protocol. The <code>sslArgInfoAlert</code> notification is called with a <code>NULL</code> value for the <code class="par">argv</code> parameter.  The application can get the <code>LastAlert</code> attribute from the <a href="SslLib.html#1101045"><code>SslContext</code></a> to determine which alert was received.</dd>

<dt><a name="1101575"> </a><code>#define sslArgInfoCert 0x0003</code></dt>
<dd><a name="1101576"> </a>Notification of peer certificate. The <code>sslArgInfoCert</code> call is made after the server's certificate chain has been verified.  The <code class="par">argv</code> parameter is a <code>SslExtendedItems</code> pointer, which points to the remote server's certificate.</dd>

<dt><a name="1101578"> </a><code>#define sslArgInfoHandshake 0x0001</code></dt>
<dd><a name="1101579"> </a>Notification of a state change in the SSL protocol. The <code>sslArgInfoHandshake</code> will be called upon each handshake state change.  The <code class="par">argv</code> parameter will be <code>NULL</code>, but the <code>HsState</code> attribute can be interrogated to read the current state.</dd>

<dt><a name="1101581"> </a><code>#define sslArgInfoReadAfter (sslCmdRead | 0x8000)</code></dt>
<dd><a name="1101585"> </a>Notification after a Receive/Read <a href="NetLibrary.html#1083561">Net Library</a> call. See the Comments section, below, for more information.</dd>

<dt><a name="1101587"> </a><code>#define sslArgInfoReadBefore sslCmdRead</code></dt>
<dd><a name="1101591"> </a>Notification before a Receive/Read <a href="NetLibrary.html#1083561">Net Library</a> call. See the Comments section, below, for more information.</dd>

<dt><a name="1101593"> </a><code>#define sslArgInfoWriteAfter (sslCmdWrite | 0x8000)</code></dt>
<dd><a name="1101597"> </a>Notification after a Send/Write <a href="NetLibrary.html#1083561">Net Library</a> call. See the Comments section, below, for more information.</dd>

<dt><a name="1101599"> </a><code>#define sslArgInfoWriteBefore sslCmdWrite</code></dt>
<dd><a name="1101603"> </a>Notification before a Send/Write <a href="NetLibrary.html#1083561">Net Library</a> call. See the Comments section, below, for more information.</dd>

</dl>
<h4>
  <a name="1101604"> </a>Comments 
</h4>

<p><a name="1101605"> </a>The <code>sslArgInfo[Read | Write] [Before | After]</code> callback is called twice for each network I/O operation.  The first call is made before the call to the underlying <a href="NetLibrary.html#1083561">Net Library</a> Send/Receive.  The second is made after the call has completed.  If the callback returns a non-zero value, this value will be returned by origional SslLib call the application made.</p>

<p><a name="1101612"> </a>The <code class="par">argv</code> parameter is a <a href="SslLib.html#1101123"><code>SslIoBuf</code></a> structure. This structure's <code>ssl</code> field is the SslContext that the I/O operation is being performed by. <code>ptr</code> points to the space used, or to be used, in the operation.  <code>outNum</code> is the number of bytes processed.  It is only set in the After calls.  <code>inNum</code> is the number of bytes to be read or written in the call.  <code>max</code> is the maximum number of bytes that could be read.  It can be larger than <code>inNum</code>. <code>err</code> is the error value, if any.  This value is only set in the After calls. <code>flags</code> is currently not used and is set to 0.</p>

<h3 class="hbH3">
  <a name="1101614"> </a>InfoInterest Values <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101615"> </a>Purpose 
</h4>

<p><a name="1101619"> </a>Values used to specify the events for which of the <a href="SslLib.html#1101559">Info Callbacks</a> will be called. The <code>InfoInterest</code> value is the logical ORing of these values.</p>
<h4>
  <a name="1101620"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101621"> </a></code><h4>
  <a name="1101622"> </a>Constants 
</h4>

<dl>
<dt><a name="1101624"> </a><code>#define sslFlgInfoAlert 0x0001</code></dt>
<dd><a name="1101625"> </a>The <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">sslArgInfoAlert</span> callback.</dd>

<dt><a name="1101627"> </a><code>#define sslFlgInfoCert 0x0008</code></dt>
<dd><a name="1101628"> </a>The <code>sslArgInfoCert</code> callback.</dd>

<dt><a name="1101630"> </a><code>#define sslFlgInfoHandshake 0x0002</code></dt>
<dd><a name="1101631"> </a>The <code>sslArgInfoHandshake</code> callback.</dd>

<dt><a name="1101633"> </a><code>#define sslFlgInfoIo 0x0004</code></dt>
<dd><a name="1101634"> </a>The <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">sslArgInfoReadAfter</span>, <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">sslArgInfoReadBefore</span>, <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">sslArgInfoWriteAfter</span>, and <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">sslArgInfoWriteBefore</span> callbacks.</dd>

</dl>

<h3 class="hbH3">
  <a name="1101636"> </a>LastApi Attribute Values <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101637"> </a>Purpose 
</h4>

<p><a name="1101638"> </a>The last SslLib API call made. This attribute can be useful in event-driven programs.</p>
<h4>
  <a name="1101639"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101640"> </a></code>
<dl>
<dt><a name="1101642"> </a><code>#define sslLastApiFlush 0x04</code></dt>
<dd><a name="1101646"> </a>The previous function was <a href="SslLib.html#1102457"><code>SslFlush()</code></a>.</dd>

<dt><a name="1101648"> </a><code>#define sslLastApiNone 0x00</code></dt>
<dd><a name="1101649"> </a>No SSL library function call in this context since the last SSL reset.</dd>

<dt><a name="1101651"> </a><code>#define sslLastApiOpen 0x01</code></dt>
<dd><a name="1101655"> </a>The previous function was <a href="SslLib.html#1102877"><code>SslOpen()</code></a>.</dd>

<dt><a name="1101657"> </a><code>#define sslLastApiRead 0x02</code></dt>
<dd><a name="1101667"> </a>Set if <a href="SslLib.html#1102985"><code>SslRead()</code></a>, <a href="SslLib.html#1102933"><code>SslPeek()</code></a> or <a href="SslLib.html#1103027"><code>SslReceive()</code></a> was last called.</dd>

<dt><a name="1101669"> </a><code>#define sslLastApiShutdown 0x05</code></dt>
<dd><a name="1101673"> </a>The previous function was <a href="SslLib.html#1102077"><code>SslClose()</code></a>.</dd>

<dt><a name="1101675"> </a><code>#define sslLastApiWrite 0x03</code></dt>
<dd><a name="1101682"> </a>Set if <a href="SslLib.html#1103131"><code>SslWrite()</code></a> or <a href="SslLib.html#1103077"><code>SslSend()</code></a> was last called.</dd>

</dl>

<h3 class="hbH3">
  <a name="1101684"> </a>LastIO Attribute Values <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101685"> </a>Purpose 
</h4>

<p><a name="1101686"> </a>The last network operation performed.</p>
<h4>
  <a name="1101687"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101688"> </a></code>
<dl>
<dt><a name="1101690"> </a><code>#define sslLastIoNone 0x00</code></dt>
<dd><a name="1101691"> </a>No I/O operations have been performed since the context was last reset.</dd>

<dt><a name="1101693"> </a><code>#define sslLastIoRead 0x01</code></dt>
<dd><a name="1101694"> </a>A read operation.</dd>

<dt><a name="1101696"> </a><code>#define sslLastIoWrite 0x02</code></dt>
<dd><a name="1101697"> </a>A write operation.</dd>

</dl>
<h4>
  <a name="1101698"> </a>Comments 
</h4>

<p><a name="1101699"> </a>Since most of the SslLib API I/O functions can cause an SSL handshake to be performed, it is often not possible to know if the reason that a <a href="SslLib.html#1103077"><code>SslSend()</code></a> returned <code>netErrWouldBlock</code> is because the Send operation failed or a Receive operation failed (because a SSL Handshake was being performed).  This attribute allows the application to determine which I/O operation was being called if a network error is returned.  If the application is using <a href="NetLibrary.html#1086574"><code>NetLibSelect()</code></a>, this attribute is very important. Because this attribute returns the last network operation performed, <code>sslLastIoNone</code> will only be returned if the SslContext has not performed any I/O operations since its last reset.</p>

<h3 class="hbH3">
  <a name="1101707"> </a>SSL Protocol States <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101708"> </a>Purpose 
</h4>

<p><a name="1101709"> </a>These constants indicate the state that the SSL protocol is currently in. See the SSL protocol specification for clarification on what the values mean.</p>
<h4>
  <a name="1101710"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101711"> </a></code><h4>
  <a name="1101712"> </a>Constants 
</h4>

<dl>
<dt><a name="1101714"> </a><code>#define sslHsStateCert 7</code></dt>
<dt><a name="1101716"> </a><code>#define sslHsStateCertB 8</code></dt>
<dt><a name="1101718"> </a><code>#define sslHsStateCertReq 13</code></dt>
<dt><a name="1101720"> </a><code>#define sslHsStateCertReqB 14</code></dt>
<dt><a name="1101722"> </a><code>#define sslHsStateCkEx 17</code></dt>
<dt><a name="1101724"> </a><code>#define sslHsStateCleanup 25</code></dt>
<dt><a name="1101726"> </a><code>#define sslHsStateClientCert 16</code></dt>
<dt><a name="1101728"> </a><code>#define sslHsStateClientHello 2</code></dt>
<dt><a name="1101730"> </a><code>#define sslHsStateClosed 28</code></dt>
<dt><a name="1101732"> </a><code>#define sslHsStateDone 26</code></dt>
<dt><a name="1101734"> </a><code>#define sslHsStateFinished 19</code></dt>
<dt><a name="1101736"> </a><code>#define sslHsStateFlush 4</code></dt>
<dt><a name="1101738"> </a><code>#define sslHsStateGenerateKeys 21</code></dt>
<dt><a name="1101740"> </a><code>#define sslHsStateHelloRequest 29</code></dt>
<dt><a name="1101742"> </a><code>#define sslHsStateNone 0</code></dt>
<dt><a name="1101744"> </a><code>#define sslHsStateReadCcs 20</code></dt>
<dt><a name="1101746"> </a><code>#define sslHsStateReadFinished 22</code></dt>
<dt><a name="1101748"> </a><code>#define sslHsStateReadFinishedB 23</code></dt>
<dt><a name="1101750"> </a><code>#define sslHsStateReadFinishedC 24</code></dt>
<dt><a name="1101752"> </a><code>#define sslHsStateServerDone 15</code></dt>
<dt><a name="1101754"> </a><code>#define sslHsStateServerHello 3</code></dt>
<dt><a name="1101756"> </a><code>#define sslHsStateShutdown 27</code></dt>
<dt><a name="1101758"> </a><code>#define sslHsStateSkEx 9</code></dt>
<dt><a name="1101760"> </a><code>#define sslHsStateSkExAnonDh 12</code></dt>
<dt><a name="1101762"> </a><code>#define sslHsStateSkExDh 11</code></dt>
<dt><a name="1101764"> </a><code>#define sslHsStateSkExRsa 10</code></dt>
<dt><a name="1101766"> </a><code>#define sslHsStateStart 1</code></dt>
<dt><a name="1101768"> </a><code>#define sslHsStateWrite 6</code></dt>
<dt><a name="1101770"> </a><code>#define sslHsStateWriteCcs 18</code></dt>
<dt><a name="1101772"> </a><code>#define sslHsStateWriteClose 30</code></dt>
<dt><a name="1101774"> </a><code>#define sslHsStateWriteFlush 5</code></dt>
</dl>

<h3 class="hbH3">
  <a name="1101776"> </a>SSL Server Alerts <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101777"> </a>Purpose 
</h4>

<p><a name="1101778"> </a>Alert values received from the server.</p>
<h4>
  <a name="1101779"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101780"> </a></code><h4>
  <a name="1101781"> </a>Constants 
</h4>

<dl>
<dt><a name="1101783"> </a><code>#define sslAlertAccessDenied (0x0200+49)</code></dt>
<dd><a name="1101784"> </a></dd>

<dt><a name="1101786"> </a><code>#define sslAlertBadCertificate (0x0100+42)</code></dt>
<dd><a name="1101787"> </a></dd>

<dt><a name="1101789"> </a><code>#define sslAlertBadRecordMac (0x0200+20)</code></dt>
<dd><a name="1101790"> </a></dd>

<dt><a name="1101792"> </a><code>#define sslAlertCertificateExpired (0x0100+45)</code></dt>
<dd><a name="1101793"> </a></dd>

<dt><a name="1101795"> </a><code>#define sslAlertCertificateRevoked (0x0100+44)</code></dt>
<dd><a name="1101796"> </a></dd>

<dt><a name="1101798"> </a><code>#define sslAlertCertificateUnknown (0x0100+46)</code></dt>
<dd><a name="1101799"> </a></dd>

<dt><a name="1101801"> </a><code>#define sslAlertCloseNotify (0x0100+ 0)</code></dt>
<dd><a name="1101802"> </a></dd>

<dt><a name="1101804"> </a><code>#define sslAlertDecodeError (0x0200+50)</code></dt>
<dd><a name="1101805"> </a></dd>

<dt><a name="1101807"> </a><code>#define sslAlertDecompressionFailure (0x0200+30)</code></dt>
<dd><a name="1101808"> </a></dd>

<dt><a name="1101810"> </a><code>#define sslAlertDecryptError (0x0200+51)</code></dt>
<dd><a name="1101811"> </a></dd>

<dt><a name="1101813"> </a><code>#define sslAlertDecryptionFailed (0x0200+21)</code></dt>
<dd><a name="1101814"> </a></dd>

<dt><a name="1101816"> </a><code>#define sslAlertExportRestricion (0x0200+60)</code></dt>
<dd><a name="1101817"> </a></dd>

<dt><a name="1101819"> </a><code>#define sslAlertHandshakeFailure (0x0200+40)</code></dt>
<dd><a name="1101820"> </a></dd>

<dt><a name="1101822"> </a><code>#define sslAlertIllegalParameter (0x0200+47)</code></dt>
<dd><a name="1101823"> </a></dd>

<dt><a name="1101825"> </a><code>#define sslAlertInsufficientSecurity (0x0200+71)</code></dt>
<dd><a name="1101826"> </a></dd>

<dt><a name="1101828"> </a><code>#define sslAlertInternalError (0x0200+80)</code></dt>
<dd><a name="1101829"> </a></dd>

<dt><a name="1101831"> </a><code>#define sslAlertNoCertificate (0x0100+41)</code></dt>
<dd><a name="1101832"> </a></dd>

<dt><a name="1101834"> </a><code>#define sslAlertNoRenegotiation (0x0100+100)</code></dt>
<dd><a name="1101835"> </a></dd>

<dt><a name="1101837"> </a><code>#define sslAlertProtocolVersion (0x0200+70)</code></dt>
<dd><a name="1101838"> </a></dd>

<dt><a name="1101840"> </a><code>#define sslAlertRecordOverflow (0x0200+22)</code></dt>
<dd><a name="1101841"> </a></dd>

<dt><a name="1101843"> </a><code>#define sslAlertUnexpectedMessage (0x0200+10)</code></dt>
<dd><a name="1101844"> </a></dd>

<dt><a name="1101846"> </a><code>#define sslAlertUnknownCa (0x0200+48)</code></dt>
<dd><a name="1101847"> </a></dd>

<dt><a name="1101849"> </a><code>#define sslAlertUnsupportedCertificate (0x0100+43)</code></dt>
<dd><a name="1101850"> </a></dd>

<dt><a name="1101852"> </a><code>#define sslAlertUserCancled (0x0100+90)</code></dt>
</dl>
<h4>
  <a name="1101854"> </a>Comments 
</h4>

<p><a name="1101855"> </a>The alert values are received from the server and are of two types, fatal and non-fatal.</p>

<p><a name="1101856"> </a>The non-fatal alerts have a value of the form <code>0x01</code><!-PS02-><span style="color: #000000;  font-style: italic; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">XX</span>, while fatal Alerts have the form <code>0x02</code><!-PS02-><span style="color: #000000;  font-style: italic; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">XX</span>.  SslLib will fail on fatal alerts and continue on non-fatal alerts.</p>

<h3 class="hbH3">
  <a name="1101858"> </a>Verification States <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101859"> </a>Purpose 
</h4>

<p><a name="1101863"> </a>These constants represent the possible values of the <a href="SslLib.html#1101261"><code>SslVerify</code></a> structure's <code>state</code> field.  They indicate which section of the certificate verification failed. </p>
<h4>
  <a name="1101864"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101865"> </a></code><h4>
  <a name="1101866"> </a>Constants 
</h4>

<dl>
<dt><a name="1101867"> </a><code>#define sslVerifyDone 6</code></dt>
<dd><a name="1101868"> </a></dd>

<dt><a name="1101869"> </a><code>#define sslVerifyExtensions 5</code></dt>
<dd><a name="1101870"> </a></dd>

<dt><a name="1101871"> </a><code>#define sslVerifyFindParent 1</code></dt>
<dd><a name="1101872"> </a></dd>

<dt><a name="1101873"> </a><code>#define sslVerifyNotAfterFindParent 4</code></dt>
<dd><a name="1101874"> </a></dd>

<dt><a name="1101875"> </a><code>#define sslVerifyNotBefore 3</code></dt>
<dd><a name="1101876"> </a></dd>

<dt><a name="1101877"> </a><code>#define sslVerifySignature 2</code></dt>
<dd><a name="1101878"> </a></dd>

</dl>

<h3 class="hbH3">
  <a name="1101880"> </a>SSL Library Errors <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1101881"> </a>Purpose 
</h4>

<p><a name="1101882"> </a>Error codes returned by the various SSL Library functions.</p>
<h4>
  <a name="1101883"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1101884"> </a></code><h4>
  <a name="1101885"> </a>Constants 
</h4>

<dl>
<dt><a name="1101887"> </a><code>#define sslErrBadArgument (sslErrorClass+17)</code></dt>
<dd><a name="1101888"> </a>An invalid argument was provided to the function.</dd>

<dt><a name="1101890"> </a><code>#define sslErrBadDecode (sslErrorClass+9)</code></dt>
<dd><a name="1101891"> </a>An error occurred while decoding values during certificate verification.</dd>

<dt><a name="1101893"> </a><code>#define sslErrBadLength (sslErrorClass+13)</code></dt>
<dd><a name="1101894"> </a>A length argument was invalid.</dd>

<dt><a name="1101896"> </a><code>#define sslErrBadOption (sslErrorClass+18)</code></dt>
<dd><a name="1101897"> </a>An invalid argument was provided to the function.</dd>

<dt><a name="1101899"> </a><code>#define sslErrBadPeerFinished (sslErrorClass+46)</code></dt>
<dd><a name="1101900"> </a>The final check of the SSL handshake failed. This indicates that there was a problem establishing a shared secret value.  It could be caused by the server using a certificate that does not match its private key.</dd>

<dt><a name="1101902"> </a><code>#define sslErrBadSignature (sslErrorClass+47)</code></dt>
<dd><a name="1101903"> </a>An invalid signature was found on a ephemeral Cipher Suite message.</dd>

<dt><a name="1101905"> </a><code>#define sslErrBufferTooSmall (sslErrorClass+11)</code></dt>
<dd><a name="1101906"> </a>A supplied buffer was not large enough for the output data.</dd>

<dt><a name="1101908"> </a><code>#define sslErrCbAbort (sslErrorClass+4)</code></dt>
<dd><a name="1101909"> </a>This error code would be returned by an applications callback function to indicate a desire to exit.  This error may not be fatal, depending on the callback that generated the error.</dd>

<dt><a name="1101911"> </a><code>#define sslErrCert (sslErrorClass+39)</code></dt>
<dd><a name="1101912"> </a>A generic error occurred inside the SslLib certificate library.</dd>

<dt><a name="1101914"> </a><code>#define sslErrCertDecodeError (sslErrorClass+51)</code></dt>
<dd><a name="1101915"> </a>The Servers certificate could not be decoded.</dd>

<dt><a name="1101917"> </a><code>#define sslErrCsp (sslErrorClass+38)</code></dt>
<dd><a name="1101918"> </a>A generic error occurred inside the SslLib cryptographic library.</dd>

<dt><a name="1101920"> </a><code>#define sslErrDivByZero (sslErrorClass+7)</code></dt>
<dd><a name="1101921"> </a>Something went wrong in the Maths library.  These error will normally only be generated by certificates which have invalid public keys.</dd>

<dt><a name="1101923"> </a><code>#define sslErrEof (sslErrorClass+2)</code></dt>
<dd><a name="1101924"> </a>Error returned by SslLib functions when either the SSL protocol has been closed or the underlying socket has been closed.  This error indicates that the current SslContext is unable to read or write any more data bytes.</dd>

<dt><a name="1101926"> </a><code>#define sslErrExtraHandshakeData (sslErrorClass+43)</code></dt>
<dd><a name="1101927"> </a>Extra data was found in the SSL handshake messages that should not have been there.</dd>

<dt><a name="1101929"> </a><code>#define sslErrFailed (sslErrorClass+1)</code></dt>
<dd><a name="1101930"> </a>A generic error.</dd>

<dt><a name="1101932"> </a><code>#define sslErrFatalAlert (sslErrorClass+45)</code></dt>
<dd><a name="1101933"> </a>A fatal alert was received by the SSL protocol.</dd>

<dt><a name="1101935"> </a><code>#define sslErrHandshakeEncoding (sslErrorClass+40)</code></dt>
<dd><a name="1101936"> </a>An error occurred during decoding of SSL handshake messages.</dd>

<dt><a name="1101938"> </a><code>#define sslErrHandshakeProtocol (sslErrorClass+42)</code></dt>
<dd><a name="1101939"> </a>An error occurred while processing the decoded SSL handshake messages.</dd>

<dt><a name="1101941"> </a><code>#define sslErrInitNotCalled (sslErrorClass+10)</code></dt>
<dd><a name="1101942"> </a>An internal SslLib error.</dd>

<dt><a name="1101944"> </a><code>#define sslErrInternalError (sslErrorClass+21)</code></dt>
<dd><a name="1101945"> </a>An internal SslLib error.</dd>

<dt><a name="1101947"> </a><code>#define sslErrIo (sslErrorClass+5)</code></dt>
<dd><a name="1101951"> </a>This error code is returned when an underlying <a href="NetLibrary.html#1083561">Net Library</a> function call returned an error that is not fatal.  A timeout, or other such non-fatal network errors will be reclassified as this error type.  A function that returns this error type can be re-called once the error condition has disappeared.</dd>

<dt><a name="1101953"> </a><code>#define sslErrMissingProvider (sslErrorClass+41)</code></dt>
<dd><a name="1101954"> </a>An internal SslLib error.</dd>

<dt><a name="1101956"> </a><code>#define sslErrNoDmem (sslErrorClass+14)</code></dt>
<dd><a name="1101957"> </a>An internal SslLib error.</dd>

<dt><a name="1101959"> </a><code>#define sslErrNoMethodSet (sslErrorClass+15)</code></dt>
<dd><a name="1101960"> </a>An internal SslLib error.</dd>

<dt><a name="1101962"> </a><code>#define sslErrNoModInverse (sslErrorClass+8)</code></dt>
<dd><a name="1101963"> </a>Something went wrong in the Maths library.  These error will normally only be generated by certificates which have invalid public keys.</dd>

<dt><a name="1101965"> </a><code>#define sslErrNoRandom (sslErrorClass+16)</code></dt>
<dd><a name="1101966"> </a>A problem with the random number source.</dd>

<dt><a name="1101968"> </a><code>#define sslErrNotFound (sslErrorClass+6)</code></dt>
<dd><a name="1101969"> </a>Returned on an internal SslLib search that did not find a valid entry.  Consider this an internal SslLib error.</dd>

<dt><a name="1101971"> </a><code>#define sslErrNotImplemented (sslErrorClass+19)</code></dt>
<dd><a name="1101972"> </a>An internal SslLib error.</dd>

<dt><a name="1101974"> </a><code>#define sslErrNullArg (sslErrorClass+12)</code></dt>
<dd><a name="1101975"> </a>An passed argument was <code>NULL</code> that should not have been <code>NULL</code>.</dd>

<dt><a name="1101977"> </a><code>#define sslErrOk (sslErrorClass+0)</code></dt>
<dd><a name="1101978"> </a>Not an error.</dd>

<dt><a name="1101980"> </a><code>#define sslErrOutOfMemory (sslErrorClass+3)</code></dt>
<dd><a name="1101981"> </a>Returned if a dynamic memory allocation failed.  This is normally considered a very bad error.</dd>

<dt><a name="1101983"> </a><code>#define sslErrReadAppData (sslErrorClass+50)</code></dt>
<dd><a name="1101984"> </a>Application data was read by the SSL protocol when it was expecting handshake messages.</dd>

<dt><a name="1101986"> </a><code>#define sslErrReallocStaticData (sslErrorClass+20)</code></dt>
<dd><a name="1101987"> </a>An internal SslLib error</dd>

<dt><a name="1101989"> </a><code>#define sslErrRecordError (sslErrorClass+37)</code></dt>
<dd><a name="1101990"> </a>An invalid record was received in the SslContext.</dd>

<dt><a name="1101992"> </a><code>#define sslErrUnexpectedRecord (sslErrorClass+49)</code></dt>
<dd><a name="1101993"> </a>A record of the wrong was received inside the SSL protocol .</dd>

<dt><a name="1101995"> </a><code>#define sslErrUnsupportedCertType (sslErrorClass+52)</code></dt>
<dd><a name="1101996"> </a>The Servers certificate contains a public key we cannot decode.</dd>

<dt><a name="1101998"> </a><code>#define sslErrUnsupportedSignatureType (sslErrorClass+53)</code></dt>
<dd><a name="1101999"> </a>We have been send a certificate with a signature type we do not recognize. </dd>

<dt><a name="1102000"> </a><code>#define sslErrVerifyBadSignature (sslErrorClass+128)</code></dt>
<dd><a name="1102001"> </a></dd>

<dt><a name="1102002"> </a><code>#define sslErrVerifyCallback (sslErrorClass+134)</code></dt>
<dd><a name="1102003"> </a></dd>

<dt><a name="1102004"> </a><code>#define sslErrVerifyConstraintViolation (sslErrorClass+132)</code></dt>
<dd><a name="1102005"> </a></dd>

<dt><a name="1102006"> </a><code>#define sslErrVerifyNotAfter (sslErrorClass+130)</code></dt>
<dd><a name="1102007"> </a></dd>

<dt><a name="1102008"> </a><code>#define sslErrVerifyNotBefore (sslErrorClass+131)</code></dt>
<dd><a name="1102009"> </a></dd>

<dt><a name="1102010"> </a><code>#define sslErrVerifyNoTrustedRoot (sslErrorClass+129)</code></dt>
<dd><a name="1102011"> </a></dd>

<dt><a name="1102012"> </a><code>#define sslErrVerifyUnknownCriticalExtension (sslErrorClass+133)</code></dt>
<dd><a name="1102013"> </a></dd>

<dt><a name="1102015"> </a><code>#define sslErrWrongMessage (sslErrorClass+44)</code></dt>
<dd><a name="1102016"> </a>An invalid SSL message was received.</dd>

</dl>

<h3 class="hbH3">
  <a name="1102017"> </a>SSL Library Traps <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102018"> </a>Purpose 
</h4>

<p><a name="1102019"> </a>These constants are used by the trap mechanism to call the various functions in the SSL library.</p>
<h4>
  <a name="1102020"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102021"> </a></code><h4>
  <a name="1102022"> </a>Constants 
</h4>

<dl>
<dt><a name="1102023"> </a><code>#define kSslClose (sysLibTrapCustom+13)</code></dt>
<dt><a name="1102024"> </a><code>#define kSslConsume (sysLibTrapCustom+19)</code></dt>
<dt><a name="1102025"> </a><code>#define kSslContextCreate (sysLibTrapCustom+6)</code></dt>
<dt><a name="1102026"> </a><code>#define kSslContextDestroy (sysLibTrapCustom+7)</code></dt>
<dt><a name="1102027"> </a><code>#define kSslContextGetLong (sysLibTrapCustom+8)</code></dt>
<dt><a name="1102028"> </a><code>#define kSslContextGetPtr (sysLibTrapCustom+10)</code></dt>
<dt><a name="1102029"> </a><code>#define kSslContextSetLong (sysLibTrapCustom+9)</code></dt>
<dt><a name="1102030"> </a><code>#define kSslContextSetPtr (sysLibTrapCustom+11)</code></dt>
<dt><a name="1102031"> </a><code>#define kSslFlush (sysLibTrapCustom+20)</code></dt>
<dt><a name="1102032"> </a><code>#define kSslLibClose sysLibTrapClose</code></dt>
<dt><a name="1102033"> </a><code>#define kSslLibCreate (sysLibTrapCustom)</code></dt>
<dt><a name="1102034"> </a><code>#define kSslLibDestroy (sysLibTrapCustom+1)</code></dt>
<dt><a name="1102035"> </a><code>#define kSslLibGetLong (sysLibTrapCustom+3)</code></dt>
<dt><a name="1102036"> </a><code>#define kSslLibGetPtr (sysLibTrapCustom+5)</code></dt>
<dt><a name="1102037"> </a><code>#define kSslLibName sysLibTrapName</code></dt>
<dt><a name="1102038"> </a><code>#define kSslLibOpen sysLibTrapOpen</code></dt>
<dt><a name="1102039"> </a><code>#define kSslLibSetLong (sysLibTrapCustom+2)</code></dt>
<dt><a name="1102040"> </a><code>#define kSslLibSetPtr (sysLibTrapCustom+4)</code></dt>
<dt><a name="1102041"> </a><code>#define kSslLibSleep sysLibTrapSleep</code></dt>
<dt><a name="1102042"> </a><code>#define kSslLibWake sysLibTrapWake</code></dt>
<dt><a name="1102043"> </a><code>#define kSslOpen (sysLibTrapCustom+12)</code></dt>
<dt><a name="1102044"> </a><code>#define kSslPeek (sysLibTrapCustom+18)</code></dt>
<dt><a name="1102045"> </a><code>#define kSslRead (sysLibTrapCustom+16)</code></dt>
<dt><a name="1102046"> </a><code>#define kSslReceive (sysLibTrapCustom+15)</code></dt>
<dt><a name="1102047"> </a><code>#define kSslSend (sysLibTrapCustom+14)</code></dt>
<dt><a name="1102048"> </a><code>#define kSslWrite (sysLibTrapCustom+17)</code></dt>
</dl>

<h3 class="hbH3">
  <a name="1102049"> </a>Miscellaneous SSL Library Constants	 <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102050"> </a>Purpose 
</h4>

<p><a name="1102051"> </a>These constants are also defined in <code>SslLib.h</code>.</p>
<h4>
  <a name="1102052"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102053"> </a></code><h4>
  <a name="1102054"> </a>Constants 
</h4>

<dl>
<dt><a name="1102056"> </a><code>#define kSslDBName "SslLib"</code></dt>
<dd><a name="1102057"> </a>The SSL library's name. Use this when determining if the SSL library is loaded with <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a>.</dd>

<dt><a name="1102062"> </a><code>#define kSslLibCreator 'ssl0'</code></dt>
<dd><a name="1102063"> </a>The SSL library's creator ID. Use this when loading the SSL library with <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>.</dd>

<dt><a name="1102068"> </a><code>#define kSslLibType sysFileTLibrary</code></dt>
<dd><a name="1102069"> </a>The SSL library's type. Use this when loading the SSL library with <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>.</dd>

</dl>

<h2 class="haH2">
  <a name="1102074"> </a>SSL Library Functions and Macros <a href="#1100916"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1102077"> </a>SslClose Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102079"> </a>Purpose 
</h4>

<p><a name="1102080"> </a>Performs the shutdown part of the SSL protocol. </p>
<h4>
  <a name="1102081"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102082"> </a></code><h4>
  <a name="1102083"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102084"></a>Err SslClose (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   UInt16 <code class="par">mode</code>,
   UInt32 <code class="par">timeout</code>
)
</pre>
<h4>
  <a name="1102085"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102086"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102087"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102094"> </a><code>&rarr;  <i>ctx</i></code></dt>
<dd><a name="1102095"> </a>The context to query.</dd>

<dt><a name="1102096"> </a><code>&rarr;  <i>mode</i></code></dt>
<dd><a name="1102097"> </a>Flags that specify how to perform the SSL Protocol shutdown. A combination of the values listed under <a href="SslLib.html#1101363">"SSL Close Mode Flags."</a></dd>

<dt><a name="1102101"> </a><code>&rarr;  <i>timeout</i></code></dt>
<dd><a name="1102102"> </a>Timeout, in system ticks, to use for final message exchange</dd>

</dl>
<h4>
  <a name="1102103"> </a>Returns 
</h4>

<p><a name="1102104"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102108"> </a>Comments 
</h4>

<p><a name="1102109"> </a>This usually involves message exchanges.  This function can be repeatedly called after a timeout until either a network error is reported or the final SSL shutdown message exchange has been completed.  The mode values can be logically ORed together.</p>
<h4>
  <a name="1102110"> </a>Example 
</h4>

<p><a name="1102111"> </a>The following code excerpt show how you might use this function:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Err err;<a name="1102112"> </a>
SslContext *ssl;<a name="1102113"> </a>
<a name="1102114"> </a>
err = SslOpen(theLibRef, ssl,0,20*SysTicksPerSecond());<a name="1102115"> </a>
/* Perform SSL IO */<a name="1102116"> </a>
/* Shutdown the protocol but don't linger waiting for a<a name="1102117"> </a>
 * response from the server */<a name="1102118"> </a>
err = SslClose(theLibRef, ssl,sslCloseDontWaitForshutdown,
   20*SysTicksPerSecond());<a name="1102119"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102120"> </a>See Also 
</h4>

<p><a name="1102130"> </a><a href="SslLib.html#1102877"><code>SslOpen()</code></a>, <a href="SslLib.html#1102349"><code>SslContextSetLong()</code></a>, <a href="SslLib.html#1102400"><code>SslContextSetPtr()</code></a></p>

<h3 class="hbH3">
  <a name="1102133"> </a>SslConsume Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102135"> </a>Purpose 
</h4>

<p><a name="1102136"> </a>Removes up to a specified number of bytes from the buffered read bytes in the passed <code>SslContext</code>.</p>
<h4>
  <a name="1102137"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102138"> </a></code><h4>
  <a name="1102139"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102140"></a>void SslConsume (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   Int32 <code class="par">number</code>
)
</pre>
<h4>
  <a name="1102141"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102142"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102143"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102150"> </a><code>&rarr;  <i>ctx</i></code></dt>
<dd><a name="1102151"> </a>The SslContext to operate on.</dd>

<dt><a name="1102152"> </a><code>&rarr;  <i>number</i></code></dt>
<dd><a name="1102153"> </a>The number of bytes to remove from the internal buffer.</dd>

</dl>
<h4>
  <a name="1102154"> </a>Returns 
</h4>

<p><a name="1102155"> </a>Nothing.</p>
<h4>
  <a name="1102156"> </a>Comments 
</h4>

<p><a name="1102160"> </a>This function is normally used in conjunction with <a href="SslLib.html#1102933"><code>SslPeek()</code></a>. </p>
<h4>
  <a name="1102161"> </a>Example 
</h4>

<p><a name="1102162"> </a>The following code excerpt shows how this function might be used.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Err err;<a name="1102163"> </a>
void *data;<a name="1102164"> </a>
Int32 *dataLen;<a name="1102165"> </a>
<a name="1102166"> </a>
err=SslPeek(theLibRef, ssl,&amp;data,*dataLen,16*1024);<a name="1102167"> </a>
/* Process the dataLen bytes located at data */<a name="1102168"> </a>
SslConsume(theLibRef, ssl,dataLen);<a name="1102169"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102170"> </a>See Also 
</h4>

<p><a name="1102180"> </a><a href="SslLib.html#1102933"><code>SslPeek()</code></a>, <a href="SslLib.html#1102985"><code>SslRead()</code></a>, <a href="SslLib.html#1103027"><code>SslReceive()</code></a></p>

<h3 class="hbH3">
  <a name="1102183"> </a>SslContextCreate Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102185"> </a>Purpose 
</h4>

<p><a name="1102186"> </a>Creates a new SSL Context.</p>
<h4>
  <a name="1102187"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102188"> </a></code><h4>
  <a name="1102189"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102190"></a>Err SslContextCreate (
   UInt16 <code class="par">libRef</code>,
   SslLib <code class="par">*lib</code>,
   SslContext <code class="par">**ctx</code>
)
</pre>
<h4>
  <a name="1102191"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102192"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102193"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102200"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102201"> </a>The SSL library structure.</dd>

<dt><a name="1102202"> </a><code>&larr;  <i>ctx</i></code></dt>
<dd><a name="1102203"> </a>Where to deposit the SslContext pointer.</dd>

</dl>
<h4>
  <a name="1102204"> </a>Returns 
</h4>

<p><a name="1102205"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102209"> </a>Comments 
</h4>

<p><a name="1102210"> </a>A SslContext is the data structure used to encapsulates all aspects of a SSL connection.  This routine will deposit a pointer to the newly created structure at the address given by the <code class="par">ctx</code> argument.  Various default values will be inherited from the passed SslLib.</p>
<h4>
  <a name="1102211"> </a>See Also 
</h4>

<p><a name="1102221"> </a><a href="SslLib.html#1102877"><code>SslOpen()</code></a>, <a href="SslLib.html#1102227"><code>SslContextDestroy()</code></a>, <a href="SslLib.html#1102349"><code>SslContextSetLong()</code></a>, <a href="SslLib.html#1102400"><code>SslContextSetPtr()</code></a></p>

<h3 class="hbH3">
  <a name="1102227"> </a>SslContextDestroy Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102229"> </a>Purpose 
</h4>

<p><a name="1102230"> </a>Destroys the SSL Context. </p>
<h4>
  <a name="1102231"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102232"> </a></code><h4>
  <a name="1102233"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102234"></a>void SslContextDestroy (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>
)
</pre>
<h4>
  <a name="1102235"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102236"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102237"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102244"> </a><code>&rarr;  <i>ctx</i></code></dt>
<dd><a name="1102245"> </a>The SslContext to destroy.</dd>

</dl>
<h4>
  <a name="1102246"> </a>Returns 
</h4>

<p><a name="1102247"> </a>Nothing.</p>
<h4>
  <a name="1102248"> </a>Comments 
</h4>

<p><a name="1102249"> </a>This routine will free the memory associated with the passed SslContext.  This function will not close the network connection or shutdown the SSL protocol.  See <a href="SslLib.html#1102077"><code>SslClose()</code></a> for information on shutting down the SSL Protocol.</p>
<h4>
  <a name="1102253"> </a>See Also 
</h4>

<p><a name="1102260"> </a><a href="SslLib.html#1102183"><code>SslContextCreate()</code></a>, <a href="SslLib.html#1102077"><code>SslClose()</code></a></p>

<h3 class="hbH3">
  <a name="1102263"> </a>SslContextGetLong Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102265"> </a>Purpose 
</h4>

<p><a name="1102266"> </a>Retrieve an integer attribute value from the passed SslContext structure. </p>
<h4>
  <a name="1102267"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102268"> </a></code><h4>
  <a name="1102269"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102270"></a>Int32 SslContextGetLong (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*lib</code>,
   SslAttribute <code class="par">attr</code>
)
</pre>
<h4>
  <a name="1102271"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102272"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102273"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102280"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102281"> </a>The SslContext from which the value is to be retrieved.</dd>

<dt><a name="1102282"> </a><code>&rarr;  <i>attr</i></code></dt>
<dd><a name="1102283"> </a>Attribute to retrieve.</dd>

</dl>
<h4>
  <a name="1102284"> </a>Returns 
</h4>

<p><a name="1102285"> </a>The value of the attribute is returned.  If a non-existent attribute was requested, -1 is returned.  This could give incorrect values so an application should make sure to call this routine with the correct arguments.</p>
<h4>
  <a name="1102286"> </a>Comments 
</h4>

<p><a name="1102287"> </a>This function is not normally used directly, but via pre-defined macros.</p>
<h4>
  <a name="1102288"> </a>Example 
</h4>

<p><a name="1102289"> </a>The following example shows the use of one of the macros that make use of this function:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
/* Is the SslContext configured to do ssl? */<a name="1102290"> </a>
if (!(SslContextGet_Mode(theLibRef, lib) &amp; sslModeSsl))<a name="1102291"> </a>
   return(WE_ARE_NOT_USING_SSL);<a name="1102292"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102293"> </a>See Also 
</h4>

<p><a name="1102300"> </a><a href="SslLib.html#1102349"><code>SslContextSetLong()</code></a>, <a href="SslLib.html#1102263"><code>SslContextGetLong()</code></a></p>

<h3 class="hbH3">
  <a name="1102303"> </a>SslContextGetPtr Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102305"> </a>Purpose 
</h4>

<p><a name="1102306"> </a>Retrieve a pointer to an attribute value from the passed SslContext structure.</p>
<h4>
  <a name="1102307"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102308"> </a></code><h4>
  <a name="1102309"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102310"></a>Err SslContextGetPtr (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*lib</code>,
   SslAttribute <code class="par">attr</code>,
   void <code class="par">**value</code>
)
</pre>
<h4>
  <a name="1102311"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102312"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102313"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102320"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102321"> </a>The SslContext to retrieve the attribute from.</dd>

<dt><a name="1102322"> </a><code>&rarr;  <i>attr</i></code></dt>
<dd><a name="1102323"> </a>The attribute to retrieve</dd>

<dt><a name="1102324"> </a><code>&larr;  <i>value</i></code></dt>
<dd><a name="1102325"> </a>A pointer to an attribute specific pointer</dd>

</dl>
<h4>
  <a name="1102326"> </a>Returns 
</h4>

<p><a name="1102327"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102331"> </a>Comments 
</h4>

<p><a name="1102332"> </a>This function is not normally used directly, but via pre-defined macros.  The type of the pointer returned is specific to the attribute being requested.</p>
<h4>
  <a name="1102333"> </a>Example 
</h4>

<p><a name="1102334"> </a>The following example shows the use of one of the macros that makes use of this function:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
SslSession *session;<a name="1102335"> </a>
Err err;<a name="1102336"> </a>
<a name="1102337"> </a>
err = SslContextGet_SslSession(theLibRef, ssl,&amp;session);<a name="1102338"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102339"> </a>See Also 
</h4>

<p><a name="1102346"> </a><a href="SslLib.html#1102400"><code>SslContextSetPtr()</code></a>, <a href="SslLib.html#1102637"><code>SslLibGetPtr()</code></a></p>

<h3 class="hbH3">
  <a name="1102349"> </a>SslContextSetLong Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102351"> </a>Purpose 
</h4>

<p><a name="1102352"> </a>Modify one of the numeric attributes of a SslContext structure. </p>
<h4>
  <a name="1102353"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102354"> </a></code><h4>
  <a name="1102355"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102356"></a>Err SslContextSetLong (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*lib</code>,
   SslAttribute <code class="par">attr</code>,
   long <code class="par">value</code>
)
</pre>
<h4>
  <a name="1102357"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102358"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102359"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102366"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102367"> </a>The SslContext on which to operate.</dd>

<dt><a name="1102368"> </a><code>&rarr;  <i>attr</i></code></dt>
<dd><a name="1102369"> </a>The attribute to modify.</dd>

<dt><a name="1102370"> </a><code>&rarr;  <i>value</i></code></dt>
<dd><a name="1102371"> </a>The new value.</dd>

</dl>
<h4>
  <a name="1102372"> </a>Returns 
</h4>

<p><a name="1102373"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102377"> </a>Comments 
</h4>

<p><a name="1102378"> </a>This function is not normally used directly, rather it is used via pre-defined macros.  The <code class="par">attr</code> parameter specifies the SslContext attribute that will be set to the value passed in <code class="par">value</code>.</p>
<h4>
  <a name="1102379"> </a>Example 
</h4>

<p><a name="1102380"> </a>The following code excerpt shows how this function is used.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
SslContext *ssl;<a name="1102381"> </a>
Err err;<a name="1102382"> </a>
<a name="1102383"> </a>
err = SslContextCreate(theLibRef, lib,&amp;ssl);<a name="1102384"> </a>
/*modify output buffer size */<a name="1102385"> </a>
err = SslContextSet_WbufSize(theLibRef, lib, 8*1024);<a name="1102386"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102387"> </a>See Also 
</h4>

<p><a name="1102394"> </a><a href="SslLib.html#1102400"><code>SslContextSetPtr()</code></a>, <a href="SslLib.html#1102303"><code>SslContextGetPtr()</code></a>, <a href="SslLib.html#1102263"><code>SslContextGetLong()</code></a></p>

<h3 class="hbH3">
  <a name="1102400"> </a>SslContextSetPtr Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102402"> </a>Purpose 
</h4>

<p><a name="1102403"> </a>Update one of the non-integer attributes of a SslContext. </p>
<h4>
  <a name="1102404"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102405"> </a></code><h4>
  <a name="1102406"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102407"></a>Err SslContextSetPtr (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*lib</code>,
   SslAttribute <code class="par">attr</code>,
   void <code class="par">*value</code>
)
</pre>
<h4>
  <a name="1102408"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102409"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102410"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102417"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102418"> </a>The SslContext to modify.</dd>

<dt><a name="1102419"> </a><code>&rarr;  <i>attr</i></code></dt>
<dd><a name="1102420"> </a>The attribute to update.</dd>

<dt><a name="1102421"> </a><code>&rarr;  <i>value</i></code></dt>
<dd><a name="1102422"> </a>The value to update, specific to the SslAttribute.</dd>

</dl>
<h4>
  <a name="1102423"> </a>Returns 
</h4>

<p><a name="1102424"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102428"> </a>Comments 
</h4>

<p><a name="1102429"> </a>The <code class="par">attr</code> value defines the type of the <code class="par">value</code> parameter.  This function is not normally used directly, rather it is used via pre-defined macros.</p>
<h4>
  <a name="1102430"> </a>Example 
</h4>

<p><a name="1102431"> </a>The following code excerpt shows how this function is used.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
SslContext *ssl;<a name="1102432"> </a>
SslCallback cb;<a name="1102433"> </a>
Err err;<a name="1102434"> </a>
<a name="1102435"> </a>
err = SslContextCreate(theLibRef, lib,&amp;ssl);<a name="1102436"> </a>
<a name="1102437"> </a>
/* Configure to have 'debugCallbackFunction' called for each<a name="1102438"> </a>
 * SSL protocol handshake state change */<a name="1102439"> </a>
cb.callback = debugCallbackFunction;<a name="1102440"> </a>
cb.data = NULL;<a name="1102441"> </a>
err = SslContextSet_InfoInterest(theLibRef, lib,
   sslInfoHandshake);<a name="1102442"> </a>
err = SslContextSet_InfoCallback(theLibRef, lib,(void *)&amp;cb);<a name="1102443"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102444"> </a>See Also 
</h4>

<p><a name="1102451"> </a><a href="SslLib.html#1102263"><code>SslContextGetLong()</code></a>, <a href="SslLib.html#1102349"><code>SslContextSetLong()</code></a>, <a href="SslLib.html#1102303"><code>SslContextGetPtr()</code></a></p>

<h3 class="hbH3">
  <a name="1102457"> </a>SslFlush Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102459"> </a>Purpose 
</h4>

<p><a name="1102460"> </a>Cause an immediate write of any data buffered in the SslContext to the network.</p>
<h4>
  <a name="1102461"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102462"> </a></code><h4>
  <a name="1102463"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102464"></a>Err SslFlush (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   Int32 <code class="par">*outstanding</code>
)
</pre>
<h4>
  <a name="1102465"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102466"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102467"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102474"> </a><code>&rarr;  <i>ctx</i></code></dt>
<dd><a name="1102475"> </a>The SslContext to operate on.</dd>

<dt><a name="1102476"> </a><code>&larr;  <i>outstanding</i></code></dt>
<dd><a name="1102477"> </a>The number of byte still unflushed after this call.</dd>

</dl>
<h4>
  <a name="1102478"> </a>Returns 
</h4>

<p><a name="1102479"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102483"> </a>Comments 
</h4>

<p><a name="1102484"> </a>A SslContext can be set into 'noAutoFlush' mode.  This means that the SslSend and SslWrite operations will not cause an immediate write to the network.  If this mode is enabled, then explicit SslFlush calls need to be made to ensure that the data buffered in the SslContext is sent to the network.  The main use of noAutoFlush is to allow multiple SslWrite/SslSend commands to have their output buffered in the SslContexts output buffer.  This improves the SSL Protocols efficiency and is generally a good policy if lots of small write operations are being performed by the application.   The number of bytes that can be written to the SslContext write buffer is a few tens of bytes less than the output buffer size.  This means that if the application is writing less than this number of bytes, no network errors can occur until the SslFlush call is made.  The outstanding parameter will be updated to contain the number of buffered bytes that are still buffered in the SslContext.  If this value is non-zero, the next SslWrite, SslSend, SslFlush operaton will attempt to write those bytes to the network.</p>
<h4>
  <a name="1102485"> </a>Example 
</h4>

<p><a name="1102486"> </a>The following code excerpt shows how this function can be used:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Err err;<a name="1102487"> </a>
<a name="1102488"> </a>
SslContextSet_AutoFlush(theLibRef, ssl,0);<a name="1102489"> </a>
SslWrite(theLibRef, ssl,"GET ",4, &amp;err);<a name="1102490"> </a>
SslWrite(theLibRef, ssl,url,StrLen(url), &amp;err);<a name="1102491"> </a>
SslWrite(theLibRef, ssl," HTTP/1.0\r\n\r\n",13, &amp;err);<a name="1102492"> </a>
<a name="1102493"> </a>
err=SslFlush(theLibRef, ssl,NULL);<a name="1102494"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102495"> </a>See Also 
</h4>

<p><a name="1102505"> </a><a href="SslLib.html#1103131"><code>SslWrite()</code></a>, <a href="SslLib.html#1103077"><code>SslSend()</code></a>, <a href="SslLib.html#1102349"><code>SslContextSetLong()</code></a></p>

<h3 class="hbH3">
  <a name="1102508"> </a>SslLibClose Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102510"> </a>Purpose 
</h4>

<p><a name="1102511"> </a>SSL Library's shared library close function.</p>
<h4>
  <a name="1102512"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102513"> </a></code><h4>
  <a name="1102514"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102515"></a>Err SslLibClose (
   UInt16 <code class="par">libRef</code>
)
</pre>
<h4>
  <a name="1102516"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102517"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102518"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

</dl>
<h4>
  <a name="1102525"> </a>Returns 
</h4>

<p><a name="1102526"> </a>Returns <code>errNone</code> if the SSL library was successfully closed.</p>

<h3 class="hbH3">
  <a name="1102529"> </a>SslLibCreate Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102531"> </a>Purpose 
</h4>

<p><a name="1102532"> </a>Creates the SSL library context.</p>
<h4>
  <a name="1102533"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102534"> </a></code><h4>
  <a name="1102535"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102536"></a>Err SslLibCreate (
   UInt16 <code class="par">libRef</code>,
   SslLib <code class="par">**lib</code>
)
</pre>
<h4>
  <a name="1102537"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102538"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102539"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102546"> </a><code>&larr;  <i>lib</i></code></dt>
<dd><a name="1102547"> </a>Where to deposit the SslLib pointer</dd>

</dl>
<h4>
  <a name="1102548"> </a>Returns 
</h4>

<p><a name="1102549"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102553"> </a>Comments 
</h4>

<p><a name="1102554"> </a>This routine will deposit the newly-created SslLib at the address given by the <code class="par">lib</code> argument. This routine is generally the first call made when performing SSL functionality.  Various default configuration values can be set against this structure.  These values will be inherited by SslContext structures created against the SslLib.</p>
<h4>
  <a name="1102555"> </a>See Also 
</h4>

<p><a name="1102562"> </a><a href="SslLib.html#1102571"><code>SslLibDestroy()</code></a>, <a href="SslLib.html#1102183"><code>SslContextCreate()</code></a>, <a href="SslLib.html#1102725"><code>SslLibSetLong()</code></a>, <a href="SslLib.html#1102778"><code>SslLibSetPtr()</code></a></p>

<h3 class="hbH3">
  <a name="1102571"> </a>SslLibDestroy Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102573"> </a>Purpose 
</h4>

<p><a name="1102574"> </a>Destroys the context represented by <code class="par">lib</code>.</p>
<h4>
  <a name="1102575"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102576"> </a></code><h4>
  <a name="1102577"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102578"></a>void SslLibDestroy (
   UInt16 <code class="par">libRef</code>,
   SslLib <code class="par">*lib</code>
)
</pre>
<h4>
  <a name="1102579"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102580"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102581"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102588"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102589"> </a>SslLib structure to be destroyed.</dd>

</dl>
<h4>
  <a name="1102590"> </a>Returns 
</h4>

<p><a name="1102591"> </a>Nothing.</p>
<h4>
  <a name="1102592"> </a>See Also 
</h4>

<p><a name="1102596"> </a><a href="SslLib.html#1102529"><code>SslLibCreate()</code></a></p>

<h3 class="hbH3">
  <a name="1102599"> </a>SslLibGetLong Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102601"> </a>Purpose 
</h4>

<p><a name="1102602"> </a>Retrieve an integer attribute value from the passed SslLib structure. </p>
<h4>
  <a name="1102603"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102604"> </a></code><h4>
  <a name="1102605"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102606"></a>Int32 SslLibGetLong (
   UInt16 <code class="par">libRef</code>,
   SslLib <code class="par">*lib</code>,
   SslAttribute <code class="par">attr</code>
)
</pre>
<h4>
  <a name="1102607"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102608"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102609"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102616"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102617"> </a>The SslLib from which the value is to be retrieved.</dd>

<dt><a name="1102618"> </a><code>&rarr;  <i>attr</i></code></dt>
<dd><a name="1102619"> </a>Attribute to retrieve.</dd>

</dl>
<h4>
  <a name="1102620"> </a>Returns 
</h4>

<p><a name="1102621"> </a>The value of the attribute is returned.  If a non-existent attribute was requested, -1 is returned.</p>
<h4>
  <a name="1102622"> </a>Comments 
</h4>

<p><a name="1102623"> </a>This function is not normally used directly, but via pre-defined macros.</p>
<h4>
  <a name="1102624"> </a>See Also 
</h4>

<p><a name="1102631"> </a><a href="SslLib.html#1102303"><code>SslContextGetPtr()</code></a>, <a href="SslLib.html#1102725"><code>SslLibSetLong()</code></a>, <a href="SslLib.html#1102263"><code>SslContextGetLong()</code></a></p>

<h3 class="hbH3">
  <a name="1102637"> </a>SslLibGetPtr Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102639"> </a>Purpose 
</h4>

<p><a name="1102640"> </a>Retrieve an pointer attribute value from the passed SslLib structure. </p>
<h4>
  <a name="1102641"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102642"> </a></code><h4>
  <a name="1102643"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102644"></a>Err SslLibGetPtr (
   UInt16 <code class="par">libRef</code>,
   SslLib <code class="par">*lib</code>,
   SslAttribute <code class="par">attr</code>,
   void <code class="par">**value</code>
)
</pre>
<h4>
  <a name="1102645"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102646"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102647"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102654"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102655"> </a>The SslLib to retrieve the attribute from.</dd>

<dt><a name="1102656"> </a><code>&rarr;  <i>attr</i></code></dt>
<dd><a name="1102657"> </a>The attribute to retrieve.</dd>

<dt><a name="1102658"> </a><code>&larr;  <i>value</i></code></dt>
<dd><a name="1102659"> </a>A pointer to a attribute specific pointer</dd>

</dl>
<h4>
  <a name="1102660"> </a>Returns 
</h4>

<p><a name="1102661"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102665"> </a>Comments 
</h4>

<p><a name="1102666"> </a>This function is not normally used directly, but via pre-defined macros.  The type of the pointer returned is specific to the attribute being requested.</p>
<h4>
  <a name="1102667"> </a>Example 
</h4>

<p><a name="1102668"> </a>The following code excerpt shows how this function is used.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
SslCallback *cb;<a name="1102669"> </a>
Err err;<a name="1102670"> </a>
<a name="1102671"> </a>
err = SslLibGet_InfoCallback(theLibRef, lib,&amp;cb);<a name="1102672"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102673"> </a>See Also 
</h4>

<p><a name="1102680"> </a><a href="SslLib.html#1102778"><code>SslLibSetPtr()</code></a>, <a href="SslLib.html#1102303"><code>SslContextGetPtr()</code></a></p>

<h3 class="hbH3">
  <a name="1102683"> </a>SslLibName Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102685"> </a>Purpose 
</h4>

<p><a name="1102686"> </a></p>
<h4>
  <a name="1102687"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102688"> </a></code><h4>
  <a name="1102689"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102690"></a>Err SslLibName (
   UInt16 <code class="par">libRef</code>
)
</pre>
<h4>
  <a name="1102691"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102692"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102693"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

</dl>
<h4>
  <a name="1102700"> </a>Returns 
</h4>

<p><a name="1102701"> </a></p>

<h3 class="hbH3">
  <a name="1102704"> </a>SslLibOpen Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102706"> </a>Purpose 
</h4>

<p><a name="1102707"> </a>SSL Library's shared library open function.</p>
<h4>
  <a name="1102708"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102709"> </a></code><h4>
  <a name="1102710"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102711"></a>Err SslLibOpen (
   UInt16 <code class="par">libRef</code>
)
</pre>
<h4>
  <a name="1102712"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102713"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102714"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

</dl>
<h4>
  <a name="1102721"> </a>Returns 
</h4>

<p><a name="1102722"> </a>Returns <code>errNone</code> if the SSL library was successfully opened.</p>

<h3 class="hbH3">
  <a name="1102725"> </a>SslLibSetLong Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102727"> </a>Purpose 
</h4>

<p><a name="1102728"> </a>Modify one of the numeric attributes of a SslLib structure. </p>
<h4>
  <a name="1102729"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102730"> </a></code><h4>
  <a name="1102731"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102732"></a>Err SslLibSetLong (
   UInt16 <code class="par">libRef</code>,
   SslLib <code class="par">*lib</code>,
   SslAttribute <code class="par">attr</code>,
   Int32 <code class="par">value</code>
)
</pre>
<h4>
  <a name="1102733"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102734"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102735"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102742"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102743"> </a>The SslLib on which to operate.</dd>

<dt><a name="1102744"> </a><code>&rarr;  <i>attr</i></code></dt>
<dd><a name="1102745"> </a>The attribute to modify.</dd>

<dt><a name="1102746"> </a><code>&rarr;  <i>value</i></code></dt>
<dd><a name="1102747"> </a>The new value.</dd>

</dl>
<h4>
  <a name="1102748"> </a>Returns 
</h4>

<p><a name="1102749"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102753"> </a>Comments 
</h4>

<p><a name="1102754"> </a>This function is not normally used directly, rather it is used via pre-defined macros.  The <code class="par">attr</code> parameter specifies the SslLib attribute that will be set to the value passed in <code class="par">value</code>.</p>
<h4>
  <a name="1102755"> </a>Example 
</h4>

<p><a name="1102756"> </a>The following code excerpt shows how this function is used.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
SslLib *lib;<a name="1102757"> </a>
Err err;<a name="1102758"> </a>
<a name="1102759"> </a>
err = SslLibCreate(theLibRef, &amp;lib);<a name="1102760"> </a>
err = SslLibSet_AutoFlush(theLibRef, lib,0); /* Turn off */<a name="1102761"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102762"> </a>See Also 
</h4>

<p><a name="1102772"> </a><a href="SslLib.html#1102529"><code>SslLibCreate()</code></a>, <a href="SslLib.html#1102778"><code>SslLibSetPtr()</code></a>, <a href="SslLib.html#1102637"><code>SslLibGetPtr()</code></a>, <a href="SslLib.html#1102599"><code>SslLibGetLong()</code></a></p>

<h3 class="hbH3">
  <a name="1102778"> </a>SslLibSetPtr Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102780"> </a>Purpose 
</h4>

<p><a name="1102781"> </a>Update one of the non-integer attributes of a SslLib.</p>
<h4>
  <a name="1102782"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102783"> </a></code><h4>
  <a name="1102784"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102785"></a>Err SslLibSetPtr (
   UInt16 <code class="par">libRef</code>,
   SslLib <code class="par">*lib</code>,
   SslAttribute <code class="par">attr</code>,
   void <code class="par">*value</code>
)
</pre>
<h4>
  <a name="1102786"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102787"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102788"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102795"> </a><code>&rarr;  <i>lib</i></code></dt>
<dd><a name="1102796"> </a>The SslLib to operate on.</dd>

<dt><a name="1102797"> </a><code>&rarr;  <i>attr</i></code></dt>
<dd><a name="1102798"> </a>The attribute to update.</dd>

<dt><a name="1102799"> </a><code>&rarr;  <i>value</i></code></dt>
<dd><a name="1102800"> </a>The value to update, specific to the SslAttribute.</dd>

</dl>
<h4>
  <a name="1102801"> </a>Returns 
</h4>

<p><a name="1102802"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102806"> </a>Comments 
</h4>

<p><a name="1102807"> </a>The <code class="par">attr</code> value defines the type of the <code class="par">value</code> parameter.  This function is not normally used directly, rather it is used via pre-defined macros.</p>
<h4>
  <a name="1102808"> </a>Example 
</h4>

<p><a name="1102809"> </a>The following code excerpt shows how this function is used.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
SslLib *lib;<a name="1102810"> </a>
SslCallback cb;<a name="1102811"> </a>
Err err;<a name="1102812"> </a>
<a name="1102813"> </a>
err = SslLibCreate(theLibRef, &amp;lib);<a name="1102814"> </a>
<a name="1102815"> </a>
/* Configure to have 'debugCallbackFunction' called for each<a name="1102816"> </a>
 * SSL protocol handshake state change */<a name="1102817"> </a>
cb.callback = debugCallbackFunction;<a name="1102818"> </a>
cb.data = NULL;<a name="1102819"> </a>
err = SslLibSet_InfoInterest(theLibRef, lib,
   sslInfoHandshake);<a name="1102820"> </a>
err = SslLibSet_InfoCallback(theLibRef, lib,(void *)&amp;cb);<a name="1102821"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="1102822"> </a>See Also 
</h4>

<p><a name="1102832"> </a><a href="SslLib.html#1102599"><code>SslLibGetLong()</code></a>, <a href="SslLib.html#1102725"><code>SslLibSetLong()</code></a>, <a href="SslLib.html#1102637"><code>SslLibGetPtr()</code></a></p>

<h3 class="hbH3">
  <a name="1102835"> </a>SslLibSleep Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102837"> </a>Purpose 
</h4>

<p><a name="1102838"> </a>SSL Library's shared library sleep function.</p>
<h4>
  <a name="1102839"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102840"> </a></code><h4>
  <a name="1102841"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102842"></a>Err SslLibSleep (
   UInt16 <code class="par">libRef</code>
)
</pre>
<h4>
  <a name="1102843"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102844"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102845"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

</dl>
<h4>
  <a name="1102852"> </a>Returns 
</h4>

<p><a name="1102853"> </a></p>

<h3 class="hbH3">
  <a name="1102856"> </a>SslLibWake Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102858"> </a>Purpose 
</h4>

<p><a name="1102859"> </a>SSL Library's shared library wake function.</p>
<h4>
  <a name="1102860"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102861"> </a></code><h4>
  <a name="1102862"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102863"></a>Err SslLibWake (
   UInt16 <code class="par">libRef</code>
)
</pre>
<h4>
  <a name="1102864"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102865"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102866"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

</dl>
<h4>
  <a name="1102873"> </a>Returns 
</h4>

<p><a name="1102874"> </a></p>

<h3 class="hbH3">
  <a name="1102877"> </a>SslOpen Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102879"> </a>Purpose 
</h4>

<p><a name="1102880"> </a>Initializes the passed SslContext.</p>
<h4>
  <a name="1102881"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102882"> </a></code><h4>
  <a name="1102883"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102884"></a>Err SslOpen (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   UInt16 <code class="par">mode</code>,
   UInt32 <code class="par">timeout</code>
)
</pre>
<h4>
  <a name="1102885"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102886"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102887"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102894"> </a><code>&harr;  <i>ctx</i></code></dt>
<dd><a name="1102895"> </a>The SslContext to start a SSL Handshake with.</dd>

<dt><a name="1102896"> </a><code>&rarr;  <i>mode</i></code></dt>
<dd><a name="1102897"> </a>How we should 'start' this connection. A combination of the values listed under <a href="SslLib.html#1101332">"SSL Open Mode Flags."</a></dd>

<dt><a name="1102901"> </a><code>&rarr;  <i>timeout</i></code></dt>
<dd><a name="1102905"> </a>Optional timeout (in system ticks) to use for in <a href="NetLibrary.html#1083561">Net Library</a>.</dd>

</dl>
<h4>
  <a name="1102906"> </a>Returns 
</h4>

<p><a name="1102907"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102911"> </a>Comments 
</h4>

<p><a name="1102912"> </a>Depending on the mode, <code>SslOpen()</code> may or may not actually send the handshake messages during this function call, but may delay the handshake until the first <a href="SslLib.html#1103077"><code>SslSend()</code></a>/<a href="SslLib.html#1103027"><code>SslReceive()</code></a>.  It may not even use the SSL protocol.  The mode values can be logically ORed together, and their values affect the functionality of the <code>SslOpen()</code> call.  If  non-fatal network errors occur (timeouts), the function can be re-called.  When the function finally returns <code>errNone</code>, the SSL handshake will have completed and any <code>SslContext</code> will be able to return a valid <code>SslSession</code> structure.  If one re-calls <code>SslOpen()</code>, make sure to not have either of <code>sslOpenModeClear</code> or <code>SslOpenModeSsl</code> set or the connection will be reset.</p>

<p><a name="1102919"> </a>Quite a few of the mode parameters set flags against the <code>SslContext</code>.   </p>
<h4>
  <a name="1102920"> </a>Returns 
</h4>

<p><a name="1102930"> </a><a href="SslLib.html#1102077"><code>SslClose()</code></a>, <a href="SslLib.html#1102349"><code>SslContextSetLong()</code></a>, <a href="SslLib.html#1102400"><code>SslContextSetPtr()</code></a></p>

<h3 class="hbH3">
  <a name="1102933"> </a>SslPeek Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102935"> </a>Purpose 
</h4>

<p><a name="1102936"> </a>Obtains a pointer into the buffered data that is located in the SslContext.</p>
<h4>
  <a name="1102937"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102938"> </a></code><h4>
  <a name="1102939"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102940"></a>Err SslPeek (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   void <code class="par">**buffer_ptr</code>,
   Int32 <code class="par">*availableBytes</code>,
   Int32 <code class="par">readSize</code>
)
</pre>
<h4>
  <a name="1102941"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102942"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102943"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1102950"> </a><code>&rarr;  <i>ctx</i></code></dt>
<dd><a name="1102951"> </a>The SslContext to operate on.</dd>

<dt><a name="1102952"> </a><code>&larr;  <i>buffer_ptr</i></code></dt>
<dd><a name="1102953"> </a>The location to place the data pointer.</dd>

<dt><a name="1102954"> </a><code>&larr;  <i>availableBytes</i></code></dt>
<dd><a name="1102955"> </a>The location to place the number of bytes available in <code>*</code><code class="par">buffer_ptr</code>.</dd>

<dt><a name="1102956"> </a><code>&rarr;  <i>readSize</i></code></dt>
<dd><a name="1102957"> </a>The maximum number of bytes to return.</dd>

</dl>
<h4>
  <a name="1102958"> </a>Returns 
</h4>

<p><a name="1102959"> </a>Returns <code>errNone</code> if the operation completed successfully. Otherwise, this function returns one of the error codes listed under <a href="SslLib.html#1101880">"SSL Library Errors."</a></p>
<h4>
  <a name="1102963"> </a>Comments 
</h4>

<p><a name="1102964"> </a>This function returns a pointer to available data bytes and assigns the number available to <code class="par">availableBytes</code>.  This function does not copy any data bytes from the <code>SslContext</code>, rather it returns a pointer into the buffered data that is located in the <code>SslContext</code>.  If there were no data bytes in the <code>SslContext</code>, data will be read from the network until there are data bytes available.  Repeated calls to <code>SslPeek()</code> will return the same <code class="par">buffer_ptr</code> value until a <a href="SslLib.html#1102133"><code>SslConsume()</code></a> call is done to indicate that bytes no longer need to be buffered. <code class="par">readSize</code> is the maximum number of available bytes that will be reported as being available. </p>

<p><a name="1102968"> </a>This is a more advanced function but is used internally, along with <code>SslConsume()</code>, to build the <a href="SslLib.html#1102985"><code>SslRead()</code></a> and <a href="SslLib.html#1103027"><code>SslReceive()</code></a> functions.  Its main use is for 'streaming' input data where the application does not need to allocate it's own data storage bufferes since it can read directly from the <code>SslContext</code> buffers.  Once a quantity of data is reported as availale in <code>*</code><code class="par">availableBytes</code>, the total will not increase until that number of bytes has been 'consumed'.</p>
<h4>
  <a name="1102975"> </a>See Also 
</h4>

<p><a name="1102982"> </a><a href="SslLib.html#1102133"><code>SslConsume()</code></a>, <a href="SslLib.html#1102985"><code>SslRead()</code></a></p>

<h3 class="hbH3">
  <a name="1102985"> </a>SslRead Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1102987"> </a>Purpose 
</h4>

<p><a name="1102988"> </a>Receives data.</p>
<h4>
  <a name="1102989"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1102990"> </a></code><h4>
  <a name="1102991"> </a>Prototype 
</h4>
<pre class="proto"><a name="1102992"></a>Int32 SslRead (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   void <code class="par">*buffer</code>,
   Int32 <code class="par">bufferLen</code>,
   Err <code class="par">*errRet</code>
)
</pre>
<h4>
  <a name="1102993"> </a>Parameters 
</h4>

<dl>
<dt><a name="1102994"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1102995"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1103002"> </a><code>&rarr;  <i>ctx</i></code></dt>
<dd><a name="1103003"> </a>The SslContext to read from.</dd>

<dt><a name="1103004"> </a><code>&larr;  <i>buffer</i></code></dt>
<dd><a name="1103005"> </a>Buffer into which read data will be placed.</dd>

<dt><a name="1103006"> </a><code>&rarr;  <i>bufferLen</i></code></dt>
<dd><a name="1103007"> </a>Size of buffer (max bytes read).</dd>

<dt><a name="1103008"> </a><code>&larr;  <i>errRet</i></code></dt>
<dd><a name="1103009"> </a>This will contain an error code if return is -1.</dd>

</dl>
<h4>
  <a name="1103010"> </a>Returns 
</h4>

<p><a name="1103011"> </a>Returns the number of bytes successfully received, or -1 if an error occurred.</p>
<h4>
  <a name="1103012"> </a>Comments 
</h4>

<p><a name="1103016"> </a>Performs the same functionality as <a href="SslLib.html#1103027"><code>SslReceive()</code></a>. This call will use the timeout set earlier against the <code>SslContext</code>. </p>
<h4>
  <a name="1103017"> </a>See Also 
</h4>

<p><a name="1103024"> </a><a href="SslLib.html#1103131"><code>SslWrite()</code></a>, <a href="SslLib.html#1103077"><code>SslSend()</code></a></p>

<h3 class="hbH3">
  <a name="1103027"> </a>SslReceive Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1103029"> </a>Purpose 
</h4>

<p><a name="1103030"> </a>Receives data.</p>
<h4>
  <a name="1103031"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1103032"> </a></code><h4>
  <a name="1103033"> </a>Prototype 
</h4>
<pre class="proto"><a name="1103034"></a>Int16 SslReceive (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   void <code class="par">*buffer</code>,
   UInt16 <code class="par">bufferLen</code>,
   UInt16 <code class="par">flags</code>,
   void <code class="par">*fromAddr</code>,
   UInt16 <code class="par">fromLen</code>,
   Int32 <code class="par">timeout</code>,
   Err <code class="par">*errRet</code>
)
</pre>
<h4>
  <a name="1103035"> </a>Parameters 
</h4>

<dl>
<dt><a name="1103036"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1103037"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1103044"> </a><code>&rarr;  <i>ctx</i></code></dt>
<dd><a name="1103045"> </a>The SslContext to use.</dd>

<dt><a name="1103046"> </a><code>&larr;  <i>buffer</i></code></dt>
<dd><a name="1103047"> </a>Buffer into which received data will be placed.</dd>

<dt><a name="1103048"> </a><code>&rarr;  <i>bufferLen</i></code></dt>
<dd><a name="1103049"> </a>Size of buffer (max bytes received).</dd>

<dt><a name="1103050"> </a><code>&rarr;  <i>flags</i></code></dt>
<dd><a name="1103054"> </a>One or more <code>netIOFlag...</code> flags. See the <a href="NetLibrary.html#1083561">Net Library</a> documentation.</dd>

<dt><a name="1103055"> </a><code>&larr;  <i>fromAddr</i></code></dt>
<dd><a name="1103056"> </a>Buffer to hold address of sender (NetSocketAddrType).</dd>

<dt><a name="1103057"> </a><code>&harr;  <i>fromLen</i></code></dt>
<dd><a name="1103058"> </a>Size of <code class="par">fromAddr</code> buffer.</dd>

<dt><a name="1103059"> </a><code>&rarr;  <i>timeout</i></code></dt>
<dd><a name="1103060"> </a>Max timeout in system ticks. -1 means wait forever.</dd>

<dt><a name="1103061"> </a><code>&larr;  <i>errRet</i></code></dt>
<dd><a name="1103062"> </a>This will contain an error code if return is -1.</dd>

</dl>
<h4>
  <a name="1103063"> </a>Returns 
</h4>

<p><a name="1103064"> </a>Returns the number of bytes successfully received, or -1 if an error occurred.</p>
<h4>
  <a name="1103065"> </a>Comments 
</h4>

<p><a name="1103066"> </a>The function returns either the number of bytes successfully received or -1. If -1, there was an error. In that case, an error code will be deposited at the address given by <code class="par">errRet</code>.</p>
<h4>
  <a name="1103067"> </a>See Also 
</h4>

<p><a name="1103074"> </a><a href="SslLib.html#1103077"><code>SslSend()</code></a>, <a href="NetLibrary.html#1086371"><code>NetLibReceive()</code></a></p>

<h3 class="hbH3">
  <a name="1103077"> </a>SslSend Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1103079"> </a>Purpose 
</h4>

<p><a name="1103080"> </a>Sends data over the network.</p>
<h4>
  <a name="1103081"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1103082"> </a></code><h4>
  <a name="1103083"> </a>Prototype 
</h4>
<pre class="proto"><a name="1103084"></a>Int16 SslSend (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   const void <code class="par">*buffer</code>,
   UInt16 <code class="par">bufferLen</code>,
   UInt16 <code class="par">flags</code>,
   void <code class="par">*toAddr</code>,
   UInt16 <code class="par">toLen</code>,
   Int32 <code class="par">timeout</code>,
   Err <code class="par">*errRet</code>
)
</pre>
<h4>
  <a name="1103085"> </a>Parameters 
</h4>

<dl>
<dt><a name="1103086"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1103087"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1103094"> </a><code>&rarr;  <i>ctx</i></code></dt>
<dd><a name="1103095"> </a>The SslContext to use.</dd>

<dt><a name="1103096"> </a><code>&rarr;  <i>buffer</i></code></dt>
<dd><a name="1103097"> </a>Buffer containing data to send.</dd>

<dt><a name="1103098"> </a><code>&rarr;  <i>bufferLen</i></code></dt>
<dd><a name="1103099"> </a>Length, in bytes, of data to send.</dd>

<dt><a name="1103100"> </a><code>&rarr;  <i>flags</i></code></dt>
<dd><a name="1103104"> </a>One or more <code>netIOFlag...</code> flags. See the <a href="NetLibrary.html#1083561">Net Library</a> documentation.</dd>

<dt><a name="1103105"> </a><code>&rarr;  <i>toAddr</i></code></dt>
<dd><a name="1103109"> </a>Address to send to. See the <a href="NetLibrary.html#1086663"><code>NetLibSend()</code></a> documentation.</dd>

<dt><a name="1103110"> </a><code>&rarr;  <i>toLen</i></code></dt>
<dd><a name="1103111"> </a>Size of <code class="par">toAddr</code> buffer</dd>

<dt><a name="1103112"> </a><code>&rarr;  <i>timeout</i></code></dt>
<dd><a name="1103113"> </a>Max timeout in system ticks. -1 means wait forever.</dd>

<dt><a name="1103114"> </a><code>&larr;  <i>errRet</i></code></dt>
<dd><a name="1103115"> </a>This will contain an error code if return is -1.</dd>

</dl>
<h4>
  <a name="1103116"> </a>Returns 
</h4>

<p><a name="1103117"> </a>Returns the number of bytes successfully sent, or -1 if an error occurred.</p>
<h4>
  <a name="1103118"> </a>Comments 
</h4>

<p><a name="1103119"> </a>This function mirrors the <code>NetLibSend()</code> function and has similar arguments and semantics.</p>

<p><a name="1103120"> </a>The function returns either the number of bytes successfully sent or -1. If -1, there was an error. In that case, an error code will be deposited at the address given by <code class="par">errRet</code>.  The other parameters are the same as for <code>NetLibSend()</code> and are used when the data bytes are written to the network.</p>
<h4>
  <a name="1103121"> </a>See Also 
</h4>

<p><a name="1103128"> </a><a href="SslLib.html#1103027"><code>SslReceive()</code></a>, <a href="NetLibrary.html#1086663"><code>NetLibSend()</code></a></p>

<h3 class="hbH3">
  <a name="1103131"> </a>SslWrite Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1103133"> </a>Purpose 
</h4>

<p><a name="1103134"> </a>Sends data over the network.</p>
<h4>
  <a name="1103135"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1103136"> </a></code><h4>
  <a name="1103137"> </a>Prototype 
</h4>
<pre class="proto"><a name="1103138"></a>Int32 SslWrite (
   UInt16 <code class="par">libRef</code>,
   SslContext <code class="par">*ctx</code>,
   const void <code class="par">*buffer</code>,
   Int32 <code class="par">bufferLen</code>,
   Err <code class="par">*errRet</code>
)
</pre>
<h4>
  <a name="1103139"> </a>Parameters 
</h4>

<dl>
<dt><a name="1103140"> </a><code>&rarr;  <i>libRef</i></code></dt>
<dd><a name="1103141"> </a>SSL library reference number, obtained from a call to either <a href="SystemManager.html#1076670"><code>SysLibFind()</code></a> or <a href="SystemManager.html#1076720"><code>SysLibLoad()</code></a>, depending on whether or not the SSL library is already loaded.</dd>

<dt><a name="1103148"> </a><code>&larr;  <i>ctx</i></code></dt>
<dd><a name="1103149"> </a>The SslContext to write to.</dd>

<dt><a name="1103150"> </a><code>&rarr;  <i>buffer</i></code></dt>
<dd><a name="1103151"> </a>Buffer containing data to write.</dd>

<dt><a name="1103152"> </a><code>&rarr;  <i>bufferLen</i></code></dt>
<dd><a name="1103153"> </a>Length, in bytes, of data to write.</dd>

<dt><a name="1103154"> </a><code>&larr;  <i>errRet</i></code></dt>
<dd><a name="1103155"> </a>This will contain an error code if return is -1.</dd>

</dl>
<h4>
  <a name="1103156"> </a>Returns 
</h4>

<p><a name="1103157"> </a>Returns the number of bytes successfully sent, or -1 if an error occurred.</p>
<h4>
  <a name="1103158"> </a>Comments 
</h4>

<p><a name="1103162"> </a>Performs the same functionality as <a href="SslLib.html#1103077"><code>SslSend()</code></a>. This call will use the timeout set earlier against the <code>SslContext</code>.</p>
<h4>
  <a name="1103163"> </a>See Also 
</h4>

<p><a name="1103170"> </a><a href="SslLib.html#1102985"><code>SslRead()</code></a>, <a href="SslLib.html#1103077"><code>SslSend()</code></a></p>

<h2 class="haH2">
  <a name="1103172"> </a>Application-Defined Functions <a href="#1100916"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1103175"> </a>SslCallbackFunc Function <a href="#1100916"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1103177"> </a>Purpose 
</h4>

<p><a name="1103178"> </a>A function that the application supplies to SslLib that will be called when specific situations occur during the SSL protocol.  The callbacks are specific to the particular SslContext or SslLib they are registered with.</p>
<h4>
  <a name="1103179"> </a>Declared In 
</h4>
<code>SslLib.h<a name="1103180"> </a></code><h4>
  <a name="1103181"> </a>Prototype 
</h4>
<pre class="proto"><a name="1103182"></a>Int32 (
   *SslCallbackFunc
) (
   SslCallback <code class="par">*cb</code>,
   Int32 <code class="par">command</code>,
   Int32 <code class="par">argi</code>,
   void <code class="par">*argv</code>
)
</pre>
<h4>
  <a name="1103183"> </a>Parameters 
</h4>

<dl>
<dt><a name="1103184"> </a><code>&rarr;  <i>cb</i></code></dt>
<dd><a name="1103188"> </a>The <a href="SslLib.html#1100964"><code>SslCallback</code></a> structure itself. </dd>

<dt><a name="1103189"> </a><code>&rarr;  <i>command</i></code></dt>
<dd><a name="1103190"> </a>A command which specifies the reason for the callback.  A single callback structure can be used to handle several different types of SslLib callbacks.  In this case, the function must have conditional logic to distinguish between the different commands.  The command is used to interpret the remaining two parameters, <code class="par">argi</code> and <code class="par">argv</code>. </dd>

<dt><a name="1103191"> </a><code>&rarr;  <i>argi</i></code></dt>
<dd><a name="1103192"> </a>A command-specific 32-bit integer, normally used to specify more information about the reason for the callback. </dd>

<dt><a name="1103193"> </a><code>&harr;  <i>argv</i></code></dt>
<dd><a name="1103194"> </a>Pointer to a value that is normally determined by the <code class="par">command</code> and/or the <code class="par">argi</code> arguments. </dd>

</dl>
<h4>
  <a name="1103195"> </a>Returns 
</h4>

<p><a name="1103196"> </a>Returns <code>errNone</code> if the callback command was process without error, or a command-specific error code value otherwise.</p>
<h4>
  <a name="1103197"> </a>Comments 
</h4>

<p><a name="1103201"> </a>An application will supply an <a href="SslLib.html#1100964"><code>SslCallback</code></a> structure to the SslLib library.  When SslLib needs to then invoke the callback, the callback function is called with four arguments.  </p>

<p><a name="1103202"> </a>When an <code>SslCallback</code> is passed into SslLib, a copy is taken of the structure.  This means that the structure passed in can be thought of as a template.  It is important to remember that the data field will be copied, so if the object this element points to must be destroyed, additional logic will be required.  When a SslContext is created, the SslCallback structures supplied to the SslLib are copied into the SslContext.  This could cause problems if not handled correctly if the data pointed to by the data field is dynamic memory.</p>

<p><a name="1103203"> </a>There are several general 'commands' that all callbacks should expect to receive; these commands are listed under <a href="SslLib.html#1101453">"SSL Callback Commands."</a> There are normally related to creation and destruction of the structure that holds the callback.  If the callback does need to perform any action due to these conditions, return 0.</p>
<h4>
  <a name="1103207"> </a>Example 
</h4>

<p><a name="1103208"> </a>If a callback returns a non-zero value, the SSL library will treat this as an error and return this value back out to the application.  This can be used to implement abort functionality.  While in the callback, any SslLib functions can be called to retrieve further information.  If an <code>sslCmdInfoAlert</code> command is being processed, <a href="SslLibMac.html#1141582"><code>SslContextGet_LastAlert()</code></a> can be called to retrieve the alert message that was received as shown here:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
alert=SslContextGet_LastAlert(theLibRef, cb-&gt;ssl);<a name="1103212"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103215"> </a>The alert values that can be returned are listed under <a href="SslLib.html#1101776">"SSL Server Alerts."</a></p>

<p><a name="1103217"> </a>There are two defined callbacks currently used by SslLib: "Info" and "Verify."</p>

<h4 class="hcH4">
  <a name="1103219"> </a>The Info Callback
</h4>

<p><a name="1103220"> </a>For the Info callback, the <code class="par">command</code> parameter is set to <code>sslCmdInfo</code>. The <code class="par">argi</code>, and <code class="par">argv</code> values passed are as follows:</p>


<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1103223"> </a><b>argi</b></p>
    </th>
    <th><p class="tt"><a name="1103225"> </a><b>argv type</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103227"> </a><code>sslArgInfoHandshake</code></p>
    </td>
    <td><p class="tt"><a name="1103229"> </a><code>NULL</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103231"> </a><code>sslArgInfoAlert</code></p>
    </td>
    <td><p class="tt"><a name="1103233"> </a><code>NULL</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103235"> </a><code>sslArgInfoReadBefore</code></p>
    </td>
    <td><p class="tt"><a name="1103240"> </a><a href="SslLib.html#1101123"><code>SslIoBuf</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103242"> </a><code>sslArgInfoReadAfter</code></p>
    </td>
    <td><p class="tt"><a name="1103247"> </a><a href="SslLib.html#1101123"><code>SslIoBuf</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103249"> </a><code>sslArgInfoWriteBefore</code></p>
    </td>
    <td><p class="tt"><a name="1103254"> </a><a href="SslLib.html#1101123"><code>SslIoBuf</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103256"> </a><code>sslArgInfoWriteAfter</code></p>
    </td>
    <td><p class="tt"><a name="1103261"> </a><a href="SslLib.html#1101123"><code>SslIoBuf</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103263"> </a><code>sslArgCert</code></p>
    </td>
    <td><p class="tt"><a name="1103265"> </a><code>SslExtendedItems - </code>the certificate sent by the server.</p>
    </td>
  </tr>
</table>

</div>


<p><a name="1103270"> </a>See <a href="SslLib.html#1101559">"Info Callbacks"</a> for more information on these <code class="par">argi</code> values.</p>

<p><a name="1103271"> </a>This wealth of information makes it possible for the application to receive notification of state changes in the SSL protocol, receive any SSL protocol alert messages, and track the I/O operation that the SSL protocol is performing.  This callback is primarily intended to aid in debugging applications or to provide visual feedback to the progress of the SSL protocol.</p>

<h4 class="hcH4">
  <a name="1103273"> </a>The Verify Callback
</h4>

<p><a name="1103274"> </a>For the Verify callback, the <code class="par">command</code> parameter is set to <code>sslCmdVerify</code>. The <code class="par">argi</code>, and <code class="par">argv</code> values passed are as follows:</p>


<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1103277"> </a><b>argi</b></p>
    </th>
    <th><p class="tt"><a name="1103279"> </a><b>argv type</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103281"> </a><code>sslErrVerifyBadSignature</code></p>
    </td>
    <td><p class="tt"><a name="1103283"> </a><code>SslVerify</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103285"> </a><code>sslErrVerifyNoTrustedRoot</code></p>
    </td>
    <td><p class="tt"><a name="1103287"> </a><code>SslVerify</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103289"> </a><code>sslErrVerifyNotAfter</code></p>
    </td>
    <td><p class="tt"><a name="1103291"> </a><code>SslVerify</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103293"> </a><code>sslErrVerifyNotBefore</code></p>
    </td>
    <td><p class="tt"><a name="1103295"> </a><code>SslVerify</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103297"> </a><code>sslErrVerifyConstraintViolation</code> </p>
    </td>
    <td><p class="tt"><a name="1103299"> </a><code>SslVerify</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103301"> </a><code>sslErrVerifyUnknownCriticalExtension</code> </p>
    </td>
    <td><p class="tt"><a name="1103303"> </a><code>SslVerify</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103305"> </a><code>0</code></p>
    </td>
    <td><p class="tt"><a name="1103307"> </a><code>SslVerify</code></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1103309"> </a>During the SSL handshake the server side sends a certificate to the client. This certificate contains the server's public key.  SslLib attempts to verify that the certificate is valid.  During this certificate verification process, if there are any errors, the Verify callback is called.</p>

<p><a name="1103310"> </a>The application can, through this callback, override any of the error conditions reported during verification.  If there is no Verify callback associated with an SslContext, any errors will immediately be returned to the application.</p>

<p><a name="1103311"> </a>The Verify callback will be called as each certificate in the certificate chain is verified with any error values encountered passed in <code class="par">argi</code> until the certificate is verified.  If the certificate verifies ok, the 0 value is passed.  This process is repeated for each certificate.  This means that even if the certificate chain verifies without an error, the callback will be called once for each certificate (with a 0 <code class="par">argi</code> value).  If an Info callback is also registered, it would be called once after the certificate chain has been verified with the server's certificate.  If there is no verification callback, and an error occurs, the application can 'clear' the error and re-call the relevant SslLib function.  The verification will proceed from where it was up to.</p>

<h5 class="hdH5">
  <a name="1103313"> </a>The SslVerify Structure
</h5>

<p><a name="1103314"> </a>The <code>SslVerify</code> structure is defined as follows:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
typedef struct SslVerify_st {
   SslExtendedItems *certificate;
   SslExtendedItems *fieldItems;   /* Problem field base */
   UInt32 field;                   /* Problem field */
   SslExtendedItems *ex;           /* Extension */
   UInt32 depth;                   /* Certificate depth */
   UInt32 state;                   /* Verification state */
} SslVerify;<a name="1103315"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103316"> </a><code>certificate</code> is a pointer to a structure containing the certificate currently being processed.  <code>fieldItems</code>  is a pointer to a structure that contains the data element that is currently causing a problem. <code>field</code> is the index into <code>fieldItems</code> of the erroneous data element. The <code>ex</code> field, if there is an error in extension processing, contains the data element that makes up the X509 extension that just failed. <code>depth</code> is the level of the certificate being processed, where 0 is the server's certificate, and higher numbers are certificates being used to chain to a trusted root certificate.</p>

<p><a name="1103317"> </a>The following #defines represent the possible values of the <code>state</code> field.  They indicate which section of the certificate verification failed. </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
#define sslVerifyFindParent 1
#define sslVerifySignature 2
#define sslVerifyNotBefore 3
#define sslVerifyNotAfterFindParent 4
#define sslVerifyExtensions 5
#define sslVerifyDone 6<a name="1103318"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103319"> </a><code>fieldItems</code> will not always be the same pointer as <code>certificate</code>.  This is especially true during extension errors.  If we have an error in an extension, and the extension has been "decomposed," the "decomposed" elements will be in the <code>ex</code> field.  The object identifier that identifies the extension "decomposed" in <code>ex</code> would be <code>verify-&gt;fieldItems.item[verify-&gt;field]</code>.</p>

<p><a name="1103320"> </a>The following table lists the elements identified by the <code>fieldItems</code> and <code>field</code> values for a given verification error.</p>


<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1103323"> </a><b>Verification Error</b></p>
    </th>
    <th><p class="tt"><a name="1103325"> </a><b><code>fieldItems[field]</code> contains...</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103327"> </a><code>sslErrCertBadSignature</code></p>
    </td>
    <td><p class="tt"><a name="1103329"> </a>The server's certificate, which contains the public key entries.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103331"> </a><code>SslErrCertNoTrustedRoot</code></p>
    </td>
    <td><p class="tt"><a name="1103333"> </a><code>NULL</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103335"> </a><code>SslErrCertNotAfter</code></p>
    </td>
    <td><p class="tt"><a name="1103337"> </a><code>sslExItemTypeX509</code>, <code>asn1FldX509NotAfter</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103339"> </a><code>SslErrCertNotBefore</code></p>
    </td>
    <td><p class="tt"><a name="1103341"> </a><code>sslExItemTypeX509</code>, <code>asn1FldX509NotBefore</code></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103343"> </a><code>sslErrCertConstraintViolation</code> </p>
    </td>
    <td><p class="tt"><a name="1103345"> </a><code>asn1ExItemTypeX509Ex</code> start location</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103347"> </a><code>sslErrCertUnknownCriticalExtension</code> </p>
    </td>
    <td><p class="tt"><a name="1103349"> </a><code>asn1ExItemTypeX509Ex</code> start location</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103351"> </a><code>SslErrOk</code></p>
    </td>
    <td><p class="tt"><a name="1103353"> </a><code>NULL</code></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1103355"> </a>For the cases of the returned field being the "<code>asn1ExItemTypeX509Ex</code> start location", an explanation is as follows:</p>

<p><a name="1103356"> </a>A certificate can have zero or more extensions.  These extensions specify extra information to be used during evaluation of a certificate.  Each extension consists of an "Object identifier," an optional Boolean "critical extension" flag, and the data bytes.  The <code>fieldItems-&gt;item[field]</code> values in this case points to the <code>SslExtendedItem</code> that contains the "Object identifier" for that extension. <code> field+1</code> will reference either the optional Boolean field that flags the extension as critical or the data bytes.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
SslVerify *verify;<a name="1103357"> </a>
SslExtendedItem *oid,*critical,*data;<a name="1103358"> </a>
<a name="1103359"> </a>
oid= &amp;(verify-&gt;fieldItems[verify-&gt;field]);<a name="1103360"> </a>
if (verify-&gt;fieldItems[verify-&gt;field+1].data_type ==
   asn1Boolean) {<a name="1103361"> </a>
   critical=(verify-&gt;fieldItems[verify-&gt;field+1]);<a name="1103362"> </a>
   data=(verify-&gt;fieldItems[verify-&gt;field+2]);<a name="1103363"> </a>
} else {<a name="1103364"> </a>
   critical=NULL;<a name="1103365"> </a>
   data= &amp;(verify-&gt;fieldItems[verify-&gt;field+1]);<a name="1103366"> </a>
}<a name="1103367"> </a>
/* The data bytes for the 'data' is located at<a name="1103368"> </a>
 * ((UInt8 *)verify-&gt;fieldItems)+data-&gt;offset;<a name="1103369"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103370"> </a>SslLib attempts to interpret only critical extensions, so the critical field should always be present.  If a critical extension is not understood, the certificate should be rejected.  These callback values allow the application to accept a certificate with critical extensions that the application SslLib does not understand.</p>

<p><a name="1103371"> </a>SslLib recognizes three extensions at this point in time, taken from the X.509 standard:</p>


<div class="tablediv"><table cellspacing="0" class="tTableNR">

  <tr valign="top">
    <td><p class="tt"><a name="1103374"> </a>2.5.29.15</p>
    </td>
    <td><p class="tt"><a name="1103376"> </a><code>KeyUsage</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103378"> </a>2.5.29.37</p>
    </td>
    <td><p class="tt"><a name="1103380"> </a><code>ExtKeyUsage</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103382"> </a>2.5.29.19</p>
    </td>
    <td><p class="tt"><a name="1103384"> </a><code>BasicConstraints</code></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1103386"> </a>If any of these constraints are flagged as critical, an error will not occur (assuming they are valid).</p>

<p><a name="1103387"> </a><code>BasicConstraints</code> is the only extension currently verified.  It specifies if a certificate can be used for signing other certificates.  If the certificate is being used incorrectly, an <code>sslErrCertConstraintViolation</code> error will be generated.  For this error, the <code>ex</code> field of the <code>SslVerify</code> structure will potentially contain</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
asn1ExItemTypeX509ExData, asn1FldX509ExBasicConstraintsCa<a name="1103388"> </a>
asn1ExItemTypeX509ExData, asn1FldX509ExBasicConstraintsPathLenConstraint<a name="1103389"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103390"> </a>Note that if these optional fields are not in the certificate, they will not be present in the <code>SslExtendedItems</code>.  The <code>PathLenConstraint</code> will also not contain any data bytes; rather,. the numeric value this field contains will be encoded in the <code>len</code> field of the <code>SslExtendedItem</code>.  If this was not the case, the application would have to learn all about decoding ASN.1 integers.  The depth field relates to this certificate. </p>

<p><a name="1103391"> </a>If this error occurs, the application should not override the error, due to its serious nature.</p>

<h5 class="hdH5">
  <a name="1103393"> </a>The SslExtendedItems Structure
</h5>

<p><a name="1103394"> </a>The <code>SslExtendedItems</code> structure is defined as follows:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
typedef struct SslExtendedItems_st {
   UInt32 length;
   UInt32 num;
   SslExtendedItem eitem[1];
} SslExtendedItems;<a name="1103395"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103396"> </a>The <code>SslExtendedItems</code> structure is used to hold a set of <code>SslExtendedItem</code> structures.  The <code>eitem</code> field, while defined as a size of one, is actually large enough to hold <code>num</code> entries.  The <code>length</code> field is the total size of the structure.  The structure can be copied by allocating <code>length</code> bytes and then copying <code>length</code> bytes from the <code>SslExtendedItems</code> pointer into the new location.  An <code>SslExtendedItems</code> structure is used to hold sets of related data elements.  A set of such values may contain a RSA public key, a certificate, and a certificate extension all in the same <code>SslExtendedItems</code> strucuture. </p>

<h5 class="hdH5">
  <a name="1103397"> </a>The SslExtendedItem Structure
</h5>

<p><a name="1103398"> </a>Each <code>SslExtendedItem</code> belongs to a type that is predefined for each of these objects.</p>

<p><a name="1103399"> </a>Currently defined values are:</p>


<div class="tablediv"><table cellspacing="0" class="tTableNR">

  <tr valign="top">
    <td><p class="tt"><a name="1103402"> </a><code>sslExItemTypeX509</code></p>
    </td>
    <td><p class="tt"><a name="1103404"> </a>X.509 Certificate.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103406"> </a><code>SslExItemTypeRSA</code></p>
    </td>
    <td><p class="tt"><a name="1103408"> </a>RSA public key.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103410"> </a><code>sslExItemTypeRDN</code></p>
    </td>
    <td><p class="tt"><a name="1103412"> </a>An X.509 Relative Distinguished Name (RDN).  This is a complex way of saying a certificate name.  Each certificate contains two names, the Subject of the certificate and the Issuer of the certificate.  Both are encoded as RDNs which contain multiple fields.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103414"> </a><code>sslExItemTypeX509Ex</code></p>
    </td>
    <td><p class="tt"><a name="1103416"> </a>X.509 certificates can contain what are called Extensions. A certificate can contain multiple extensions.  This type is used to specify extensions.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1103418"> </a><code>SslExItemTypeE509ExData</code></p>
    </td>
    <td><p class="tt"><a name="1103420"> </a>Used to group 'decomposed' X.509 extensions.</p>
    </td>
  </tr>
</table>

</div>


<p><a name="1103422"> </a>The <code>SslExtendedItem</code> structure is defined as follows:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
typedef struct SslExtendedItem_st {
   UInt16 type;
   UInt16 field;
   UInt16 dataType;
   UInt16 len;
   UInt32 offset;
} SslExtendedItem;<a name="1103423"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103424"> </a>An <code>SslExtendedItem</code> strucure is a single data element.  The <code>type</code> field values (as specified in the preceding table) are used to group related items.  A single <code>SslExtendedItems</code> structure can contain multiple <code>SslExtendedItem</code> structures with different <code>type</code> values.  In this way a single structure can contain elements referring to both a certificate and an RSA public key.</p>

<p><a name="1103425"> </a>The <code>field</code> field contains a type-specific value that is used to identify the <code>SslExtendedItem</code>.  The values for this field are defined specifically for each type.</p>

<p><a name="1103426"> </a>The <code>dataType</code> field specifies the encoding type of the data.  For the cases being used by SslLib, the value is the ASN.1 encoding type.  These values are defined in the <code>SslLibAsn1.h</code> header file.  They are relevant primarily if the application is attempting to display the data bytes.  </p>

<p><a name="1103427"> </a>The <code>len</code> field is the length of the data in the <code>SslExtendedItem</code> </p>

<p><a name="1103428"> </a>The <code>offset</code> field is the offset from the start of the parent <code>SslExtendedItems</code> to the data field.</p>

<p><a name="1103429"> </a>To access all the data bytes in an <code>SslExtendedItems</code> structure:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
SslExtendedItems *ei;<a name="1103430"> </a>
UInt16 i,j;<a name="1103431"> </a>
UInt8 *p;<a name="1103432"> </a>
<a name="1103433"> </a>
for (i=0; i&lt;ei-&gt;num; i++) {<a name="1103434"> </a>
   p=((UInt8 *)ei)+ei-&gt;eitem[i].offset;<a name="1103435"> </a>
<a name="1103436"> </a>
   for (j=0; j&lt;ei-&gt;eitem[i].len; j++)<a name="1103437"> </a>
      doSomething(p[j]);<a name="1103438"> </a>
}<a name="1103439"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103440"> </a>An <code>SslExtendedItems</code> structure will often contain multiple types.  When SslLib returns an <code>SslExtendedItems</code> structure for a certificate, it will usually contain the types <code>sslExItemTypeX509</code>, <code>sslExItemTypeRSA</code>, and <code>sslExItemTypeRDN</code> (for the subject name).</p>
<h4>
  <a name="1103441"> </a>Example 
</h4>

<p><a name="1103442"> </a>Following is an example of usage from the SslLib, for the 'information' callback:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Int32 info_callback(SslCallback *cb,Int32 command,<a name="1103443"> </a>
   Int32 argi,void *argv);<a name="1103444"> </a>
<a name="1103445"> </a>
SslCallback infoCB;<a name="1103446"> </a>
<a name="1103447"> </a>
infoCB.callback=info_callback;<a name="1103448"> </a>
SslContextSet_InfoCallback(theLibRef, ssl,&amp;infoCB);<a name="1103449"> </a>
SslContextSet_InfoInterest(theLibRef, ssl,<a name="1103450"> </a>
   sslFlgInfoAlert|<a name="1103451"> </a>
   sslFlgInfoHandshake|<a name="1103452"> </a>
   sslFlgInfoIo);<a name="1103453"> </a>
<a name="1103454"> </a>
/* We have now configured the SslContext so that<a name="1103455"> </a>
 * info_callback will be called when 'interesting' events<a name="1103456"> </a>
 * occur. */<a name="1103457"> </a>
<a name="1103458"> </a>
Int32 info_callback(SslCallback *cb,Int32 command,<a name="1103459"> </a>
   Int32 argi, void *argv)<a name="1103460"> </a>
   {<a name="1103461"> </a>
   UInt32 alert;<a name="1103462"> </a>
<a name="1103463"> </a>
   switch (command){<a name="1103464"> </a>
   case sslCmdInfo:<a name="1103465"> </a>
      /* We have received an 'info' call */<a name="1103466"> </a>
      switch (argi){<a name="1103467"> </a>
      case sslArgInfoHandshake:<a name="1103468"> </a>
         /* The SslContext is in the handshake stage<a name="1103469"> </a>
            of connection establishment. */<a name="1103470"> </a>
         break;<a name="1103471"> </a>
      case sslArgInfoAlert:<a name="1103472"> </a>
         /* An Alert message was received by the SslContext*/<a name="1103473"> </a>
         alert=SslContextGet_LastAlert(theLibRef, cb-&gt;ssl);<a name="1103474"> </a>
         break;<a name="1103475"> </a>
      case sslArgInfoReadBefore:<a name="1103476"> </a>
      case sslArgInfoReadAfter:<a name="1103477"> </a>
      case sslArgInfoWriteBefore:<a name="1103478"> </a>
      case sslArgInfoWriteAfter:<a name="1103479"> </a>
         /* The SslContext is doing network operations */<a name="1103480"> </a>
         break;<a name="1103481"> </a>
      }<a name="1103482"> </a>
      break;<a name="1103483"> </a>
   case sslCmdNew:   /* Called when we are 'copied in' */<a name="1103484"> </a>
   case sslCmdFree:   /* Called when we are 'finished' */<a name="1103485"> </a>
   case sslCmdReset:   /* Called instead of 'sslCmdNew' to
      reset the settings */<a name="1103486"> </a>
   case sslCmdSet:   /* Set a value */<a name="1103487"> </a>
   case sslCmdGet:   /* Get a value */<a name="1103488"> </a>
      break;<a name="1103489"> </a>
   }<a name="1103490"> </a>
   return(0);<a name="1103491"> </a>
}<a name="1103492"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1103493"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996-2004, PalmSource, Inc. and its affiliates.  All rights reserved. <br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="Reference_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="ReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SmsLib.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SslLibMac.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ReferenceIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>