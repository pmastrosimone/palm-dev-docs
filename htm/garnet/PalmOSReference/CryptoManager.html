<html>
<head>
<title>(68K) Cryptography Provider Manager | Palm OS&#174; Programmer's  API Reference</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 10:47:47">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="1057664"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="ReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="BtLibRef_Sockets.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SmsLib.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ReferenceIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">84 &nbsp;&nbsp;
Cryptography Provider Manager</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Palm OS&#174; Programmer's  API Reference</p>
<p class="SubTitle">Palm OS&#174; 68K SDK </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="PartIV.html">Part IV: Libraries</a> </h1>
<h1 class="SideTOC1"><a href="CryptoManager.html">84  Cryptography Provider Manager</a></h1>

   <h2 class="SideTOC2"><a href="#1057671">
   The Default Provider</a></h2>

   <h2 class="SideTOC2"><a href="#1057679">
   Fundamental CPM Functions</a></h2>

   <h2 class="SideTOC2"><a href="#1057712">
   Using the Crypto-Info Structures</a></h2>

   <h2 class="SideTOC2"><a href="#1057744">
   Using the Export Functions</a></h2>

   <h2 class="SideTOC2"><a href="#1057767">
   CPM and AP Constants</a></h2>

      <h3 class="SideTOC3"><a href="#1057769">
      AP Capability Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1057817">
      Block Encryption Mode Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1057874">
      Cipher Algorithm Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1057910">
      Export Encoding Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1057958">
      Hashing Algorithm Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1058021">
      Key Class Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1058051">
      Key Usage Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1058099">
      Plaintext Padding Constants</a></h3>

   <h2 class="SideTOC2"><a href="#1088183">
   CPM Error Codes</a></h2>

   <h2 class="SideTOC2"><a href="#1058140">
   CPM and AP Structures and Data Types</a></h2>

      <h3 class="SideTOC3"><a href="#1058143">
      APCipherInfoStruct</a></h3>

      <h3 class="SideTOC3"><a href="#1058215">
      APHashInfoStruct</a></h3>

      <h3 class="SideTOC3"><a href="#1058278">
      APKeyInfoStruct</a></h3>

      <h3 class="SideTOC3"><a href="#1058332">
      APProviderContextStruct</a></h3>

      <h3 class="SideTOC3"><a href="#1058366">
      APProviderInfoStruct</a></h3>

      <h3 class="SideTOC3"><a href="#1058411">
      APVerifyInfoStruct</a></h3>

      <h3 class="SideTOC3"><a href="#1058465">
      CPMInfoStruct</a></h3>

   <h2 class="SideTOC2"><a href="#1058494">
   CPM Functions</a></h2>

      <h3 class="SideTOC3"><a href="#1058497">
      CPMLibDecrypt</a></h3>

      <h3 class="SideTOC3"><a href="#1058549">
      CPMLibDecryptFinal</a></h3>

      <h3 class="SideTOC3"><a href="#1058603">
      CPMLibDecryptInit</a></h3>

      <h3 class="SideTOC3"><a href="#1058652">
      CPMLibDecryptUpdate</a></h3>

      <h3 class="SideTOC3"><a href="#1058687">
      CPMLibEncrypt</a></h3>

      <h3 class="SideTOC3"><a href="#1058750">
      CPMLibEncryptFinal</a></h3>

      <h3 class="SideTOC3"><a href="#1058818">
      CPMLibEncryptInit</a></h3>

      <h3 class="SideTOC3"><a href="#1058874">
      CPMLibEncryptUpdate</a></h3>

      <h3 class="SideTOC3"><a href="#1058909">
      CPMLibExportCipherInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1058952">
      CPMLibExportHashInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1058992">
      CPMLibExportKeyInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059032">
      CPMLibExportVerifyInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059072">
      CPMLibGenerateKey</a></h3>

      <h3 class="SideTOC3"><a href="#1059111">
      CPMLibGetInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059138">
      CPMLibGetProviderInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059160">
      CPMLibHash</a></h3>

      <h3 class="SideTOC3"><a href="#1059201">
      CPMLibHashFinal</a></h3>

      <h3 class="SideTOC3"><a href="#1059246">
      CPMLibHashInit</a></h3>

      <h3 class="SideTOC3"><a href="#1059280">
      CPMLibHashUpdate</a></h3>

      <h3 class="SideTOC3"><a href="#1059322">
      CPMLibImportCipherInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059354">
      CPMLibImportHashInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059386">
      CPMLibImportKeyInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059418">
      CPMLibImportVerifyInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059450">
      CPMLibReleaseCipherInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059476">
      CPMLibReleaseHashInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059502">
      CPMLibReleaseKeyInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059528">
      CPMLibReleaseVerifyInfo</a></h3>

      <h3 class="SideTOC3"><a href="#1059554">
      CPMLibVerify</a></h3>

      <h3 class="SideTOC3"><a href="#1059614">
      CPMLibVerifyFinal</a></h3>

      <h3 class="SideTOC3"><a href="#1059662">
      CPMLibVerifyInit</a></h3>

      <h3 class="SideTOC3"><a href="#1059713">
      CPMLibVerifyUpdate</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1057665"> </a>The Cryptography Provider Manager (CPM) is a shared library that acts as a framework for cryptographic services. These services are divided into two levels: </p>
<ul type="disc">
  <li><a name="1057666"> </a>At the application level, the CPM provides an API that any application can use to perform cryptographic operations.
  <li><a name="1057667"> </a>The operations themselves are not part of the CPM; instead, they're provided by an <b>algorithm provider</b> (or <b>AP</b>). To export its functionality to the CPM, an algorithm provider implements a set of callback functions. Third party developers can create and distribute their own APs. The Palm OS provides a default algorithm provider that's used in the absence of alternatives.
</ul>

<p><a name="1057668"> </a>The CPM provides the glue between an application and an AP. In general, this glue is invisible: You don't need to know anything about the APs that are available to use their cryptographic services. This makes it possible for an application to use common cryptographic operations without having to be overly concerned with the exact implementation of these operations. It also relieves the algorithm providers from the duty of providing their own invocation API. </p>

<div><hr>
  <a name="1057669"> </a> <b>NOTE: </b> In Palm OS Garnet, only the application level API is offered; the ability to create and install your own algorithm provider will be supported in a later release.
<hr>
</div>

<h2 class="haH2">
  <a name="1057671"> </a>The Default Provider <a href="#1057664"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1057672"> </a>In Palm OS Garnet, there is only one algorithm provider. Implemented by RSA, it provides three cryptographic services:</p>
<ul type="disc">
  <li><a name="1057673"> </a>Data encryption and decryption using an RC4 symmetric key stream cipher
  <li><a name="1057674"> </a>Message digest creation (hashing) using the SHA-1 algorithm.
  <li><a name="1057675"> </a>Message verification through a combination of the two other operations.
</ul>

<p><a name="1057676"> </a>All of the Palm OS Garnet cryptography operations are provided by RSA.</p>

<p><a name="1057677"> </a>One of the features of the CPM library is that the developer doesn't need to know anything about cryptography. The functions are designed such that the default settings will yield satisfying results. </p>

<h2 class="haH2">
  <a name="1057679"> </a>Fundamental CPM Functions <a href="#1057664"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1057680"> </a>The fundamental cryptography functions are:</p>
<ul type="disc">
  <li><a name="1057684"> </a><a href="CryptoManager.html#1058687"><code>CPMLibEncrypt()</code></a> performs a data encryption operation.
  <li><a name="1057688"> </a><a href="CryptoManager.html#1058497"><code>CPMLibDecrypt()</code></a> performs a data decryption operation.
  <li><a name="1057692"> </a><a href="CryptoManager.html#1059160"><code>CPMLibHash()</code></a> creates a message digest.
  <li><a name="1057696"> </a><a href="CryptoManager.html#1059554"><code>CPMLibVerify()</code></a> verifies a message that has a signature and certificate.
</ul>

<p><a name="1057697"> </a>These functions operate on blocks of data. For example, <a href="CryptoManager.html#1058687"><code>CPMLibEncrypt()</code></a> takes a block of data (and a key), encrypts it, and hands back the encrypted data all in one go.</p>

<p><a name="1057701"> </a>The CPM also provides sets of functions that let you perform these operations sequentially, allowing you to (for example) initialize an encryption "stream," iteratively feed data to the encryption algorithm, and then "finalize" the stream and get the encrypted data back. These functions are (for encryption) <a href="CryptoManager.html#1058818"><code>CPMLibEncryptInit()</code></a>, <a href="CryptoManager.html#1058874"><code>CPMLibEncryptUpdate()</code></a>, and <a href="CryptoManager.html#1058750"><code>CPMLibEncryptFinal()</code></a>.</p>

<h2 class="haH2">
  <a name="1057712"> </a>Using the Crypto-Info Structures <a href="#1057664"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1057713"> </a>The cryptography operations that are currently supported by the CPM library rely on four "crypto-info" data structures:</p>
<ul type="disc">
  <li><a name="1057717"> </a>The <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> describes a symmetric key, 
  <li><a name="1057721"> </a><a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> describes an encryption/decryption operation.
  <li><a name="1057725"> </a><a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> describes message digest creation.
  <li><a name="1057729"> </a><a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a> describes a message verification operation. 
</ul>

<p><a name="1057730"> </a>When you perform a cryptographic operation, you'll be asked for one or more of these structures. In most cases you can pass in an "empty" structure and the function will populate it for you. However, it's important that you zero the structure first.</p>

<p><a name="1057734"> </a>For example, the <a href="CryptoManager.html#1059160"><code>CPMLibHash()</code></a> function takes a <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> as an argument. To use the default hashing operations, simply allocate the structure, zero it, and pass it in:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
APHashInfoType hashinfo;<a name="1057738"> </a>
MemSet ((void *)&amp;hashinfo, sizeof (APHashInfoType), 0);<a name="1057739"> </a>
CPMLibHash( ..., &amp;hashInfo, ...);<a name="1057740"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1057741"> </a>When you're done with a crypto-info structure, you must "release" it:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
CPMLibReleaseHashInfo( ..., &amp;hashInfo );<a name="1057742"> </a>
</pre><div class="CodeRule"><hr></div>


<h2 class="haH2">
  <a name="1057744"> </a>Using the Export Functions <a href="#1057664"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1057745"> </a>The cryptography structures (key, hash, cipher, verification) can be "exported," or encoded into a form that can be cached. These operations are provided by the <code>CPMLibExport...Info</code> functions. Purposeful details of exporting (and importing, its functional complement) are given in the individual function descriptions, below. This little section touches on a wrinkle of usage.</p>

<p><a name="1057746"> </a>When you use an export function, you're asked to supply a buffer that can accommodate the encoded data. This means that you have to know how big the encoded data will be; the export function itself tells you the size through its final (reference) argument. Thus, you have to call the export function twice: Once to get the buffer size, and then again to actually get the encoded data. This is demonstrated below:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
UInt32 length=0;<a name="1057747"> </a>
UInt8 *data=NULL;<a name="1057748"> </a>
Err error;<a name="1057749"> </a>
<a name="1057750"> </a>
/* For demo purposes, we're only interested in the last two
 * arguments (the buffer and the buffer length). First, we
 * set the buffer to NULL, and retrieve the length.
 */<a name="1057751"> </a>
error = CPMLibExport... (... NULL, &amp;length);<a name="1057752"> </a>
<a name="1057753"> </a>
/* At this pass, we expect the function to tell us that 
 * the buffer is too small. Any other return is treated 
 * as an error. Note that the &lt;length&gt; argument is reset to
 * to the required allocation length despite the error
 * return.
 */<a name="1057754"> </a>
if (error != cpmErrBufTooSmall)<a name="1057755"> </a>
  return ...; // or whatever<a name="1057756"> </a>
<a name="1057757"> </a>
/* Allocate the buffer (for brevity, the example omits 
 * the error check). 
 */
data = MemPtrNew(length);<a name="1057758"> </a>
<a name="1057759"> </a>
/* Call the export function again to retrieve the 
 * <span style="color: #000000;  font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">encoded</span> data.
 */
error = CPMLibExport... ( ... data, &amp;length);<a name="1057760"> </a>
<a name="1057761"> </a>
/* This time we want a 'clean' return. */<a name="1057762"> </a>
if (error != errNone) {<a name="1057763"> </a>
  // handle the error<a name="1057764"> </a>
}<a name="1057765"> </a>
</pre><div class="CodeRule"><hr></div>


<h2 class="haH2">
  <a name="1057767"> </a>CPM and AP Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1057769"> </a>AP Capability Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1057770"> </a>The AP capability values are bitfield constants that represent the capabilities that an AP supports. The capability constants are <code>OR</code>'d into the <code>flags</code> field of the <a href="CryptoManager.html#1058366"><code>APProviderInfoStruct</code></a> structure.</p>

<p><a name="1057774"> </a>Declared in <code>CPMLibCommon.h</code>, the constants are: </p>

<dl>
<dt><a name="1057777"> </a><code>APF_MP </code></dt>
<dd><a name="1057779"> </a>Streaming operations (initialize/update/finalize) are supported ("MP" stands for "multiple part"). See <a href="CryptoManager.html#1057679">"Fundamental CPM Functions"</a> for details. Note that all APs are expected to support block operations.</dd>

<dt><a name="1057784"> </a><code>APF_HW</code></dt>
<dd><a name="1057786"> </a>The AP's algorithms are implemented in hardware (such as a SmartCard).</dd>

<dt><a name="1057788"> </a><code>APF_KEYGEN</code></dt>
<dd><a name="1057790"> </a>Symmetric key operations (including key info import and export) are supported.</dd>

<dt><a name="1057792"> </a><code>APF_KEYPAIRGEN</code></dt>
<dd><a name="1057794"> </a>Asymmetric key operations (including key info import and export) are supported.</dd>

<dt><a name="1057796"> </a><code>APF_KEYDERIVE</code></dt>
<dd><a name="1057798"> </a>Key derivation is supported.</dd>

<dt><a name="1057800"> </a><code>APF_HASH</code></dt>
<dd><a name="1057802"> </a>Hashing operations (including hash info import and export) are supported.</dd>

<dt><a name="1057804"> </a><code>APF_CIPHER</code></dt>
<dd><a name="1057806"> </a>Message encryption and decryption operations (including cipher info import and export) are supported.</dd>

<dt><a name="1057808"> </a><code>APF_SIGN</code></dt>
<dd><a name="1057810"> </a>Message signing operations (including sign info import and export) are supported.</dd>

<dt><a name="1057812"> </a><code>APF_VERIFY</code></dt>
<dd><a name="1057814"> </a>Message verification operations (including verify info import and export) are supported.</dd>

</dl>

<h3 class="hbH3">
  <a name="1057817"> </a>Block Encryption Mode Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1057818"> </a>Purpose 
</h4>

<p><a name="1057819"> </a>The constants listed below represent the various block encryption modes that may be supported by an AP. You can request a particular mode by setting the <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> <code>mode</code> field before passing the structure to the <a href="CryptoManager.html#1058687"><code>CPMLibEncrypt()</code></a> or <a href="CryptoManager.html#1058497"><code>CPMLibDecrypt()</code></a> function. If you don't specify a mode, the AP will choose one for you, and reset the <code>mode</code> field to the chosen mode.</p>

<p><a name="1057830"> </a>The <code>APModeEnum</code> data type is used to type the encryption mode constants.</p>
<h4>
  <a name="1057831"> </a>Prototype 
</h4>
<pre class="proto"><a name="1057833"></a>typedef UInt32 APModeEnum;
</pre>

<p><a name="1057834"> </a>Note that encryption modes apply to block operations only. Specifying a mode for a stream encryption (through <a href="CryptoManager.html#1058818"><code>CPMLibEncryptInit()</code></a> <span style="color: #000000;  font-style: italic; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">et al.</span>) has no effect.</p>

<p><a name="1057838"> </a>The constants (and the type) are declared in CPMLibConstants.h. The constants are: </p>
<h4>
  <a name="1075311"> </a>Constants 
</h4>

<dl>
<dt><a name="1057841"> </a><code><code>apModeTypeUnspecified = 0</code></code></dt>
<dd><a name="1057843"> </a>The mode isn't specified; the AP uses its default mode.</dd>

<dt><a name="1057845"> </a><code><code>apModeTypeNone</code></code></dt>
<dd><a name="1057847"> </a>The encryption mode doesn't apply.</dd>

<dt><a name="1057849"> </a><code><code>apModeTypeECB</code></code></dt>
<dd><a name="1057851"> </a>Electronic codebook mode.</dd>

<dt><a name="1057853"> </a><code><code>apModeTypeCBC</code></code></dt>
<dd><a name="1057855"> </a>Cipher block chaining mode.</dd>

<dt><a name="1057857"> </a><code><code>apModeTypeCBC_CTS</code></code></dt>
<dd><a name="1057859"> </a>Cipher block chaining with cipher text stealing.</dd>

<dt><a name="1057861"> </a><code><code>apModeTypeCFB</code></code></dt>
<dd><a name="1057863"> </a>Cipher feedback mode.</dd>

<dt><a name="1057865"> </a><code><code>apModeTypeOFB</code></code></dt>
<dd><a name="1057867"> </a>Output feedback mode.</dd>

<dt><a name="1057869"> </a><code><code>apModeCounter</code></code></dt>
<dd><a name="1057871"> </a>Counter mode</dd>

</dl>

<h3 class="hbH3">
  <a name="1057874"> </a>Cipher Algorithm Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1057875"> </a>Purpose 
</h4>

<p><a name="1057876"> </a>These constants represent the different cipher algorithms that an AP may support. The algorithm type is encoded in the <code>type</code> field of the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> structure. You can request a specific algorithm by setting the value of the <code>type</code> field before passing the structure to <a href="CryptoManager.html#1059072"><code>CPMLibGenerateKey()</code></a>. If you don't care, leave the field zero'd (<code>apAlgorithmTypeUnspecified</code>); the function will set the field to tell you which algorithm was used.</p>

<p><a name="1057886"> </a>In the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> structure, the constants are typed as <code>APAlgorithmEnum</code>:</p>
<h4>
  <a name="1057888"> </a>Prototype 
</h4>
<pre class="proto"><a name="1057890"></a>typedef UInt32 APAlgorithmEnum;
</pre>

<p><a name="1057891"> </a>The constants (and the type) are defined in <code>CPMLibCommon.h</code>. There we see the usual "unspecified" constant: </p>

<dl>
<dt><a name="1057894"> </a><code>apAlgorithmTypeUnspecified = 0</code></dt>
<dd><a name="1057896"> </a>No algorithm specified; the AP will use its default.</dd>

</dl>

<p><a name="1057898"> </a>The rest of the constants are divided into groups, below, and listed with very little additional explanation: The constants' names are reasonably self-documenting.</p>

<h4 class="hcH4">
  <a name="1057899"> </a>Block Cipher Algorithms
</h4>

<p><a name="1057900"> </a><code>apSymmetricTypeDES<br>apSymmetricTypeRC2<br>apSymmetricTypeRC4<br>apSymmetricTypeRC5<br>apSymmetricTypeRC6</code>,<code> <br>apSymmetricTypeDESX_XDX3</code> ("Strong" DES)<code> apSymmetricType3DES_EDE2<br>apSymmetricType3DES_EDE3<br>apSymmetricTypeIDEA<br>apSymmetricTypeDiamond2<br>apSymmetricTypeBlowfish<br>apSymmetricTypeTEA</code> (Tiny Encryption Algorithm),<code> apSymmetricTypeSAFER</code> (Safe and Fast Encryption Routine),<code> apSymmetricType3WAY<br>apSymmetricTypeGOST</code> (USSR Government Standard),<br><code>apSymmetricTypeSHARK<br>apSymmetricTypeCAST128</code>,<code> apSymmetricTypeSquare</code>,<br><code>apSymmetricTypeSkipjack</code></p>

<h4 class="hcH4">
  <a name="1057901"> </a>Stream Ciphers
</h4>

<p><a name="1057902"> </a><code>apSymmetricTypePanama</code>,<code> apSymmetricTypeARC4</code>,<br><code>apSymmetricTypeSEAL</code>,<code> apSymmetricTypeWAKE</code>,<br><code>apSymmetricTypeSapphire</code>,<code> apSymmetricTypeBBS</code></p>

<h4 class="hcH4">
  <a name="1057903"> </a>AES Block Ciphers
</h4>

<p><a name="1057904"> </a><code>apSymmetricTypeRijndael</code>,<code> apSymmetricTypeCAST256</code>,<br><code>apSymmetricTypeTwofish</code>,<code> apSymmetricTypeMARS</code>,<br><code>apSymmetricTypeSerpent</code></p>

<h4 class="hcH4">
  <a name="1057905"> </a>Asymmetric Key Ciphers
</h4>

<p><a name="1057906"> </a><code>apAsymmetricTypeRSA</code>,<code> apAsymmetricTypeDSA</code>,<br><code>apAsymmetricTypeElgamal</code>,<code> <br>apAsymmetricTypeNR</code> (Nyberg-Rueppel),<br><code>apAsymmetricTypeBlumGoldwasser</code>,<br><code>apAsymmetricTypeRabin</code>,<code> <br>apAsymmetricTypeRW</code> (Rabin-Williams),<br><code>apAsymmetricTypeLUC</code>,<code> apAsymmetricTypeLUCELG</code>,<br><code>apAsymmetricTypeECDSA</code>,<code> apAsymmetricTypeECNR</code>,<br><code>apAsymmetricTypeECIES</code>,<code> apAsymmetricTypeECDHC</code>,<br><code>apAsymmetricTypeECMQVC</code></p>

<h4 class="hcH4">
  <a name="1057907"> </a>Key Agreement Ciphers
</h4>

<p><a name="1057908"> </a><code>apKeyAgreementTypeDH</code> (Diffie-Hellman),<br><code>apKeyAgreementTypeDH2</code> (Unified Diffie-Hellman),<br><code>apKeyAgreementTypeMQV (</code>Menezes-Qu-Vanstone),<br><code>apKeyAgreementTypeLUCDIF</code>,<code> apKeyAgreementTypeXTRDH</code></p>

<h3 class="hbH3">
  <a name="1057910"> </a>Export Encoding Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1057911"> </a>Constants that represent different data encoding schemes that are used to convert the crypto-info structs (<a href="CryptoManager.html#1058278">APKeyInfoStruct</a>, <a href="CryptoManager.html#1058215">APHashInfoStruct</a>, et al.) into a form that can be cached.</p>

<p><a name="1057918"> </a>The encoding formats are used by the import and export functions, <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>, <a href="CryptoManager.html#1058992"><code>CPMLibExportKeyInfo()</code></a>, <a href="CryptoManager.html#1059354"><code>CPMLibImportHashInfo()</code></a>, <a href="CryptoManager.html#1058952"><code>CPMLibExportHashInfo()</code></a>, <a href="CryptoManager.html#1059418"><code>CPMLibImportVerifyInfo()</code></a>, <a href="CryptoManager.html#1059032"><code>CPMLibExportVerifyInfo()</code></a>, <a href="CryptoManager.html#1059322"><code>CPMLibImportCipherInfo()</code></a>, and <a href="CryptoManager.html#1058909"><code>CPMLibExportCipherInfo()</code></a>.</p>

<p><a name="1057956"> </a>Declared in <code>CPMLibCommon.h</code>, the constants are:</p>

<dl>
<dt><a name="1057945"> </a><code>IMPORT_EXPORT_TYPE_RAW</code></dt>
<dd><a name="1057947"> </a>The default encoding, as defined by the AP.</dd>

<dt><a name="1057949"> </a><code>IMPORT_EXPORT_TYPE_DER</code></dt>
<dd><a name="1057951"> </a>ASN.1 DER encoding.</dd>

<dt><a name="1057953"> </a><code>IMPORT_EXPORT_TYPE_XML</code></dt>
<dd><a name="1057955"> </a>Standardized XML encoding.</dd>

</dl>

<h3 class="hbH3">
  <a name="1057958"> </a>Hashing Algorithm Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1057959"> </a>The hashing constants represent various hashing algorithms. If you want to tell the AP to use a specific algorithm in a hashing operation, you would pass one of these constants as an argument to <a href="CryptoManager.html#1059160"><code>CPMLibHash()</code></a> or <a href="CryptoManager.html#1059246"><code>CPMLibHashInit()</code></a>. If you want the default, use <code>apHashTypeUnspecified</code>, The algorithm that's actually used is returned through a <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> structure.</p>

<p><a name="1057969"> </a>Declared in <code>CPMLibCommon.h</code>, the constants are: </p>

<dl>
<dt><a name="1057972"> </a><code>apHashTypeUnspecified = 0</code></dt>
<dd><a name="1057974"> </a>Unspecified hash algorithm; when generating a message digest, the AP decides which algorithm to use.</dd>

<dt><a name="1057976"> </a><code>apHashTypeNone</code></dt>
<dd><a name="1057978"> </a>Don't hash. Use this constant if you want the AP to suppress hashing in an operation, such as verification, that normally performs it</dd>

<dt><a name="1057980"> </a><code>apHashTypeMD2</code></dt>
<dd><a name="1057982"> </a>Rivest Message Digest 2 (MD2)</dd>

<dt><a name="1057984"> </a><code>apHashTypeMD5</code></dt>
<dd><a name="1057986"> </a>Rivest Message Digest 5 (MD5)</dd>

<dt><a name="1057988"> </a><code>apHashTypeSHA1</code></dt>
<dd><a name="1057990"> </a>Secure Hash Algorithm-160 (SHA-1)</dd>

<dt><a name="1057992"> </a><code>apHashTypeSHA256</code></dt>
<dd><a name="1057994"> </a>SHA 256-bit algorithm</dd>

<dt><a name="1057996"> </a><code>apHashTypeSHA384</code></dt>
<dd><a name="1057998"> </a>SHA 384-bit algorithm</dd>

<dt><a name="1058000"> </a><code>apHashTypeSHA512</code></dt>
<dd><a name="1058002"> </a>SHA 512-bit algorithm</dd>

<dt><a name="1058004"> </a><code>apHashTypeHAVAL</code></dt>
<dd><a name="1058006"> </a>HAVAL one-way algorithm</dd>

<dt><a name="1058008"> </a><code>apHashTypeRIPEMD160 </code></dt>
<dd><a name="1058010"> </a>RIPEMD 160-bit</dd>

<dt><a name="1058012"> </a><code>apHashTypeTiger</code></dt>
<dd><a name="1058014"> </a>Tiger algorithm</dd>

<dt><a name="1058016"> </a><code>apHashTypePanama</code></dt>
<dd><a name="1058018"> </a>PANAMA algorithm</dd>

</dl>

<h3 class="hbH3">
  <a name="1058021"> </a>Key Class Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058022"> </a>Purpose 
</h4>

<p><a name="1058023"> </a>A key's "class" specifies whether the key is symmetric or asymmetric and, if the latter, whether it's public or private. The key class constants represent these qualities. Key class is encoded in the <code>keyclass</code> field of the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> structure.</p>

<p><a name="1058027"> </a>In the struct, the constants are typed as <code>APKeyClassEnum</code>:</p>
<h4>
  <a name="1058028"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058030"></a>typedef UInt32 APKeyClassEnum;
</pre>

<p><a name="1058031"> </a>The constants (and the type) are defined in <code>CPMLibCommon.h</code>. The constants are: </p>
<h4>
  <a name="1075348"> </a>Constants 
</h4>

<dl>
<dt><a name="1058034"> </a><code><code>apKeyClassUnspecified = 0</code></code></dt>
<dd><a name="1058036"> </a>The key's class is unspecified.</dd>

<dt><a name="1058038"> </a><code><code>apKeyClassSymmetric</code></code></dt>
<dd><a name="1058040"> </a>This is a symmetric key.</dd>

<dt><a name="1058042"> </a><code><code>apKeyClassPublic</code></code></dt>
<dd><a name="1058044"> </a>This is the public part of an asymmetric key.</dd>

<dt><a name="1058046"> </a><code><code>apKeyClassPrivate</code></code></dt>
<dd><a name="1058048"> </a>This is the private part of an asymmetric key.</dd>

</dl>

<h3 class="hbH3">
  <a name="1058051"> </a>Key Usage Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058052"> </a>Purpose 
</h4>

<div><hr>
  <a name="1058053"> </a> <b>NOTE: </b> The key usage constants are currently unused. 
<hr>
</div>

<p><a name="1058054"> </a>The key usage constants describe the different ways that an encryption key can be used. How a key is used is encoded in the <code>usage</code> field of the key's <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> structure. </p>

<p><a name="1058058"> </a>Note that the key usage values are mutually exclusive; you can't OR a set of key usage constants to create a "selectively talented" key. The <code>apKeyUsageAll</code> constant is the only "multi-purpose" value currently provided.</p>

<p><a name="1058060"> </a>The <code>APKeyUsageEnum</code> data type is used to type the key usage constants:</p>
<h4>
  <a name="1058061"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058062"></a>typedef UInt32 APKeyUsageEnum;
</pre>

<p><a name="1058063"> </a>The constants (and the type) are defined in <code>CPMLibConstants.h</code>. The constants are:</p>
<h4>
  <a name="1076736"> </a>Constants 
</h4>

<dl>
<dt><a name="1058066"> </a><code><code>apKeyUsageUnspecified = 0</code></code></dt>
<dd><a name="1058068"> </a>The key's usage is unspecified.</dd>

<dt><a name="1058070"> </a><code><code>apKeyUsageAll </code></code></dt>
<dd><a name="1058072"> </a>The key can be used in any operation.</dd>

<dt><a name="1058074"> </a><code><code>apKeyUsageCertificateSigning</code></code></dt>
<dd><a name="1058076"> </a>The key is intended for certificate signing.</dd>

<dt><a name="1058078"> </a><code><code>apKeyUsageSigning</code></code></dt>
<dd><a name="1058080"> </a>The key is intended for message signing operations.</dd>

<dt><a name="1058082"> </a><code><code>apKeyUsageEncryption</code></code></dt>
<dd><a name="1058084"> </a>The key is intended for key or data encryption operations.</dd>

<dt><a name="1058086"> </a><code><code>apKeyUsageKeyEncrypting</code></code></dt>
<dd><a name="1058088"> </a>The key is intended for key encryption operations</dd>

<dt><a name="1058090"> </a><code><code>apKeyUsageDataEncrypting</code></code></dt>
<dd><a name="1058092"> </a>The key is intended for data encryption operations.</dd>

<dt><a name="1058094"> </a><code><code>apKeyUsageMessageIntegrity</code></code></dt>
<dd><a name="1058096"> </a>The key is intended for message verification operations.</dd>

</dl>

<h3 class="hbH3">
  <a name="1058099"> </a>Plaintext Padding Constants <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058100"> </a>Purpose 
</h4>

<p><a name="1058101"> </a>The plaintext padding constants describe the different ways that plaintext is padded before it's encrypted. The padding type is encoded in the <code>padding</code> field of an <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> structure. </p>

<p><a name="1058106"> </a>The <code>APPaddingEnum</code> data type is used to type the padding constants:</p>
<h4>
  <a name="1058107"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058108"></a>typedef UInt32 APPaddingEnum;
</pre>

<p><a name="1058109"> </a>The constants (and the type) are declared in <code>CPMLibCommon.h</code>. The constants are: </p>
<h4>
  <a name="1079792"> </a>Constants 
</h4>

<dl>
<dt><a name="1058112"> </a><code><code>apPaddingTypeUnspecified = 0</code></code></dt>
<dd><a name="1058114"> </a>The padding is unspecified; the AP will use the default</dd>

<dt><a name="1058116"> </a><code><code>apPaddingTypeNone </code></code></dt>
<dd><a name="1058118"> </a>Specifically request that padding <span style="color: #000000;  font-style: italic; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">not</span> be applied.</dd>

<dt><a name="1058120"> </a><code><code>apPaddingTypePKCS1Type1</code></code></dt>
<dd><a name="1058122"> </a>Public Key Cryptography Standard 1, type 1</dd>

<dt><a name="1058124"> </a><code><code>apPaddingTypePKCS1Type2</code></code></dt>
<dd><a name="1058126"> </a>Public Key Cryptography Standard 1, type 2</dd>

<dt><a name="1058128"> </a><code><code>apPaddingTypePKCS5</code></code></dt>
<dd><a name="1058130"> </a>Public Key Cryptography Standard 5</dd>

<dt><a name="1058132"> </a><code><code>apPaddingTypeOAEP</code></code></dt>
<dd><a name="1058134"> </a>Optimal Asymmetric Encryption Padding</dd>

<dt><a name="1058136"> </a><code><code>apPaddingTypeSSLv23</code></code></dt>
<dd><a name="1058138"> </a>Secure Sockets Layer version 23</dd>

</dl>

<h2 class="haH2">
  <a name="1088183"> </a>CPM Error Codes <a href="#1057664"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1088184"> </a>The table below lists and explains the error codes that are returned by the CPM functions.</p>

<dl>
<dt><a name="1088185"> </a><code><code>cpmErrAlreadyOpen</code></code></dt>
<dd><a name="1088186"> </a>Returned by CPMLibOpen() to indicate that the CPM library has already been opened by your application. The open library remains open.</dd>

<dt><a name="1088187"> </a><code><code>cpmErrNotOpen</code></code></dt>
<dd><a name="1088188"> </a>All CPM functions (except CPMLibOpen()) expect the CPM library to be open. This code is returned if the library isn't open. To open the library, call CPMLibOpen().</dd>

<dt><a name="1088189"> </a><code><code>cpmErrStillOpen</code></code></dt>
<dd><a name="1088190"> </a>Returned by CPMLibClose() if the function was unable to close the library. </dd>

<dt><a name="1088191"> </a><code><code>cpmErrNoProviders</code></code></dt>
<dd><a name="1088192"> </a>Returned by CPMLibOpen() if the function was uable to locate (or load) any crytography providers. Without a cryptography provider, none of the other CPM functions will work.</dd>

<dt><a name="1088193"> </a><code><code>cpmErrNoBaseProvider</code></code></dt>
<dd><a name="1088194"> </a>Returned by CPMLibOpen() if the function was uable to locate (or load) the default cryptography provider. (Note that this means that at least one non-default provider was found. If no providers were found, the function would have returned cpmErrNoProviders).</dd>

<dt><a name="1088195"> </a><code><code>cpmErrProviderNotFound</code></code></dt>
<dd><a name="1088196"> </a>Returned by CPMLibGenerateKey(), CPMLibEncryt(), CPMLibDecrypt() and other algorithm-dependent functions if the requested provider couldn't be found.</dd>

<dt><a name="1088197"> </a><code><code>cpmErrParamErr</code></code></dt>
<dd><a name="1088198"> </a>Returned by a number of CPM functions when an argument is invalid (a pointer that points to an unallocated structure; a structure field that isn't properly set, and so on).</dd>

<dt><a name="1088199"> </a><code><code>cpmErrOutOfMemory</code></code></dt>
<dd><a name="1088200"> </a>Returned by CPMLibOpen() if the memory for a new library handle (and the structures it represents) couldn't be allocated</dd>

<dt><a name="1088201"> </a><code><code>cpmErrBufTooSmall</code></code></dt>
<dd><a name="1088202"> </a>Returned by CPMLibExportKey() and CPMLibExportContext() functions if the storage buffer (allocated by the caller) isn't big enough to accommodate the key or context.</dd>

<dt><a name="1088203"> </a><code><code>cpmErrBadData</code></code></dt>
<dd><a name="1088204"> </a>Returned by algorithm functions (CPMLibEncrypt...(), CPMLibDecrypt...(), etc.) when the key or other required data is invalid.</dd>

<dt><a name="1088205"> </a><code><code>cpmErrUnimplemented</code></code></dt>
<dd><a name="1088206"> </a>Returned by functions that aren't curently implemented.</dd>

<dt><a name="1088207"> </a><code><code>cpmErrUnsupported</code></code></dt>
<dd><a name="1088208"> </a>Returned by functions that aren't currently supported.</dd>

<dt><a name="1088209"> </a><code><code>cpmErrNoGlobals</code></code></dt>
<dd><a name="1088210"> </a>Returned by functions that access global CPM data&#8212;functions such as CPMLibEnumerateProviders() and CPMLibGetProviderInfo()&#8212;when that data doesn't exist.</dd>

<dt><a name="1088211"> </a><code><code>cpmErrKeyExists</code></code></dt>
<dd><a name="1088212"> </a>Returned by CPMLibImportKey() when the key you're trying to import already exists.</dd>

<dt><a name="1088213"> </a><code><code>cpmErrKeyNotFound</code></code></dt>
<dd><a name="1088214"> </a>Returned by CPMLibExportKey() when the key you're trying to export doesn't exists.</dd>

</dl>

<h2 class="haH2">
  <a name="1058140"> </a>CPM and AP Structures and Data Types <a href="#1057664"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1058143"> </a>APCipherInfoStruct Struct <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058145"> </a>Purpose 
</h4>

<p><a name="1058146"> </a>The <code>APCipherInfoStruct</code> encapsulates information about an instance of a data encryption or decryption operation. The structure is populated and returned by the data encryption and decryption functions (<a href="CryptoManager.html#1058687"><code>CPMLibEncrypt()</code></a>, <a href="CryptoManager.html#1058497"><code>CPMLibDecrypt()</code></a>, <a href="CryptoManager.html#1058818"><code>CPMLibEncryptInit()</code></a>, and <a href="CryptoManager.html#1058603"><code>CPMLibDecryptInit()</code></a>). You can set some of the fields' values yourself (before calling an encryption/decryption function) to fine-tune the impending operation. </p>

<p><a name="1058159"> </a>You're responsible for allocating and freeing the <code>APCipherInfoStruct</code>s that you need&#8212;the CPM never allocates them for you. The <code>APCipherInfoStruct</code>s that you create (and actually use) must be released through <a href="CryptoManager.html#1059450"><code>CPMLibReleaseCipherInfo()</code></a> before they're freed.</p>

<p><a name="1058163"> </a>For more information (including examples) on how to use a crypto-info structure, see <a href="CryptoManager.html#1057712">"Using the Crypto-Info Structures."</a></p>

<p><a name="1058167"> </a>Declared in <code>CPMLibCommon.h</code>, the structure looks like this:</p>
<h4>
  <a name="1058168"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058169"></a>struct APCipherInfoStruct {
   APProviderContextType  providerContext;
   APAlgorithmEnum  type;
   APPaddingEnum  padding;
   UInt8  *iv;
   UInt32  ivLength;
   void  *algorithmParams;
};
</pre>
<h4>
  <a name="1081375"> </a>Fields 
</h4>

<dl>
<dt><a name="1058180"> </a><code><code>providerContext</code></code></dt>
<dd><a name="1058182"> </a>Information about the AP that performed (or is requested to perform) the operation. See <a href="CryptoManager.html#1058332"><code>APProviderContextStruct</code></a>.</dd>

<dt><a name="1058187"> </a><code><code>type</code></code></dt>
<dd><a name="1058189"> </a>Constant that represents the cipher algorithm that was used or that's requested. See <a href="CryptoManager.html#1057874">Cipher Algorithm Constants</a></dd>

<dt><a name="1058194"> </a><code><code>padding</code></code></dt>
<dd><a name="1058196"> </a>Constant that represents the plaintext padding scheme used by the algorithm. See <a href="CryptoManager.html#1058099">Plaintext Padding Constants</a>.</dd>

<dt><a name="1058201"> </a><code><code>iv</code></code></dt>
<dd><a name="1058203"> </a>Initialization vector.</dd>

<dt><a name="1058205"> </a><code><code>ivLength</code></code></dt>
<dd><a name="1058207"> </a>The length of the initialization vector, in bytes.</dd>

<dt><a name="1058209"> </a><code><code>algorithmParams</code></code></dt>
<dd><a name="1058211"> </a>Additional data that's fed to the algorithm, as specified by the AP.</dd>

</dl>

<h3 class="hbH3">
  <a name="1058215"> </a>APHashInfoStruct Struct <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058217"> </a>Purpose 
</h4>

<p><a name="1058218"> </a>The APHashInfoStruct contains information about an instance of a message digest operation. You allocate the structure yourself, zero its contents, set the fields that you're interested in (if any), and then pass it as an argument to the message digest functions (<a href="CryptoManager.html#1059160"><code>CPMLibHash()</code></a>, <a href="CryptoManager.html#1059246"><code>CPMLibHashInit()</code></a>, <a href="CryptoManager.html#1058952"><code>CPMLibExportHashInfo()</code></a>, and so on). When you're finished with the struct, you pass it to <a href="CryptoManager.html#1059476"><code>CPMLibReleaseHashInfo()</code></a>. </p>

<p><a name="1058231"> </a>For more information (including examples) on how to use the structure, see <a href="CryptoManager.html#1057712">"Using the Crypto-Info Structures."</a></p>

<p><a name="1058235"> </a>Declared in CPMLibCommon.h, the structure looks like this:</p>
<h4>
  <a name="1058236"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058237"></a>struct APHashInfoStruct {
  APProviderContextType  providerContext;
  APHashEnum  type;  
  UInt32  length; 
};
</pre>
<h4>
  <a name="1081422"> </a>Fields 
</h4>

<dl>
<dt><a name="1058245"> </a><code><code>providerContext</code></code></dt>
<dd><a name="1058247"> </a>Information about the AP that performed (or is requested to perform) the operation. See <a href="CryptoManager.html#1058332"><code>APProviderContextStruct</code></a>.</dd>

<dt><a name="1058252"> </a><code><code>type</code></code></dt>
<dd><a name="1058254"> </a>The hashing algorithm that was used to create (or is requested to create) the message digest.</dd>

<dt><a name="1058256"> </a><code><code>length</code></code></dt>
<dd><a name="1058258"> </a>The length of the digest.</dd>

</dl>
<h4>
  <a name="1082773"> </a>Comments 
</h4>

<p><a name="1058260"> </a>The APHashInfoStruct is one of the crypto-info structures; it's used as an input/output argument to the message digest functions (<a href="CryptoManager.html#1059160"><code>CPMLibHash()</code></a>, <a href="CryptoManager.html#1059246"><code>CPMLibHashInit()</code></a>, <a href="CryptoManager.html#1058952"><code>CPMLibExportHashInfo()</code></a>, and so on). You allocate the structure yourself; before passing the struct to a function, you <span style="color: #000000;  font-style: italic; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">must</span> zero its contents. When you're finished with the struct, you pass it to <a href="CryptoManager.html#1059476"><code>CPMLibReleaseHashInfo()</code></a>. For more information on how to use a crypto-info structure, see <a href="CryptoManager.html#1057712">"Using the Crypto-Info Structures."</a></p>

<h3 class="hbH3">
  <a name="1058278"> </a>APKeyInfoStruct Struct <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058280"> </a>Purpose 
</h4>

<p><a name="1058281"> </a>The <code>APKeyInfoStruct</code> holds information about an encrytion key. </p>
<h4>
  <a name="1058282"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058283"></a>struct APKeyInfoStruct {
  APProviderContextType  providerContext; 
  APAlgorithmEnum  type;
  APKeyUsageEnum  usage;
  APKeyClassEnum  keyclass; 
  UInt32  length;
  UInt32  actualLength; 
  UInt16  exportable; 
  UInt16  ephemeral;   
};
</pre>
<h4>
  <a name="1085810"> </a>Fields 
</h4>

<dl>
<dt><a name="1058296"> </a><code><code>providerID</code> </code></dt>
<dd><a name="1058298"> </a>Algorithm provider ID number.</dd>

<dt><a name="1058300"> </a><code><code>type</code> </code></dt>
<dd><a name="1058302"> </a>A code that identifies the type of algorithm, one of the <a href="CryptoManager.html#1057874">Cipher Algorithm Constants</a> values.</dd>

<dt><a name="1058307"> </a><code><code>usage</code> </code></dt>
<dd><a name="1058309"> </a>A code that identifies how the algorithm is used, one of the <a href="CryptoManager.html#1058051">Key Usage Constants</a> values.</dd>

<dt><a name="1058314"> </a><code><code>keyLength</code> </code></dt>
<dd><a name="1058316"> </a>Length of the key data, in bytes and padded to the next largest word. (Default is 8.)</dd>

<dt><a name="1058318"> </a><code><code>keyActualLength</code></code></dt>
<dd><a name="1058320"> </a>The actual, unpadded length of the key data. (Default is 7).</dd>

<dt><a name="1058322"> </a><code><code>exportable</code> </code></dt>
<dd><a name="1058324"> </a>Can this key be used in a CPMExportKey() call?. 1 if it can, 0 if it can't.</dd>

<dt><a name="1058326"> </a><code><code>ephemeral</code> </code></dt>
<dd><a name="1058328"> </a>Is this a "one-shot" key? 1 if it is, 0 if it's permanent..</dd>

</dl>

<h3 class="hbH3">
  <a name="1058332"> </a>APProviderContextStruct Struct <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058334"> </a>Purpose 
</h4>

<p><a name="1058335"> </a>The <code>APProviderContextStruct</code> contains information about an instance of a cryptographic operation. The structure is contained (as an <code>APProviderContextType</code> value) in the four crypto-info structs, <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a>, <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a>, <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a>, and <a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a>.</p>

<p><a name="1058348"> </a>Declared in <code>CPMLibCommon.h</code>, the structure looks like this:</p>
<h4>
  <a name="1058349"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058350"></a>struct APProviderContextStruct {
  UInt32  providerID;
  void  *localContext;   
};
</pre>
<h4>
  <a name="1086058"> </a>Fields 
</h4>

<dl>
<dt><a name="1058356"> </a><code><code>providerID</code></code></dt>
<dd><a name="1058358"> </a>Integer that uniquely identifies the provider that's being used in the operation. </dd>

<dt><a name="1058360"> </a><code><code>localContext</code></code></dt>
<dd><a name="1058362"> </a>Provider-specific information about the operation.</dd>

</dl>

<h3 class="hbH3">
  <a name="1058366"> </a>APProviderInfoStruct Struct <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058368"> </a>Purpose 
</h4>

<p><a name="1058369"> </a>The <code>APProviderInfoStruct</code> contains information about a specific algorithm provider. The structure is returned (as an <code>APProviderInfoType</code>) by <a href="CryptoManager.html#1059138"><code>CPMLibGetProviderInfo()</code></a>.</p>

<p><a name="1058374"> </a>Declared in <code>CPMLibCommon.h</code>, the structure looks like this:</p>
<h4>
  <a name="1058375"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058376"></a>struct APProviderInfoStruct {
  char  name[32];
  char  other[64];
  UInt32  flags;
  UInt8  numAlgorithms; 
  Boolean  bHardware; 
};
</pre>
<h4>
  <a name="1087588"> </a>Fields 
</h4>

<dl>
<dt><a name="1058386"> </a><code><code>name</code></code></dt>
<dd><a name="1058388"> </a>The human-readable name of the provider.</dd>

<dt><a name="1058390"> </a><code><code>other</code></code></dt>
<dd><a name="1058392"> </a>Additional textual information.</dd>

<dt><a name="1058394"> </a><code><code>flags</code></code></dt>
<dd><a name="1058396"> </a>A bitfield that publishes the functionality that this provider supports. See <a href="CryptoManager.html#1057769">AP Capability Constants</a> for a list of values that this field can combine.</dd>

<dt><a name="1058401"> </a><code><code>numAlgorithms</code></code></dt>
<dd><a name="1058403"> </a>A count of the algorithms this provider supplies.</dd>

<dt><a name="1058405"> </a><code><code>bHardware</code></code></dt>
<dd><a name="1058407"> </a><code>true</code> if the provider's algorithms are implemented in hardware; <code>false</code> if in software.</dd>

</dl>

<h3 class="hbH3">
  <a name="1058411"> </a>APVerifyInfoStruct Struct <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058413"> </a>Purpose 
</h4>

<p><a name="1058414"> </a>The <code>APVerifyInfoStruct</code> is used by the verification functions (<a href="CryptoManager.html#1059554"><code>CPMLibVerify()</code></a>, <span style="color: #000000;  font-style: italic; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">et al.</span>) to verify a message. It contains (primarily) the hash operation and cipher operation information that will be used during verification. It's the caller's responsibility to allocate and embed the structure's <code>APHashInfoStruct</code> and <code>APCipherInfoStruct</code> fields before passing the <code>APVerifyInfoStruct</code> to a verification function.</p>

<p><a name="1058418"> </a>Any <code>APVerifyInfoStructs</code> that you actually use must be released through <a href="CryptoManager.html#1059528"><code>CPMLibReleaseVerifyInfo()</code></a> before it's freed. The embedded structures must also be released through <a href="CryptoManager.html#1059450"><code>CPMLibReleaseCipherInfo()</code></a> and <a href="CryptoManager.html#1059476"><code>CPMLibReleaseHashInfo()</code></a>.</p>

<p><a name="1058428"> </a>For more information (including examples) on how to use a crypto-info structure, see <a href="CryptoManager.html#1057712">"Using the Crypto-Info Structures."</a></p>

<p><a name="1058432"> </a>Declared in <code>CPMLibCommon.h</code>, the structure looks like this:</p>
<h4>
  <a name="1058433"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058434"></a>struct APVerifyInfoStruct {
  APProviderContextType  providerContext;
  APHashInfoType  *hashInfoP;    
  APCipherInfoType  *cipherInfoP; 
}
</pre>
<h4>
  <a name="1087676"> </a>Fields 
</h4>

<dl>
<dt><a name="1058442"> </a><code><code>providerContext</code></code></dt>
<dd><a name="1058444"> </a>Information about the AP that performed (or is requested to perform) the operation. See <a href="CryptoManager.html#1058332"><code>APProviderContextStruct</code></a>.</dd>

<dt><a name="1058449"> </a><code>hashInfoP</code></dt>
<dd><a name="1058454"> </a><a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> that contains the certificate's hash information.</dd>

<dt><a name="1058456"> </a><code>cipherInfoP</code></dt>
<dd><a name="1058461"> </a><a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that contains the certificate's cipher information.</dd>

</dl>

<h3 class="hbH3">
  <a name="1058465"> </a>CPMInfoStruct Struct <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058467"> </a>Purpose 
</h4>

<p><a name="1058468"> </a>Structure that provides information about the CPM library. It's used by the <a href="CryptoManager.html#1059111"><code>CPMLibGetInfo()</code></a> function.</p>
<h4>
  <a name="1058472"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058473"></a>typedef struct CPMInfoStruct {
  UInt8  numInstances; 
  UInt8   numProviders; 
  Boolean  defaultProviderPresent;
};
</pre>
<h4>
  <a name="1087751"> </a>Fields 
</h4>

<dl>
<dt><a name="1058481"> </a><code><code>numInstances</code></code></dt>
<dd><a name="1058483"> </a>The number of clients (applications) that are talking to this library.</dd>

<dt><a name="1058485"> </a><code><code>numProviders</code></code></dt>
<dd><a name="1058487"> </a>The number of algorithm providers that this library knows about.</dd>

<dt><a name="1058489"> </a><code>defaultProviderPresent</code></dt>
<dd><a name="1058491"> </a>Does the library contain a default provider? <code>true</code> if it does, otherwise <code>false</code>.</dd>

</dl>

<h2 class="haH2">
  <a name="1058494"> </a>CPM Functions <a href="#1057664"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1058497"> </a>CPMLibDecrypt Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058499"> </a>Purpose 
</h4>

<p><a name="1058500"> </a>Decrypts a block of encrypted data.</p>
<h4>
  <a name="1058501"> </a>Declared In 
</h4>
<code>CPMLib68kInterface.h, CPMLibARMInterface.h<a name="1058502"> </a></code><h4>
  <a name="1058503"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058504"></a>Err CPMLibDecrypt (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APCipherInfoType *cipherInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength 
)
</pre>
<h4>
  <a name="1058505"> </a>Parameters 
</h4>

<dl>
<dt><a name="1058506"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1058507"> </a>(68k only) CPM Library reference number.</dd>

<dt><a name="1058508"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1058512"> </a><a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that contains the key that was used to encrypt the data. You obtain the structure by importing the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that was exported by the data encryptor.</dd>

<dt><a name="1058516"> </a><code>&harr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1058520"> </a>A pointer to an <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that describes the parameters that will be used in the decryption operation. You typically retrieve the structure by importing the <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that was exported by the data encryptor. If you're using the decryption defaults provided by the CPM library, you can pass in a freshly allocated (and zero'd) <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a>; in this case, the structure will be populated by this function to reflect the actual decryption parameters.</dd>

<dt><a name="1058527"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1058528"> </a>A pointer to the (encrypted) data that you want to decrypt.</dd>

<dt><a name="1058529"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1058530"> </a>Length, in bytes, of <code>inBuffer</code>.</dd>

<dt><a name="1058531"> </a><code>&larr;  <i><code>outBuffer</code></i></code></dt>
<dd><a name="1058532"> </a>A pointer to the buffer into which the decrypted data will be copied. The buffer must be allocated by the caller, and must be big enough to accommodate all of the decrypted data.</dd>

<dt><a name="1058533"> </a><code>&harr;  <i><code>outBufferLength</code></i></code></dt>
<dd><a name="1058534"> </a>You pass in the (allocated) length of <code>outBuffer</code>, in bytes. The function resets the argument to the amount of data that was actually copied into <code>outBuffer</code>. If the function returns <code>cpmErrBufTooSmall</code>, <code>outBufferLength</code> is set to the minimum buffer size that's needed to accommodate the decrypted data..</dd>

</dl>
<h4>
  <a name="1058535"> </a>Returns 
</h4>

<p><a name="1058536"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058540"> </a>Comments 
</h4>

<p><a name="1058541"> </a>This functions peforms block decryption. For stream decryption, see <a href="CryptoManager.html#1058603"><code>CPMLibDecryptInit()</code></a>. </p>

<p><a name="1058545"> </a>The <code>keyInfo</code> and <code>cipherInfo</code> must agree on the algorithm type, as specified in their respective <code>APAlgorithmEnum</code> fields. </p>

<p><a name="1058546"> </a>If <code>outBuffer</code> isn't big enough, the function will fail and <code>outBufferLength</code> will return the "correct" output buffer size (i.e. large enough to accommodate the encrypted data) . When this happens, simply reallocate the output buffer and call <code>CPMLibDecrypt</code> again.</p>

<h3 class="hbH3">
  <a name="1058549"> </a>CPMLibDecryptFinal Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058551"> </a>Purpose 
</h4>

<p><a name="1058552"> </a>Finalizes a stream decryption operation.</p>
<h4>
  <a name="1058553"> </a>Declared In 
</h4>
<code>CPMLib68kInterface.h, CPMLibARMInterface.h<a name="1058554"> </a></code><h4>
  <a name="1058555"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058556"></a>Err CPMLibDecryptFinal (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APCipherInfoType *cipherInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength
)
</pre>
<h4>
  <a name="1058557"> </a>Parameters 
</h4>

<dl>
<dt><a name="1058558"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1058559"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1058560"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1058561"> </a>Key used to decrypt the data, as returned by <a href="CryptoManager.html#1059072"><code>CPMLibGenerateKey()</code></a> or <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>. </dd>

<dt><a name="1058568"> </a><code>&rarr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1058572"> </a>A pointer to the <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that was returned by the stream-initializing <a href="CryptoManager.html#1058603"><code>CPMLibDecryptInit()</code></a> call. </dd>

<dt><a name="1058576"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1058577"> </a>A pointer to the data that you want to encrypt. If you already supplied all the data through previous <a href="CryptoManager.html#1058652"><code>CPMLibDecryptUpdate()</code></a> calls, pass <code>NULL</code>.</dd>

<dt><a name="1058581"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1058582"> </a>The length of <code>inBuffer</code>, in bytes. If <code>inBuffer</code> is <code>NULL</code>, pass 0.</dd>

<dt><a name="1058583"> </a><code>&larr;  <i><code>outBuffer</code></i></code></dt>
<dd><a name="1058584"> </a>A pointer to the buffer where the decrypted <code>inBuffer</code> data will be copied. The buffer must be allocated by the caller, and must be big enough to accommodate all of the decrypted data.</dd>

<dt><a name="1058585"> </a><code>&harr;  <i><code>outBufferLength</code></i></code></dt>
<dd><a name="1058586"> </a>You pass in the (allocated) length of <code>outBuffer</code>, in bytes. The function resets the argument to the amount of data that was actually copied into <code>outBuffer</code>. If the function returns <code>cpmErrBufTooSmall</code>, <code>outBufferLength</code> is set to the minimum buffer size that's needed to accommodate the decrypted <code>inBuffer</code> data..</dd>

</dl>
<h4>
  <a name="1058587"> </a>Returns 
</h4>

<p><a name="1058588"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058592"> </a>Comments 
</h4>

<p><a name="1058593"> </a>This function (optionally) decrypts a final buffer of data and then closes the decryption stream that was initialized by <a href="CryptoManager.html#1058603"><code>CPMLibDecryptInit()</code></a>. </p>

<p><a name="1058597"> </a>Note that <code>outBuffer</code> contains the decrypted <code>inBuffer</code> data only&#8212;it doesn't contain all the data that was decrypted by this stream. It's the callers responsibility to accumulate the data that was decrypted by previous, successive <a href="CryptoManager.html#1058652"><code>CPMLibDecryptUpdate()</code></a> calls.</p>

<h3 class="hbH3">
  <a name="1058603"> </a>CPMLibDecryptInit Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058605"> </a>Purpose 
</h4>

<p><a name="1058606"> </a>Initializes a stream decryption session.</p>
<h4>
  <a name="1058607"> </a>Declared In 
</h4>
<code>CPMLib68kInterface.h, CPMLibARMInterface.h<a name="1058608"> </a></code><h4>
  <a name="1058609"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058610"></a>Err CPMLibDecryptInit (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APCipherInfoType *cipherInfo 
)
</pre>
<h4>
  <a name="1058611"> </a>Parameters 
</h4>

<dl>
<dt><a name="1058612"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1058613"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1058614"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1058618"> </a><a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that contains the key that was used to encrypt the data. You obtain the structure by importing the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that was exported by the data encryptor.</dd>

<dt><a name="1058622"> </a><code>&harr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1058626"> </a>A pointer to an <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that describes the parameters that will be used in the decryption operation. You typically retrieve the structure by importing the <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that was exported by the data encryptor. If you're using the decryption defaults provided by the CPM library, you can pass in a freshly allocated (and zero'd) <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a>; in this case, the structure will be populated by this function to reflect the actual decryption parameters.</dd>

</dl>
<h4>
  <a name="1058633"> </a>Returns 
</h4>

<p><a name="1058634"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058638"> </a>Comments 
</h4>

<p><a name="1058639"> </a>This function initializes a stream decryption operation. To feed data to the operation, you call <a href="CryptoManager.html#1058652"><code>CPMLibDecryptUpdate()</code></a> followed by <a href="CryptoManager.html#1058549"><code>CPMLibDecryptFinal()</code></a>. The "update" function is optional; the "final" function is mandatory. For block encryption, see <a href="CryptoManager.html#1058497"><code>CPMLibDecrypt()</code></a>. </p>

<p><a name="1058649"> </a>The <code>keyInfo</code> and <code>cipherInfo</code> must agree on the algorithm type, as specified in their respective <code>APAlgorithmEnum</code> fields. </p>

<h3 class="hbH3">
  <a name="1058652"> </a>CPMLibDecryptUpdate Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058654"> </a>Purpose 
</h4>

<p><a name="1058655"> </a>Feeds data to a stream decryption operation.</p>
<h4>
  <a name="1058656"> </a>Declared In 
</h4>
<code>CPMLib68kInterface.h, CPMLibARMInterface.h<a name="1058657"> </a></code><h4>
  <a name="1058658"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058659"></a>Err CPMLibDecryptUpdate (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APCipherInfoType *cipherInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength
)
</pre>
<h4>
  <a name="1058660"> </a>Parameters 
</h4>

<p><a name="1058664"> </a>see <a href="CryptoManager.html#1058750"><code>CPMLibEncryptFinal()</code></a></p>
<h4>
  <a name="1058665"> </a>Returns 
</h4>

<p><a name="1058666"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058670"> </a>Comments 
</h4>

<p><a name="1058671"> </a>This function feeds data into the stream decryption session that was started by <a href="CryptoManager.html#1058603"><code>CPMLibDecryptInit()</code></a>. You can make any number of <code>CPMLibDecryptUpdate</code> calls while the stream is open. When you've finished feeding data into the stream, you call <a href="CryptoManager.html#1058549"><code>CPMLibDecryptFinal()</code></a>.</p>

<p><a name="1058678"> </a>This function's arguments, return values, and behavior are nearly identical to <a href="CryptoManager.html#1058549"><code>CPMLibDecryptFinal()</code></a> (which see for details). The only difference between them is that this function leaves the stream open, and <a href="CryptoManager.html#1058549"><code>CPMLibDecryptFinal()</code></a> closes it. </p>

<h3 class="hbH3">
  <a name="1058687"> </a>CPMLibEncrypt Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058689"> </a>Purpose 
</h4>

<p><a name="1058690"> </a>Encrypts a block of data.</p>
<h4>
  <a name="1058691"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1058692"> </a></code><h4>
  <a name="1058693"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058694"></a>Err CPMLibEncrypt (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APCipherInfoType *cipherInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength
)
</pre>
<h4>
  <a name="1058695"> </a>Parameters 
</h4>

<dl>
<dt><a name="1058696"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1058697"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1058698"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1058702"> </a>A pointer to an <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that represents the key that will be used to encrypt the data. The allocate the structure, zero it, and then populate it by calling <a href="CryptoManager.html#1059072"><code>CPMLibGenerateKey()</code></a> or <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>. </dd>

<dt><a name="1058709"> </a><code>&rarr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1058713"> </a>A pointer to an <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that you can use to set the parameters of the encryption operation. If the CPM can't satisfy the requirements you specify in the structure, the operation will fail. If you want to use the default cipher settings, pass in a zero'd structure. When the function returns, the structure will be filled with information describing the operation. </dd>

<dt><a name="1058714"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1058715"> </a>A pointer to the data that you want to encrypt.</dd>

<dt><a name="1058716"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1058717"> </a>The length of <code>inBuffer</code>, in bytes.</dd>

<dt><a name="1058718"> </a><code>&larr;  <i><code>outBuffer</code></i></code></dt>
<dd><a name="1058719"> </a>A pointer to the buffer where the encrypted data will be copied. The buffer must be allocated by the caller, and must be big enough to accommodate all of the encrypted data.</dd>

<dt><a name="1058720"> </a><code>&harr;  <i><code>outBufferLength</code></i></code></dt>
<dd><a name="1058721"> </a>You pass in the (allocated) length of <code>outBuffer</code>, in bytes. The function resets the argument to the amount of data that was actually copied into <code>outBuffer</code>. If the function returns <code>cpmErrBufTooSmall</code>, <code>outBufferLength</code> is set to the minimum buffer size that's needed to accommodate the encrypted data.</dd>

</dl>
<h4>
  <a name="1058722"> </a>Returns 
</h4>

<p><a name="1058723"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058727"> </a>Comments 
</h4>

<p><a name="1058728"> </a>This functions peforms block encryption. For stream encryption, see <a href="CryptoManager.html#1058818"><code>CPMLibEncryptInit()</code></a>. </p>

<p><a name="1058732"> </a>The <code>keyInfo</code> and <code>cipherInfo</code> must agree on the algorithm type, as specified in their respective <code>APAlgorithmEnum</code> fields. </p>

<p><a name="1058733"> </a>If <code>outBuffer</code> isn't big enough, the function will fail and <code>outBufferLength</code> will return the "correct" output buffer size (i.e. large enough to accommodate the encrypted data) . When this happens, simply reallocate the output buffer and call <code>CPMLibEncrypt</code> again.</p>

<p><a name="1058734"> </a>After you've encrypted the data, you must export the <code>keyInfo</code> and cipherInfo structures (see <a href="CryptoManager.html#1058992"><code>CPMLibExportKeyInfo()</code></a> and <a href="CryptoManager.html#1058909"><code>CPMLibExportCipherInfo()</code></a>) so they can be imported, later, by the data decryptor. Secure storage and transmission of the encryption key is th caller's responsibility.</p>

<p><a name="1058744"> </a>To decrypt encrypted data, you call <a href="CryptoManager.html#1058497"><code>CPMLibDecrypt()</code></a> or <a href="CryptoManager.html#1058603"><code>CPMLibDecryptInit()</code></a>.</p>

<h3 class="hbH3">
  <a name="1058750"> </a>CPMLibEncryptFinal Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058752"> </a>Purpose 
</h4>

<p><a name="1058753"> </a>Finalizes a stream encryption operation.</p>
<h4>
  <a name="1058754"> </a>Declared In 
</h4>
<code>CPMLib68kInterface.h, CPMLibARMInterface.h<a name="1058755"> </a></code><h4>
  <a name="1058756"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058757"></a>Err CPMLibEncryptFinal (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APCipherInfoType *cipherInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength
)
</pre>
<h4>
  <a name="1058758"> </a>Parameters 
</h4>

<dl>
<dt><a name="1058759"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1058760"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1058761"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1058762"> </a>Key used to encrypt the data, as returned by <a href="CryptoManager.html#1059072"><code>CPMLibGenerateKey()</code></a> or <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>. </dd>

<dt><a name="1058769"> </a><code>&rarr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1058773"> </a>A pointer to the <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that was returned in the stream-initializing <a href="CryptoManager.html#1058818"><code>CPMLibEncryptInit()</code></a> call. </dd>

<dt><a name="1058777"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1058778"> </a>A pointer to the data that you want to encrypt. If you already supplied all the data through previous <a href="CryptoManager.html#1058874"><code>CPMLibEncryptUpdate()</code></a> calls, pass <code>NULL</code>.</dd>

<dt><a name="1058782"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1058783"> </a>The length of <code>inBuffer</code>, in bytes. If <code>inBuffer</code> is <code>NULL</code>, pass 0.</dd>

<dt><a name="1058784"> </a><code>&larr;  <i><code>outBuffer</code></i></code></dt>
<dd><a name="1058785"> </a>A pointer to the buffer where the encrypted <code>inBuffer</code> data will be copied. The buffer must be allocated by the caller, and must be big enough to accommodate the encrypted <code>inBuffer</code> data.</dd>

<dt><a name="1058786"> </a><code>&harr;  <i><code>outBufferLength</code></i></code></dt>
<dd><a name="1058787"> </a>You pass in the (allocated) length of <code>outBuffer</code>, in bytes. The function resets the argument to the amount of data that was actually copied into <code>outBuffer</code>. If the function returns <code>cpmErrBufTooSmall</code>, <code>outBufferLength</code> is set to the minimum buffer size that's needed to accommodate the encrypted data.</dd>

</dl>
<h4>
  <a name="1058788"> </a>Returns 
</h4>

<p><a name="1058789"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058793"> </a>Comments 
</h4>

<p><a name="1058794"> </a>This function (optionally) encrypts a final buffer of data and then closes the encryption stream that was initialized by <a href="CryptoManager.html#1058818"><code>CPMLibEncryptInit()</code></a>. </p>

<p><a name="1058798"> </a>After you've encrypted the data, you should export the <code>keyInfo</code> and <code>cipherInfo</code> structures (see <a href="CryptoManager.html#1058992"><code>CPMLibExportKeyInfo()</code></a> and <a href="CryptoManager.html#1058909"><code>CPMLibExportCipherInfo()</code></a>) so they can be imported, later, by the data decryptor. Secure storage and transmission of the encryption key is the caller's responsibility.</p>

<p><a name="1058805"> </a>Note that <code>outBuffer</code> contains the encrypted <code>inBuffer</code> data only&#8212;it doesn't contain all the data that was encrypted by this stream. It's the callers responsibility to accumulate the data that was encrypted by previous, successive <a href="CryptoManager.html#1058874"><code>CPMLibEncryptUpdate()</code></a> calls.</p>

<p><a name="1058812"> </a>To decrypt encrypted data, you call <a href="CryptoManager.html#1058497"><code>CPMLibDecrypt()</code></a> or <a href="CryptoManager.html#1058603"><code>CPMLibDecryptInit()</code></a>.</p>

<h3 class="hbH3">
  <a name="1058818"> </a>CPMLibEncryptInit Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058820"> </a>Purpose 
</h4>

<p><a name="1058821"> </a>Initializes a stream encryption session.</p>
<h4>
  <a name="1058822"> </a>Declared In 
</h4>
<code>CPMLib68kInterface.h, CPMLibARMInterface.h<a name="1058823"> </a></code><h4>
  <a name="1058824"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058825"></a>Err CPMLibEncryptInit (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APCipherInfoType *cipherInfo 
)
</pre>
<h4>
  <a name="1058826"> </a>Parameters 
</h4>

<dl>
<dt><a name="1058827"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1058828"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1058829"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1058830"> </a>Key used to encrypt the data, as returned by <a href="CryptoManager.html#1059072"><code>CPMLibGenerateKey()</code></a> or <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>. </dd>

<dt><a name="1058837"> </a><code>&rarr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1058841"> </a>A pointer to an <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that you can use to set the parameters of the encryption operation. If the CPM can't satisfy the requirements you specify in the structure, the operation will fail. If you want to use the default cipher settings, pass in a zero'd structure. When the function returns, the structure will be filled with information describing the operation. The structure is used as a cookie in the subsequent <a href="CryptoManager.html#1058874"><code>CPMLibEncryptUpdate()</code></a> and/or <a href="CryptoManager.html#1058750"><code>CPMLibEncryptFinal()</code></a> functions.</dd>

</dl>
<h4>
  <a name="1058848"> </a>Returns 
</h4>

<p><a name="1058849"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058853"> </a>Comments 
</h4>

<p><a name="1058854"> </a>This function initializes a stream encryption operation. To feed data to the operation, you call <a href="CryptoManager.html#1058874"><code>CPMLibEncryptUpdate()</code></a> followed by <a href="CryptoManager.html#1058750"><code>CPMLibEncryptFinal()</code></a>. The "update" function is optional; the "final" function is mandatory. For block encryption, see <a href="CryptoManager.html#1058687"><code>CPMLibEncrypt()</code></a>. </p>

<p><a name="1058864"> </a>The <code>keyInfo</code> and <code>cipherInfo</code> must agree on the algorithm type, as specified in their respective <code>APAlgorithmEnum</code> fields. </p>

<p><a name="1058868"> </a>To decrypt encrypted data, you call <a href="CryptoManager.html#1058497"><code>CPMLibDecrypt()</code></a> or <a href="CryptoManager.html#1058603"><code>CPMLibDecryptInit()</code></a>.</p>

<h3 class="hbH3">
  <a name="1058874"> </a>CPMLibEncryptUpdate Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058876"> </a>Purpose 
</h4>

<p><a name="1058877"> </a>Feeds data to a stream encryption operation.</p>
<h4>
  <a name="1058878"> </a>Declared In 
</h4>
<code>CPMLib68kInterface.h, CPMLibARMInterface.h<a name="1058879"> </a></code><h4>
  <a name="1058880"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058881"></a>Err CPMLibEncryptUpdate (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APCipherInfoType *cipherInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength
)
</pre>
<h4>
  <a name="1058882"> </a>Parameters 
</h4>

<p><a name="1058886"> </a>see <a href="CryptoManager.html#1058750"><code>CPMLibEncryptFinal()</code></a></p>
<h4>
  <a name="1058887"> </a>Returns 
</h4>

<p><a name="1058888"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058892"> </a>Comments 
</h4>

<p><a name="1058893"> </a>This function feeds data into the stream encryption session that was started by <a href="CryptoManager.html#1058818"><code>CPMLibEncryptInit()</code></a>. You can make any number of <code>CPMLibEncryptUpdate</code> calls while the encryption stream is open. When you've finished feeding data into the stream, you call <a href="CryptoManager.html#1058750"><code>CPMLibEncryptFinal()</code></a>.</p>

<p><a name="1058900"> </a>This function's arguments, return values, and behavior are nearly identical to <a href="CryptoManager.html#1058750"><code>CPMLibEncryptFinal()</code></a> (which see for details). The only difference between them is that this function leaves the stream open, and <a href="CryptoManager.html#1058750"><code>CPMLibEncryptFinal()</code></a> closes it. </p>

<h3 class="hbH3">
  <a name="1058909"> </a>CPMLibExportCipherInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058911"> </a>Purpose 
</h4>

<p><a name="1058912"> </a>Encodes a cipher into a form that can be cached. To reconstitute an exported cipher, pass it to <a href="CryptoManager.html#1059322"><code>CPMLibImportCipherInfo()</code></a>.</p>
<h4>
  <a name="1058916"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1058917"> </a></code><h4>
  <a name="1058918"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058919"></a>Err CPMLibExportCipherInfo (
    UInt16 libRef,
   APCipherInfoType *cipherInfo,
   UInt8 encoding,
   UInt8 *exportBuffer,
   UInt32 exportBufferLength 
)
</pre>
<h4>
  <a name="1058920"> </a>Parameters 
</h4>

<dl>
<dt><a name="1058921"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1058922"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1058923"> </a><code>&rarr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1058924"> </a>Structure that represents the cipher that you want to export, as created and returned by <a href="CryptoManager.html#1059072"><code>CPMLibGenerateKey()</code></a>, or as imported through <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>.</dd>

<dt><a name="1058931"> </a><code>&rarr;  <i><code>encoding</code></i></code></dt>
<dd><a name="1058932"> </a>Constant that specifies the type of encoding. One of <code>IMPORT_EXPORT_RAW</code>, <code>IMPORT_EXPORT_DER</code>, or <code>IMPORT_EXPORT_XML</code>. See <a href="CryptoManager.html#1057910"><code>Export Encoding Constants</code></a> for details about these formats.</dd>

<dt><a name="1058936"> </a><code>&harr;  <i><code>exportBuffer</code></i></code></dt>
<dd><a name="1058937"> </a>Buffer into which the function copies the encoded data. The buffer must be allocated by the caller. Point this argument to NULL if you're using the function to retrieve the size of the encoded data. </dd>

<dt><a name="1058938"> </a><code>&harr;  <i><code>exportBufferLength</code></i></code></dt>
<dd><a name="1058939"> </a>You pass in the size of <code>exportBuffer</code> in bytes. The function returns (through this argument) the size that's required to accommodate the encoded data.</dd>

</dl>
<h4>
  <a name="1058940"> </a>Returns 
</h4>

<p><a name="1058941"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058945"> </a>Comments 
</h4>

<p><a name="1058946"> </a>You call this function twice: Once to get the size of the required exportBuffer, and then again (after allocating the buffer) to get the encoded buffer. See <a href="CryptoManager.html#1057744">"Using the Export Functions"</a> for more information and a free sample.</p>

<h3 class="hbH3">
  <a name="1058952"> </a>CPMLibExportHashInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058954"> </a>Purpose 
</h4>

<p><a name="1058958"> </a>Encodes an <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> into a form that can be cached. To reconstitute an exported hash info, pass it to <a href="CryptoManager.html#1059354"><code>CPMLibImportHashInfo()</code></a>.</p>
<h4>
  <a name="1058962"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1058963"> </a></code><h4>
  <a name="1058964"> </a>Prototype 
</h4>
<pre class="proto"><a name="1058965"></a>Err CPMLibExportKeyInfo (
    UInt16 libRef,
   APHashInfoType *hashInfo,
   UInt8 encoding,
   UInt8 *exportBuffer,
   UInt32 exportBufferLength 
)
</pre>
<h4>
  <a name="1058966"> </a>Parameters 
</h4>

<dl>
<dt><a name="1058967"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1058968"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1058969"> </a><code>&rarr;  <i><code>hashInfo</code></i></code></dt>
<dd><a name="1058970"> </a>Structure that you want to export.</dd>

<dt><a name="1058971"> </a><code>&rarr;  <i><code>encoding</code></i></code></dt>
<dd><a name="1058972"> </a>Constant that specifies the type of encoding. One of <code>IMPORT_EXPORT_RAW</code>, <code>IMPORT_EXPORT_DER</code>, or <code>IMPORT_EXPORT_XML</code>. See <a href="CryptoManager.html#1057910"><code>Export Encoding Constants</code></a> for details about these formats.</dd>

<dt><a name="1058976"> </a><code>&harr;  <i><code>exportBuffer</code></i></code></dt>
<dd><a name="1058977"> </a>Buffer into which the function copies the encoded data. The buffer must be allocated by the caller. Point this argument to <code>NULL</code> if you're using the function to retrieve the size of the encoded data (see below</dd>

<dt><a name="1058978"> </a><code>&harr;  <i><code>exportBufferLength</code></i></code></dt>
<dd><a name="1058979"> </a>You pass in the size of <code>exportBuffer</code> in bytes; the function returns (through this argument) the size that's required to accommodate the encoded data. </dd>

</dl>
<h4>
  <a name="1058980"> </a>Returns 
</h4>

<p><a name="1058981"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1058985"> </a>Comments 
</h4>

<p><a name="1058986"> </a>You call this function twice: Once to get the size of the export buffer, and then again (after allocating the buffer) to retrieve the encoded data. See <a href="CryptoManager.html#1057744">"Using the Export Functions"</a> for more information and a free sample.</p>

<h3 class="hbH3">
  <a name="1058992"> </a>CPMLibExportKeyInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1058994"> </a>Purpose 
</h4>

<p><a name="1058998"> </a>Encodes a <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> into a form that can be cached. To reconstitute an exported key, pass it to <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>.</p>
<h4>
  <a name="1059002"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059003"> </a></code><h4>
  <a name="1059004"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059005"></a>Err CPMLibExportKeyInfo (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   UInt8 encoding,
   UInt8 *exportBuffer,
   UInt32 exportBufferLength 
)
</pre>
<h4>
  <a name="1059006"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059007"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059008"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059009"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1059010"> </a>Structure that you want to export.</dd>

<dt><a name="1059011"> </a><code>&rarr;  <i><code>encoding</code></i></code></dt>
<dd><a name="1059012"> </a>Constant that specifies the type of encoding. One of <code>IMPORT_EXPORT_RAW</code>, <code>IMPORT_EXPORT_DER</code>, or <code>IMPORT_EXPORT_XML</code>. See <a href="CryptoManager.html#1057910"><code>Export Encoding Constants</code></a> for details about these formats.</dd>

<dt><a name="1059016"> </a><code>&harr;  <i><code>exportBuffer</code></i></code></dt>
<dd><a name="1059017"> </a>Buffer into which the function copies the encoded data. The buffer must be allocated by the caller. Point this argument to <code>NULL</code> if you're using the function to retrieve the size of the encoded data (see below</dd>

<dt><a name="1059018"> </a><code>&harr;  <i><code>exportBufferLength</code></i></code></dt>
<dd><a name="1059019"> </a>You pass in the size of <code>exportBuffer</code> in bytes; the function returns (through this argument) the size that's required to accommodate the encoded data. </dd>

</dl>
<h4>
  <a name="1059020"> </a>Returns 
</h4>

<p><a name="1059021"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059025"> </a>Comments 
</h4>

<p><a name="1059026"> </a>You call this function twice: Once to get the size of the export buffer, and then again (after allocating the buffer) to retrieve the encoded data. See <a href="CryptoManager.html#1057744">"Using the Export Functions"</a> for more information and a free sample.</p>

<h3 class="hbH3">
  <a name="1059032"> </a>CPMLibExportVerifyInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059034"> </a>Purpose 
</h4>

<p><a name="1059038"> </a>Encodes a <a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a> into a form that can be cached. To reconstitute an exported key, pass it to <a href="CryptoManager.html#1059418"><code>CPMLibImportVerifyInfo()</code></a>.</p>
<h4>
  <a name="1059042"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059043"> </a></code><h4>
  <a name="1059044"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059045"></a>Err CPMLibExportKeyInfo (
    UInt16 libRef,
   APVerifyInfoType *verifyInfo,
   UInt8 encoding,
   UInt8 *exportBuffer,
   UInt32 exportBufferLength 
)
</pre>
<h4>
  <a name="1059046"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059047"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059048"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059049"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1059050"> </a>Structure that you want to export.</dd>

<dt><a name="1059051"> </a><code>&rarr;  <i><code>encoding</code></i></code></dt>
<dd><a name="1059052"> </a>Constant that specifies the type of encoding. One of <code>IMPORT_EXPORT_RAW</code>, <code>IMPORT_EXPORT_DER</code>, or <code>IMPORT_EXPORT_XML</code>. See <a href="CryptoManager.html#1057910"><code>Export Encoding Constants</code></a> for details about these formats.</dd>

<dt><a name="1059056"> </a><code>&harr;  <i><code>exportBuffer</code></i></code></dt>
<dd><a name="1059057"> </a>Buffer into which the function copies the encoded data. The buffer must be allocated by the caller. Point this argument to <code>NULL</code> if you're using the function to retrieve the size of the encoded data (see below</dd>

<dt><a name="1059058"> </a><code>&harr;  <i><code>exportBufferLength</code></i></code></dt>
<dd><a name="1059059"> </a>You pass in the size of <code>exportBuffer</code> in bytes; the function returns (through this argument) the size that's required to accommodate the encoded data. </dd>

</dl>
<h4>
  <a name="1059060"> </a>Returns 
</h4>

<p><a name="1059061"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059065"> </a>Comments 
</h4>

<p><a name="1059066"> </a>You call this function twice: Once to get the size of the export buffer, and then again (after allocating the buffer) to retrieve the encoded data. See <a href="CryptoManager.html#1057744">"Using the Export Functions"</a> for more information and a free sample.</p>

<h3 class="hbH3">
  <a name="1059072"> </a>CPMLibGenerateKey Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059074"> </a>Purpose 
</h4>

<p><a name="1059075"> </a>Generates a new symmetric key.</p>
<h4>
  <a name="1059076"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059077"> </a></code><h4>
  <a name="1059078"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059079"></a>Err CPMLibGenerateKey (
    UInt16 libRef,
   UInt8 *seedData,
   UInt32 seedLength,
   APKeyInfoType *keyInfo 
)
</pre>
<h4>
  <a name="1059080"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059081"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059082"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059083"> </a><code>&rarr;  <i><code>seedData</code></i></code></dt>
<dd><a name="1059084"> </a>Optional data that's used to seed the key generator. Because PalmOS Garnet doesn't currently support key "derivation" (identical key generation based on identical seeds) the seed data is, in essence, a no-op, and can be a pointer to 0. However, you may want to supply (and cache) unique seed data today in anticipation of tomorrow's derivation functionality.</dd>

<dt><a name="1059085"> </a><code>&rarr;  <i><code>seedLength</code></i></code></dt>
<dd><a name="1059086"> </a>Length of <code>seedData</code>, in bytes. (Pass 0 if *<code>seedData</code> is 0.)</dd>

<dt><a name="1059087"> </a><code>&harr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1059091"> </a>A pointer to a <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that will contain the generated key. The <code>keyInfo</code> structure is allocated and owned by the caller. You can specify the desired provider, key-generation scheme, and so on, by setting the <code>APKeyInfoType</code> fields. Or, to retrieve a default key, zero the structure before you pass it in. </dd>

</dl>
<h4>
  <a name="1059092"> </a>Returns 
</h4>

<p><a name="1059093"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059097"> </a>Comments 
</h4>

<p><a name="1059101"> </a>The <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that's populated by this function can be used in subsequent encryption, decryption, and verification operations.</p>

<p><a name="1059105"> </a>When you're finished using the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a>, you must release it through <a href="CryptoManager.html#1059502"><code>CPMLibReleaseKeyInfo()</code></a>.</p>

<h3 class="hbH3">
  <a name="1059111"> </a>CPMLibGetInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059113"> </a>Purpose 
</h4>

<p><a name="1059114"> </a>Retrieves information about the CPM library.</p>
<h4>
  <a name="1059115"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059116"> </a></code><h4>
  <a name="1059117"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059119"></a>Err CPMLibLibGetInfo (
    UInt16 libRef,
   CPMInfoType *info
)
</pre>
<h4>
  <a name="1059120"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059121"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059122"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059123"> </a><code>&rarr;  <i><code>info</code></i></code></dt>
<dd><a name="1059127"> </a>Pointer to a <a href="CryptoManager.html#1058465"><code>CPMInfoStruct</code></a> that returns the information about the library. See <a href="CryptoManager.html#1058465"><code>CPMInfoStruct</code></a> for a description.</dd>

</dl>
<h4>
  <a name="1059131"> </a>Returns 
</h4>

<p><a name="1059132"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059138"> </a>CPMLibGetProviderInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059140"> </a>Purpose 
</h4>

<p><a name="1059141"> </a>Retrieves information about a specific provider.</p>
<h4>
  <a name="1059142"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059143"> </a></code><h4>
  <a name="1059144"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059145"></a>Err CPMLibGetProviderInfo (
    UInt16 libRef,
   UInt32 providerID,
   APProviderInfoType *providerInfo
)
</pre>
<h4>
  <a name="1059146"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059147"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059148"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059149"> </a><code>&rarr;  <i><code>providerID</code></i></code></dt>
<dd><a name="1059150"> </a>ID number that identifies the provider.</dd>

<dt><a name="1059151"> </a><code>&larr;  <i><code>providerInfo</code></i></code></dt>
<dd><a name="1059152"> </a>Structure into which the function places provider information. The structure is allocated and freed by the caller. The function doesn't clear inapplicable fields on the way out.</dd>

</dl>
<h4>
  <a name="1059153"> </a>Returns 
</h4>

<p><a name="1059154"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059160"> </a>CPMLibHash Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059162"> </a>Purpose 
</h4>

<p><a name="1059163"> </a>Hashes a block of data.</p>
<h4>
  <a name="1059164"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059165"> </a></code><h4>
  <a name="1059166"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059167"></a>Err CPMLibHash (
    UInt16 libRef,
   APHashEnum type,
   APHashInfoType *hashInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength 
)
</pre>
<h4>
  <a name="1059168"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059169"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059170"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059171"> </a><code>&rarr;  <i><code>type</code></i></code></dt>
<dd><a name="1059172"> </a>A constant that represents the hashing algorithm that will be used to create the message digest. See <a href="CryptoManager.html#1057958">Hashing Algorithm Constants</a> for a list of constants. If you want the default algorithm, use <code>apHashTypeUnspecified</code>.</dd>

<dt><a name="1059176"> </a><code>&rarr;  <i><code>hashInfo</code></i></code></dt>
<dd><a name="1059180"> </a>A pointer to an <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> that you can use to set the parameters of the hashing operation. If the CPM can't satisfy the requirements you specify in the structure, the operation will fail. If you want to use the default settings, pass in a zero'd structure. When the function returns, the structure will be filled with information describing the operation.</dd>

<dt><a name="1059181"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1059182"> </a>A pointer to the data that you want to hash. </dd>

<dt><a name="1059183"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1059184"> </a>The length of <code>inBuffer</code>, in bytes. If <code>inBuffer</code> is <code>NULL</code>, pass 0.</dd>

<dt><a name="1059185"> </a><code>&larr;  <i><code>outBuffer</code></i></code></dt>
<dd><a name="1059186"> </a>A pointer to the buffer where the hashed <code>inBuffer</code> data will be copied. The buffer must be allocated by the caller, and must be big enough to accommodate all of the hashed data.</dd>

<dt><a name="1059187"> </a><code>&harr;  <i><code>outBufferLength</code></i></code></dt>
<dd><a name="1059188"> </a>You pass in the (allocated) length of <code>outBuffer</code>, in bytes. The function resets the argument to the amount of data that was actually copied into <code>outBuffer. </code>If the function returns <code>cpmErrBufTooSmall</code>, <code>outBufferLength</code> is set to the minimum buffer size that's needed to accommodate the hashed data..</dd>

</dl>
<h4>
  <a name="1059189"> </a>Returns 
</h4>

<p><a name="1059190"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059194"> </a>Comments 
</h4>

<p><a name="1059195"> </a>This function performs a block hash operation. For stream hashing, use <a href="CryptoManager.html#1059246"><code>CPMLibHashInit()</code></a>.</p>

<h3 class="hbH3">
  <a name="1059201"> </a>CPMLibHashFinal Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059203"> </a>Purpose 
</h4>

<p><a name="1059204"> </a>Finalizes a hash session and returns the hashed data.</p>
<h4>
  <a name="1059205"> </a>Declared In 
</h4>
<code>CPMLib.h<a name="1059206"> </a></code><h4>
  <a name="1059207"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059208"></a>Err CPMLibHashFinal (
    UInt16 libRef,
   APHashInfoType *hashInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength 
)
</pre>
<h4>
  <a name="1059209"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059210"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059211"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059212"> </a><code>&rarr;  <i><code>hashInfo</code></i></code></dt>
<dd><a name="1059216"> </a>A pointer to the <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> that was returned by <a href="CryptoManager.html#1059246"><code>CPMLibHashInit()</code></a>.</dd>

<dt><a name="1059220"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1059221"> </a>A pointer to the data that you want to hash. If you already supplied all the data through previous <a href="CryptoManager.html#1059280"><code>CPMLibHashUpdate()</code></a> calls, pass <code>NULL</code>.</dd>

<dt><a name="1059225"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1059226"> </a>The length of <code>inBuffer</code>, in bytes. If <code>inBuffer</code> is <code>NULL</code>, pass 0.</dd>

<dt><a name="1059227"> </a><code>&larr;  <i><code>outBuffer</code></i></code></dt>
<dd><a name="1059228"> </a>A pointer to the buffer where all the data that has been hashed by this stream will be copied. The buffer must be allocated by the caller, and must be big enough to accommodate all of the hashed data.</dd>

<dt><a name="1059229"> </a><code>&harr;  <i><code>outBufferLength</code></i></code></dt>
<dd><a name="1059230"> </a>You pass in the (allocated) length of <code>outBuffer</code>, in bytes. The function resets the argument to the amount of data that was actually copied into <code>outBuffer</code>. If the function returns <code>cpmErrBufTooSmall</code>, <code>outBufferLength</code> is set to the minimum buffer size that's needed to accommodate the hashed data.</dd>

</dl>
<h4>
  <a name="1059231"> </a>Returns 
</h4>

<p><a name="1059232"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059236"> </a>Comments 
</h4>

<p><a name="1059237"> </a>This function returns all the data that was hashed by the hash stream, and then closes the stream. It follows an initial call to <a href="CryptoManager.html#1059246"><code>CPMLibHashInit()</code></a> and some number of calls to <a href="CryptoManager.html#1059280"><code>CPMLibHashUpdate()</code></a>. </p>

<h3 class="hbH3">
  <a name="1059246"> </a>CPMLibHashInit Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059248"> </a>Purpose 
</h4>

<p><a name="1059249"> </a>Initiates a streaming hash operation.</p>
<h4>
  <a name="1059250"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059251"> </a></code><h4>
  <a name="1059252"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059253"></a>Err CPMLibHash (
    UInt16 libRef,
   APHashInfoType *hashInfo 
)
</pre>
<h4>
  <a name="1059254"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059255"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059256"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059257"> </a><code>&rarr;  <i><code>hashInfo</code></i></code></dt>
<dd><a name="1059261"> </a>A pointer to an <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> that you can use to set the parameters of the hash operation. If the CPM can't satisfy the requirements you specify in the structure, the operation will fail. If you want to use the default settings, pass in a zero'd structure. When the function returns, the structure will be filled with information describing the operation.</dd>

</dl>
<h4>
  <a name="1059262"> </a>Returns 
</h4>

<p><a name="1059263"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059267"> </a>Comments 
</h4>

<p><a name="1059268"> </a>This function initializes a streaming hash operation. To feed data to the stream, you call <a href="CryptoManager.html#1059280"><code>CPMLibHashUpdate()</code></a> followed by <a href="CryptoManager.html#1059201"><code>CPMLibHashFinal()</code></a>. The "update" function is optional; the "final" function is mandatory. For a block hash, see <a href="CryptoManager.html#1059160"><code>CPMLibHash()</code></a>. </p>

<h3 class="hbH3">
  <a name="1059280"> </a>CPMLibHashUpdate Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059282"> </a>Purpose 
</h4>

<p><a name="1059283"> </a>Sends data to streaming hash operation.</p>
<h4>
  <a name="1059284"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059285"> </a></code><h4>
  <a name="1059286"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059287"></a>Err CPMLibHashUpdate (
    UInt16 libRef,
   APHashInfoType *hashInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength
)
</pre>
<h4>
  <a name="1059288"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059289"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059290"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059291"> </a><code>&rarr;  <i><code>hashInfo</code></i></code></dt>
<dd><a name="1059295"> </a>A pointer to the <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> that was returned by <a href="CryptoManager.html#1059246"><code>CPMLibHashInit()</code></a>.</dd>

<dt><a name="1059299"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1059300"> </a>A pointer to the data that you want to hash. </dd>

<dt><a name="1059301"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1059302"> </a>The length of <code>inBuffer</code>, in bytes.</dd>

</dl>
<h4>
  <a name="1059303"> </a>Returns 
</h4>

<p><a name="1059304"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059308"> </a>Comments 
</h4>

<p><a name="1059309"> </a>This function feeds data into the streaming hash session that was started by <a href="CryptoManager.html#1059246"><code>CPMLibHashInit()</code></a>. You can make any number of <code>CPMLibHashUpdate</code> calls while the hash stream is open. When you've finished feeding data into the stream, you call <a href="CryptoManager.html#1059201"><code>CPMLibHashFinal()</code></a>. </p>

<p><a name="1059316"> </a>Note that this function doesn't return any hashed data. All the data that's hashed by the stream is returned through the <a href="CryptoManager.html#1059201"><code>CPMLibHashFinal()</code></a> call.</p>

<h3 class="hbH3">
  <a name="1059322"> </a>CPMLibImportCipherInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059324"> </a>Purpose 
</h4>

<p><a name="1059325"> </a>Imports a previously-exported cipher info structure so that it can be used in subsequent operations.</p>
<h4>
  <a name="1059326"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059327"> </a></code><h4>
  <a name="1059328"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059329"></a>Err CPMLibImportCipherInfo (
    UInt16 libRef,
   UInt8 encoding,
   UInt8 *importData,
   UInt32 importDataLength,
   APCipherInfoType *cipherInfo 
)
</pre>
<h4>
  <a name="1059330"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059331"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059332"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059333"> </a><code>&rarr;  <i><code>encoding</code></i></code></dt>
<dd><a name="1059334"> </a>Constant that specifies the encoding type that was used to export the key. One of <code>IMPORT_EXPORT_RAW</code>, <code>IMPORT_EXPORT_DER</code>, or <code>IMPORT_EXPORT_XML</code>. See <a href="CryptoManager.html#1057910"><code>Export Encoding Constants</code></a> for details about these formats.</dd>

<dt><a name="1059338"> </a><code>&rarr;  <i><code>importData</code></i></code></dt>
<dd><a name="1059339"> </a>The encoded data.</dd>

<dt><a name="1059340"> </a><code>&rarr;  <i><code>importDataLength</code></i></code></dt>
<dd><a name="1059341"> </a>The length of <code>importData</code>, in bytes.</dd>

<dt><a name="1059342"> </a><code>&larr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1059346"> </a><a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that returns the imported key. The structure must be allocated before it's passed in.</dd>

</dl>
<h4>
  <a name="1059347"> </a>Returns 
</h4>

<p><a name="1059348"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059354"> </a>CPMLibImportHashInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059356"> </a>Purpose 
</h4>

<p><a name="1059357"> </a>Imports a previously-exported hash info structure so that it can be used in subsequent operations.</p>
<h4>
  <a name="1059358"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059359"> </a></code><h4>
  <a name="1059360"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059361"></a>Err CPMLibImportHashInfo (
    UInt16 libRef,
   UInt8 encoding,
   UInt8 *importData,
   UInt32 importDataLength,
   APHashInfoType *keyInfo 
)
</pre>
<h4>
  <a name="1059362"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059363"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059364"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059365"> </a><code>&rarr;  <i><code>encoding</code></i></code></dt>
<dd><a name="1059366"> </a>Constant that specifies the encoding type that was used to export the key. One of <code>IMPORT_EXPORT_RAW</code>, <code>IMPORT_EXPORT_DER</code>, or <code>IMPORT_EXPORT_XML</code>. See <a href="CryptoManager.html#1057910"><code>Export Encoding Constants</code></a> for details about these formats.</dd>

<dt><a name="1059370"> </a><code>&rarr;  <i><code>importData</code></i></code></dt>
<dd><a name="1059371"> </a>The encoded data.</dd>

<dt><a name="1059372"> </a><code>&rarr;  <i><code>importDataLength</code></i></code></dt>
<dd><a name="1059373"> </a>The length of <code>importData</code>, in bytes.</dd>

<dt><a name="1059374"> </a><code>&larr;  <i><code>hashInfo</code></i></code></dt>
<dd><a name="1059378"> </a><a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> that returns the imported hash info. The structure must be allocated before it's passed in.</dd>

</dl>
<h4>
  <a name="1059379"> </a>Returns 
</h4>

<p><a name="1059380"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059386"> </a>CPMLibImportKeyInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059388"> </a>Purpose 
</h4>

<p><a name="1059389"> </a>Imports a previously-exported key so that it (the key) can be used in subsequent operations.</p>
<h4>
  <a name="1059390"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059391"> </a></code><h4>
  <a name="1059392"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059393"></a>Err CPMLibImportKeyInfo (
    UInt16 libRef,
   UInt8 encoding,
   UInt8 *importData,
   UInt32 importDataLength,
   APKeyInfoType *keyInfo 
)
</pre>
<h4>
  <a name="1059394"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059395"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059396"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059397"> </a><code>&rarr;  <i><code>encoding</code></i></code></dt>
<dd><a name="1059398"> </a>Constant that specifies the encoding type that was used to export the key. One of <code>IMPORT_EXPORT_RAW</code>, <code>IMPORT_EXPORT_DER</code>, or <code>IMPORT_EXPORT_XML</code>. See <a href="CryptoManager.html#1057910"><code>Export Encoding Constants</code></a> for details about these formats.</dd>

<dt><a name="1059402"> </a><code>&rarr;  <i><code>importData</code></i></code></dt>
<dd><a name="1059403"> </a>The encoded data.</dd>

<dt><a name="1059404"> </a><code>&rarr;  <i><code>importDataLength</code></i></code></dt>
<dd><a name="1059405"> </a>The length of <code>importData</code>, in bytes.</dd>

<dt><a name="1059406"> </a><code>&larr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1059410"> </a><a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that returns the imported key. The structure must be allocated before it's passed in.</dd>

</dl>
<h4>
  <a name="1059411"> </a>Returns 
</h4>

<p><a name="1059412"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059418"> </a>CPMLibImportVerifyInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059420"> </a>Purpose 
</h4>

<p><a name="1059421"> </a>Imports a previously-exported verify info structure so that it can be used in subsequent operations.</p>
<h4>
  <a name="1059422"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059423"> </a></code><h4>
  <a name="1059424"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059425"></a>Err CPMLibImportVerifyInfo (
    UInt16 libRef,
   UInt8 encoding,
   UInt8 *importData,
   UInt32 importDataLength,
   APVerifyInfoType *keyInfo 
)
</pre>
<h4>
  <a name="1059426"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059427"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059428"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059429"> </a><code>&rarr;  <i><code>encoding</code></i></code></dt>
<dd><a name="1059430"> </a>Constant that specifies the encoding type that was used to export the key. One of <code>IMPORT_EXPORT_RAW</code>, <code>IMPORT_EXPORT_DER</code>, or <code>IMPORT_EXPORT_XML</code>. See <a href="CryptoManager.html#1057910"><code>Export Encoding Constants</code></a> for details about these formats.</dd>

<dt><a name="1059434"> </a><code>&rarr;  <i><code>importData</code></i></code></dt>
<dd><a name="1059435"> </a>The encoded data.</dd>

<dt><a name="1059436"> </a><code>&rarr;  <i><code>importDataLength</code></i></code></dt>
<dd><a name="1059437"> </a>The length of <code>importData</code>, in bytes.</dd>

<dt><a name="1059438"> </a><code>&larr;  <i><code>verifyInfo</code></i></code></dt>
<dd><a name="1059442"> </a><a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a> that returns the imported verify info. The structure must be allocated before it's passed in.</dd>

</dl>
<h4>
  <a name="1059443"> </a>Returns 
</h4>

<p><a name="1059444"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059450"> </a>CPMLibReleaseCipherInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059452"> </a>Purpose 
</h4>

<p><a name="1059456"> </a>Releases a <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a>, allowing you to free it.</p>
<h4>
  <a name="1059457"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059458"> </a></code><h4>
  <a name="1059459"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059460"></a>Err CPMLibReleaseCipherInfo (
    UInt16 libRef,
   APCipherInfoType *cipherInfo 
)
</pre>
<h4>
  <a name="1059461"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059462"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059463"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059464"> </a><code>&rarr;  <i><code>cipherInfo</code></i></code></dt>
<dd><a name="1059468"> </a>A pointer to a <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> that you want to release.</dd>

</dl>
<h4>
  <a name="1059469"> </a>Returns 
</h4>

<p><a name="1059470"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059476"> </a>CPMLibReleaseHashInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059478"> </a>Purpose 
</h4>

<p><a name="1059482"> </a>Releases a <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a>, allowing you to free it.</p>
<h4>
  <a name="1059483"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059484"> </a></code><h4>
  <a name="1059485"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059486"></a>Err CPMLibReleaseHashInfo (
    UInt16 libRef,
   APHashInfoType *hashInfo 
)
</pre>
<h4>
  <a name="1059487"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059488"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059489"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059490"> </a><code>&rarr;  <i><code>hashInfo</code></i></code></dt>
<dd><a name="1059494"> </a>A pointer to a <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> that you want to release.</dd>

</dl>
<h4>
  <a name="1059495"> </a>Returns 
</h4>

<p><a name="1059496"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059502"> </a>CPMLibReleaseKeyInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059504"> </a>Purpose 
</h4>

<p><a name="1059508"> </a>Releases a <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a>, allowing you to free it.</p>
<h4>
  <a name="1059509"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059510"> </a></code><h4>
  <a name="1059511"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059512"></a>Err CPMLibReleaseKeyInfo (
    UInt16 libRef,
   APKeyInfoType *keyInfo 
)
</pre>
<h4>
  <a name="1059513"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059514"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059515"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059516"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1059520"> </a>A pointer to the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that you want to release.</dd>

</dl>
<h4>
  <a name="1059521"> </a>Returns 
</h4>

<p><a name="1059522"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059528"> </a>CPMLibReleaseVerifyInfo Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059530"> </a>Purpose 
</h4>

<p><a name="1059534"> </a>Releases a <a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a>, allowing you to free it.</p>
<h4>
  <a name="1059535"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059536"> </a></code><h4>
  <a name="1059537"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059538"></a>Err CPMLibReleaseVerifyInfo (
    UInt16 libRef,
   APVerifyInfoType *verifyInfo 
)
</pre>
<h4>
  <a name="1059539"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059540"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059541"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059542"> </a><code>&rarr;  <i><code>verifyInfo</code></i></code></dt>
<dd><a name="1059546"> </a>A pointer to a <a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a> that you want to release.</dd>

</dl>
<h4>
  <a name="1059547"> </a>Returns 
</h4>

<p><a name="1059548"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>

<h3 class="hbH3">
  <a name="1059554"> </a>CPMLibVerify Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059556"> </a>Purpose 
</h4>

<p><a name="1059557"> </a>Verifies a message.</p>
<h4>
  <a name="1059558"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059559"> </a></code><h4>
  <a name="1059560"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059561"></a>Err CPMLibVerify (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APVerifyInfoType *verifyInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength,
   UInt8 *signature,
   UInt32 signatureLength,
   VerifyResultType *verifyResult 
)
</pre>
<h4>
  <a name="1059562"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059563"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059564"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059565"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1059569"> </a>An <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that represents the certificate's encryption key. Extracting the key data from the certificate and constructing the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> (through <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>) is the caller's responsibility.</dd>

<dt><a name="1059576"> </a><code>&rarr;  <i><code>verifyInfo</code></i></code></dt>
<dd><a name="1059580"> </a>A pointer to an <a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a> that specifies the hash and cipher operations that should be performed during verification. This information is embedded as <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> and <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> structures. If you want to use the default operations, allocate and zero the embedded structures. When the function returns, the structures will be populated with information describing the operations that were used.</dd>

<dt><a name="1059587"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1059588"> </a>A pointer to the message data.</dd>

<dt><a name="1059589"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1059590"> </a>The length of <code>inBuffer</code>, in bytes.</dd>

<dt><a name="1059591"> </a><code>&larr;  <i><code>outBuffer</code></i></code></dt>
<dd><a name="1059592"> </a>A pointer to the buffer where the decrypted signature will be copied. The buffer must be allocated by the caller, and must be big enough to accommodate all of the decrypted data. If you don't care about the signature, pass <code>NULL</code>.</dd>

<dt><a name="1059593"> </a><code>&harr;  <i><code>outBufferLength</code></i></code></dt>
<dd><a name="1059594"> </a>If <code>outBuffer</code> is <code>NULL</code>, set this to 0. Otherwise, you pass in the (allocated) length of <code>outBuffer</code>, in bytes. The function resets the argument to the amount of data that was actually copied into <code>outBuffer. </code>If the function returns <code>cpmErrBufTooSmall</code>, <code>outBufferLength</code> is set to the minimum buffer size that's needed to accommodate the verified data.</dd>

<dt><a name="1059595"> </a><code>&rarr;  <i><code>signature</code></i></code></dt>
<dd><a name="1059596"> </a>A pointer to the message's signature. Extracting the signature from the message is the caller's responsibility</dd>

<dt><a name="1059597"> </a><code>&rarr;  <i><code>signatureLength</code></i></code></dt>
<dd><a name="1059598"> </a>The length of the signature, in bytes.</dd>

<dt><a name="1059599"> </a><code>&larr;  <i><code>verifyResult</code></i></code></dt>
<dd><a name="1059600"> </a>An integer point that returns, by reference, the result of the verification. 0 means the message was verified; non-zero means is wasn't. The meaning of a non-zero return is defined by the algorithm provider.</dd>

</dl>
<h4>
  <a name="1059601"> </a>Returns 
</h4>

<p><a name="1059602"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059606"> </a>Comments 
</h4>

<p><a name="1059607"> </a>This function performs a block verifcation operation. For stream verification, use <a href="CryptoManager.html#1059662"><code>CPMLibVerifyInit()</code></a>.</p>

<p><a name="1059611"> </a>Keep in mind that a direct return of <code>errNone</code> doesn't mean that the message has been verified. The verification status is returned by reference in <code>verifyResult</code>.</p>

<h3 class="hbH3">
  <a name="1059614"> </a>CPMLibVerifyFinal Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059616"> </a>Purpose 
</h4>

<p><a name="1059617"> </a>Finalizes a verify session.</p>
<h4>
  <a name="1059618"> </a>Declared In 
</h4>
<code>CPMLib.h<a name="1059619"> </a></code><h4>
  <a name="1059620"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059621"></a>Err CPMLibVerifyFinal (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APVerifyInfoType *verifyInfo,
   UInt8 *inBuffer,
   UInt32 inBufferLength,
   UInt8 *outBuffer,
   UInt32 *outBufferLength,
   UInt8 *signature,
   UInt32 signatureLength,
   VerifyResultType *verifyResult 
)
</pre>
<h4>
  <a name="1059622"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059623"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059624"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059625"> </a><code>&rarr;  <i><code>verifyInfo</code></i></code></dt>
<dd><a name="1059629"> </a>A pointer to the <a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a> that was returned by <a href="CryptoManager.html#1059662"><code>CPMLibVerifyInit()</code></a>.</dd>

<dt><a name="1059633"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1059634"> </a>A pointer to the final buffer of message data, or <code>NULL</code> if there's no more data..</dd>

<dt><a name="1059635"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1059636"> </a>The length of <code>inBuffer</code>, in bytes.</dd>

<dt><a name="1059637"> </a><code>&larr;  <i><code>outBuffer</code></i></code></dt>
<dd><a name="1059638"> </a>A pointer to the buffer where the decrypted signature will be copied. The buffer must be allocated by the caller, and must be big enough to accommodate all of the decrypted data. If you don't care about the signature, pass <code>NULL</code>.</dd>

<dt><a name="1059639"> </a><code>&harr;  <i><code>outBufferLength</code></i></code></dt>
<dd><a name="1059640"> </a>If <code>outBuffer</code> is <code>NULL</code>, set this to 0. Otherwise, you pass in the (allocated) length of <code>outBuffer</code>, in bytes. The function resets the argument to the amount of data that was actually copied into <code>outBuffer. </code>If the function returns <code>cpmErrBufTooSmall</code>, <code>outBufferLength</code> is set to the minimum buffer size that's needed to accommodate the verified data.</dd>

<dt><a name="1059641"> </a><code>&rarr;  <i><code>signature</code></i></code></dt>
<dd><a name="1059642"> </a>A pointer to the message's signature. Extracting the signature from the message is the caller's responsibility</dd>

<dt><a name="1059643"> </a><code>&rarr;  <i><code>signatureLength</code></i></code></dt>
<dd><a name="1059644"> </a>The length of the signature, in bytes.</dd>

<dt><a name="1059645"> </a><code>&larr;  <i><code>verifyResult</code></i></code></dt>
<dd><a name="1059646"> </a>An integer point that returns, by reference, the result of the verification. 0 means the message was verified; non-zero means is wasn't. The meaning of a non-zero return is defined by the algorithm provider.</dd>

</dl>
<h4>
  <a name="1059647"> </a>Returns 
</h4>

<p><a name="1059648"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059652"> </a>Comments 
</h4>

<p><a name="1059653"> </a>This function feeds a final (optional) buffer of message into a verify stream that was previously initialized by <a href="CryptoManager.html#1059662"><code>CPMLibVerifyInit()</code></a> and augmented through successive calls to <a href="CryptoManager.html#1059713"><code>CPMLibVerifyUpdate()</code></a>. The entire message is then verified, the results of the verification are returned in <code>verifyResult</code>, and the stream is closed.</p>

<h3 class="hbH3">
  <a name="1059662"> </a>CPMLibVerifyInit Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059664"> </a>Purpose 
</h4>

<p><a name="1059665"> </a>Initiates a streaming verify operation.</p>
<h4>
  <a name="1059666"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059667"> </a></code><h4>
  <a name="1059668"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059669"></a>Err CPMLibVerify (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APVerifyInfoType *verifyInfo 
)
</pre>
<h4>
  <a name="1059670"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059671"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059672"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059673"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1059677"> </a>An <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that represents the certificate's encryption key. Extracting the key data from the certificate and constructing the <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> (through <a href="CryptoManager.html#1059386"><code>CPMLibImportKeyInfo()</code></a>) is the caller's responsibility.</dd>

<dt><a name="1059684"> </a><code>&rarr;  <i><code>verifyInfo</code></i></code></dt>
<dd><a name="1059688"> </a>A pointer to an <a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a> that specifies the hash and cipher operations that should be performed during verification. This information is embedded as <a href="CryptoManager.html#1058215"><code>APHashInfoStruct</code></a> and <a href="CryptoManager.html#1058143"><code>APCipherInfoStruct</code></a> structures. If you want to use the default operations, allocate and zero the embedded structures. When the function returns, the structures will be populated with information describing the operations that were used.</dd>

</dl>
<h4>
  <a name="1059695"> </a>Returns 
</h4>

<p><a name="1059696"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059700"> </a>Comments 
</h4>

<p><a name="1059701"> </a>This function initializes a streaming hash operation. To feed data to the stream, you call <a href="CryptoManager.html#1059713"><code>CPMLibVerifyUpdate()</code></a> followed by <a href="CryptoManager.html#1059614"><code>CPMLibVerifyFinal()</code></a>. The "update" function is optional; the "final" function is mandatory. For a block hash, see <a href="CryptoManager.html#1059554"><code>CPMLibVerify()</code></a>. </p>

<h3 class="hbH3">
  <a name="1059713"> </a>CPMLibVerifyUpdate Function <a href="#1057664"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1059715"> </a>Purpose 
</h4>

<p><a name="1059716"> </a>Sends message data to a streaming verify operation.</p>
<h4>
  <a name="1059717"> </a>Declared In 
</h4>
<code>CPMLib68KInterface.h, CPMLibArmInterface.h<a name="1059718"> </a></code><h4>
  <a name="1059719"> </a>Prototype 
</h4>
<pre class="proto"><a name="1059720"></a>Err CPMLibVerifyUpdate (
    UInt16 libRef,
   APKeyInfoType *keyInfo,
   APVerifyInfoType *verifyInfo 
)UInt8 *inBuffer,
   UInt32 inBufferLength
)
</pre>
<h4>
  <a name="1059721"> </a>Parameters 
</h4>

<dl>
<dt><a name="1059722"> </a><code>&rarr;  <i><code>libRef</code></i></code></dt>
<dd><a name="1059723"> </a>CPM Library reference number (68k only).</dd>

<dt><a name="1059724"> </a><code>&rarr;  <i><code>keyInfo</code></i></code></dt>
<dd><a name="1059728"> </a>The <a href="CryptoManager.html#1058278"><code>APKeyInfoStruct</code></a> that was used in the <a href="CryptoManager.html#1059662"><code>CPMLibVerifyInit()</code></a> call.</dd>

<dt><a name="1059732"> </a><code>&rarr;  <i><code>verifyInfo</code></i></code></dt>
<dd><a name="1059736"> </a>A pointer to the <a href="CryptoManager.html#1058411"><code>APVerifyInfoStruct</code></a> that was returned by <a href="CryptoManager.html#1059662"><code>CPMLibVerifyInit()</code></a>.</dd>

<dt><a name="1059740"> </a><code>&rarr;  <i><code>inBuffer</code></i></code></dt>
<dd><a name="1059741"> </a>A pointer to the message data. </dd>

<dt><a name="1059742"> </a><code>&rarr;  <i><code>inBufferLength</code></i></code></dt>
<dd><a name="1059743"> </a>The length of <code>inBuffer</code>, in bytes.</dd>

</dl>
<h4>
  <a name="1059744"> </a>Returns 
</h4>

<p><a name="1059745"> </a>The function returns <code>errNone</code> upon success. For other error codes, see <a href="CryptoManager.html#1088183">CPM Error Codes</a>.</p>
<h4>
  <a name="1059749"> </a>Comments 
</h4>

<p><a name="1059750"> </a>This function feeds message data into the verify stream that was intialized by <a href="CryptoManager.html#1059662"><code>CPMLibVerifyInit()</code></a>. When you're finished feeding data into the stream, call <a href="CryptoManager.html#1059614"><code>CPMLibVerifyFinal()</code></a> to close the stream and return the verification results.</p>

<p><a name="1059823"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996-2004, PalmSource, Inc. and its affiliates.  All rights reserved. <br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="Reference_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="ReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="BtLibRef_Sockets.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SmsLib.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ReferenceIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>