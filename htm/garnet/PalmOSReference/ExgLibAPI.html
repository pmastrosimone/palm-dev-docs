<html>
<head>
<title>(68K) Exchange Library | Palm OS&#174; Programmer's  API Reference</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 10:46:54">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="1069165"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="ReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ExchangeManager.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="IRLib.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ReferenceIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">63 &nbsp;&nbsp;
Exchange Library</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Palm OS&#174; Programmer's  API Reference</p>
<p class="SubTitle">Palm OS&#174; 68K SDK </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="PartIII.html">Part III: Communications</a> </h1>
<h1 class="SideTOC1"><a href="ExgLibAPI.html">63  Exchange Library</a></h1>

   <h2 class="SideTOC2"><a href="#1069177">
   Exchange Library Functions</a></h2>

      <h3 class="SideTOC3"><a href="#1069180">
      ExgLibAccept</a></h3>

      <h3 class="SideTOC3"><a href="#1069221">
      ExgLibClose</a></h3>

      <h3 class="SideTOC3"><a href="#1069237">
      ExgLibConnect</a></h3>

      <h3 class="SideTOC3"><a href="#1069286">
      ExgLibControl</a></h3>

      <h3 class="SideTOC3"><a href="#1069325">
      ExgLibDisconnect</a></h3>

      <h3 class="SideTOC3"><a href="#1069386">
      ExgLibGet</a></h3>

      <h3 class="SideTOC3"><a href="#1069430">
      ExgLibHandleEvent</a></h3>

      <h3 class="SideTOC3"><a href="#1069454">
      ExgLibOpen</a></h3>

      <h3 class="SideTOC3"><a href="#1069470">
      ExgLibPut</a></h3>

      <h3 class="SideTOC3"><a href="#1069533">
      ExgLibReceive</a></h3>

      <h3 class="SideTOC3"><a href="#1069581">
      ExgLibRequest</a></h3>

      <h3 class="SideTOC3"><a href="#1069614">
      ExgLibSend</a></h3>

      <h3 class="SideTOC3"><a href="#1069660">
      ExgLibSleep</a></h3>

      <h3 class="SideTOC3"><a href="#1069679">
      ExgLibWake</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1069170"> </a>The Exchange Library API described in this chapter and declared in <code>ExgLib.h</code> specifies a minimal set of functions that all exchange libraries must implement. This chapter is directed towards developers who use or create exchange libraries. Developers creating an exchange library should also read the <a href="../PalmOSCompanion2/ExchangeLibraries.html#1001417">Exchange Libraries</a> chapter of the <i>Palm OS Programmer's Companion</i>, vol. II, <i>Communications</i>.</p>

<h2 class="haH2">
  <a name="1069177"> </a>Exchange Library Functions <a href="#1069165"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1069180"> </a>ExgLibAccept Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069182"> </a>Purpose 
</h4>

<p><a name="1069183"> </a>Accept an incoming connection.</p>
<h4>
  <a name="1069184"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069185"> </a></code><h4>
  <a name="1069186"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069187"></a>Err ExgLibAccept(
   UInt16 libRefnum,
   ExgSocketType *exgSocketP
)
</pre>
<h4>
  <a name="1069188"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069189"> </a><code>&rarr;  <i><code>libRefnum</code></i></code></dt>
<dd><a name="1069190"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069191"> </a><code>&rarr;  <i><code>exgSocketP</code></i></code></dt>
<dd><a name="1069195"> </a>A pointer to the socket structure (see <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a>).</dd>

</dl>
<h4>
  <a name="1069196"> </a>Returns 
</h4>

<p><a name="1069197"> </a>Returns <code>errNone</code> if no error. <code>exgErrNotSupported</code> is returned if a preview is in progress and the exchange library does not support preview. Other error codes are defined by each exchange library.</p>
<h4>
  <a name="1069198"> </a>Comments 
</h4>

<p><a name="1069202"> </a>The Exchange Manager's <a href="ExchangeManager.html#1055291"><code>ExgAccept()</code></a> function simply calls <code>ExgLibAccept</code> in the exchange library identified by the <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure passed to <code>ExgAccept</code>. An application calls the Exchange Manager's <code>ExgAccept</code> function when:</p>
<ul type="disc">
  <li><a name="1069206"> </a>The application wants to initiate a connection to receive data, which it does in response to <code>sysAppLaunchCmdExgReceiveData</code>.
  <li><a name="1069207"> </a>The application wants to initiate a connection to receive a preview of the data, which it does in response to <code>sysAppLaunchCmdExgAskUser</code>.
</ul>

<p><a name="1069208"> </a>Any implementation of <code>ExgLibAccept</code> should update any progress dialogs to indicate that data is being accepted (or received) into an application.</p>
<h4>
  <a name="1069209"> </a>Compatibility 
</h4>

<p><a name="1069213"> </a>Implemented only if <a href="CompatibilityApdx.html#995256">4.0 New Feature Set</a> is present.</p>
<h4>
  <a name="1069214"> </a>See Also 
</h4>

<p><a name="1069218"> </a><a href="ExgLibAPI.html#1069470"><code>ExgLibPut()</code></a></p>

<h3 class="hbH3">
  <a name="1069221"> </a>ExgLibClose Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069223"> </a>Purpose 
</h4>

<p><a name="1069224"> </a>Library-specific. Although this function is not called by the Exchange Manager, all shared libraries normally implement it.</p>
<h4>
  <a name="1069225"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069226"> </a></code><h4>
  <a name="1069227"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069228"></a>Err ExgLibClose (
   UInt16 libRefnum
)
</pre>
<h4>
  <a name="1069230"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069231"> </a><code>&rarr;  <i><code>libRefnum</code></i></code></dt>
<dd><a name="1069232"> </a>Reference number of this exchange library.</dd>

</dl>
<h4>
  <a name="1069233"> </a>Comments 
</h4>

<p><a name="1069234"> </a>Exchange libraries are free to implement this function for internal or external use. The Exchange Manager does not call it.</p>

<h3 class="hbH3">
  <a name="1069237"> </a>ExgLibConnect Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069239"> </a>Purpose 
</h4>

<p><a name="1069240"> </a>Open a connection in preparation for sending or receiving objects.</p>
<h4>
  <a name="1069241"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069242"> </a></code><h4>
  <a name="1069243"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069244"></a>Err ExgLibConnect(
   UInt16 libRefNum,
   ExgSocketType *exgSocketP
)
</pre>
<h4>
  <a name="1069245"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069246"> </a><code>&rarr;  <i><code>libRefNum</code></i></code></dt>
<dd><a name="1069247"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069248"> </a><code>&harr;  <i><code>exgSocketP</code></i></code></dt>
<dd><a name="1069252"> </a>A pointer to an <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure identifying the socket through which objects will be sent or received.</dd>

</dl>
<h4>
  <a name="1069253"> </a>Returns 
</h4>

<p><a name="1069254"> </a>Returns <code>errNone</code> if no error. If <code>ExgLibConnect</code> is not supported by this library, this function returns <code>exgErrNotSupported</code>; if its use is optional, <code>errNone</code> is returned. Other error codes are defined by each exchange library.</p>
<h4>
  <a name="1069255"> </a>Comments 
</h4>

<p><a name="1069256"> </a>The Exchange Manager may call this function to initiate a connection for sending multiple objects or for performing two-way communications. Some exchange libraries support sending multiple objects but do not support this call. See <a href="../PalmOSCompanion2/ExchangeManagerConcept.html#996388">"Sending Multiple Objects"</a> of <i>Palm OS Programmer's Companion</i>, vol. II, <i>Communications</i> for more information. </p>

<p><a name="1069263"> </a>Not all exchange libraries support this operation. In this case, the first call to <a href="ExgLibAPI.html#1069470"><code>ExgLibPut()</code></a> must clean up after itself before returning an error. The exchange library should not expect to get an <a href="ExgLibAPI.html#1069325"><code>ExgLibDisconnect()</code></a> call.</p>

<p><a name="1069270"> </a>If <code>ExgLibConnect</code> is supported and an application calls <a href="ExchangeManager.html#1055367"><code>ExgConnect()</code></a>, the exchange library should delay any cleanup until <code>ExgLibDisconnect</code>, unless <code>ExgLibConnect</code> returns an error, in which case it should clean up after itself. The library can expect to get an <code>ExgLibDisconnect</code> call if it returns <code>errNone</code> from <code>ExgLibConnect</code>. If the application does not call <code>ExgConnect</code>, the first call to <code>ExgLibPut</code> must clean up after itself before returning an error and the exchange library should not expect to get an <code>ExgLibDisconnect</code> call.</p>

<p><a name="1069274"> </a>The Exchange Manager's <code>ExgConnect</code> function calls <code>ExgLibConnect</code> in the exchange library identified by the <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure passed to <code>ExgConnect</code>. If <code>ExgLibConnect</code> is implemented to return <code>exgErrNotEnoughPower</code>, the Exchange Manager puts up an alert, so there is no need for the exchange library to do so. Other error codes are not treated specially by the Exchange Manager; the exchange library must put up its own alerts when appropriate.</p>

<p><a name="1069278"> </a>The exchange library may prompt the user for addressing information.</p>
<h4>
  <a name="1069279"> </a>Compatibility 
</h4>

<p><a name="1069283"> </a>Implemented only if <a href="CompatibilityApdx.html#995256">4.0 New Feature Set</a> is present.</p>

<h3 class="hbH3">
  <a name="1069286"> </a>ExgLibControl Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069288"> </a>Purpose 
</h4>

<p><a name="1069289"> </a>Supply information about the exchange library.</p>
<h4>
  <a name="1069290"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069291"> </a></code><h4>
  <a name="1069292"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069294"></a>Err ExgLibControl(
   UInt16 libRefNum,
   UInt16 op,
   void *valueP,
   UInt16 *valueLenP
)
</pre>
<h4>
  <a name="1069295"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069296"> </a><code>&rarr;  <i><code>libRefNum</code></i></code></dt>
<dd><a name="1069297"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069298"> </a><code>&rarr;  <i><code>op</code></i></code></dt>
<dd><a name="1069299"> </a>The operation to perform.</dd>

<dt><a name="1069300"> </a><code>&harr;  <i><code>valueP</code></i></code></dt>
<dd><a name="1069301"> </a>An operation specific parameter. See comments below.</dd>

<dt><a name="1069302"> </a><code>&harr;  <i><code>valueLenP</code></i></code></dt>
<dd><a name="1069303"> </a>An operation specific parameter. See comments below.</dd>

</dl>
<h4>
  <a name="1069304"> </a>Returns 
</h4>

<p><a name="1069305"> </a>Returns <code>errNone</code> if no error. <code>exgErrNotSupported</code> is returned if the specified operation is not supported by the exchange library. <code>exgErrBadParam</code> is returned if the parameters (<code>valueP</code> and <code>valueLenP</code>) are not appropriate for the operation. Additional error codes are defined by each exchange library.</p>
<h4>
  <a name="1069306"> </a>Comments 
</h4>

<p><a name="1069307"> </a><code>ExgLibControl</code> is a general purpose function that performs various minor operations based upon a selector. E<code>xgMgr.h</code> defines three selectors: <code>exgLibCtlGetTitle</code>, which should be supported by all exchange libraries, <code>exgLibCtlGetVersion</code>, and <code>exgLibCtlGetPreview</code>. Additional library-specific selectors should be numbered starting at <code>exgLibCtlSpecificOp</code> (0x8000).</p>

<p><a name="1069308"> </a>Upon receiving <code>exgLibCtlGetTitle</code>, the exchange library must return a library title suitable for use in Exchange Manager dialogs. Exchange libraries that are built as applications should generally return their <code>'tAIN'</code> resource as their title. Be sure that the title returned through <code>valueP</code> honors the maximum length specified in <code>valueLenP</code>. </p>

<p><a name="1069309"> </a>An exchange library that implements the Palm OS 4.0 version of the Exchange Library API needn't do anything special upon receiving <code>exgLibCtlGetVersion</code>; it should simply return <code>exgErrNotSupported</code>. Otherwise, set <code>valueP</code> to a two-byte value indicating the API version number and return <code>errNone</code>. Note that a version number of zero corresponds to the Palm OS 4.0 version of the Exchange Library API.</p>

<p><a name="1069310"> </a>The <code>exgLibCtlGetPreview</code> operation is used by the Exchange Manager to determine whether a given exchange library supports preview. The Exchange Manager assumes that an exchange library supports preview if the exchange library doesn't implement this operation. To indicate that a library does not support preview, set <code>valueP</code> to <code>false</code> and return <code>errNone</code>.</p>

<p><a name="1069314"> </a>The Exchange Manager's <a href="ExchangeManager.html#1055470"><code>ExgControl()</code></a> function simply calls <code>ExgLibControl</code> in the exchange library identified by the <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure passed to <code>ExgControl</code>.</p>
<h4>
  <a name="1069318"> </a>Compatibility 
</h4>

<p><a name="1069322"> </a>Implemented only if <a href="CompatibilityApdx.html#995256">4.0 New Feature Set</a> is present.</p>

<h3 class="hbH3">
  <a name="1069325"> </a>ExgLibDisconnect Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069327"> </a>Purpose 
</h4>

<p><a name="1069331"> </a>Disconnect a connection made with <a href="ExgLibAPI.html#1069237"><code>ExgLibConnect()</code></a>, <a href="ExgLibAPI.html#1069180"><code>ExgLibAccept()</code></a>, <a href="ExgLibAPI.html#1069470"><code>ExgLibPut()</code></a>, or <a href="ExgLibAPI.html#1069386"><code>ExgLibGet()</code></a>.</p>
<h4>
  <a name="1069341"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069342"> </a></code><h4>
  <a name="1069343"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069345"></a>Err ExgLibDisconnect(
   UInt16 libRefnum,
   ExgSocketType *exgSocketP,
   Err error
)
</pre>
<h4>
  <a name="1069346"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069347"> </a><code>&rarr;  <i><code>libRefnum</code></i></code></dt>
<dd><a name="1069348"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069349"> </a><code>&rarr;  <i><code>exgSocketP</code></i></code></dt>
<dd><a name="1069353"> </a>A pointer to an <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure identifying the socket connection to be disconnected.</dd>

<dt><a name="1069354"> </a><code>&rarr;  <i><code>error</code></i></code></dt>
<dd><a name="1069355"> </a>The current error state. Used to indicate why the connection is being broken, for example, user cancel or out of memory.</dd>

</dl>
<h4>
  <a name="1069356"> </a>Returns 
</h4>

<p><a name="1069357"> </a>Typically the same error code passed in. However, this function may return an error even if <code>errNone</code> is passed in.</p>
<h4>
  <a name="1069358"> </a>Comments 
</h4>

<p><a name="1069359"> </a><code>ExgLibDisconnect</code> may be used to finish reading the data during a preview; in this case, the connection, if any, is not shut down.</p>

<p><a name="1069360"> </a>Applications call <code>ExgLibDisconnect</code> when all data has been sent or the application wants to stop the send process. If the send data process is not completed, the caller should pass an error parameter indicating why the operation was stopped. <code>ExgLibDisconnect</code> is responsible for completing the operation and closing any communication ports if necessary. If data was buffered for sending in <code>ExgLibSend</code>, then the disconnect process may actually perform the entire transmit operation. It is important to note that the <code>ExgLibDisconnect</code> function can be called for an <code>ExgLibPut</code>, <code>ExgLibAccept</code> or <code>ExgLibGet</code> function. So it is equally important to keep track of the current operation in the <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a>. If dialogs are displayed, this function must update them as appropriate. If there are errors, <code>ExgLibDisconnect</code> should display them (if allowed by the application).</p>

<p><a name="1069367"> </a>If <a href="ExgLibAPI.html#1069237"><code>ExgLibConnect()</code></a> is not supported, the first call to <a href="ExgLibAPI.html#1069470"><code>ExgLibPut()</code></a> must clean up after itself before returning an error and the exchange library should not expect to get an <code>ExgLibDisconnect</code> call.</p>

<p><a name="1069371"> </a>If <code>ExgLibConnect</code> is supported and an application calls <a href="ExchangeManager.html#1055367"><code>ExgConnect()</code></a>, the exchange library should delay any cleanup until <code>ExgLibDisconnect</code>, unless <code>ExgLibConnect</code> returns an error, in which case it should clean up after itself. The library can expect to get an <code>ExgLibDisconnect</code> call if it returns <code>errNone</code> from <code>ExgLibConnect</code>. If the application does not call <code>ExgConnect</code>, the first call to <code>ExgLibPut</code> must clean up after itself before returning an error and the exchange library should not expect to get an <code>ExgLibDisconnect</code> call.</p>

<p><a name="1069378"> </a>The Exchange Manager's <a href="ExchangeManager.html#1055705"><code>ExgDisconnect()</code></a> function simply calls <code>ExgLibDisconnect</code> in the exchange library identified by the <code>ExgSocketType</code> structure passed to <code>ExgDisconnect</code>.</p>
<h4>
  <a name="1069379"> </a>Compatibility 
</h4>

<p><a name="1069383"> </a>Implemented only if <a href="CompatibilityApdx.html#995256">4.0 New Feature Set</a> is present.</p>

<h3 class="hbH3">
  <a name="1069386"> </a>ExgLibGet Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069388"> </a>Purpose 
</h4>

<p><a name="1069389"> </a>Establish a connection and request data from a remote device.</p>
<h4>
  <a name="1069390"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069391"> </a></code><h4>
  <a name="1069392"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069394"></a>Err ExgLibGet(
   UInt16 libRefNum,
   ExgSocketType *exgSocketP
)
</pre>
<h4>
  <a name="1069395"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069396"> </a><code>&rarr;  <i><code>libRefNum</code></i></code></dt>
<dd><a name="1069397"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069398"> </a><code>&harr;  <i><code>exgSocketP</code></i></code></dt>
<dd><a name="1069402"> </a>A pointer to the socket structure (see <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a>).</dd>

</dl>
<h4>
  <a name="1069403"> </a>Returns 
</h4>

<p><a name="1069404"> </a>Returns <code>errNone</code> if no error. <code>exgErrNotSupported</code> is returned if this operation is not supported by this library. Other error codes are defined by each exchange library.</p>
<h4>
  <a name="1069405"> </a>Comments 
</h4>

<p><a name="1069406"> </a><code>ExgLibGet</code> informs the library that it should make a connection to the remote device and request information from it. When an exchange library's <code>ExgLibGet</code> function is called, it should fetch the requested data and prepare to deliver it when the application calls <a href="ExchangeManager.html#1056545"><code>ExgReceive()</code></a>. After <a href="ExgLibAPI.html#1069533"><code>ExgLibReceive()</code></a> is called, possibly more than once, <a href="ExgLibAPI.html#1069325"><code>ExgLibDisconnect()</code></a> follows.</p>

<p><a name="1069419"> </a>The Exchange Manager's <a href="ExchangeManager.html#1055912"><code>ExgGet()</code></a> function calls <code>ExgLibGet</code> in the exchange library identified in the <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure passed to <code>ExgGet</code>. If an exchange library's implementation of <code>ExgLibGet</code> returns <code>exgErrNotEnoughPower</code>, the Exchange Manager puts up an alert, so there is no need for the exchange library to do so. Other error codes are not treated specially by the Exchange Manager; an exchange library must put up its own alerts when appropriate.</p>
<h4>
  <a name="1069423"> </a>Compatibility 
</h4>

<p><a name="1069427"> </a>Implemented only if <a href="CompatibilityApdx.html#995256">4.0 New Feature Set</a> is present.</p>

<h3 class="hbH3">
  <a name="1069430"> </a>ExgLibHandleEvent Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069432"> </a>Purpose 
</h4>

<p><a name="1069433"> </a>Handle exchange-library-specific events.</p>
<h4>
  <a name="1069434"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069435"> </a></code><h4>
  <a name="1069436"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069438"></a>Boolean ExgLibHandleEvent(
   UInt16 libRefnum,
   void *eventP
)
</pre>
<h4>
  <a name="1069439"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069440"> </a><code>&rarr;  <i><code>libRefnum</code></i></code></dt>
<dd><a name="1069441"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069442"> </a><code>&rarr;  <i><code>eventP</code></i></code></dt>
<dd><a name="1069443"> </a>The event to handle.</dd>

</dl>
<h4>
  <a name="1069444"> </a>Returns 
</h4>

<p><a name="1069445"> </a>Returns <code>true</code> if the event was handled.</p>
<h4>
  <a name="1069446"> </a>Comments 
</h4>

<p><a name="1069447"> </a>Exchange libraries are free to implement this function for internal or external use. The <code>Exchange Manager</code> does not call it.</p>

<h3 class="hbH3">
  <a name="1069454"> </a>ExgLibOpen Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069456"> </a>Purpose 
</h4>

<p><a name="1069457"> </a>Library-specific. Although this function is not called by the Exchange Manager, all shared libraries normally implement it.</p>
<h4>
  <a name="1069458"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069459"> </a></code><h4>
  <a name="1069460"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069461"></a>Err ExgLibOpen (
   UInt16 libRefnum
)
</pre>
<h4>
  <a name="1069463"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069464"> </a><code>&rarr;  <i><code>libRefnum</code></i></code></dt>
<dd><a name="1069465"> </a>Reference number of this exchange library.</dd>

</dl>
<h4>
  <a name="1069466"> </a>Comments 
</h4>

<p><a name="1069467"> </a>Exchange libraries are free to implement this function for internal or external use. The <code>ExgLibDisconnect</code> does not call it.</p>

<h3 class="hbH3">
  <a name="1069470"> </a>ExgLibPut Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069472"> </a>Purpose 
</h4>

<p><a name="1069473"> </a>Signals the start of an object to be transferred to the destination device.</p>
<h4>
  <a name="1069474"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069475"> </a></code><h4>
  <a name="1069476"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069478"></a>Err ExgLibPut(
   UInt16 libRefnum,
   ExgSocketType *exgSocketP
)
</pre>
<h4>
  <a name="1069479"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069480"> </a><code>&rarr;  <i><code>libRefnum</code></i></code></dt>
<dd><a name="1069481"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069482"> </a><code>&larr;  <i><code>exgSocketP</code></i></code></dt>
<dd><a name="1069486"> </a>Pointer to the socket structure (see <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a>). </dd>

</dl>
<h4>
  <a name="1069487"> </a>Returns 
</h4>

<p><a name="1069488"> </a>Returns <code>errNone</code> if no error. Error codes are defined by each exchange library.</p>
<h4>
  <a name="1069489"> </a>Comments 
</h4>

<p><a name="1069490"> </a>Opens a connection if necessary. The actual data should be sent using <a href="ExgLibAPI.html#1069614"><code>ExgLibSend()</code></a> after which the connection should be shut down with <a href="ExgLibAPI.html#1069325"><code>ExgLibDisconnect()</code></a>. The exchange library may prompt the user for addressing information.</p>

<p><a name="1069497"> </a>The first time this library is called, it may be necessary to allocate global variables and perform other initialization steps. It is usually a good idea to keep any state information about the open connection in the <code>socketRef</code> field of the <code>exgSocketP</code> structure. This data can then be passed to subsequent operations on that socket.</p>

<p><a name="1069498"> </a><code>ExgLibPut</code> should then check if the <code>socketRef</code> field of <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">exgSocketP</span> has been initialized. In some cases, an application may already have filled <code>socketRef</code> with addressing information. The use of <code>socketRef</code> is entirely up to the exchange library. If <code>socketRef</code> is empty, the exchange library needs to fill in any addressing information. In order to do this, the exchange library needs to open its own dialog asking the user for whatever addressing information would be appropriate. </p>

<p><a name="1069499"> </a>Exchange libraries are responsible for any validation of data entered in the addressing dialog and may use Address Book lookup or other system features to improve the user experience.</p>

<p><a name="1069500"> </a>Once the user has completed addressing and confirmed the dialog, the exchange library should, in general, call the <a href="ProgressManager.html#995795">Progress Manager</a> to open a progress dialog that remains open during the entire put operation. The progress dialog should not be opened if the <code>noStatus</code> option was passed or if the transaction is in asynchronous mode.</p>

<p><a name="1069504"> </a>If the exchange library is displaying dialogs, it must also look for events and pass them to the Progress Manager.</p>

<p><a name="1069505"> </a>Other operations within <code>ExgLibPut</code> depend on the exchange library. The exchange library may open communications ports and establish remote links at this time. Or it may just open a stream for buffering data until a later operation. If any errors occur in this process, the exchange library is responsible for removing any progress dialogs and returning an error. If displaying progress, the exchange library may also need to display an error using the Progress Manager before returning.</p>

<div><hr>
  <a name="1069506"> </a> <b>NOTE: </b> The progress dialog is converted to an error dialog and waits until the user dismisses it. This may occur in <code>ExgLibPut</code> or later in <a href="ExgLibAPI.html#1069325"><code>ExgLibDisconnect()</code></a>. It depends on whether the connection was made in <code>ExgLibPut</code> or whether it used an existing connection made by a previous call to <code>ExgLibConnect</code> or <code>ExgLibPut</code>.
<hr>
</div>

<p><a name="1069513"> </a>The first call to <a href="ExgLibAPI.html#1069470"><code>ExgLibPut()</code></a> must clean up after itself before returning an error if one of the following conditions exists:</p>
<ul type="disc">
  <li><a name="1069517"> </a>If <a href="ExgLibAPI.html#1069237"><code>ExgLibConnect()</code></a> is not supported.
  <li><a name="1069518"> </a>If <code>ExgLibConnect</code> is supported and an application does not call <code>ExgLibConnect</code>.
</ul>

<p><a name="1069522"> </a>The Exchange Manager's <a href="ExchangeManager.html#1056469"><code>ExgPut()</code></a> function calls <code>ExgLibPut</code> in the exchange library identified by the <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure passed to <code>ExgPut</code>. If <code>ExgLibPut</code> returns <code>exgErrNotEnoughPower</code>, the Exchange Manager puts up an alert, so there is no need for the exchange library to do so. Other error codes are not treated specially by the Exchange Manager; an exchange library must put up its own alerts when appropriate.</p>
<h4>
  <a name="1069526"> </a>Compatibility 
</h4>

<p><a name="1069530"> </a>Implemented only if <a href="CompatibilityApdx.html#995256">4.0 New Feature Set</a> is present.</p>

<h3 class="hbH3">
  <a name="1069533"> </a>ExgLibReceive Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069535"> </a>Purpose 
</h4>

<p><a name="1069536"> </a>Receive data from a remote device.</p>
<h4>
  <a name="1069537"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069538"> </a></code><h4>
  <a name="1069539"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069541"></a>UInt32 ExgLibReceive(
   UInt16 libRefNum,
   ExgSocketType *exgSocketP,
   void *bufP,
   UInt32 bufSize,
   Err *errP
)
</pre>
<h4>
  <a name="1069542"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069543"> </a><code>&rarr;  <i><code>libRefNum</code></i></code></dt>
<dd><a name="1069544"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069545"> </a><code>&harr;  <i><code>exgSocketP</code></i></code></dt>
<dd><a name="1069549"> </a>A pointer to the socket structure (see <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a>). </dd>

<dt><a name="1069550"> </a><code>&rarr;  <i><code>bufP</code></i></code></dt>
<dd><a name="1069551"> </a>A pointer to a buffer into which the data is put.</dd>

<dt><a name="1069552"> </a><code>&rarr;  <i><code>bufSize</code></i></code></dt>
<dd><a name="1069553"> </a>The size of the buffer in bytes.</dd>

<dt><a name="1069554"> </a><code>&larr;  <i><code>errP</code></i></code></dt>
<dd><a name="1069555"> </a>The error code result: <code>errNone</code> if no error. <code>exgErrNotSupported</code> is returned if used during a preview and the exchange library does not support preview or if there appears to be more data available but <code>ExgLibReceive</code> cannot obtain it.Error codes are defined by each exchange library.</dd>

</dl>
<h4>
  <a name="1069556"> </a>Returns 
</h4>

<p><a name="1069557"> </a>The number of bytes received. Returns 0 if the object is complete. <code>ExgLibReceive</code> blocks until at least one byte is available or the object is complete.</p>
<h4>
  <a name="1069558"> </a>Comments 
</h4>

<p><a name="1069565"> </a>Use after <a href="ExgLibAPI.html#1069386"><code>ExgLibGet()</code></a> or <a href="ExgLibAPI.html#1069180"><code>ExgLibAccept()</code></a> to receive the contents of the object. May be used after <code>ExgLibAccept</code> to examine the contents during a preview.</p>

<p><a name="1069566"> </a><code>ExgLibReceive</code> must update any progress dialogs to indicate that data is being received. The <code>ExgLibReceive</code> should fill the buffer passed as much as possible and return the actual number of bytes that were stored in the buffer. <code>ExgLibReceive</code> must block for at least one byte if the stream is not complete. Returning zero bytes indicates the end of the data.</p>

<p><a name="1069570"> </a>The Exchange Manager's <a href="ExchangeManager.html#1056545"><code>ExgReceive()</code></a> function simply calls <code>ExgLibReceive</code> in the exchange library identified by the <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure passed to <code>ExgReceive</code>.</p>
<h4>
  <a name="1069574"> </a>Compatibility 
</h4>

<p><a name="1069578"> </a>Implemented only if <a href="CompatibilityApdx.html#995256">4.0 New Feature Set</a> is present.</p>

<h3 class="hbH3">
  <a name="1069581"> </a>ExgLibRequest Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069583"> </a>Purpose 
</h4>

<p><a name="1069584"> </a>Requests an object using a URL, then has the Exchange Manager send it to the default application registered for the object's type.</p>
<h4>
  <a name="1069585"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069586"> </a></code><h4>
  <a name="1069587"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069589"></a>Err ExgLibRequest(
   UInt16 libRefNum,
   ExgSocketType *socketP
)
</pre>
<h4>
  <a name="1069590"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069591"> </a><code>&rarr;  <i><code>libRefNum</code></i></code></dt>
<dd><a name="1069592"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069593"> </a><code>&harr;  <i><code>socketP</code></i></code></dt>
<dd><a name="1069597"> </a>Pointer to the socket structure (see <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a>). The <code>name</code> field contains the URL of the object being requested.</dd>

</dl>
<h4>
  <a name="1069598"> </a>Returns 
</h4>

<p><a name="1069599"> </a>Returns <code>errNone</code> if no error. <code>exgErrNotSupported</code> is returned if the exchange library does not support this operation. Other error codes are defined by each exchange library.</p>
<h4>
  <a name="1069600"> </a>Comments 
</h4>

<p><a name="1069601"> </a>The exchange library may prompt the user for addressing information. The socket's <code>name</code> field may contain a URL with any of the schemes for which the exchange library registered. Not all exchange libraries support this operation.</p>

<div><hr>
  <a name="1069602"> </a> <b>NOTE: </b> This function is often used to tickle an exchange library to make it check to see if there are new messages. These messages are then delivered as usual. So there may or may not be a specific object being requested.
<hr>
</div>

<p><a name="1069606"> </a>The Exchange Manager's <a href="ExchangeManager.html#1056753"><code>ExgRequest()</code></a> function calls <code>ExgLibRequest</code> in the exchange library identified by the <code>ExgSocketType</code> structure passed to <code>ExgRequest</code>. If <code>ExgLibRequest</code> returns <code>exgErrNotEnoughPower</code>, the Exchange Manager puts up an alert, so there is no need for the exchange library to do so. Other error codes are not treated specially by the Exchange Manager; an exchange library must put up its own alerts when appropriate.</p>
<h4>
  <a name="1069607"> </a>See Also 
</h4>

<p><a name="1069611"> </a><a href="ExchangeManager.html#1056615"><code>ExgRegisterDatatype()</code></a></p>

<h3 class="hbH3">
  <a name="1069614"> </a>ExgLibSend Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069616"> </a>Purpose 
</h4>

<p><a name="1069617"> </a>Send data for an object to a destination device.</p>
<h4>
  <a name="1069618"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069619"> </a></code><h4>
  <a name="1069620"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069622"></a>UInt32 ExgLibSend(
   UInt16 libRefNum,
   ExgSocketType *exgSocketP,
   const void *bufP,
   UInt32 bufLen,
   Err *errP
)
</pre>
<h4>
  <a name="1069623"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069624"> </a><code>&rarr;  <i><code>libRefNum</code></i></code></dt>
<dd><a name="1069625"> </a>Reference number of this exchange library.</dd>

<dt><a name="1069626"> </a><code>&larr;  <i><code>exgSocketP</code></i></code></dt>
<dd><a name="1069630"> </a>A pointer to the socket structure (see <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a>).</dd>

<dt><a name="1069631"> </a><code>&rarr;  <i><code>bufP</code></i></code></dt>
<dd><a name="1069632"> </a>A pointer to a buffer containing the data to send.</dd>

<dt><a name="1069633"> </a><code>&rarr;  <i><code>bufLen</code></i></code></dt>
<dd><a name="1069634"> </a>The number of bytes to send.</dd>

<dt><a name="1069635"> </a><code>&larr;  <i><code>errP</code></i></code></dt>
<dd><a name="1069636"> </a>The error code result. Error codes are defined by each exchange library</dd>

</dl>
<h4>
  <a name="1069637"> </a>Returns 
</h4>

<p><a name="1069638"> </a>Returns the number of bytes sent.</p>
<h4>
  <a name="1069639"> </a>Comments 
</h4>

<p><a name="1069646"> </a>Applications call <a href="ExchangeManager.html#1056818"><code>ExgSend()</code></a> after <a href="ExchangeManager.html#1056469"><code>ExgPut()</code></a> and in response to <code>sysAppLaunchCmdExgGetData</code>.</p>

<p><a name="1069647"> </a>This function blocks until all bytes to be sent are actually sent, or until an error occurs (such as device full).</p>

<p><a name="1069648"> </a><code>ExgLibSend</code> may be called any number of times with varying size buffers to transmit information. If dialogs are being displayed, <code>ExgLibSend</code> must keep them updated (perhaps with animation or progress information). <code>ExgLibSend</code> must also check for events and let the Progress Manager handle them.</p>

<p><a name="1069649"> </a>The Exchange Manager's <code>ExgSend</code> function simply calls <code>ExgLibSend</code> in the exchange library identified by the <a href="ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure passed to <code>ExgSend</code>.</p>
<h4>
  <a name="1069653"> </a>Compatibility 
</h4>

<p><a name="1069657"> </a>Implemented only if <a href="CompatibilityApdx.html#995256">4.0 New Feature Set</a> is present.</p>

<h3 class="hbH3">
  <a name="1069660"> </a>ExgLibSleep Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069662"> </a>Purpose 
</h4>

<p><a name="1069663"> </a>The device is going to sleep.</p>
<h4>
  <a name="1069664"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069665"> </a></code><h4>
  <a name="1069666"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069668"></a>Err ExgLibSleep(
   UInt16 libRefnum
)
</pre>
<h4>
  <a name="1069669"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069670"> </a><code>&rarr;  <i><code>libRefnum</code></i></code></dt>
<dd><a name="1069671"> </a>Reference number of this exchange library.</dd>

</dl>
<h4>
  <a name="1069672"> </a>Returns 
</h4>

<p><a name="1069673"> </a>Returns <code>errNone</code> if no error. Error codes are defined by each exchange library.</p>
<h4>
  <a name="1069674"> </a>Comments 
</h4>

<p><a name="1069675"> </a>The device goes into sleep mode when the user turns the device off, the auto-off timer expires, or power is low. All shared libraries must implement <code>ExgLibSleep</code>; however, no processing is required and simply returning <code>errNone</code> is enough.</p>

<div><hr>
  <a name="1069676"> </a> <b>IMPORTANT: </b> Libraries must return from this function quickly to allow sufficient time for emergency shutdown situations (removal of batteries, for example).
<hr>
</div>

<h3 class="hbH3">
  <a name="1069679"> </a>ExgLibWake Function <a href="#1069165"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1069681"> </a>Purpose 
</h4>

<p><a name="1069682"> </a>The device is waking up.</p>
<h4>
  <a name="1069683"> </a>Declared In 
</h4>
<code>ExgLib.h<a name="1069684"> </a></code><h4>
  <a name="1069685"> </a>Prototype 
</h4>
<pre class="proto"><a name="1069687"></a>Err ExgLibWake(
   UInt16 libRefnum
)
</pre>
<h4>
  <a name="1069688"> </a>Parameters 
</h4>

<dl>
<dt><a name="1069689"> </a><code>&rarr;  <i><code>libRefnum</code></i></code></dt>
<dd><a name="1069690"> </a>Reference number of this exchange library.</dd>

</dl>
<h4>
  <a name="1069691"> </a>Returns 
</h4>

<p><a name="1069692"> </a>Returns <code>errNone</code> if no error. Error codes are defined by each exchange library.</p>
<h4>
  <a name="1069693"> </a>Comments 
</h4>

<p><a name="1069694"> </a>The device wakes up when the user turns the device on. All shared libraries must implement <code>ExgLibWake</code>, although no processing is required; it is enough to simply return <code>errNone</code>.</p>

<p><a name="1069695"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996-2004, PalmSource, Inc. and its affiliates.  All rights reserved. <br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="Reference_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="ReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ExchangeManager.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="IRLib.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ReferenceIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>