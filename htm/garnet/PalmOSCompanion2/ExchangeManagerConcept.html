<html>
<head>
<title>(68K) Object Exchange | Palm OS&#174; Programmer's Companion</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 10:43:42">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="995795"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="Companion2TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Companion2About.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ExchangeLibraries.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Companion2IX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">1 &nbsp;&nbsp;
Object Exchange</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Palm OS&#174; Programmer's Companion</p>
<p class="SubTitle">Volume II Communications </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1"><a href="ExchangeManagerConcept.html">1  Object Exchange</a></h1>

   <h2 class="SideTOC2"><a href="#995851">
   About the Exchange Manager </a></h2>

      <h3 class="SideTOC3"><a href="#995862">
      Exchange Libraries</a></h3>

      <h3 class="SideTOC3"><a href="#995921">
      Typed Data Objects</a></h3>

   <h2 class="SideTOC2"><a href="#995981">
   Initializing the Exchange Socket Structure</a></h2>

      <h3 class="SideTOC3"><a href="#996005">
      Identifying the Exchange Library</a></h3>

      <h3 class="SideTOC3"><a href="#996082">
      Identifying the Type of Data </a></h3>

   <h2 class="SideTOC2"><a href="#996099">
   Registering for Data</a></h2>

      <h3 class="SideTOC3"><a href="#996128">
      General Registration Guidelines</a></h3>

      <h3 class="SideTOC3"><a href="#996157">
      Setting the Default Application</a></h3>

      <h3 class="SideTOC3"><a href="#996285">
      Registering to Receive Unwrapped Data</a></h3>

   <h2 class="SideTOC2"><a href="#996310">
   Sending Data</a></h2>

      <h3 class="SideTOC3"><a href="#996325">
      Sending a Single Object</a></h3>

      <h3 class="SideTOC3"><a href="#996388">
      Sending Multiple Objects</a></h3>

      <h3 class="SideTOC3"><a href="#996445">
      Implementing the Send Command </a></h3>

   <h2 class="SideTOC2"><a href="#996458">
   Receiving Data</a></h2>

      <h3 class="SideTOC3"><a href="#996494">
      Controlling the Exchange Dialog</a></h3>

      <h3 class="SideTOC3"><a href="#996557">
      Displaying a Preview</a></h3>

      <h3 class="SideTOC3"><a href="#996608">
      Receiving the Data</a></h3>

   <h2 class="SideTOC2"><a href="#996714">
   Sending and Receiving Databases</a></h2>

      <h3 class="SideTOC3"><a href="#996719">
      Sending a Database</a></h3>

      <h3 class="SideTOC3"><a href="#996801">
      Receiving a Database</a></h3>

   <h2 class="SideTOC2"><a href="#996831">
   Requesting Data</a></h2>

      <h3 class="SideTOC3"><a href="#996859">
      Sending a Get Request for a Single Object</a></h3>

      <h3 class="SideTOC3"><a href="#996889">
      Responding to a Get Request </a></h3>

      <h3 class="SideTOC3"><a href="#996910">
      Two-Way Communications</a></h3>

      <h3 class="SideTOC3"><a href="#996930">
      Requesting a URL </a></h3>

   <h2 class="SideTOC2"><a href="#996950">
   Sending and Receiving Locally</a></h2>

   <h2 class="SideTOC2"><a href="#997016">
   Interacting with the Launcher</a></h2>

   <h2 class="SideTOC2"><a href="#997031">
   Summary of Exchange Manager</a></h2>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="995805"> </a>The simplest form of communication for a Palm OS<sup>&#174;</sup> application to implement is the sending and receiving of typed data objects, such as MIME data, databases, or database records. </p>

<p><a name="995807"> </a>You use the Exchange Manager to send and receive typed data objects. The Exchange Manager interface is independent of the transport mechanism. You can use IR, SMS, or any other protocol that has an Exchange Manager plug-in called an <b>exchange library</b>. </p>

<p><a name="995810"> </a>The Exchange Manager is supported in Palm OS 3.0 and higher. In Palm OS 4.0, significant updates were made. </p>

<p><a name="995811"> </a>This chapter describes how applications use the Exchange Manager to send and receive typed data objects. It covers the following topics: </p>
<ul type="disc">
  <li><a name="995815"> </a><a href="ExchangeManagerConcept.html#995851">About the Exchange Manager</a>
  <li><a name="995819"> </a><a href="ExchangeManagerConcept.html#995981">Initializing the Exchange Socket Structure</a>
  <li><a name="995823"> </a><a href="ExchangeManagerConcept.html#996099">Registering for Data</a>
  <li><a name="995827"> </a><a href="ExchangeManagerConcept.html#996285">Registering to Receive Unwrapped Data</a>
  <li><a name="995831"> </a><a href="ExchangeManagerConcept.html#996458">Receiving Data</a>
  <li><a name="995835"> </a><a href="ExchangeManagerConcept.html#996714">Sending and Receiving Databases</a>
  <li><a name="995839"> </a><a href="ExchangeManagerConcept.html#996831">Requesting Data</a>
  <li><a name="995843"> </a><a href="ExchangeManagerConcept.html#996950">Sending and Receiving Locally</a>
  <li><a name="995847"> </a><a href="ExchangeManagerConcept.html#997016">Interacting with the Launcher</a>
</ul>

<p><a name="995848"> </a>This chapter does not describe how to implement an exchange library. </p>

<h2 class="haH2">
  <a name="995851"> </a>About the Exchange Manager  <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="995852"> </a>This section explains concepts you need to know before you can begin using the Exchange Manager. It discusses the following topics: </p>
<ul type="disc">
  <li><a name="995856"> </a><a href="ExchangeManagerConcept.html#995862">Exchange Libraries</a>
  <li><a name="995860"> </a><a href="ExchangeManagerConcept.html#995921">Typed Data Objects</a>
</ul>
<h3 class="hbH3">
  <a name="995862"> </a>Exchange Libraries <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="995863"> </a>The Exchange Manager works in conjunction with an exchange library. Each <b>exchange library</b> is transport-dependent and performs the actual communication with the remote device. When an application makes an Exchange Manager call, the Exchange Manager forwards the request to the appropriate exchange library. The Exchange Manager's main duty is to maintain a registry of which libraries implement each protocol and which applications receive each type of data. See <a href="ExchangeManagerConcept.html#995869">Figure 1.1</a>.</p>

<p class="FFigureCaption">
  <a name="995869"> </a><b>Figure 1.1&nbsp;&nbsp;Object exchange using Exchange Manager<div align="left"><img src="images/ExchangeMgr2.gif" border="0" hspace="0" vspace="0">
</div></b>
</p>


<p><a name="995877"> </a>The list of supported exchange libraries depends on the version of Palm OS. See <a href="ExchangeManagerConcept.html#995888">Table 1.1</a>. </p>

<p class="caption"><a name="995888"> </a><b>Table 1.1&nbsp;&nbsp;Supported exchange libraries </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="995892"> </a><b>Exchange Library </b></p>
    </th>
    <th><p class="tt"><a name="995894"> </a><b>Minimum Palm OS Version </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995897"> </a>IR Library (IrDA) </p>
    </td>
    <td><p class="tt"><a name="995899"> </a>Palm OS 3.0 </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995901"> </a>Local Exchange Library </p>
    </td>
    <td><p class="tt"><a name="995903"> </a>Palm OS 4.0 </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995906"> </a>SMS Library (Short Messaging System)</p>
    </td>
    <td><p class="tt"><a name="995908"> </a>Palm OS 4.0 </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995914"> </a>Bluetooth Library<a href="#995913"><sup>1</sup></a> </p>
    </td>
    <td><p class="tt"><a name="995916"> </a>Palm OS 4.0</p>
    </td>
  </tr>
</table>
<div class="tablediv"><table cellspacing="0" class="tTableNR">
   <tr>
     <td><div class="FNTFootnoteTable">
<a name="995913"> </a><a href="#995914">1</a>. The Bluetooth Library is not present in Palm OS 4.0, but is planned to be provided shortly after Palm OS 4.0 ships. </div>
</td>
   </tr>
</table></div>

</div>


<p><a name="995918"> </a>As other exchange libraries become available, users can install them on their Palm Powered<sup>&#8482;</sup> handhelds and use the communications functionality they provide.</p>

<p><a name="995919"> </a>Note that on Palm OS 3.X the only exchange library available is the IR Library, and it is not extensible. The IR Library cannot, for example, be replaced with a different exchange library. </p>
<h3 class="hbH3">
  <a name="995921"> </a>Typed Data Objects <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="995922"> </a>The Exchange Manager sends and receives typed data objects. A <b>typed data object</b> (or <b>object</b>) is a stream of bytes plus some information about its contents. The content information includes any of: a creator ID, a MIME data type, or a filename. </p>

<p><a name="995925"> </a>The object itself can be in any format, but it's best to use a standardized data format rather than a proprietary one if you have a choice. <a href="ExchangeManagerConcept.html#995935">Table 1.2</a> lists the standardized data formats that the built-in Palm OS applications can receive. </p>

<p class="caption"><a name="995935"> </a><b>Table 1.2&nbsp;&nbsp;Built-in applications and standard data types </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="995939"> </a><b>Application</b></p>
    </th>
    <th><p class="tt"><a name="995941"> </a><b>Data Type</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995943"> </a>Address Book</p>
    </td>
    <td><p class="tt"><a name="995946"> </a>vCards (vcf file extension, text/x-vCard MIME type)</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995948"> </a>Datebook</p>
    </td>
    <td><p class="tt"><a name="995951"> </a>vCalendars (vcs file extension, text/x-vCalendar MIME type)</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995953"> </a>Launcher</p>
    </td>
    <td><p class="tt"><a name="995955"> </a>Palm OS databases (prc, pdb, oprc, and pqa file extensions, application/x-pilot and application/vnd.palm MIME types)</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995957"> </a>Memo</p>
    </td>
    <td><p class="tt"><a name="995959"> </a>Plain text (txt file extension, text/plain MIME type)</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="995961"> </a>ToDo</p>
    </td>
    <td><p class="tt"><a name="995963"> </a>Not explicitly registered, but receives vCalendar objects from Datebook as appropriate </p>
    </td>
  </tr>
</table>

</div>


<div><hr>
  <a name="995965"> </a> <b>NOTE: </b> The MIME type application/vnd.palm has been registered with the IANA and is preferred over the application/x-pilot MIME type. 
<hr>
</div>

<p><a name="995966"> </a>If you want your application to receive objects, you must first register with the Exchange Manager for the type of data you want to receive. See <a href="ExchangeManagerConcept.html#996099">"Registering for Data"</a> for instructions on how to do so. You can override the built-in applications by registering for any data type listed in <a href="ExchangeManagerConcept.html#995935">Table 1.2</a> and becoming the default application for that type. See <a href="ExchangeManagerConcept.html#996157">"Setting the Default Application"</a> for more information. </p>

<p><a name="995976"> </a>If you only want to send data, you do not have to register. Your application can send data of the types listed in <a href="ExchangeManagerConcept.html#995935">Table 1.2</a>, and the Exchange Manager ensures that the appropriate application receives it. </p>

<h2 class="haH2">
  <a name="995981"> </a>Initializing the Exchange Socket Structure <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="995982"> </a>The Exchange Manager, exchange library, and application use an exchange socket structure (<a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a>) to communicate with each other. This structure is passed from the application to the Exchange Manager to the exchange library and vice versa. (The use of the term "socket" in the Exchange Manager API is not related to the term "socket" as used in sockets communication programming.) When your application sends data, you must create this structure and initialize it with the appropriate information. When you receive data, this structure provides information about the connection and the incoming data. </p>

<p><a name="995987"> </a>The <code>ExgSocketType</code> structure you use must identify two important pieces of information: </p>
<ul type="disc">
  <li><a name="995988"> </a>the exchange library that should do the sending (see <a href="ExchangeManagerConcept.html#996005">"Identifying the Exchange Library"</a>) 
  <li><a name="995994"> </a>the type of data being sent (see <a href="ExchangeManagerConcept.html#996082">"Identifying the Type of Data"</a>) 
</ul>

<p><a name="995996"> </a>The socket structure defines other fields that you may use to provide other information if you want. See the description of the <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure in the <i>Palm OS Programmer's API Reference</i> for complete details. </p>

<div><hr>
  <a name="996003"> </a> <b>IMPORTANT: </b> When initializing the <code>ExgSocketType</code> structure, set all unused fields to 0. 
<hr>
</div>
<h3 class="hbH3">
  <a name="996005"> </a>Identifying the Exchange Library <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996010"> </a>The <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure identifies the library to be used in one of the following ways: </p>
<ul type="disc">
  <li><a name="996011"> </a>a library reference number in the <code>libraryRef</code> field 
  <li><a name="996013"> </a>a Uniform Resource Locator (URL) in the <code>name</code> field 
</ul>

<p><a name="996014"> </a>The Exchange Manager checks for a library reference number first. If it is 0, it checks for a URL. </p>

<p><a name="996015"> </a>When your application sends data, it must identify which exchange library to use. You only need to identify the exchange library in Palm OS 4.0 and higher. Earlier releases contain only one exchange library (for IR), so all sending is automatically done by that library. If you do not specify an exchange library on Palm OS 4.0 and higher, the IR Library is used to maintain backward compatibility. </p>

<p><a name="996016"> </a>It's more common to identify the library using a URL instead of a library reference number. The URL scheme specifies which exchange library to use. The <b>scheme</b> is the part of the URL that appears before the colon (:). For example, the scheme in the following URL is "http" </p>
<pre class="proto"><a name="996018"></a>http://www.palmos.com 


</pre>

<p><a name="996019"> </a>When you pass the preceding URL to a web browser, the scheme tells the browser to connect to the server using the HTTP protocol. Similarly, when you pass the Exchange Manager a URL, the scheme tells the Exchange Manager which exchange library to use. For example, the following URL tells the Exchange Manager to connect to a remote Palm Powered handheld using the IR Library: </p>
<pre class="proto"><a name="996020"></a>_beam:BusinessCard.vcf


</pre>

<p><a name="996021"> </a>On Palm OS, a URL has the following format: </p>
<pre class="proto"><a name="996022"></a>[?]<i>scheme1</i>[;<i>scheme2</i>]...:<i>filename</i> 


</pre>

<p><a name="996023"> </a>where: </p>

<dl>
<dt><a name="996024"> </a><code><code>?</code></code></dt>
<dd><a name="996025"> </a>If more than one exchange library is registered for the provided schemes, the Exchange Manager has the user select the exchange library by displaying the Send With dialog. </dd>

<dt><a name="996026"> </a><code><i>scheme1</i>[;<i>scheme2</i>]...</code></dt>
<dd><a name="996027"> </a>The URL schemes that identify which exchange library should be used. If more than one exchange library is registered for the scheme, the default exchange library is selected unless the URL begins with a question mark. </dd>

<dd><a name="996028"> </a>As shown, multiple schemes may be provided, separated by semicolons. Multiple schemes are only supported in conjunction with the question mark. For example, the string "?_send;_beam" has the Exchange Manager display a Send With dialog that lists all exchange libraries that support either the _send scheme or the _beam scheme. </dd>

<dt><a name="996029"> </a><code><i>filename</i></code></dt>
<dd><a name="996030"> </a>The name of the file to send. Typically, this file also has an extension that is used, if necessary, to determine which application should receive the data. See <a href="ExchangeManagerConcept.html#996082">"Identifying the Type of Data"</a> for more information about the file extension. </dd>

</dl>

<p><a name="996034"> </a>Palm OS defines some URL prefixes that any application can use to connect with the installed exchange libraries. A URL prefix is everything up to and including the colon character. <a href="ExchangeManagerConcept.html#996044">Table 1.3</a> describes the prefixes. </p>

<p class="caption"><a name="996044"> </a><b>Table 1.3&nbsp;&nbsp;Exchange Library URL Prefixes </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="996048"> </a><b>Exchange Library</b></p>
    </th>
    <th><p class="tt"><a name="996050"> </a><b>URL Prefix </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996052"> </a>IR Library</p>
    </td>
    <td><p class="tt"><a name="996055"> </a><code>exgBeamPrefix</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996057"> </a>Local Exchange Library </p>
    </td>
    <td><p class="tt"><a name="996060"> </a><code>exgLocalPrefix</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996062"> </a>SMS Library </p>
    </td>
    <td><p class="tt"><a name="996065"> </a><code>kSmsScheme</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996067"> </a>Any library that supports the _send scheme (user's choice)</p>
    </td>
    <td><p class="tt"><a name="996070"> </a><code>exgSendPrefix</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996072"> </a>Any library that supports the _send or _beam scheme (user's choice)</p>
    </td>
    <td><p class="tt"><a name="996075"> </a><code>exgSendBeamPrefix</code> </p>
    </td>
  </tr>
</table>

</div>


<p><a name="996080"> </a>The section <a href="ExchangeManagerConcept.html#996445">"Implementing the Send Command"</a> provides more information on using <code>exgSendPrefix</code> or <code>exgSendBeamPrefix</code>. </p>
<h3 class="hbH3">
  <a name="996082"> </a>Identifying the Type of Data  <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996083"> </a>When your application sends data, the exchange socket structure (<a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a>) identifies the type of data being sent. It can do so with one of the following values: </p>
<ul type="disc">
  <li><a name="996087"> </a>A MIME type in the <code>type</code> field. This field is only used on Palm OS 4.0 and higher. 
  <li><a name="996088"> </a>A file extension for the file in the <code>name</code> field. That is, you might supply <code>MyDB.pdb</code> as the value of the <code>name</code> field. The part after the last period (.) is the extension. 
</ul>

<p><a name="996089"> </a>In most cases, the data type determines which application receives the data on the remote side. (If the <code>target</code> field is specified, it determines which application receives the data instead of the data type as described below.) The Exchange Manager maintains a registry of applications and the types of data each application can receive. When the Exchange Manager receives an object, it checks the exchange socket for the data type. It checks the <code>type</code> field first, and if it is not defined or if no application is registered to receive that MIME type, it checks the <code>name</code> field for a file extension. This is discussed in more detail in the <a href="ExchangeManagerConcept.html#996099">"Registering for Data"</a> section. </p>

<p><a name="996093"> </a>Note that you may also directly specify which application should receive the data. To do so, place the creator ID in the <code>target</code> field. You do not have to specify a MIME type or file extension in this instance. When the <code>target</code> field is nonzero, the Exchange Manager checks for the existence of that application on the receiving device. If it exists, that application receives the data regardless of whether it is registered. If the target application does not exist, the Exchange Manager searches the registry as usual. Use the <code>target</code> field only if you know that you are communicating with a Palm Powered handheld and want to explicitly specify which application should receive the data. </p>

<p><a name="996094"> </a>On Palm OS 4.0 and higher, an application can register for another application's creator ID and receive all objects targeted to that creator ID. See <a href="ExchangeManagerConcept.html#996157">"Setting the Default Application"</a> for more details. </p>

<h2 class="haH2">
  <a name="996099"> </a>Registering for Data <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996100"> </a>In most cases, applications that want to receive data from the Exchange Manager must register for the MIME type and/or file extension that they want to receive. The function that you use to do so differs depending on which operating system versions you want to support. </p>

<p><a name="996105"> </a>On Palm OS 3.X, you call <a href="../PalmOSReference/ExchangeManager.html#1056721"><code>ExgRegisterData</code></a> and pass it three parameters: your application's creator ID, a constant that identifies the type of data you want to register to receive (<code>exgRegExtensionID</code> for file extensions or <code>exgRegTypeID</code> for MIME types), and a string that lists the MIME types or file extensions. For example, on Palm OS 3.X the Beamer sample application distributed with the Palm OS SDK makes this call: </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
ExgRegisterData(beamerCreator,<a name="996106"> </a>
  exgRegExtensionID, BitmapExt);<a name="996107"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996108"> </a>On Palm OS 4.0 and higher, <code>ExgRegisterData</code> is deprecated and replaced with <a href="../PalmOSReference/ExchangeManager.html#1056615"><code>ExgRegisterDatatype</code></a>. <code>ExgRegisterDatatype</code> supports more types of data and takes more parameters. You still pass the creator ID, the type of data you want to register for, and the string that describes the specifics of what you are registering for. Palm OS 4.0 and higher supports registering for creator IDs (<code>exgRegCreatorID</code>) or URL schemes (<code>exgRegSchemeID</code>) in addition to MIME types and file extensions; however, registering for these new data types is not as common. See <a href="ExchangeManagerConcept.html#996157">"Setting the Default Application"</a> for a case where you would register for a creator ID, and see <a href="ExchangeManagerConcept.html#996930">"Requesting a URL"</a> for a case where you would register for a URL. </p>

<p><a name="996121"> </a>In addition, you must pass two more parameters to <code>ExgRegisterDatatype</code>: a string containing descriptions of the data you are registering to receive and a flag indicating whether you want to receive the data directly if it is sent as part of another object. The descriptions that you pass in are displayed to preview the data in the exchange dialog under certain circumstances. The flag parameter is described in the <a href="ExchangeManagerConcept.html#996285">"Registering to Receive Unwrapped Data"</a> section. </p>

<p><a name="996125"> </a>For example, on Palm OS 4.0 the Beamer sample application distributed with the Palm OS SDK makes this call: </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
<code>ExgRegisterDatatype</code>(beamerCreator,<a name="996126"> </a>
  exgRegExtensionID, BitmapExt, "bitmap", 0);<a name="996127"> </a>
</pre><div class="CodeRule"><hr></div>

<h3 class="hbH3">
  <a name="996128"> </a>General Registration Guidelines <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996129"> </a>Follow these guidelines when registering for data: </p>
<ul type="disc">
  <li><a name="996130"> </a>Register as early as possible. 
   <p><a name="996131"> </a>To ensure that your application can receive data at any time after it is installed, call <a href="../PalmOSReference/ExchangeManager.html#1056721"><code>ExgRegisterData</code></a> or <a href="../PalmOSReference/ExchangeManager.html#1056615"><code>ExgRegisterDatatype</code></a> in response to the <a href="../PalmOSReference/AppLaunchCodes.html#1012389"><code>sysAppLaunchCmdSyncNotify</code></a> launch code. This launch code is sent to your application upon its first installation and any time the HotSync<sup>&#174;</sup> operation modifies the application's database. </p>
  <li><a name="996143"> </a>It's best to use a standardized data format rather than a proprietary one if you have a choice. 
  <li><a name="996144"> </a>On Palm OS 4.0 and higher, multiple applications can register to receive the same data type. The section <a href="ExchangeManagerConcept.html#996157">"Setting the Default Application"</a> describes this further. 
  <li><a name="996148"> </a>When registering for file extensions, do not include the period (.) as part of the extension. Register for "TXT", for example, not ".TXT". 
  <li><a name="996149"> </a>Do <i>not</i> make multiple calls if you want to register for more than one MIME type or more than one file extension. 
   <p><a name="996150"> </a>Instead, make one call for all file extensions and one call for all MIME types. Pass a single string containing file extensions or MIME types separated by a tab (\t) character. For example, the following call registers the application for two file extensions, TXT and DOC: </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
<code>ExgRegisterData(myCreator, exgRegExtensionID,
"TXT\tDOC", "plain text", 0);</code><a name="996151"> </a>
</pre><div class="CodeRule"><hr></div>

  <li><a name="996152"> </a>The description parameter is optional. If you implement the preview mode as described in <a href="ExchangeManagerConcept.html#996557">"Displaying a Preview"</a> later in this chapter, you do not need to provide a description. It is, however, strongly recommended that you provide one. 
</ul>
<h3 class="hbH3">
  <a name="996157"> </a>Setting the Default Application <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996158"> </a>Because multiple applications can register for the same data type on Palm OS 4.0 and higher, the Exchange Manager supports the concept of a default application that receives all objects of a particular data type. To set the default application, call the function <a href="../PalmOSReference/ExchangeManager.html#1056868"><code>ExgSetDefaultApplication</code></a>. There is one default application per data type in the registry. Palm OS 3.X does not support having multiple applications registered for the same data types. </p>

<p><a name="996163"> </a>Suppose a device running Palm OS 4.0 receives a vCard object, and it has three applications registered to receive vCards. The Exchange Manager checks the registry to see if any of these applications is assigned as the default. If so, the default application receives all vCards (unless the exchange socket structure's <code>target</code> field is set). If none of the three applications is the default, the Exchange Manager chooses one, and that application receives all vCards. </p>

<p><a name="996164"> </a>PalmSource, Inc. strongly recommends that you allow users to choose which application is the default. To do so, you could display a panel that shows users the applications that can receive the same type of data as your application, show them which is the default, and allow them to select a different default. Use <a href="../PalmOSReference/ExchangeManager.html#1056045"><code>ExgGetRegisteredApplications</code></a> to get a list of all applications registered to receive the same data type as yours, and use <a href="../PalmOSReference/ExchangeManager.html#1055984"><code>ExgGetDefaultApplication</code></a> to retrieve the current default, if any. See <a href="ExchangeManagerConcept.html#996237">Listing 1.2</a> to see how the iMessenger example application performs this task for the <code>mailto</code> URL scheme. The full source code is distributed with the SDK. </p>
<p class="CCodeCaption">
  <a name="996177"> </a><b>Listing 1.1&nbsp;&nbsp;Initializing a List of Registered Applications</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
void PrvSetMailAppsList(Int32 listSelection)<a name="996178"> </a>
{<a name="996179"> </a>
   ControlPtr ctl;<a name="996180"> </a>
   ListPtr lst;<a name="996181"> </a>
   UInt32 defaultID;<a name="996182"> </a>
 <a name="996183"> </a>
   ctl = GetObjectPtr(PrefDefaultMailTrigger);<a name="996184"> </a>
   lst = GetObjectPtr(PrefDefaultMailList);<a name="996185"> </a>
 <a name="996186"> </a>
   // crIDs, appCnt, appNames are all global variables. <a name="996187"> </a>
   // Get the list of creator IDs if we don't have it already. <a name="996188"> </a>
   if(!crIDs) {<a name="996189"> </a>
      ExgGetRegisteredApplications(&amp;crIDs, &amp;appCnt, &amp;appNames, NULL, <a name="996190"> </a>
         exgRegSchemeID, "mailto");<a name="996191"> </a>
      if(appCnt) {<a name="996192"> </a>
         MemHandle tmpH = SysFormPointerArrayToStrings(appNames, appCnt);<a name="996193"> </a>
         if(tmpH)<a name="996194"> </a>
            appNamesArray = MemHandleLock(tmpH);<a name="996195"> </a>
         else<a name="996196"> </a>
            return;<a name="996197"> </a>
      }<a name="996198"> </a>
      else<a name="996199"> </a>
         return;<a name="996200"> </a>
   }<a name="996201"> </a>
 <a name="996202"> </a>
   if(appNamesArray)<a name="996203"> </a>
      LstSetListChoices(lst, appNamesArray, appCnt);<a name="996204"> </a>
   LstSetHeight(lst, appCnt &lt; 6 ? appCnt : 6);<a name="996205"> </a>
 <a name="996206"> </a>
   if(listSelection == -1)<a name="996207"> </a>
   {<a name="996208"> </a>
      UInt16 i;<a name="996209"> </a>
      ExgGetDefaultApplication(&amp;defaultID, exgRegSchemeID, "mailto");<a name="996210"> </a>
 <a name="996211"> </a>
      for(i=0;i&lt;appCnt;i++) {<a name="996212"> </a>
         if(crIDs[i] == defaultID)<a name="996213"> </a>
            LstSetSelection(lst, i);<a name="996214"> </a>
      }<a name="996215"> </a>
   }<a name="996216"> </a>
   else<a name="996217"> </a>
      LstSetSelection(lst, listSelection);<a name="996218"> </a>
 <a name="996219"> </a>
   CtlSetLabel(ctl, appNamesArray[LstGetSelection(lst)]);<a name="996220"> </a>
}<a name="996221"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996222"> </a>To become the default application for a data type that a built-in Palm OS application is registered to receive (see <a href="ExchangeManagerConcept.html#995935">Table 1.2</a>), you must perform some extra steps to ensure that you can receive that type of object when it is beamed from a device running Palm OS 3.X. You must register for the built-in application's creator ID and become the default application for that creator ID. </p>

<p><a name="996226"> </a>On Palm OS 3.X, the built-in applications always set their creator IDs in the <code>target</code> field when sending data, causing the data to always be sent to that application. On Palm OS 4.0 and higher, the built-in applications still register to receive the same type of data, but they do not set the <code>target</code> field when sending. This means that if your application is registered for the same data type and is the default application, it receives the data from Palm OS 4.0 and higher as expected, but if the data is sent from a device running Palm OS 3.X, you still won't receive that data because it is specifically targeted for the built-in application. </p>

<p><a name="996228"> </a>To solve this problem, the <code>ExgRegisterData</code> function in Palm OS 4.0 and higher supports registering for another application's creator ID. <a href="ExchangeManagerConcept.html#996237">Listing 1.2</a> shows how an application that receives vCards might set the default application after allowing the user to select the default from a list, assuming the list is initialized with code similar to that in <a href="ExchangeManagerConcept.html#996177">Listing 1.1</a>.</p>

<p><a name="996235"> </a>Note that, as with all data types, your application won't receive the data targeted for the other application unless yours is the default application for that creator ID. </p>
<p class="CCodeCaption">
  <a name="996237"> </a><b>Listing 1.2&nbsp;&nbsp;Setting the default application for vCards</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
UInt32 PilotMain (UInt16 cmd, void *cmdPBP, UInt16 launchFlags)<a name="996238"> </a>
{<a name="996239"> </a>
   ...<a name="996240"> </a>
   // Register for vCard MIME type, extension, and Address Book's creator ID. <a name="996241"> </a>
   // At this point, we are not the default application so we do not receive<a name="996242"> </a>
   // vCards. We still must register upon install so that our application <a name="996243"> </a>
   // appears in the preferences list when the user chooses the default <a name="996244"> </a>
   // application for vCards. <a name="996245"> </a>
   case sysAppLaunchCmdSyncNotify:<a name="996246"> </a>
      Char addressCreatorStr[5];<a name="996247"> </a>
      <a name="996248"> </a>
      // Create a string from Address Book's creator ID. <a name="996249"> </a>
      <code>MemMove(addressCreatorStr, </code>sysFileCAddress<code>, 4);</code><a name="996250"> </a>
      <code>address</code>CreatorStr[4] = chrNull;<a name="996251"> </a>
 <a name="996252"> </a>
      ExgRegisterDatatype(crID, exgRegTypeID, "text/x-vCard", "vCard", 0);<a name="996253"> </a>
      ExgRegisterDatatype(crID, exgRegExtensionID, "vcf", "vCard", 0);<a name="996254"> </a>
      ExgRegisterDatatype(crID, exgRegCreatorID, addressCreatorStr, NULL, 0);<a name="996255"> </a>
      ...<a name="996256"> </a>
}<a name="996257"> </a>
 <a name="996258"> </a>
static void PrefApply (void)<a name="996259"> </a>
{<a name="996260"> </a>
   MemHandle h;<a name="996261"> </a>
   FieldType *fld;<a name="996262"> </a>
   ControlType *ctl;<a name="996263"> </a>
   UInt16 listItem;<a name="996264"> </a>
 <a name="996265"> </a>
   // Set the default vCard app<a name="996266"> </a>
vif(appCnt &amp;&amp; crIDs)<a name="996267"> </a>
   {<a name="996268"> </a>
      UInt32 crID;<a name="996269"> </a>
      Char addressCreatorStr[5];<a name="996270"> </a>
      <a name="996271"> </a>
      // Create a string from Address Book's creator ID. <a name="996272"> </a>
      <code>MemMove(addressCreatorStr, </code>sysFileCAddress<code>, 4);</code><a name="996273"> </a>
      <code>address</code>CreatorStr[4] = chrNull;<a name="996274"> </a>
      <a name="996275"> </a>
      listItem = LstGetSelection(GetObjectPtr(PrefDefaultAppList));<a name="996276"> </a>
      crID = crIDs[listItem];<a name="996277"> </a>
      ExgSetDefaultApplication(crID, exgRegTypeID, "text/x-vCard");<a name="996278"> </a>
      ExgSetDefaultApplication(crID, exgRegExtensionID, "vcf");<a name="996279"> </a>
      ExgSetDefaultApplication(crID, exgRegCreatorID, <code>addressCreatorStr</code>);<a name="996280"> </a>
   }<a name="996281"> </a>
}<a name="996282"> </a>
</pre><div class="CodeRule"><hr></div>

<h3 class="hbH3">
  <a name="996285"> </a>Registering to Receive Unwrapped Data <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996286"> </a>On Palm OS 4.0 or higher, in rare circumstances, you can register to receive data that is sent enclosed in another object. </p>

<p><a name="996287"> </a>For example, suppose you have a stock quote application that wants to receive vStock objects. If the device is sent an e-mail message that has the vStock object attached, your application may want to register to receive the vStock object directly rather than having the e-mail application receive it. To do so, call <a href="../PalmOSReference/ExchangeManager.html#1056615"><code>ExgRegisterDatatype</code></a> and pass the constant <code>exgUnwrap</code> as the last parameter. The flag is named <code>exgUnwrap</code> because the exchange library unwraps the received object (the e-mail message in this example) so that it can send the contained objects (the vStock object) directly. </p>

<p><a name="996292"> </a>If you want to register to receive an object when it is sent as part of another object, you probably also want to receive it when it is sent by itself. This requires two calls to <code>ExgRegisterDatatype</code>: one with the <code>exgUnwrap</code> flag set, and one without. </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
<code>ExgRegisterDatatype(myCreator, </code><a name="996294"> </a>
<code>  exgRegExtensionID, "TXT\tDOC", "plain text", </code><a name="996295"> </a>
<code>  0);</code><a name="996296"> </a>
<code>ExgRegisterDatatype(myCreator, </code><a name="996297"> </a>
<code>  exgRegExtensionID, "TXT\tDOC", "plain text", </code><a name="996298"> </a>
<code>  exgUnwrap);</code><a name="996299"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996300"> </a>Thus, you might make four calls to <code>ExgRegisterDatatype</code>: </p>
<ul type="disc">
  <li><a name="996301"> </a>one call to register for the file extensions 
  <li><a name="996302"> </a>one call to register for file extensions that are sent as part of another object
  <li><a name="996303"> </a>one call to register for MIME types
  <li><a name="996304"> </a>one call to register for MIME types that are sent as part of another object
</ul>

<p><a name="996305"> </a>As mentioned previously, it's rare for an application to register to receive unwrapped data directly. It's more common for one application (such as an e-mail application) to receive the entire compound object and then unwrap and disperse the enclosed objects using the Local Exchange Library. See <a href="ExchangeManagerConcept.html#996950">"Sending and Receiving Locally"</a> for more information. </p>

<h2 class="haH2">
  <a name="996310"> </a>Sending Data <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996311"> </a>This section describes how to send data using the Exchange Manager. It discusses the following topics: </p>
<ul type="disc">
  <li><a name="996315"> </a><a href="ExchangeManagerConcept.html#996325">Sending a Single Object</a>
  <li><a name="996319"> </a><a href="ExchangeManagerConcept.html#996388">Sending Multiple Objects</a>
  <li><a name="996323"> </a><a href="ExchangeManagerConcept.html#996445">Implementing the Send Command</a>
</ul>
<h3 class="hbH3">
  <a name="996325"> </a>Sending a Single Object <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996326"> </a>The most common use of the Exchange Manager is to send or receive a single object. To send an object, do the following: </p>
<ol type="1">
  <li value="1"><a name="996331"> </a>Create and initialize an <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a> data structure with information about which library to use and the data to be sent. See <a href="ExchangeManagerConcept.html#995981">"Initializing the Exchange Socket Structure"</a> for more information. 
  <li value="2"><a name="996339"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056469"><code>ExgPut</code></a> to establish the connection with the exchange library. 
  <li value="3"><a name="996344"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056818"><code>ExgSend</code></a> one or more times to send the data. 
   <p><a name="996345"> </a>In this function, you specify the number of bytes to send, and <code>ExgSend</code> returns the number of bytes that were sent. You may need to call it multiple times if data is remaining to be sent after the first and subsequent calls. </p>
  <li value="4"><a name="996350"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> to end the connection. 
   <p><a name="996351"> </a>A zero (0) return value indicates a successful transmission. However, this doesn't necessarily mean that the receiver kept the data. If the target application for an object doesn't exist on the receiving device, the data is discarded; or the user can decide to discard any received objects.</p>
</ol>

<p><a name="996352"> </a>Note that the <code>ExgSend</code> function blocks until it returns. However, most libraries provide a user interface dialog that keeps the user informed of transmission progress and allows them to cancel the operation. </p>

<p><a name="996353"> </a>The Exchange Manager automatically displays error dialogs as well, if errors occur. You must check for error codes from Exchange Manager routines, but you don't need to display an error dialog if you get one because the Exchange Manager handles this for you.</p>

<p><a name="996357"> </a>For example, <a href="ExchangeManagerConcept.html#996359">Listing 1.3</a> shows how to send the current draw window from one Palm Powered handheld to another Palm Powered handheld. It is modified from the Beamer example application that is included in the Palm OS SDK. </p>
<p class="CCodeCaption">
  <a name="996359"> </a><b>Listing 1.3&nbsp;&nbsp;Sending data using Exchange Manager</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Err SendData(void)<a name="996360"> </a>
{<a name="996361"> </a>
   ExgSocketType exgSocket;<a name="996362"> </a>
   UInt32 size = 0;<a name="996363"> </a>
   UInt32 sizeSent = 0;<a name="996364"> </a>
   Err err = 0;<a name="996365"> </a>
   BitmapType *bmpP;<a name="996366"> </a>
 <a name="996367"> </a>
   // copy draw area into the bitmap<a name="996368"> </a>
   SaveWindow();<a name="996369"> </a>
   bmpP = PrvGetBitmap(canvasWinH, &amp;size, &amp;err);<a name="996370"> </a>
   // Is there data in the field?<a name="996371"> </a>
   if (!err &amp;&amp; size) {<a name="996372"> </a>
      // important to init structure to zeros...<a name="996373"> </a>
      MemSet(&amp;exgSocket,sizeof(exgSocket),0);<a name="996374"> </a>
      exgSocket.description = "Beamer picture";<a name="996375"> </a>
      exgSocket.name = "Beamer.pbm";<a name="996376"> </a>
      exgSocket.length = size;<a name="996377"> </a>
      err = ExgPut(&amp;exgSocket); <a name="996378"> </a>
      if (!err) {<a name="996379"> </a>
         sizeSent = ExgSend(&amp;exgSocket,bmpP,size,&amp;err);<a name="996380"> </a>
         ExgDisconnect(&amp;exgSocket,err);<a name="996381"> </a>
      }<a name="996382"> </a>
   }<a name="996383"> </a>
   if (bmpP) MemPtrFree(bmpP);	<a name="996384"> </a>
   return err;<a name="996385"> </a>
}<a name="996386"> </a>
</pre><div class="CodeRule"><hr></div>

<h3 class="hbH3">
  <a name="996388"> </a>Sending Multiple Objects <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996389"> </a>On Palm OS 4.0 and higher, if the exchange library supports it, you can send multiple objects in a single connection. To send multiple objects, do the following: </p>
<ol type="1">
  <li value="1"><a name="996394"> </a>Create and initialize an <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a> data structure with information about which library to use and the data to be sent. See <a href="ExchangeManagerConcept.html#995981">"Initializing the Exchange Socket Structure"</a> for more information. You might also supply a value for the <code>count</code> field to specify how many objects are to be sent. 
  <li value="2"><a name="996402"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055367"><code>ExgConnect</code></a> to establish the connection with the exchange library. 
  <li value="3"><a name="996403"> </a>For each object, do the following: 
  <ol type="a">
    <li><a name="996408"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056469"><code>ExgPut</code></a> to signal the start of a new object. 
    <li><a name="996413"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056818"><code>ExgSend</code></a> multiple times to send the data. 
      <p><a name="996414"> </a>In this function you specify the number of bytes to send, and <code>ExgSend</code> returns the number of bytes that were sent. You may need to call it multiple times if data is remaining to be sent after the first and subsequent calls. </p>
  </ol>
  <li value="4"><a name="996419"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> to end the connection. 
   <p><a name="996420"> </a>A zero (0) return value indicates a successful transmission. However, this doesn't necessarily mean that the receiver kept the data. If the target application for an object doesn't exist on the receiving device, the data is discarded; or the user can decide to discard any beamed objects.</p>
</ol>

<p><a name="996421"> </a>The <code>ExgConnect</code> call is optional. Some exchange libraries, such as the IR Library, support the sending of multiple objects but do not support <code>ExgConnect</code>. If <code>ExgConnect</code> returns an error, the first call to <code>ExgPut</code> initiates the connection. You should only continue to send objects if the first <code>ExgPut</code> call succeeds. See <a href="ExchangeManagerConcept.html#996426">Listing 1.4</a>. Libraries that support the <code>ExgConnect</code> call also support sending multiple objects without using <code>ExgConnect</code>. </p>
<p class="CCodeCaption">
  <a name="996426"> </a><b>Listing 1.4&nbsp;&nbsp;Sending multiple objects</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Boolean isConnected = false;<a name="996427"> </a>
err = ExgConnect(&amp;exgSocket);      //optional<a name="996428"> </a>
if (!err)<a name="996429"> </a>
   isConnected = true;<a name="996430"> </a>
if (!err || err == exgErrNotSupported) {<a name="996431"> </a>
   while (/* we have objects to send */) {<a name="996432"> </a>
      err = ExgPut(&amp;exgSocket);<a name="996433"> </a>
      if (!isConnected &amp;&amp; !err)<a name="996434"> </a>
         isConnected = true; //auto-connected on first put.<a name="996435"> </a>
      while (!err &amp;&amp; (sizeSent &lt; size)) <a name="996436"> </a>
         sizeSent += ExgSend(&amp;exgSocket,dataP,size,&amp;err);<a name="996437"> </a>
      if (err)<a name="996438"> </a>
         break;<a name="996439"> </a>
   }<a name="996440"> </a>
}<a name="996441"> </a>
if (isConnected) <a name="996442"> </a>
   ExgDisconnect(&amp;exgSocket, err);<a name="996443"> </a>
</pre><div class="CodeRule"><hr></div>

<h3 class="hbH3">
  <a name="996445"> </a>Implementing the Send Command  <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996447"> </a>Starting in Palm OS 4.0, the built-in applications support a Send menu command. The purpose of this command is to allow the user to send data using any available transport mechanism. </p>

<p><a name="996449"> </a>The Exchange Manager defines a _send URL scheme. The intent is that any exchange library that supports sending is registered for the _send scheme. Currently, only the SMS Library is registered for this scheme on release ROMs. When Bluetooth support becomes available, the Bluetooth Library will be registered for this scheme. The IR Library is <i>not</i> registered for the _send scheme. </p>

<p><a name="996450"> </a>To implement the Send command in your application, construct a URL that has the prefix <code>exgSendPrefix</code>, and send the data in the normal manner. You can also use the <code>exgSendBeamPrefix</code> instead so that the user can select from all exchange libraries registered for either sending or beaming (which includes the IR Library). Both of these prefixes begin with a question mark, causing the Exchange Manager to display a dialog if it finds more than one exchange library registered for the specified schemes. </p>

<p><a name="996453"> </a>Currently on a Palm OS 4.0 release ROM, only the SMS Exchange Library supports the _send scheme, so using <code>exgSendPrefix</code> would not cause the dialog to be displayed. If the user later adds Bluetooth support, the prefix would cause the dialog to be displayed. </p>

<div><hr>
  <a name="996454"> </a> <b>NOTE: </b> On debug ROMs, the Local Exchange Library is listed as one of the possible transport mechanisms. This allows you to debug your Send command. The Local Exchange Library is not listed in the Send With dialog on release ROMs. 
<hr>
</div>

<p><a name="996456"> </a>For an example of how to implement the Send command, see the Memo application example code distributed with the Palm OS SDK.</p>

<h2 class="haH2">
  <a name="996458"> </a>Receiving Data <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996459"> </a>To have your application receive data from the Exchange Manager, do the following:</p>
<ol type="1">
  <li value="1"><a name="996460"> </a>Register for the type of data you want to receive. See <a href="ExchangeManagerConcept.html#996099">"Registering for Data"</a> for more information. 
  <li value="2"><a name="996468"> </a>Handle the launch code <a href="../PalmOSReference/AppLaunchCodes.html#1011831"><code>sysAppLaunchCmdExgAskUser</code></a> if you want to control the user confirmation dialog that is displayed. See <a href="ExchangeManagerConcept.html#996494">"Controlling the Exchange Dialog"</a> for more information. 
  <li value="3"><a name="996476"> </a>Handle the launch code <a href="../PalmOSReference/AppLaunchCodes.html#1011910"><code>sysAppLaunchCmdExgPreview</code></a> if you want to display a preview of the data to be received. See <a href="ExchangeManagerConcept.html#996557">"Displaying a Preview"</a> for more information. 
  <li value="4"><a name="996480"> </a>Handle the launch code <a href="../PalmOSReference/AppLaunchCodes.html#1011991"><code>sysAppLaunchCmdExgReceiveData</code></a> to receive the data. See <a href="ExchangeManagerConcept.html#996608">"Receiving the Data"</a> for more information. 
  <li value="5"><a name="996492"> </a>If you want, handle <a href="../PalmOSReference/AppLaunchCodes.html#1012140"><code>sysAppLaunchCmdGoTo</code></a> to display the record. 
</ol>
<h3 class="hbH3">
  <a name="996494"> </a>Controlling the Exchange Dialog <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996495"> </a>When the Exchange Manager receives an object and decides that your application is the target for that object, it sends your application a series of launch codes. The first launch code your application receives, in most cases, is <a href="../PalmOSReference/AppLaunchCodes.html#1011831"><code>sysAppLaunchCmdExgAskUser</code></a>. </p>

<div><hr>
  <a name="996500"> </a> <b>NOTE: </b> In Palm OS 4.0 and higher, the Exchange Manager allows the exchange library to turn off the user confirmation dialog. In this case, your application does not receive the <code>sysAppLaunchCmdExgAskUser</code> launch code. 
<hr>
</div>

<p><a name="996502"> </a>The Exchange Manger sends this launch code because it is about to display the exchange dialog, which asks the user to confirm the receipt of data. The launch code is your opportunity to accept the data without confirmation, reject the data without confirmation, or replace the exchange dialog. </p>

<p><a name="996503"> </a>Responding to this launch code is optional. If you don't respond, the Exchange Manager calls <a href="../PalmOSReference/ExchangeManager.html#1055807"><code>ExgDoDialog</code></a> to display the exchange dialog. </p>

<p><a name="996508"> </a>On Palm OS 3.5 and higher, the <code>ExgDoDialog</code> function allows you to specify that the dialog display a category pop-up list. This pop-up list allows the user to receive the data into a certain category in the database, but the pop-up list is not shown by default. If you want the exchange dialog to display the pop-up list, you must respond to <code>sysAppLaunchCmdExgAskUser</code> and call <code>ExgDoDialog</code> yourself. Pass a pointer to an <code>ExgDialogInfoType</code> structure. The <code>ExgDialogInfoType</code> structure is defined as follows: </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
typedef struct {<a name="996509"> </a>
  UInt16     version;<a name="996510"> </a>
  DmOpenRef  db;<a name="996511"> </a>
  UInt16     categoryIndex;<a name="996512"> </a>
} ExgDialogInfoType;<a name="996514"> </a>
</pre><div class="CodeRule"><hr></div>


<dl>
<dt><a name="996516"> </a><code>&rarr;  <i>version</i></code></dt>
<dd><a name="996517"> </a>Set this field to 0 to specify version 0 of this structure. </dd>

<dt><a name="996518"> </a><code>&rarr;  <i><code>db</code></i></code></dt>
<dd><a name="996519"> </a>A pointer to an open database that defines the categories the dialog should display. </dd>

<dt><a name="996520"> </a><code>&larr;  <i><code>categoryIndex</code></i></code></dt>
<dd><a name="996521"> </a>The index of the category in which the user wants to file the incoming data. </dd>

</dl>

<p><a name="996522"> </a>If <code>db</code> is valid, the function extracts the category information from the specified database and displays it in a pop-up list. Upon return, the <code>categoryIndex</code> field contains the index of the category the user selected, or <code>dmUnfiledCategory</code> if the user did not select a category. </p>

<p><a name="996524"> </a>If the call to <code>ExgDoDialog</code> is successful, your application is responsible for retaining the value returned in <code>categoryIndex</code> and using it to file the incoming data as a record in that category. One way to do this is to store the <code>categoryIndex</code> in the socket's <code>appData</code> field (see <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a>) and then extract it from the socket in your response to the launch code <a href="../PalmOSReference/AppLaunchCodes.html#1011991"><code>sysAppLaunchCmdExgReceiveData</code></a>. See <a href="ExchangeManagerConcept.html#996536">Listing 1.5</a> for an example. </p>
<p class="CCodeCaption">
  <a name="996536"> </a><b>Listing 1.5&nbsp;&nbsp;Extracting the category from the exchange socket</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
UInt16 categoryID = (ExgSocketType *)cmdPBP-&gt;appData;<a name="996537"> </a>
 <a name="996538"> </a>
/* Receive the data, and create a new record using the<a name="996539"> </a>
   received data. indexNew is the index of this record. */<a name="996540"> </a>
if (category != dmUnfiledCategory){<a name="996541"> </a>
   UInt16 attr;<a name="996542"> </a>
   Err err;<a name="996543"> </a>
   err = DmRecordInfo(dbP, indexNew, &amp;attr, NULL, NULL);<a name="996544"> </a>
 <a name="996545"> </a>
   // Set the category to the one the user specified, and <a name="996546"> </a>
   // mark the record dirty. <a name="996547"> </a>
   if ((attr &amp; dmRecAttrCategoryMask) != category) {<a name="996548"> </a>
     attr &amp;= ~dmRecAttrCategoryMask;<a name="996549"> </a>
     attr |= category | dmRecAttrDirty;<a name="996550"> </a>
     err = DmSetRecordInfo(dbP, indexNew, &amp;attr, NULL);<a name="996551"> </a>
   }<a name="996552"> </a>
}<a name="996553"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996554"> </a>Some of the Palm OS built-in applications (Address Book, Memo, and ToDo) use this method of setting the category on data received through beaming. Refer to the example code provided in the Palm OS SDK for these applications for a more complete example of how to use <code>ExgDoDialog</code>.</p>

<p><a name="996555"> </a>When you explicitly call <code>ExgDoDialog</code>, you must set the <code>result</code> field of the <code>sysAppLaunchCmdExgAskUser</code> launch code's parameter block to either <code>exgAskOk</code> (upon success) or <code>exgAskCancel</code> (upon failure) to prevent the system from displaying the dialog a second time. </p>
<h3 class="hbH3">
  <a name="996557"> </a>Displaying a Preview <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996558"> </a>On Palm OS 4.0 and higher, the exchange dialog contains a preview of the data to be received. The preview allows the user to see what the data is. The reason for the preview is that Palm OS 4.0 and higher supports exchange libraries other than the IR Library. When you use the IR Library to beam data to another Palm Powered handheld, the sender and the receiver must be in close contact with one another. Other transport mechanisms do not require the devices to be within close proximity, so the user might not know that the data is being received or why. In this case, the user might need more information about the object being received, so the Exchange Manager displays information about the object in the exchange dialog. Also, some exchange libraries do not transmit information for the exchange socket's <code>description</code> field, so the Exchange Manager must provide another means of supplying the user with information about the data being received. </p>

<p><a name="996560"> </a>To display the preview, the Exchange Manager launches the receiving application with the launch code <a href="../PalmOSReference/AppLaunchCodes.html#1011910"><code>sysAppLaunchCmdExgPreview</code></a>. Your application does not have to respond to this launch code. If it doesn't, the Exchange Manager displays the first item that it locates in the following list: </p>
<ul type="disc">
  <li><a name="996565"> </a>The data's description from the exchange socket's <code>description</code> field
  <li><a name="996566"> </a>The filename in the socket's <code>name</code> field
  <li><a name="996567"> </a>The receiving application's description as stored in the exchange registry (you pass this description to <a href="../PalmOSReference/ExchangeManager.html#1056615"><code>ExgRegisterDatatype</code></a> when registering) 
  <li><a name="996572"> </a>The MIME type in the socket's <code>type</code> field
  <li><a name="996573"> </a>The file extension in the socket's <code>name</code> field
</ul>

<p><a name="996574"> </a>If you want to support a preview that is more elaborate than those in the previous list, handle the <code>sysAppLaunchCmdExgPreview</code> launch code. </p>

<p><a name="996579"> </a>The launch code's parameter block is an <a href="../PalmOSReference/ExchangeManager.html#1054900"><code>ExgPreviewInfoType</code></a> structure. This structure contains the <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure, an <code>op</code> field that describes what type of preview data the Exchange Manager expects, and fields in which to return the data. </p>

<p><a name="996584"> </a>To respond to the launch code, do the following: </p>
<ol type="1">
  <li value="1"><a name="996585"> </a>Check the <code>op</code> field in the parameter block to see what type of preview data is expected. In most cases, the preview data is a string, but a graphical display might also be requested. 
  <li value="2"><a name="996589"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055291"><code>ExgAccept</code></a> to establish a connection with the exchange library. 
  <li value="3"><a name="996593"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056545"><code>ExgReceive</code></a> one or more times to receive the data. 
   <p><a name="996594"> </a>In this function, you specify the number of bytes to receive and it returns the number of bytes that were received. You may need to call it multiple times if data is remaining to be received after the first and subsequent calls. </p>
  <li value="4"><a name="996595"> </a>Place the data in the parameter block's <code>string</code> field if the <code>op</code> field specifies a string preview. If the <code>op</code> field specifies a graphical preview, draw the data into the rectangle identified by the parameter block's <code>bounds</code> field. 
  <li value="5"><a name="996599"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> to end the connection. 
   <p><a name="996600"> </a>A zero (0) return value indicates a successful transmission. </p>
</ol>

<p><a name="996601"> </a>Note that you perform essentially the same steps to preview the data as you do to receive it. The only difference is what you do with the data after you receive it. In response to <code>sysAppLaunchCmdExgPreview</code>, you pass the data back to the Exchange Manager and discard it in case the user rejects the data. In response to <a href="../PalmOSReference/AppLaunchCodes.html#1011991"><code>sysAppLaunchCmdExgReceiveData</code></a>, you store the data. </p>

<p><a name="996606"> </a>For an example of handling the <code>sysAppLaunchCmdExgPreview</code> launch code, see the Address Book example application that is distributed with the Palm OS SDK. The <code>TransferPreview</code> function handles the launch code. </p>
<h3 class="hbH3">
  <a name="996608"> </a>Receiving the Data <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996610"> </a>If the Exchange Manager receives <code>exgAskOk</code> in response to the exchange dialog or the <a href="../PalmOSReference/AppLaunchCodes.html#1011831"><code>sysAppLaunchCmdExgAskUser</code></a> launch code, the next step is to launch the application with <a href="../PalmOSReference/AppLaunchCodes.html#1011991"><code>sysAppLaunchCmdExgReceiveData</code></a>. This launch code tells the application to actually receive the data. </p>

<p><a name="996619"> </a>To respond to this launch code, do the following: </p>
<ol type="1">
  <li value="1"><a name="996624"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055291"><code>ExgAccept</code></a> to accept the connection<code>.</code>
  <li value="2"><a name="996628"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056545"><code>ExgReceive</code></a> one or more times to receive the data.
   <p><a name="996629"> </a>In this function you specify the number of bytes to receive, and <code>ExgReceive</code> returns the number of bytes that were received. You may need to call it multiple times if data is remaining to be received after the first and subsequent calls. </p>
   <p><a name="996630"> </a>Note that in the socket structure, the <code>length</code> field may not be accurate, so in your receive loop you should be flexible in handling more or less data than <code>length</code> specifies.</p>
  <li value="3"><a name="996631"> </a>If you want your application launched again with the <a href="../PalmOSReference/AppLaunchCodes.html#1012140"><code>sysAppLaunchCmdGoTo</code></a> launch code, place your application's creator ID in the <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a>'s <code>goToCreator</code> field and supply the information that should be passed to the launch code in the <code>gotoParams</code> field. (The <code>ExgSocketType</code> structure is the <code>sysAppLaunchCmdExgReceiveData</code>'s parameter block.) 
  <li value="4"><a name="996638"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> to end the connection. 
   <p><a name="996642"> </a>A zero (0) return value indicates a successful transmission. </p>
</ol>

<p><a name="996643"> </a>After your application returns from <code>sysAppLaunchCmdExgReceiveData</code>, if the <code>goToCreator</code> specifies your application's creator ID and if the exchange library supports it, your application is launched with <code>sysAppLaunchCmdGoto</code>. In response to this launch code, your application should launch, open its database, and display the record identified by the <code>recordNum</code> field (or <code>matchCustom</code> field) in the parameter block. The Exchange Manager always does a full application launch with <code>sysAppLaunchCmdGoto</code>, so your application has access to global variables; however, if you also use this launch code to implement the global find facility, you may not have access to global variables in that instance. The example code in <a href="ExchangeManagerConcept.html#996648">Listing 1.6</a> checks to see if globals are available, and if so, calls <code>StartApplication</code> to initialize them. </p>
<p class="CCodeCaption">
  <a name="996648"> </a><b>Listing 1.6&nbsp;&nbsp;Responding to sysAppLaunchCmdGoto</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
case sysAppLaunchCmdGoto:<a name="996649"> </a>
  if (launchFlags &amp; sysAppLaunchFlagNewGlobals) {
     err = StartApplication();<a name="996650"> </a>
     if (err) return err;<a name="996651"> </a>
     GoTo(cmdPBP, true);<a name="996652"> </a>
     EventLoop();<a name="996653"> </a>
     StopApplication();<a name="996654"> </a>
  } else {<a name="996655"> </a>
     GoTo(cmdPBP, false);<a name="996656"> </a>
}<a name="996657"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996658"> </a>On Palm OS 4.0 and higher, not all exchange libraries support using the <code>sysAppLaunchCmdGoto</code> launch code after the receipt of data. </p>

<p><a name="996659"> </a>Also note that because Palm OS 4.0 and higher supports multiple object exchange, there is no guarantee that your application is the one that is launched at the end of a receipt of data. If multiple objects are being received, it is possible for another application to receive data after yours and to set the <code>goToCreator</code> field to its own creator ID. In this case, the last application to set the field is the one that is launched. </p>

<p><a name="996663"> </a><a href="ExchangeManagerConcept.html#996665">Listing 1.7</a> shows a function that receives a data object and sets the <code>goToCreator</code> and <code>goToParams</code>. This code is taken from the Beamer example application that is distributed with the Palm OS SDK. </p>
<p class="CCodeCaption">
  <a name="996665"> </a><b>Listing 1.7&nbsp;&nbsp;Receiving a data object</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
static Err ReceiveData(ExgSocketPtr exgSocketP)<a name="996666"> </a>
{<a name="996667"> </a>
   Err err;<a name="996668"> </a>
   MemHandle dataH;<a name="996669"> </a>
   UInt16 size;<a name="996670"> </a>
   UInt8 *dataP;<a name="996671"> </a>
   Int16 len;<a name="996672"> </a>
   UInt16 dataLen = 0;<a name="996673"> </a>
   <a name="996674"> </a>
   if (exgSocketP-&gt;length)<a name="996675"> </a>
      size = exgSocketP-&gt;length;<a name="996676"> </a>
   else<a name="996677"> </a>
      size = ChunkSize; <a name="996678"> </a>
   dataH = MemHandleNew(size);  <a name="996679"> </a>
   if (!dataH) return -1;  // <a name="996680"> </a>
   // accept will open a progress dialog and wait for your receive commands<a name="996681"> </a>
   err = ExgAccept(exgSocketP);<a name="996682"> </a>
   if (!err){<a name="996683"> </a>
      dataP = MemHandleLock(dataH);<a name="996684"> </a>
      do {<a name="996685"> </a>
         len = ExgReceive(exgSocketP,&amp;dataP[dataLen], size-dataLen,&amp;err);<a name="996686"> </a>
         if (len &amp;&amp; !err) {<a name="996687"> </a>
            dataLen+=len;<a name="996688"> </a>
            // resize block when we reach the limit of this one...<a name="996689"> </a>
            if (dataLen &gt;= size) {<a name="996690"> </a>
               MemHandleUnlock(dataH);<a name="996691"> </a>
               err = MemHandleResize(dataH,size+ChunkSize);<a name="996692"> </a>
               dataP = MemHandleLock(dataH);<a name="996693"> </a>
               if (!err) size += ChunkSize;<a name="996694"> </a>
            }<a name="996695"> </a>
         }<a name="996696"> </a>
      }<a name="996697"> </a>
      while (len &amp;&amp; !err);<a name="996698"> </a>
 <a name="996699"> </a>
      MemHandleUnlock(dataH);<a name="996700"> </a>
      <a name="996701"> </a>
      ExgDisconnect(exgSocketP,err); // closes transfer dialog<a name="996702"> </a>
      <a name="996703"> </a>
      if (!err) {<a name="996704"> </a>
         exgSocketP-&gt;goToCreator = beamerCreator;<a name="996705"> </a>
         exgSocketP-&gt;goToParams.matchCustom = (UInt32)dataH;<a name="996706"> </a>
      }<a name="996707"> </a>
   }<a name="996708"> </a>
   // release memory if an error occured<a name="996709"> </a>
   if (err) MemHandleFree(dataH);<a name="996710"> </a>
   return err;<a name="996711"> </a>
}<a name="996712"> </a>
</pre><div class="CodeRule"><hr></div>


<h2 class="haH2">
  <a name="996714"> </a>Sending and Receiving Databases <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996716"> </a>It's common to want to send and receive an entire database using the Exchange Manager. For example, you might want to allow your application's users to share their versions of the PDB file associated with your application by beaming that file to each other. </p>

<p><a name="996717"> </a>Sending and receiving a database involves the extra steps of flattening the database into a byte stream when sending and un-flattening it upon return. </p>
<h3 class="hbH3">
  <a name="996719"> </a>Sending a Database <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996720"> </a>To send a database, do the following: </p>
<ol type="1">
  <li value="1"><a name="996725"> </a>Create and initialize an <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a> data structure with information about which library to use and the data to be sent. See <a href="ExchangeManagerConcept.html#995981">"Initializing the Exchange Socket Structure"</a> for more information. 
  <li value="2"><a name="996733"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056469"><code>ExgPut</code></a> to establish the connection with the exchange library. 
  <li value="3"><a name="996738"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055648"><code>ExgDBWrite</code></a> and pass it a pointer to a callback function in your application that it can use to send the database. You make the call to <a href="../PalmOSReference/ExchangeManager.html#1056818"><code>ExgSend</code></a> in that function.
  <li value="4"><a name="996747"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> to end the connection. 
</ol>

<p><a name="996748"> </a>The <code>ExgDBWrite</code> function takes as parameters the local ID and card number of the database to be sent and a pointer to a callback function. You may also pass in the name of the database as it should appear in a file list and any application-specific data you want passed to the callback function. In this case, you would pass the pointer to the exchange socket structure as the application-specific data. If you need any other data, create a structure that contains the exchange socket and pass a pointer to that structure instead. </p>

<p><a name="996749"> </a>The write callback function is called as many times as is necessary to send the data. It takes three arguments: a pointer to the data to be sent, the size of the data, and the application-specific data passed as the second argument to <code>ExgDBWrite</code>. </p>

<p><a name="996753"> </a><a href="ExchangeManagerConcept.html#996755">Listing 1.8</a> shows an example of how to send a database. The <code>SendMe</code> function looks up the database creator ID and card number and passes it to the <code>SendDatabase</code> function. The <code>SendDatabase</code> function creates and initializes the exchange socket structure and then passes all that information along to the <code>ExgDBWrite</code> function. The <code>ExgDBWrite</code> function locates the database in the storage heap, translates it into a stream of bytes and passes that byte stream as the first argument to the write callback function <code>WriteDBData</code>. <code>WriteDBData</code> forwards the exchange socket and the data stream to the <code>ExgSend</code> call, sets its size parameter to the number of bytes sent (the return value of <code>ExgSend</code>), and returns any error returned by <code>ExgSend</code>. </p>
<p class="CCodeCaption">
  <a name="996755"> </a><b>Listing 1.8&nbsp;&nbsp;Sending a database</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
 <a name="996756"> </a>
// Callback for ExgDBWrite to send data with Exchange Manager <a name="996757"> </a>
Err WriteDBData(const void* dataP, ULong* sizeP, void* userDataP) <a name="996758"> </a>
{<a name="996759"> </a>
   Err err;<a name="996760"> </a>
 <a name="996761"> </a>
   *sizeP = ExgSend((ExgSocketPtr)userDataP, (void*)dataP, *sizeP, &amp;err);<a name="996762"> </a>
   return err;<a name="996763"> </a>
}<a name="996764"> </a>
 <a name="996765"> </a>
Err SendDatabase (Word cardNo, LocalID dbID, CharPtr nameP, <a name="996766"> </a>
CharPtr descriptionP) <a name="996767"> </a>
{<a name="996768"> </a>
   ExgSocketType exgSocket;<a name="996769"> </a>
   Err err;<a name="996770"> </a>
 <a name="996771"> </a>
   // Create exgSocket structure<a name="996772"> </a>
   MemSet(&amp;exgSocket, sizeof(exgSocket), 0);<a name="996773"> </a>
   exgSocket.description = descriptionP;<a name="996774"> </a>
   exgSocket.name = nameP;<a name="996775"> </a>
 <a name="996776"> </a>
   // Start an exchange put operation<a name="996777"> </a>
   err = ExgPut(&amp;exgSocket);<a name="996778"> </a>
   if (!err) {<a name="996779"> </a>
      err = ExgDBWrite(WriteDBData, &amp;exgSocket, NULL, dbID, cardNo);<a name="996780"> </a>
      err = ExgDisconnect(&amp;exgSocket, err);<a name="996781"> </a>
   }<a name="996782"> </a>
   return err;<a name="996783"> </a>
}<a name="996784"> </a>
 <a name="996785"> </a>
// Sends this application<a name="996786"> </a>
Err SendMe(void)<a name="996787"> </a>
{<a name="996788"> </a>
   Err err;<a name="996789"> </a>
 <a name="996790"> </a>
   // Find our app using its internal name<a name="996791"> </a>
   LocalID dbID = DmFindDatabase(0, "Beamer");<a name="996792"> </a>
 <a name="996793"> </a>
   if (dbID)<a name="996794"> </a>
      err = SendDatabase(0, dbID, "Beamer.prc", "Beamer application");<a name="996795"> </a>
   else<a name="996796"> </a>
      err = DmGetLastErr();<a name="996797"> </a>
   return err;<a name="996798"> </a>
}<a name="996799"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996800"> </a>Note that there is nothing about <code>ExgDBWrite</code> that is tied to the Exchange Manager, so it may be used to send a database using other transport mechanisms as well. For example, if you wanted to transfer a database from your Palm Powered handheld to your desktop PC using the serial port, you could use <code>ExgDBWrite</code> to do so. </p>
<h3 class="hbH3">
  <a name="996801"> </a>Receiving a Database <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996802"> </a>The Launcher application receives databases with the <code>.prc</code> or <code>.pdb</code> file extension. If you want your application to be launched when the database is received, you can use a different extension and handle receiving the database within your application. For example, a book reader application might want to be launched when the user is beamed a book. In this case, the book reader application might use an extension such as <code>.bk</code> for the book databases. </p>

<p><a name="996803"> </a>You receive a database by responding to the same launch codes that you do for receiving any other data object (see <a href="ExchangeManagerConcept.html#996458">"Receiving Data"</a>); however, your response to the <a href="../PalmOSReference/AppLaunchCodes.html#1011991"><code>sysAppLaunchCmdExgReceiveData</code></a> launch code is a little different: </p>
<ol type="1">
  <li value="1"><a name="996814"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055291"><code>ExgAccept</code></a> to accept the connection.
  <li value="2"><a name="996819"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055573"><code>ExgDBRead</code></a> and pass it a pointer to a callback function in your application that it can use to read the database. You make the call to <a href="../PalmOSReference/ExchangeManager.html#1056545"><code>ExgReceive</code></a> in that function.
  <li value="3"><a name="996828"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> to end the connection. 
</ol>

<p><a name="996829"> </a>The <code>ExgDBRead</code> function takes as parameters two pointers to callback functions. The first callback function is a function that is called multiple times to read the data. The second function is used if the database to be received already exists on the device. </p>

<h2 class="haH2">
  <a name="996831"> </a>Requesting Data <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996832"> </a>On Palm OS 4.0 and higher, some exchange libraries allow you to request data from a remote device through a call to <a href="../PalmOSReference/ExchangeManager.html#1055912"><code>ExgGet</code></a>. You can use <a href="../PalmOSReference/ExchangeManager.html#1055912"><code>ExgGet</code></a> to implement two-way communications between two Palm<sup>&#8482;</sup> devices. </p>

<p><a name="996841"> </a>This section describes how to use the Exchange Manager to request data. It covers: </p>
<ul type="disc">
  <li><a name="996845"> </a><a href="ExchangeManagerConcept.html#996859">Sending a Get Request for a Single Object</a>
  <li><a name="996849"> </a><a href="ExchangeManagerConcept.html#996889">Responding to a Get Request</a>
  <li><a name="996853"> </a><a href="ExchangeManagerConcept.html#996910">Two-Way Communications</a>
  <li><a name="996857"> </a><a href="ExchangeManagerConcept.html#996930">Requesting a URL</a>
</ul>
<h3 class="hbH3">
  <a name="996859"> </a>Sending a Get Request for a Single Object <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996860"> </a>To request data from a remote device, do the following: </p>
<ol type="1">
  <li value="1"><a name="996861"> </a>Create and initialize an exchange socket structure (<a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a>) as described in <a href="ExchangeManagerConcept.html#995981">"Initializing the Exchange Socket Structure"</a>section. The data structure should identify the exchange library and the type of data that your application wants to receive. 
  <li value="2"><a name="996873"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055912"><code>ExgGet</code></a> to establish the connection and request the data. 
   <p><a name="996874"> </a>In response, the exchange library establishes a connection with the remote device, and upon return has data that your application should receive. If the remote device is a Palm Powered handheld, the exchange library obtains this data from an application on the remote side using the process described in the <a href="ExchangeManagerConcept.html#996889">"Responding to a Get Request"</a> section. </p>
  <li value="3"><a name="996882"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056545"><code>ExgReceive</code></a> one or more times to receive the data.
  <li value="4"><a name="996887"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> to end the connection. 
</ol>
<h3 class="hbH3">
  <a name="996889"> </a>Responding to a Get Request  <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996890"> </a>When the Exchange Manager on the remote device receives the get request, it launches the appropriate application with the launch code <a href="../PalmOSReference/AppLaunchCodes.html#1011877"><code>sysAppLaunchCmdExgGetData</code></a>. </p>

<p><a name="996896"> </a>Your response to the <code>sysAppLaunchCmdExgGetData</code> launch code should be to send the requested data: </p>
<ol type="1">
  <li value="1"><a name="996900"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1056818"><code>ExgSend</code></a> one or more times. 
  <li value="2"><a name="996904"> </a>Call <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> when finished. 
</ol>

<p><a name="996908"> </a>See the <a href="ExchangeManagerConcept.html#996325">"Sending a Single Object"</a> section for more information. </p>
<h3 class="hbH3">
  <a name="996910"> </a>Two-Way Communications <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996918"> </a>You can use <a href="../PalmOSReference/ExchangeManager.html#1055912"><code>ExgGet</code></a> and <a href="../PalmOSReference/ExchangeManager.html#1056469"><code>ExgPut</code></a> in combination with the <a href="../PalmOSReference/ExchangeManager.html#1055367"><code>ExgConnect</code></a> call to have your application perform two-way communication. For example, you may want to implement two-way communication in a multiuser game. </p>

<p><a name="996923"> </a>In such a situation, one device acts as a client and the other acts as a server. The client calls <code>ExgConnect</code>, which tells the exchange library that a connection is established to perform multiple operations, such as the sending of multiple objects. The client then calls <code>ExgGet</code> or <code>ExgPut</code> repeatedly and calls <a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a> when finished. On the server device, the appropriate application is launched for each of these requests. The server also calls <code>ExgDisconnect</code> when it is done sending or receiving each object. The swapping of client and server roles is not supported. </p>

<p><a name="996928"> </a>Remember that not all exchange libraries support <code>ExgConnect</code> and <code>ExgGet</code>. If either one of these returns an error, your application should assume that this feature is not available. </p>
<h3 class="hbH3">
  <a name="996930"> </a>Requesting a URL  <a href="#995795"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996936"> </a>In addition to requesting data with an <a href="../PalmOSReference/ExchangeManager.html#1055912"><code>ExgGet</code></a> call, you can request a URL with a <a href="../PalmOSReference/ExchangeManager.html#1056753"><code>ExgRequest</code></a> call on Palm OS 4.0 and higher. The idea behind the <code>ExgRequest</code> call is to follow the model of pull technology. You could, for example, implement a web browser if you had an exchange library that supported the HTTP protocol. You could then send an <code>ExgRequest</code> call with an exchange socket containing a URL such as <code>http://www.palmos.com</code> and receive the web page in response. </p>

<p><a name="996941"> </a>The fundamental differences between <code>ExgRequest</code> and <code>ExgGet</code> are: </p>
<ul type="disc">
  <li><a name="996942"> </a><code>ExgRequest</code> does not automatically send the data back to the application that requested it. With <code>ExgRequest</code>, when the exchange library receives the requested data, it has the Exchange Manager send it to the default application for that data type. 
  <li><a name="996943"> </a>Applications can register for URLs sent using <code>ExgRequest</code>. <code>ExgRequest</code> first looks for an exchange library that handles the URL scheme. If it cannot find one, it looks for an application instead. If it finds an application, it launches it with the <a href="../PalmOSReference/AppLaunchCodes.html#1012191"><code>sysAppLaunchCmdGoToURL</code></a> launch code. 
   <p><a name="996948"> </a>For example, the iMessenger application distributed with the Palm OS SDK registers for the <code>mailto</code> URL scheme. If another application wants to implement an e-mail command, it could do so by calling <code>ExgRequest</code> and passing an exchange socket with a URL that begins with <code>mailto</code>. In response to this command, the Exchange Manager launches the iMessenger application, allowing the user to compose the email. </p>
</ul>

<h2 class="haH2">
  <a name="996950"> </a>Sending and Receiving Locally <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996952"> </a>Most of this chapter has described how to use the Exchange Manager to send data to a remote device and receive data from a remote device. </p>

<p><a name="996953"> </a>You may also use the Exchange Manager to exchange data with other applications on the local device. To do so, use the Local Exchange Library. You might want to do so in the following circumstances: </p>
<ul type="disc">
  <li><a name="996954"> </a>You might have an application that creates some sort of event in the Datebook application. Your users might have an application that they use in place of the built-in Datebook. To ensure that the appointment is sent to the user's chosen application, you can send that data as a vCalendar object using the Local Exchange Manager. This way, whichever application is the default in the Exchange Manager registry is the one that receives your vCalendar. 
  <li><a name="996955"> </a>You could use the preview feature of the Exchange Manager to have another application display data for you. As described in the <a href="ExchangeManagerConcept.html#996557">"Displaying a Preview"</a> section, an application can be launched with the <a href="../PalmOSReference/AppLaunchCodes.html#1011910"><code>sysAppLaunchCmdExgPreview</code></a> launch code to display a preview of the data it is registered to receive. You could use this feature in your own application to display data your application does not recognize. Suppose your application has a GIF and wants to display it in a dialog. It could use the Local Exchange Library to send that GIF to a graphics application on the local device, which in response draws the preview into the bounds of a rectangle you provide. 
  <li><a name="996962"> </a>Your application receives compound data objects, such as e-mail messages that contain attachments intended for other applications. As described in the <a href="ExchangeManagerConcept.html#996285">"Registering to Receive Unwrapped Data"</a> section, exchange libraries can "unwrap" a compound object and deliver the objects it contains directly; however, doing so is the exception the rule. 
   <p><a name="996966"> </a>It's much more common for the e-mail message to be sent to the e-mail application and have the attachments delivered to the appropriate applications only when the user requests it. In response to a user request, the e-mail application extracts the attached object and uses the Local Exchange Library to send it to the application that should receive it. </p>
  <li><a name="996967"> </a>Your application exchanges data with a remote device, and you want to debug the code that interacts with the Exchange Manager. In this case, using the Local Exchange Library causes your application to send data in loopback mode, where it is also the recipient of the data. 
</ul>

<p><a name="996968"> </a>To use the Local Exchange Library, do the following: </p>
<ol type="1">
  <li value="1"><a name="996973"> </a>Use a URL in the <code>name</code> field of the <a href="../PalmOSReference/ExchangeManager.html#1054999"><code>ExgSocketType</code></a> structure to identify the Local Exchange Library. Begin the URL with the constant string <code>exgLocalPrefix</code>. 
   <p><a name="996974"> </a>The Exchange Manager only supports URLs on Palm OS 4.0 and higher. On Palm OS 3.X devices, set the <code>localMode</code> flag to 1 to interact with the Local Exchange Library instead of the IR Library. </p>
  <li value="2"><a name="996975"> </a>If you want to suppress the exchange dialog or if you want to perform a preview operation, create and initialize an <a href="../PalmOSReference/ExchangeManager.html#1054828"><code>ExgLocalSocketInfoType</code></a> structure and assign it to the socket's <code>socketRef</code> field. 

<div class="CodeRule"><hr></div><pre class="CodeBlock">
typedef struct {<a name="996980"> </a>
  Boolean freeOnDisconnect;<a name="996981"> </a>
  Boolean noAsk;<a name="996982"> </a>
  ExgPreviewInfoType *previewInfoP;<a name="996983"> </a>
  ExgLocalOpType op;<a name="996984"> </a>
  FileHand tempFileH;<a name="996985"> </a>
} ExgLocalSocketInfoType;<a name="996986"> </a>
</pre><div class="CodeRule"><hr></div>

   <p><a name="996987"> </a>where the following are parameters you might want to set:</p>
</ol>


<div class="tablediv"><table cellspacing="0" class="tTableNR">

  <tr valign="top">
    <td><p class="tt"><a name="996990"> </a><code>freeOnDisconnect </code></p>
    </td>
    <td><p class="tt"><a name="996992"> </a>Whether the structure is freed when the <code>ExgDisconnect</code> call is made. The default is <code>true</code>. In general, code that allocates a structure should be responsible for freeing that structure. Therefore, if you have allocated <code>ExgLocalSocketInfoType</code>, you should set this field to <code>false</code> and explicitly free the structure when you are finished with it. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996994"> </a><code>noAsk </code></p>
    </td>
    <td><p class="tt"><a name="996996"> </a>Set to <code>true</code> to disable the display of the exchange dialog. If you want to, for example, create a vCalendar object and send it to the datebook application in response to a user command, you probably want to set <code>noAsk</code> to <code>true</code> so that the user does not have to confirm the receipt of the data they just requested you to send. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996998"> </a><code>previewInfoP </code></p>
    </td>
    <td><p class="tt"><a name="997004"> </a>A pointer to an <a href="../PalmOSReference/ExchangeManager.html#1054900"><code>ExgPreviewInfoType</code></a> structure, used to display a preview of the data. If you wanted to simply use another application to help display data, you would create and initialize this structure. </p>
    </td>
  </tr>
</table>

</div>

   <p><a name="997006"> </a>All other fields are set by the Local Exchange Library. If you don't create this structure, the library does it for you; therefore, you only need to create this structure if you want to supply non-default values for the <code>noAsk</code> or <code>previewInfoP</code> fields. </p>
<ol type="1">
  <li value="3"><a name="997007"> </a>You can suppress the display of the progress dialogs that the exchange libraries typically display by setting the <code>noStatus</code> field of the <code>ExgSocketType</code> structure to <code>true</code>. 
  <li value="4"><a name="997010"> </a>Send and receive data in the normal manner. See <a href="ExchangeManagerConcept.html#996310">"Sending Data"</a> and <a href="ExchangeManagerConcept.html#996458">"Receiving Data"</a> for details. 
</ol>

<h2 class="haH2">
  <a name="997016"> </a>Interacting with the Launcher <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="997018"> </a>On Palm OS 4.0 and higher, when you beam an application from the Launcher, other databases can be automatically beamed with it. If the application has an associated overlay database, the overlay is beamed along with the application. You do not have to perform any extra work to allow this to happen. </p>

<p><a name="997020"> </a>Overlay database support begins in Palm OS 3.5; however, if you beam an application from the Palm OS 3.5 Launcher application, it does not beam the overlay. </p>

<p><a name="997021"> </a>In addition to beaming overlays, you can set up a record database so that the Launcher beams it along with the application database and the overlay. For example, a dictionary application might have its dictionary data in an associated database. When a user beams the dictionary application to another user, the dictionary data should be beamed along with the application itself. To allow this to happen, you set the bit <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">dmHdrAttrBundle</span> in the database's attributes, as shown here: </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
DmDatabaseInfo(cardNo, dbID, NULL, &amp;attributes, <a name="997023"> </a>
  NULL, NULL, NULL, NULL, NULL, NULL, NULL, <a name="997024"> </a>
  NULL, NULL);<a name="997025"> </a>
attributes |= dmHdrAttrBundle;<a name="997026"> </a>
DmSetDatabaseInfo(cardNo, dbID, NULL, <a name="997027"> </a>
  &amp;attributes, NULL, NULL, NULL, NULL, NULL, <a name="997028"> </a>
  NULL, NULL, NULL, NULL);<a name="997029"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="997030"> </a>If you beam an application plus databases to a device running Palm OS 4.0 or higher, the user sees a single confirmation message. If you beam the application to a device running Palm OS 3.X, the device receives only the application database and displays an alert saying that it cannot receive the other databases. </p>

<h2 class="haH2">
  <a name="997031"> </a>Summary of Exchange Manager <a href="#995795"><span class="nav">^TOP^</span></a>
</h2>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="997034"> </a><b>Exchange Manager Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997038"> </a><b>Sending Data </b></p>
    </td>
    <td><p class="tt"><a name="997040"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997045"> </a><a href="../PalmOSReference/ExchangeManager.html#1056818"><code>ExgSend</code></a></p>
<p class="tt"><a name="997049"> </a><a href="../PalmOSReference/ExchangeManager.html#1056469"><code>ExgPut</code></a></p>
    </td>
    <td><p class="tt"><a name="997054"> </a><a href="../PalmOSReference/ExchangeManager.html#1055648"><code>ExgDBWrite</code></a><br></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997056"> </a><b>Receiving Data </b></p>
    </td>
    <td><p class="tt"><a name="997058"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997063"> </a><a href="../PalmOSReference/ExchangeManager.html#1056545"><code>ExgReceive</code></a></p>
<p class="tt"><a name="997067"> </a><a href="../PalmOSReference/ExchangeManager.html#1055291"><code>ExgAccept</code></a></p>
    </td>
    <td><p class="tt"><a name="997072"> </a><a href="../PalmOSReference/ExchangeManager.html#1055573"><code>ExgDBRead</code></a></p>
<p class="tt"><a name="997073"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997075"> </a><b>Registering for Data </b></p>
    </td>
    <td><p class="tt"><a name="997077"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997082"> </a><a href="../PalmOSReference/ExchangeManager.html#1056615"><code>ExgRegisterDatatype</code></a></p>
<p class="tt"><a name="997086"> </a><a href="../PalmOSReference/ExchangeManager.html#1056868"><code>ExgSetDefaultApplication</code></a></p>
    </td>
    <td><p class="tt"><a name="997091"> </a><a href="../PalmOSReference/ExchangeManager.html#1056721"><code>ExgRegisterData</code></a></p>
<p class="tt"><a name="997092"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997094"> </a><b>Requesting Data </b></p>
    </td>
    <td><p class="tt"><a name="997096"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997101"> </a><a href="../PalmOSReference/ExchangeManager.html#1055912"><code>ExgGet</code></a></p>
    </td>
    <td><p class="tt"><a name="997106"> </a><a href="../PalmOSReference/ExchangeManager.html#1056753"><code>ExgRequest</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997108"> </a><b>Connecting and Disconnecting </b></p>
    </td>
    <td><p class="tt"><a name="997110"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997115"> </a><a href="../PalmOSReference/ExchangeManager.html#1055705"><code>ExgDisconnect</code></a></p>
    </td>
    <td><p class="tt"><a name="997120"> </a><a href="../PalmOSReference/ExchangeManager.html#1055367"><code>ExgConnect</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997122"> </a><b>Displaying the Exchange Dialog</b></p>
    </td>
    <td><p class="tt"><a name="997124"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997129"> </a><a href="../PalmOSReference/ExchangeManager.html#1055807"><code>ExgDoDialog</code></a></p>
    </td>
    <td><p class="tt"><a name="997131"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997133"> </a><b>Obtaining Registry Information</b></p>
    </td>
    <td><p class="tt"><a name="997135"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997140"> </a><a href="../PalmOSReference/ExchangeManager.html#1056150"><code>ExgGetTargetApplication</code></a></p>
<p class="tt"><a name="997144"> </a><a href="../PalmOSReference/ExchangeManager.html#1056045"><code>ExgGetRegisteredApplications</code></a></p>
    </td>
    <td><p class="tt"><a name="997149"> </a><a href="../PalmOSReference/ExchangeManager.html#1056103"><code>ExgGetRegisteredTypes</code></a></p>
<p class="tt"><a name="997153"> </a><a href="../PalmOSReference/ExchangeManager.html#1055984"><code>ExgGetDefaultApplication</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997155"> </a><b>Querying the Exchange Library</b></p>
    </td>
    <td><p class="tt"><a name="997157"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997162"> </a><a href="../PalmOSReference/ExchangeManager.html#1055470"><code>ExgControl</code></a></p>
    </td>
    <td><p class="tt"><a name="997164"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997166"> </a><b>For Exchange Library Use Only</b></p>
    </td>
    <td><p class="tt"><a name="997168"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997173"> </a><a href="../PalmOSReference/ExchangeManager.html#1056358"><code>ExgNotifyReceive</code></a></p>
<p class="tt"><a name="997177"> </a><a href="../PalmOSReference/ExchangeManager.html#1056284"><code>ExgNotifyPreview</code></a></p>
    </td>
    <td><p class="tt"><a name="997182"> </a><a href="../PalmOSReference/ExchangeManager.html#1056225"><code>ExgNotifyGoto</code></a><br></p>
    </td>
  </tr>
</table>

</div>


<p><a name="997184"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996-2004, PalmSource, Inc. and its affiliates.  All rights reserved. <br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="Companion2Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="Companion2TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Companion2About.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ExchangeLibraries.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Companion2IX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>