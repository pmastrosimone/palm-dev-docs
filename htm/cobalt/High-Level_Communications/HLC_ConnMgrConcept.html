<html>
<head>
<title>(Protein) Connections | High-Level Communications</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 11:10:49">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="996635"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="HLC_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="HLC_ConnMgrPart.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="HLC_ConnMgrPlugins.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="HLC_IX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">1 &nbsp;&nbsp;
Connections</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">High-Level Communications</p>
<p class="SubTitle">Exploring Palm OS&#174; </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="HLC_ConnMgrPart.html">Part I: Connection Manager</a> </h1>
<h1 class="SideTOC1"><a href="HLC_ConnMgrConcept.html">1  Connections</a></h1>

   <h2 class="SideTOC2"><a href="#992795">
   About the Connection Manager</a></h2>

      <h3 class="SideTOC3"><a href="#992822">
      Overview</a></h3>

      <h3 class="SideTOC3"><a href="#992843">
      Terminology</a></h3>

      <h3 class="SideTOC3"><a href="#992897">
      Connection Profiles</a></h3>

      <h3 class="SideTOC3"><a href="#992943">
      Security Considerations</a></h3>

      <h3 class="SideTOC3"><a href="#992949">
      Persistent Connections</a></h3>

      <h3 class="SideTOC3"><a href="#999650">
      Graph Management</a></h3>

   <h2 class="SideTOC2"><a href="#992955">
   Using the Connection Manager</a></h2>

      <h3 class="SideTOC3"><a href="#992998">
      Making a Connection</a></h3>

      <h3 class="SideTOC3"><a href="#993028">
      Creating a Profile</a></h3>

      <h3 class="SideTOC3"><a href="#993052">
      Changing a Profile</a></h3>

      <h3 class="SideTOC3"><a href="#993105">
      Finding Profiles</a></h3>

      <h3 class="SideTOC3"><a href="#993130">
      Managing Profiles</a></h3>

      <h3 class="SideTOC3"><a href="#1000036">
      Configuring Components</a></h3>

      <h3 class="SideTOC3"><a href="#995954">
      Invoking a Function in a Profile Plug-In</a></h3>

   <h2 class="SideTOC2"><a href="#1001676">
   Summary of Connection Manager</a></h2>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1000903"> </a>The Connection Manager API provides a central mechanism for managing Palm OS<sup>&#174;</sup> communications connections at a high level. This chapter contains the following sections that describe how to use the Palm OS Connection Manager:</p>
<ul type="disc">
  <li><a name="992785"> </a><a href="HLC_ConnMgrConcept.html#992795">"About the Connection Manager,"</a> explains concepts you need to know before you can begin using the Connection Manager.
  <li><a name="992789"> </a><a href="HLC_ConnMgrConcept.html#992955">"Using the Connection Manager,"</a> describes how to use the functions in the Connection Manager to accomplish common tasks.
</ul>

<p><a name="992790"> </a>For information about the built-in Connection Manager plug-ins, see <a href="HLC_ConnMgrPlugins.html#996635">Chapter 2, "Connection Manager Plug-ins."</a></p>

<p><a name="1009971"> </a>For detailed information about Connection Manager data types, constants, and functions, see <a href="HLC_ConnMgrRef.html#1081469">Chapter 3, "Connection Manager Reference."</a></p>

<h2 class="haH2">
  <a name="992795"> </a>About the Connection Manager <a href="#996635"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="992796"> </a>This section explains concepts you need to know before you can begin using the Connection Manager. It discusses the following topics:</p>
<ul type="disc">
  <li><a name="992800"> </a><a href="HLC_ConnMgrConcept.html#992822">Overview</a>
  <li><a name="992804"> </a><a href="HLC_ConnMgrConcept.html#992843">Terminology</a>
  <li><a name="992812"> </a><a href="HLC_ConnMgrConcept.html#992897">Connection Profiles</a>
  <li><a name="992816"> </a><a href="HLC_ConnMgrConcept.html#992943">Security Considerations</a>
  <li><a name="992820"> </a><a href="HLC_ConnMgrConcept.html#992949">Persistent Connections</a>
  <li><a name="999728"> </a><a href="HLC_ConnMgrConcept.html#999650">Graph Management</a>
</ul>
<h3 class="hbH3">
  <a name="992822"> </a>Overview <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="992823"> </a>The Connection Manager manages at a high level all connections from the Palm Powered<sup>&#8482;</sup> handheld to external devices. <a href="HLC_ConnMgrConcept.html#992828">Figure 1.1</a> shows how the Connection Manager interacts with other components in the communications system.</p>

<p class="FFigureCaption">
  <a name="992828"> </a><b>Figure 1.1&nbsp;&nbsp;Connection Manager architecture</b>
</p>
<div align="left"><img src="images/ConnectionMgrOverview.jpg" height="499" width="624" border="0" hspace="0" vspace="0">
</div>

<p><a name="992833"> </a>Communications components are installed in the Palm OS in the form of Connection Manager plug-ins, which handle the work of making, maintaining, and terminating communications connections at a low level. A Connection Manager plug-in is a piece of code that is responsible for configuring and connecting one or more communications components that implement one or more protocols. A plug-in also contains the user interface parts that are necessary to configure its components. Examples of plug-ins include Bluetooth, TCP/IP, PPP, USB, and IrDA.</p>

<p><a name="992834"> </a>Connection Manager plug-ins are built on the IOS (Input/Output Subsystem) framework and typically make use of lower-level IOS drivers and modules. Connection Manager plug-ins that are built into the Palm OS are described in <a href="HLC_ConnMgrPlugins.html#996635">Chapter 2, "Connection Manager Plug-ins."</a> Licensees and hardware developers can find more information about developing and installing plug-ins in the book <i>Network Driver Design Guide</i> in the Palm OS Platform Development Kit (PDK).</p>

<p><a name="992835"> </a>The Connection Manager controls the communications plug-ins, requesting them to display configuration dialogs to the user, make connections, and terminate connections.</p>

<p><a name="992836"> </a>The Connection Manager provides a user interface framework that invokes configuration dialogs supplied by plug-ins, handles transitions between forms, allows editing of configurations and profiles, and includes progress indicators and error display.</p>

<p><a name="992837"> </a>The main functions of the Connection Manager include:</p>
<ul type="disc">
  <li><a name="992838"> </a>Managing communications plug-ins, which provide specific communications facilities and protocols to the Palm OS
  <li><a name="992839"> </a>Managing communications profiles, a kind of communications stack that links together various plug-ins to provide a complete communications path between an application and a remote service
  <li><a name="992840"> </a>Establishing connections by using profiles
</ul>

<p><a name="992841"> </a>The Connection Manager only manages connections and does not send or receive data. You must use APIs provided by the plug-ins or the system, such as the STDIO API, to send and receive data once a connection is established.</p>
<h3 class="hbH3">
  <a name="992843"> </a>Terminology <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="992844"> </a>This section defines terms important to understanding the Connection Manager.</p>

<dl>
<dt><a name="999368"> </a>availability</dt>
<dd><a name="999369"> </a>The Connection Manager determines the availability of a profile by querying each plug-in in the profile. If all plug-ins are available then the profile is available. Availability can change depending on system configuration and external circumstances. For example, a Bluetooth connection may be unavailable if there are no other Bluetooth devices within range.</dd>

<dt><a name="992845"> </a>communications component</dt>
<dd><a name="992846"> </a>A piece of code involved in a communications stack. It can implement a protocol or offer services like compression and encryption. A Connection Manager plug-in can represent one or more communications components, and a communications component can be associated with multiple plug-ins.</dd>

<dt><a name="992847"> </a>Connection Manager database</dt>
<dd><a name="992848"> </a>A database that stores records that reference plug-ins, interfaces, and connection profiles. All configuration information is stored in this database. </dd>

<dt><a name="992849"> </a>Connection Manager server</dt>
<dd><a name="992850"> </a>Most of the Connection Manager code runs in the Connection Manager server, a thread that runs in the system process, along with the plug-ins. The Connection Manager library transparently communicates with the server to accomplish operations requested by API calls.</dd>

<dt><a name="992851"> </a>connection type</dt>
<dd><a name="992852"> </a>The protocol used by the top-level component in a profile is the connection type of the profile.</dd>

<dt><a name="992853"> </a>edge</dt>
<dd><a name="992854"> </a>A hierarchical relationship between two components, where one component requires another lower-level one to make a connection. A component can have multiple edges to other components if there are multiple options available. The search algorithm uses edges to find related nodes.</dd>

<dt><a name="992855"> </a>graph</dt>
<dd><a name="992856"> </a>The hierarchical arrangement of nodes (plug-ins or interfaces) from the connection database that describes all the components that can be used for a particular connection type. It may contain multiple paths, each potentially used for a different profile.</dd>

<dt><a name="992857"> </a>interface</dt>
<dd><a name="992858"> </a>A graph node that is an abstraction of plug-ins with similar interfaces. An interface node has no associated code module or user interface components; it is simply an object in the Connection Manager database that relates to other plug-ins.</dd>

<dt><a name="996517"> </a>macro profile</dt>
<dd><a name="996518"> </a>A special profile that is used as a macro reference in other profiles. Macro profile names must begin with the special character <code>kCncMacroSpecialChar</code>, which is the open curly brace "{". An example of a macro profile is: <code>{MyMacro}="IPIF/ILL"</code>. The reference, {MyMacro} in this example, can be used in another profile and is expanded to its defined value. Macro profiles are not attached to a communications component.</dd>

<dt><a name="992859"> </a>node</dt>
<dd><a name="992860"> </a>A plug-in or interface in the Connection Manager graph, with its associated configuration parameters.</dd>

<dt><a name="992861"> </a>object</dt>
<dd><a name="992862"> </a>A connection profile, plug-in, or interface. A plug-in object doesn't contain the plug-in, but simply references it.</dd>

<dt><a name="999526"> </a>path:</dt>
<dd><a name="999527"> </a>A sequence of consecutive edges in the graph.</dd>

<dt><a name="992863"> </a>plug-in</dt>
<dd><a name="992864"> </a>A Connection Manager plug-in is a piece of code that is responsible for configuring and connecting one or more communications components that implement one or more protocols. A plug-in also contains the user interface parts that are necessary to configure its components.</dd>

<dt><a name="992865"> </a>profile</dt>
<dd><a name="992866"> </a>An object that defines an ordering of plug-ins and configuration settings of each referenced plug-in. It is typically stored in the Connection Manager database, but can also be private to an application. A profile has a string equivalent (see <b>profile string</b>). </dd>

<dt><a name="992867"> </a>profile string</dt>
<dd><a name="992868"> </a>A string equivalent of a connection profile. It's a list of plug-in names, with some values for their configuration parameters.</dd>

<dt><a name="992869"> </a>record</dt>
<dd><a name="992870"> </a>A connection profile stored in the Connection Manager database.</dd>

<dt><a name="992871"> </a>session</dt>
<dd><a name="1010996"> </a>A communication session between the Connection Manager library and the Connection Manager server. A session is automatically opened when calling any Connection Manager functions that need a session. A session is automatically closed when the application that opened it exits. A session identifier can be used to poll a connection.</dd>

<dt><a name="997019"> </a>subprofile</dt>
<dd><a name="997020"> </a>A profile that is referenced by another profile. A subprofile is just a normal profile that is called a subprofile when it is referenced by another profile.</dd>

<dt><a name="996369"> </a>template</dt>
<dd><a name="996370"> </a>A special profile which can be copied to create a new profile.</dd>

<dt><a name="999420"> </a>usability</dt>
<dd><a name="999421"> </a>The user determines the usability of a profile by checking it in a list of profiles for a connection type. Only the checked profiles in the list are usable. When an automatic connection of that type is requested, the Connection Manager considers only usable profiles.</dd>

</dl>
<h3 class="hbH3">
  <a name="992897"> </a>Connection Profiles <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="992898"> </a>A connection <b>profile</b> is an object that defines a sequence of plug-in and interface nodes from the Connection Manager graph that forms a complete path from a topmost component to a lower-level component that can establish a physical connection. For example, a profile might consist of these ordered components: TCP/IP, PPP, Dialer. This means that the desired protocol, TCP/IP, requires the use of the PPP component, which in turn requires the use of the Dialer component, which establishes a modem connection. </p>

<p><a name="992902"> </a>When making a connection, the application generally interacts only with the topmost component, which defines the connection type&#8212;TCP/IP, in this example. The application doesn't need to know about the lower-level connections.</p>

<p><a name="992903"> </a>Profiles can be created by the user via the Connection application, programmatically, or by software installation. The Connection Manager also allows modification and management of existing profiles via the Connection application or programmatically. An application can also create and manipulate private connection profiles that are visible only to itself (see <a href="HLC_ConnMgrConcept.html#992922">"Profile Strings"</a>).</p>

<p><a name="1009562"> </a>The Connection Manager database stores records that reference plug-ins, interfaces, and profiles. </p>

<p><a name="1009563"> </a>A connection profile ID is a unique <code>uint32_t</code> value that represents a stored connection profile. This is the typical way to reference stored profiles. Other objects stored in the Connection Manager database, such as plug-ins and interfaces, also have unique IDs.</p>

<p><a name="992910"> </a>A connection profile has a priority that is used to rank the profile in a list of profiles that have the same connection type. The highest priority profile of a type (such as TCP/IP profiles) is returned first from searches, and profiles are listed from highest to lowest priority in the list of profiles with the same connection type.</p>

<p><a name="1009630"> </a>Connection profiles also have an availability. The availability indicates if the profile can be connected at the current time (which is not always possible to determine). For example, a Bluetooth plug-in might be able to detect if the device is within range of a Bluetooth access point, and would set this field accordingly.</p>

<p><a name="1010436"> </a>The Connection Manager features a fallback mechanism that attempts to make a connection using alternate profiles of the same connection type if the highest priority profile has an unavailable status. Profiles of the same connection type are tried in highest to lowest priority order, and only those that have a status of available are used; or, if the availability of a profile is unknown, it is tried. The user can configure the fallback mechanism via the Connection application.</p>

<p><a name="999188"> </a>The following subsections contain more details on profiles:</p>
<ul type="disc">
  <li><a name="999202"> </a><a href="HLC_ConnMgrConcept.html#996747">Subprofiles</a>
  <li><a name="999209"> </a><a href="HLC_ConnMgrConcept.html#992913">Profile Configuration</a>
  <li><a name="999240"> </a><a href="HLC_ConnMgrConcept.html#999889">Automatic and Manual Mode Profiles</a>
  <li><a name="999216"> </a><a href="HLC_ConnMgrConcept.html#992922">Profile Strings</a>
  <li><a name="999226"> </a><a href="HLC_ConnMgrConcept.html#996570">Macro Profiles</a>
  <li><a name="999794"> </a><a href="HLC_ConnMgrConcept.html#999774">Templates</a>
</ul>

<h4 class="hcH4">
  <a name="996747"> </a>Subprofiles
</h4>

<p><a name="996753"> </a>A profile can contain references to other connection profiles, called subprofiles because they are referenced from another profile. When the profile is needed for connection or other purposes, the references are automatically expanded to the full plug-in or interface sequence that they represent.</p>

<p><a name="996787"> </a>For example, you might have a TCP/IP profile where the IP/PPP part of the profile is always the same and the dialing part changes as the user travels to different countries. You could make this change by inserting a reference to a subprofile that contains the correct dialing configuration.</p>

<p><a name="996754"> </a>You can expand and compress such subprofiles referenced within a profile. To expand all subprofiles within a profile, use <a href="HLC_ConnMgrRef.html#1105517"><code>CncProfileUngroup()</code></a>. To recompress a profile that was previously expanded, use <a href="HLC_ConnMgrRef.html#1105955"><code>CncProfileRegroupSubmit()</code></a>. This function resubmits each subprofile to the Connection Manager database as a separate profile and replaces each one in the main profile with a reference.</p>

<p><a name="996822"> </a>You can also substitute one subprofile for another in a locked expanded profile by calling <a href="HLC_ConnMgrRef.html#1107178"><code>CncSubProfileAssign()</code></a>.</p>

<h4 class="hcH4">
  <a name="992913"> </a>Profile Configuration
</h4>

<p><a name="992914"> </a>Each node in a profile has an associated property list that contains configuration parameters for its component. Because the configuration parameters are stored in the profiles, different profiles that use the same component can specify different parameter values for it.</p>

<p><a name="1011001"> </a>To be usable, profiles must be configured; that is, each plug-in in the profile must have at least those parameters set that are needed to make a connection. There are three agents that can assign parameters to a node ( that is, set parameters in the property list of the plug-in):</p>
<ul type="disc">
  <li><a name="1011002"> </a>Installation code: The plug-in installation code can define default parameters or find parameter values in the property lists of other nodes during plug-in installation.
  <li><a name="1011003"> </a>User: The user can set parameters when creating or changing a profile via the Connection application; or the user can be asked to supply missing parameters by the plug-in during a connection attempt.
  <li><a name="1011004"> </a>Application: An application can programmatically set plug-in parameters.
</ul>

<p><a name="992916"> </a>The Connection application serves as a central mechanism for managing and configuring all connections on the handheld. It manages choosing the node path to form complete profiles. And it provides a user interface framework that can display dialogs supplied by plug-ins, for the user to supply configuration parameters or choose among options. </p>

<p><a name="1010639"> </a>Note that the Connection application itself is not visible in the Launcher. The Internet, Phone, and other communication configuration applications just sublaunch the Connection application, which shows only the relevant profiles. </p>

<h4 class="hcH4">
  <a name="999889"> </a>Automatic and Manual Mode Profiles
</h4>

<p><a name="999235"> </a>Profiles can be automatic or manual. In a list of automatic profiles for a particular connection type, the Connection Manager selects a profile to use depending on its usability, availability, and priority. For example, the Internet panel lists several network profiles in priority order. If the user selects Choose Profile Automatically, the system selects the highest priority profile that is usable and available when a network connection is requested. </p>

<p><a name="1011016"> </a>The user determines usability by checking the boxes next to the profiles that are usable, as shown in the following figure. The Connection Manager determines availability internally, by querying each plug-in in a profile to see if it is available. The red symbols in the figure below indicate unavailable profiles. The circle with a slash is a generic "unavailable" symbol (for profiles that don't supply their own), and the antenna with red X is the unavailable symbol for phone profiles.</p>
<div align="left"><img src="images/ConnectionAutoList.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="999257"> </a>If the user selects Choose Profile Manually, the user must choose a specific profile from the list; this profile is always used when a connection of that type is requested. If the selected profile is not available at the time a connection is requested, then no connection is made.</p>
<div align="left"><img src="images/ConnectionManualList.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="999262"> </a>What makes a profile automatic or manual is a flag (<code>kCncManualModeOption</code> in <a href="HLC_ConnMgrRef.html#995279"><code>CncInfoType</code></a><!-PS02-><span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">.options</span>) that is set in the first plug-in in the profile. This is the plug-in to which the profile is attached. Because all profiles of the same connection type have the same first plug-in, the profiles in a particular list are either all automatic or all manual.</p>

<h4 class="hcH4">
  <a name="992922"> </a>Profile Strings
</h4>

<p><a name="992923"> </a>A connection profile object can be represented textually by a connection profile string that lists the node names and their properties.</p>

<p><a name="992924"> </a>An application can have a private profile, not stored in the Connection Manager database or visible to other applications, by saving a profile string.</p>

<p><a name="992926"> </a>The general format of a profile string is:</p>
<pre class="sl">"<i>node1</i>:<i>properties</i>/<i>node2</i>:<i>properties</i>/..."</pre>

<p><a name="992928"> </a>where <i>node1</i> and <i>node2</i> are plug-in and interface nodes in the Connection Manager graph and <i>properties</i> are property lists associated with the nodes. Each node is separated from the next by a forward slash (/).</p>

<p><a name="996581"> </a>Property lists are pairs of parameter names and values separated by commas. Note the following when writing parameters:</p>
<ul type="disc">
  <li><a name="1011023"> </a>Binary parameters are encoded using a textual hexadecimal representation enclosed in square brackets (for example, [645a3100]). (The usual 0x prefix is not used.)
  <li><a name="992930"> </a>String parameters are enclosed in single quotes. 
  <li><a name="992931"> </a>Special characters in the names or values of parameters, as well as the equal sign and quote symbols, must be represented with quoted-printable notation. Quoted-printable notation consists of an equal sign followed by a two digit hexadecimal representation of the character's value (for example, =3D). For details on quoted-printable notation, refer to RFC 2045 at:<br><a href="http://www.ietf.org/rfc/rfc2045.txt">http://www.ietf.org/rfc/rfc2045.txt</a>
  <li><a name="992933"> </a>Integers begin with a digit.
  <li><a name="1011050"> </a>Hexadecimal numbers begin with 0x (for example, 0x4a).
</ul>

<p><a name="992934"> </a>Here is an example of creating a string profile and then storing it in a profile object:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
sprintf(profile, <a name="992935"> </a>
"SerialMgr:name='PortCOM1',crea=0x%08X/Serial:Baud=%d,FCtl=0x%X,Bits=0x%X",<a name="992936"> </a>
'com1', B9600, CRTSCTS, CS8);<a name="992937"> </a>
profileId = CncProfileDecode("SerialMgrPort1Profile", profile);<a name="992941"> </a>
</pre><div class="CodeRule"><hr></div>


<h4 class="hcH4">
  <a name="996570"> </a>Macro Profiles
</h4>

<p><a name="1011067"> </a>A macro profile is a special type of subprofile whose name begins with the special character <code>kCncMacroSpecialChar</code>, which is the open curly brace "{". For example, {MyMacro} could be the name of a macro profile that is defined as follows:</p>
<pre class="sl">{MyMacro} = "IPIF/ILL"</pre>

<p><a name="1001012"> </a>When it appears in a profile, a macro name is automatically expanded to its full definition on connection, control, and search requests. You can also expand the macros in a profile by calling <a href="HLC_ConnMgrRef.html#1105517"><code>CncProfileUngroup()</code></a>.</p>

<p><a name="997187"> </a>Say there is a profile defined as follows:</p>
<pre class="sl">MyProfile ="{MyMacro}/DLE"</pre>

<p><a name="997202"> </a>When the profile is expanded, it becomes <code>"IPIF/ILL/DLE"</code>, using the definition of MyMacro above.</p>

<p><a name="997176"> </a>Macro profiles are not attached to any plug-in or interface. They are used as references in profiles or templates. </p>

<p><a name="999931"> </a>The two special macros {REPLACE} and {USING} are used in template profiles created by plug-in developers. Normal profiles don't need to use these.</p>

<h4 class="hcH4">
  <a name="999774"> </a>Templates
</h4>

<p><a name="999775"> </a>Templates are special profiles used when creating a new profile. When creating a new profile, the user typically chooses a template that is copied to a real profile.</p>

<p><a name="999777"> </a>A template contains the properties and default settings applicable to the connection type. These can then be customized by the user in the Connection application.</p>

<p><a name="999787"> </a>Template profiles are generally created only by plug-in developers.</p>

<h4 class="hcH4">
  <a name="1001093"> </a>Link Objects
</h4>

<p><a name="1001127"> </a>Link objects are used to associate different names to the same profile. They act like symbolic links or shortcuts; they reference another object and when they are found in a search, the real profile they point to is returned. </p>

<p><a name="1001168"> </a>This is useful if you create default profiles with internationalized names but also want such profiles to be referenced by others with a well known, unchanging name. For example a link named "RS232 at 115200bps" can point to the profile named "RS232 à 115200bps" in French. If a search finds the profile ID of "RS232 at 115200bps," the profile ID of "RS232 à 115200bps" will be returned.</p>
<h3 class="hbH3">
  <a name="992943"> </a>Security Considerations <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="992944"> </a>The Connection Manager addresses security in a number of ways. The Connection Manager server, which does all the actual work, runs in the system process, separate from the application process where applications run. Access to the system process is restricted, though plug-ins, which also run in the system process, do have access so they can read and send passwords to establish a connection, for example. </p>

<p><a name="999805"> </a>Connection passwords, along with other sensitive parameters, can be designated as write-only by plug-ins. Such passwords and parameters cannot be read by applications. Also, the user interface for a plug-in in the Connection application can give the user the choice not to store the password (they must enter it each time).</p>

<p><a name="992947"> </a>Plug-in installation is protected by the Security Manager. Plug-in code must be signed to guarantee its authenticity.</p>
<h3 class="hbH3">
  <a name="992949"> </a>Persistent Connections <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="992952"> </a>A persistent connection is a connection that is maintained even when applications switch. For example, an application may open a type of connection that is persistent, then the user may switch to a different application, and the connection is still maintained even though the application that opened it has stopped running.</p>

<p><a name="992953"> </a>Persistency is a property of a plug-in, and thus of the profiles attached to that plug-in. All built-in network profiles are persistent. Plug-in developers may define other types of persistent connections.</p>

<p><a name="1000640"> </a>An application can determine if a persistent network connection exists by checking the <code>kCncIsConnectedOption</code> flag in the <code>CncInfoType.options</code> field of a profile, as shown in <a href="HLC_ConnMgrConcept.html#1010406">Listing 1.1</a>.</p>
<p class="CCodeCaption">
  <a name="1010406"> </a><b>Listing 1.1&nbsp;&nbsp;Checking for a network connection</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// Returns true if there is a network connection<a name="1011212"> </a>
Boolean IsOnline(void)<a name="1011213"> </a>
{<a name="1011214"> </a>
  Boolean isOnline = false;<a name="1011215"> </a>
  uint32_t profileID; // ID of the network interface<a name="1011216"> </a>
  status_t err; // Result code<a name="1011217"> </a>
  CncInfoType* profileList = NULL; // the profiles list<a name="1011218"> </a>
  int16_t profileCount = 0; // the profiles count<a name="1011219"> </a>
  int16_t index;<a name="1011220"> </a>
 <a name="1011221"> </a>
  // get the updated profile list<a name="1011222"> </a>
  // kCncNetOutgoingInterface is defined in NetCnc.h (TCP/IP)<a name="1011223"> </a>
  profileID = CncObjectGetIndex(kCncNetOutgoingInterface);<a name="1011224"> </a>
  if (0 == profileID) return false;<a name="1011225"> </a>
  err = CncObjectFindAll(profileID, kCncFindDefault, <a name="1011226"> </a>
                         &amp;profileCount, &amp;profileList);<a name="1011227"> </a>
  if (errNone != err || 0 == profileCount) return false;<a name="1011228"> </a>
  // update online feature<a name="1011229"> </a>
  for (index = 0; index &lt; profileCount; index++)<a name="1011230"> </a>
    {<a name="1011231"> </a>
    if ((profileList[index].options &amp; 
         kCncIsConnectedOption)!= 0)<a name="1011232"> </a>
      {<a name="1011233"> </a>
       isOnline = true;<a name="1011234"> </a>
       break;<a name="1011235"> </a>
      }<a name="1011236"> </a>
    }<a name="1011237"> </a>
  // free the returned list<a name="1011238"> </a>
  MemPtrFree(profileList);<a name="1011239"> </a>
  return isOnline;<a name="1011240"> </a>
}<a name="1011241"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1000158"> </a>An application can also register for the <a href="HLC_ConnMgrRef.html#1135841"><code>cncNotifyConnectionStateEvent</code></a> notification, which is broadcast whenever the connection state of a persistent profile changes (a persistent profile is connected or disconnected on error or on user request, or the availability of the profile changes). </p>
<h3 class="hbH3">
  <a name="999650"> </a>Graph Management <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="999651"> </a>Most application developers won't need to modify the Connection Manager graph. This section is provided as an overview in case it is necessary.</p>

<p><a name="999699"> </a>The Connection Manager maintains a graph of connections between all of the installed communication components, which appear as nodes in the graph. This graph is maintained in the Connection Manager database.</p>

<p><a name="999652"> </a>The graph represents hierarchical relationships between components, where a higher component requires the use of a component at the next lower level to establish a connection. <a href="HLC_ConnMgrConcept.html#999657">Figure 1.2</a> shows a simplified example of such a graph.</p>

<p class="FFigureCaption">
  <a name="999657"> </a><b>Figure 1.2&nbsp;&nbsp;Connection Manager graph</b>
</p>
<div align="left"><img src="images/ConnectionMgrGraph4.jpg" height="279" width="480" border="0" hspace="0" vspace="0">
</div>

<p><a name="999662"> </a>Nodes in the graph can be plug-ins (boxes in the figure) or interfaces (ovals in the figure). </p>

<p><a name="999663"> </a>An <b>interface</b> is a node that is an abstraction of similar plug-ins that it logically groups together. For example, the IrComm and serial plug-ins both provide the same RS-232 interface, so they can be abstracted by a general RS-232 interface node. An interface node has no associated code module or user interface components; it is simply an object in the Connection Manager database that relates to other plug-in objects.</p>

<p><a name="999664"> </a>An interface can be used to logically group profiles (which are attached to nodes in the graph; see <a href="HLC_ConnMgrConcept.html#993167">"Adding a Profile to a Connection Type List."</a>) For example, a developer might use <a href="HLC_ConnMgrRef.html#995694"><code>CncInterfaceNew()</code></a> to create a top-level telnet interface node just to attach some telnet-specific profiles to.</p>

<p><a name="999671"> </a>Typically, interfaces are used by plug-in developers and you probably won't need to create them.</p>

<p><a name="999672"> </a>To establish a connection, the system requires a complete path from a top component in the graph, which defines the connection type, to the bottom component of any branch. There may be several different possible paths from the top component to the bottom component of a branch, each forming a possible connection profile. A communications component can be used in more than one profile.</p>

<p><a name="999673"> </a>Components can be linked together by creating relationships, called <b>edges</b>, between them. An edge is simply a hierarchical relationship between two components. It means that the "upper" component requires the "lower" component to make a connection. The upper component may have multiple edges to lower components, meaning that there is a choice of which one to use.</p>

<p><a name="999674"> </a>The search algorithm also uses edges internally. For example, if an edge exists between the "RS232" and "Serial" nodes, then searching for "RS232/*" returns profiles attached to the "RS232" node as well as profiles attached to the "Serial" node.</p>

<p><a name="999675"> </a>The Connection Manager includes functions to create (<a href="HLC_ConnMgrRef.html#995624"><code>CncEdgeNew()</code></a>) and delete (<a href="HLC_ConnMgrRef.html#995604"><code>CncEdgeDelete()</code></a>) edges between components, but these are generally unnecessary to use. Edges are typically created or deleted only by plug-in developers.</p>

<h2 class="haH2">
  <a name="992955"> </a>Using the Connection Manager <a href="#996635"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="992956"> </a>The Connection Manager manages all connections at a high level from the Palm Powered<sup>&#8482;</sup> handheld to external devices.</p>

<p><a name="992957"> </a>The Connection Manager is a shared library that the system automatically loads when needed and unloads when not needed. You don't need to do anything to load or initialize the library.</p>

<p><a name="992958"> </a>This section explains how to use the Connection Manager in your application. It covers:</p>
<ul type="disc">
  <li><a name="992962"> </a><a href="HLC_ConnMgrConcept.html#992998">Making a Connection</a>
  <li><a name="992966"> </a><a href="HLC_ConnMgrConcept.html#993028">Creating a Profile</a>
  <li><a name="992970"> </a><a href="HLC_ConnMgrConcept.html#993052">Changing a Profile</a>
  <li><a name="992974"> </a><a href="HLC_ConnMgrConcept.html#993105">Finding Profiles</a>
  <li><a name="992978"> </a><a href="HLC_ConnMgrConcept.html#993130">Managing Profiles</a>
  <li><a name="992982"> </a><a href="HLC_ConnMgrConcept.html#1000036">Configuring Components</a>
  <li><a name="995974"> </a><a href="HLC_ConnMgrConcept.html#995954">Invoking a Function in a Profile Plug-In</a>
</ul>

<p><a name="995461"> </a>Many Connection Manager functions operate on profiles, which are identified by a profile ID number. You can obtain the ID of a profile by passing the name of the profile to <a href="HLC_ConnMgrRef.html#995733"><code>CncObjectGetIndex()</code></a> or by searching for it with <a href="HLC_ConnMgrRef.html#996053"><code>CncProfileFindFirst()</code></a>, which searches based on name or a partial profile string. Of course, if you create a new profile with <a href="HLC_ConnMgrRef.html#996337"><code>CncProfileNew()</code></a> or <a href="HLC_ConnMgrRef.html#995901"><code>CncProfileDecode()</code></a>, then that function returns the profile ID.</p>
<h3 class="hbH3">
  <a name="992998"> </a>Making a Connection <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="992999"> </a>You can make a connection in the following ways:</p>
<ul type="disc">
  <li><a name="993000"> </a>From an existing stored profile
  <li><a name="993001"> </a>By creating a profile dynamically and connecting from it
</ul>

<p><a name="993002"> </a>These methods are discussed in the following sections.</p>

<h4 class="hcH4">
  <a name="993003"> </a>Connecting From a Stored Profile
</h4>

<p><a name="993004"> </a>To make a connection from an existing profile stored in the Connection Manager database, call <a href="HLC_ConnMgrRef.html#995870"><code>CncProfileConnect()</code></a>. You pass this function the ID of a stored profile and it makes the connection by requesting each plug-in in the profile to establish a connection, starting with the lowest level. Once the topmost plug-in in the profile has successfully completed a connection, this function returns an IOS file descriptor for the connection. </p>

<p><a name="993008"> </a>Applications use the file descriptor to identify the connection for reading and writing data, configuring the connection, or closing it. These tasks can be performed by functions in the STDIO library, which provides a uniform, generic, POSIX-like STDIO interface. For more information, refer to <a href="../Low-Level_Communications/LowLevelComms_Stdio_Pt.html#1000443">Part VI, "IOS STDIO," </a>in <i>Exploring Palm OS: Low-Level Communications</i>.</p>

<p><a name="993012"> </a>Normally, the call to <code>CncProfileConnect()</code> is synchronous, and blocks until the connection is established. You can call this function in asynchronous mode, however, by setting the <code>kCncConnectAsynchronous</code> flag. In this case, you must call <a href="HLC_ConnMgrRef.html#995559"><code>CncConnectReceiveState()</code></a> to receive connection progress and termination messages. The calling application may want to use <a href="../Low-Level_Communications/LowLevelComms_StdioRef.html#997909"><code>IOSPoll()</code></a> on the session file descriptor (returned by <a href="HLC_ConnMgrRef.html#995671"><code>CncGetSession()</code></a>) to know when to call this function.</p>

<p><a name="997268"> </a>Here's an example of how to use <code>IOSPoll()</code> to poll the file descriptor for a Connection Manager response, and allow normal user interface event processing to continue while polling.</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
#define kNfds 2<a name="1011251"> </a>
EventType event;<a name="1011252"> </a>
struct pollfd fdList[kNfds]; // the fd list<a name="1011253"> </a>
int32_t oNfds; // returned count of fds<a name="1011254"> </a>
status_t err;<a name="1011255"> </a>
CncConnectionStateType state;<a name="1011256"> </a>
fdList[0].fd = CncGetOrOpenSession(); // The CM session fd<a name="1011257"> </a>
fdList[1].fd = EvtGetEventDescriptor(); // The event queue fd<a name="1011258"> </a>
fdList[0].events = POLLIN; // wait for a normal message<a name="1011259"> </a>
fdList[1].events = POLLIN;<a name="1011260"> </a>
while(1) { // loop and poll<a name="1011261"> </a>
  err = IOSPoll(fdList, kNfds, -1, &amp;oNfds);<a name="1011262"> </a>
  if (err != errNone)<a name="1011263"> </a>
    break;<a name="1011264"> </a>
  if (fdList[0].revents &amp; POLLIN) {<a name="1011265"> </a>
    // process connection manager notifications<a name="1011266"> </a>
    err = CncConnectReceiveState(&amp;state);<a name="1011267"> </a>
    // check state and exit loop as needed<a name="1011268"> </a>
  } else if (fdList[1].revents &amp; POLLIN) {<a name="1011269"> </a>
    // process UI events<a name="1011270"> </a>
    do {<a name="1011271"> </a>
      EvtGetEvent(&amp;event, 0);<a name="1011272"> </a>
      // process events normally<a name="1011273"> </a>
    } while(EvtEventAvail());<a name="1011274"> </a>
    EvtFinishLastEvent();<a name="1011275"> </a>
  }<a name="1011276"> </a>
}<a name="1011277"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="997266"> </a>If you don't have the ID of a profile to connect, you can use the alternative function, <a href="HLC_ConnMgrRef.html#996013"><code>CncProfileFindConnect()</code></a>. This function searches the stored profiles by name or partial profile string.</p>

<p><a name="995216"> </a>The <code>CncProfileConnect()</code> and <code>CncProfileFindConnect()</code> functions can have multiple user interface side effects. For example, the user can be prompted to complete or configure the connection profile, if parameter values are missing or the profile does not specify a complete connection path. Some user interface side effects can be allowed or disallowed via the <code>flags</code> parameter to these functions.</p>

<h4 class="hcH4">
  <a name="993021"> </a>Creating a Profile Dynamically and Connecting
</h4>

<p><a name="993022"> </a>An application may want to use a private profile, not storing it in the Connection Manager database. To do this, the application can privately construct and store a profile string without using any Connection Manager functions. To connect using it, pass the string to <a href="HLC_ConnMgrRef.html#996013"><code>CncProfileFindConnect()</code></a>. When passed a complete profile string, this function creates a profile object from it and connects using that profile.</p>

<p><a name="993026"> </a>Note that calling any connection function can have multiple user interface side effects, as noted in the previous section.</p>

<h4 class="hcH4">
  <a name="995919"> </a>Canceling or Disconnecting a Profile
</h4>

<p><a name="995920"> </a>If you want to cancel the connection process before it is completed, you can call <a href="HLC_ConnMgrRef.html#1075366"><code>CncProfileDisconnect()</code></a>. You can also call this function to disconnect a persistently connected profile.</p>
<h3 class="hbH3">
  <a name="993028"> </a>Creating a Profile <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="993029"> </a>Users generally create profiles through the Connection application. An application can create a profile programmatically as well.</p>

<p><a name="1000931"> </a>To create a new empty profile, call <a href="HLC_ConnMgrRef.html#996337"><code>CncProfileNew()</code></a>. To add items such as plug-ins, interfaces, and other profiles to it, call <a href="HLC_ConnMgrRef.html#996268"><code>CncProfileInsertItem()</code></a>. To submit the changes to the Connection Manager database and unlock the profile, call <a href="HLC_ConnMgrRef.html#996425"><code>CncProfileSubmit()</code></a>.</p>

<p><a name="1000938"> </a>You can also create a profile by passing a string to <a href="HLC_ConnMgrRef.html#995901"><code>CncProfileDecode()</code></a>.</p>

<p><a name="993043"> </a>You can create a profile dynamically, when you want to make a connection. For details, see the previous section, <a href="HLC_ConnMgrConcept.html#1000036">"Configuring Components."</a></p>

<p><a name="1000944"> </a>If you create a profile but don't submit it to the Connection Manager database, it won't be saved after your application exits. However, it is associated with the client session while your application is running and it will be found by the find functions described in <a href="HLC_ConnMgrConcept.html#993105">"Finding Profiles."</a></p>

<p><a name="993047"> </a>For information on configuring the individual communications components in the profile, see <a href="HLC_ConnMgrConcept.html#1000036">"Configuring Components."</a></p>
<h3 class="hbH3">
  <a name="993052"> </a>Changing a Profile <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="993053"> </a>You can change a profile in the following ways:</p>
<ul type="disc">
  <li><a name="993055"> </a>Add new components such as plug-ins and interfaces
  <li><a name="993056"> </a>Delete components from the profile, or the profile itself
  <li><a name="993057"> </a>Launch the configuration application
</ul>

<p><a name="993058"> </a>These tasks are discussed in the following sections.</p>

<h4 class="hcH4">
  <a name="993068"> </a>Adding Components to a Profile
</h4>

<p><a name="993069"> </a>To add components such as plug-ins, interfaces, and other profiles to a profile, call <a href="HLC_ConnMgrRef.html#996268"><code>CncProfileInsertItem()</code></a>. Adding a component inserts a reference to it into the sequence of components that comprise a profile. </p>

<p><a name="993073"> </a>One profile can even be inserted into another as a subprofile; for details, see <a href="HLC_ConnMgrConcept.html#996747">"Subprofiles."</a></p>

<p><a name="993082"> </a>Changes you make to a profile are not saved until you submit the changes to the Connection Manager database by calling <a href="HLC_ConnMgrRef.html#996425"><code>CncProfileSubmit()</code></a>.</p>

<h4 class="hcH4">
  <a name="993086"> </a>Deleting Components and Profiles
</h4>

<p><a name="993087"> </a>To delete a plug-in or interface component and its associated parameters from a profile, call <a href="HLC_ConnMgrRef.html#995928"><code>CncProfileDeleteItem()</code></a>.</p>

<p><a name="993091"> </a>Changes you make to a profile are not saved until you submit the changes to the Connection Manager database by calling <a href="HLC_ConnMgrRef.html#996425"><code>CncProfileSubmit()</code></a>.</p>

<p><a name="993095"> </a>To delete a profile from the Connection Manager database, call <a href="HLC_ConnMgrRef.html#995716"><code>CncObjectDelete()</code></a>. Removing a plug-in or interface object also removes all edges and profiles that use it. Removing a profile also removes profiles that reference it.</p>

<h4 class="hcH4">
  <a name="993099"> </a>Launching the Configuration Application
</h4>

<p><a name="993100"> </a>To allow the user to complete or edit a profile or configure components, you can launch the Connection application by calling <a href="HLC_ConnMgrRef.html#995950"><code>CncProfileEdit()</code></a>. By setting a flag, you can control what form the application displays on launch. There are several options, such as the form that lists connection types, the form that lists profiles available for a particular connection type, the configuration form, the profile creation form, and the profile deletion form.</p>
<h3 class="hbH3">
  <a name="993105"> </a>Finding Profiles <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="993106"> </a>There may be many different profiles stored in the Connection Manager database. You can always find a profile object from its name by using <a href="HLC_ConnMgrRef.html#995733"><code>CncObjectGetIndex()</code></a>, but if you don't know its name, you can use the find functions.</p>

<p><a name="996717"> </a>There are two ways to find profiles:</p>
<ul type="disc">
  <li><a name="996721"> </a>Use <a href="HLC_ConnMgrRef.html#1076207"><code>CncObjectFindAll()</code></a> to find all profiles that are attached to a particular plug-in or interface. This function returns all found profiles in an array.
  <li><a name="996732"> </a>Use <a href="HLC_ConnMgrRef.html#996053"><code>CncProfileFindFirst()</code></a> to find a profile based on its name or partial profile string, then iterate through other matching profiles with <a href="HLC_ConnMgrRef.html#996089"><code>CncProfileFindNext()</code></a>. This method is explained in more detail in the following paragraphs.
</ul>

<p><a name="993110"> </a>To begin a search for a profile based on its name or a partial profile string, call <a href="HLC_ConnMgrRef.html#996053"><code>CncProfileFindFirst()</code></a>. You can pass this function a partial profile string such as "NetOut/*", to find profiles that begin with it. This example finds network profiles. The "/*" characters are a wildcard at the end that signify a partial string. For details about profile strings, see <a href="HLC_ConnMgrConcept.html#992922">"Profile Strings."</a></p>

<p><a name="993117"> </a>The <code>CncProfileFindFirst()</code> function returns the first profile that matches the search string and creates a search object that you can query repeatedly by calling <a href="HLC_ConnMgrRef.html#996089"><code>CncProfileFindNext()</code></a> to return the next matching profile.</p>

<p><a name="999129"> </a>Both <code>CncProfileFindFirst()</code> and <code>CncProfileFindNext()</code> return locked profiles, so if you don't want to edit the returned profiles, you might want to call <a href="HLC_ConnMgrRef.html#996445"><code>CncProfileUnlock()</code></a> in the search loop.</p>

<p><a name="993124"> </a>It's good practice to call <a href="HLC_ConnMgrRef.html#1121846"><code>CncProfileFindClose()</code></a> to clean up memory when you are done with a search, after you have called <code>CncProfileFindNext()</code> for the last time. This function frees the memory used for the search object allocated by <code>CncProfileFindFirst()</code>.</p>

<p><a name="993125"> </a>Note that you can also use the <code>CncProfileFindFirst()</code> function to create a new profile. If you specify a complete profile string for the search string, this function creates and returns the ID of a new profile object. However, the profile is automatically deleted when the Connection Manager session closes, unless you call <a href="HLC_ConnMgrRef.html#996425"><code>CncProfileSubmit()</code></a> to save it.</p>

<p><a name="1000954"> </a>If you create a profile but don't submit it to the Connection Manager database, it isn't saved, but it is associated with the client session while your application is running and it will be found by the find functions described in this section. Other applications won't find it, because each application using the Connection Manager server has its own exclusive client session. Only after it is submitted can other applications find it.</p>
<h3 class="hbH3">
  <a name="993130"> </a>Managing Profiles <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="993131"> </a>Profile management involves tasks such as:</p>
<ul type="disc">
  <li><a name="993132"> </a>Getting information about profiles and items
  <li><a name="993133"> </a>Adding a profile to the list of those available for a particular connection type
  <li><a name="993134"> </a>Locking, unlocking, and submitting changes
</ul>

<p><a name="993135"> </a>These tasks are discussed in the following sections.</p>

<h4 class="hcH4">
  <a name="993136"> </a>Getting Information About Profiles and Items
</h4>

<p><a name="993137"> </a>Before you can work with profiles and the communications components in them, you'll need to obtain their IDs, which are unique identifiers assigned to all Connection Manager objects. You can obtain the ID of a profile by passing the name of the profile to <a href="HLC_ConnMgrRef.html#995733"><code>CncObjectGetIndex()</code></a> or by searching for it with <a href="HLC_ConnMgrRef.html#996053"><code>CncProfileFindFirst()</code></a>, which searches based on its name or a partial profile string. </p>

<p><a name="993145"> </a>Most operations on the items in a profile require the index of the item in the profile, which you can obtain by passing its name to <a href="HLC_ConnMgrRef.html#996143"><code>CncProfileGetItemIndex()</code></a>. From the index, you can obtain an item's ID by calling <a href="HLC_ConnMgrRef.html#996118"><code>CncProfileGetItemId()</code></a>.</p>

<p><a name="993152"> </a>To determine the number of items in a profile, use <a href="HLC_ConnMgrRef.html#996178"><code>CncProfileGetLength()</code></a>.</p>

<p><a name="993159"> </a>An information structure, <a href="HLC_ConnMgrRef.html#995279"><code>CncInfoType</code></a>, is associated with each profile and item object, and is stored in the Connection Manager database. This structure contains information such as the object's name, version, type, and for profile objects, the priority and availability. You can use the functions <a href="HLC_ConnMgrRef.html#995748"><code>CncObjectGetInfo()</code></a> and <a href="HLC_ConnMgrRef.html#995778"><code>CncObjectSetInfo()</code></a> to get and set the information in this structure.</p>

<h4 class="hcH4">
  <a name="993167"> </a>Adding a Profile to a Connection Type List
</h4>

<p><a name="993168"> </a>On a Palm OS device, users can request connections by type. The type of a connection is identified by the topmost plug-in of its profile. All the profiles that share that topmost plug-in are of the same type. Some of the top-level plug-ins typically include TCP/IP (network), Serial, Bluetooth, and Phone. Each of these connection types might have several associated profiles. </p>

<p><a name="1010610"> </a>For each connection type, the associated Connection Manager panel lists the various profiles available, so the user can choose which to use. For example, to make a TCP/IP connection, the user might have the choice of profiles that use a dial-up connection to an ISP, a Bluetooth connection to an ISP through a LAN access point, or a GPRS connection through a mobile phone via an infrared link. </p>

<p><a name="1011296"> </a>Here's an example of a list of possible network connection profiles shown in the Internet panel:</p>
<div align="left"><img src="images/ConnectionAutoList.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="1000073"> </a>To add a new profile to the list for a particular connection type (called "attaching" a profile), use the function <a href="HLC_ConnMgrRef.html#995848"><code>CncProfileAttach()</code></a>. For example, calling this function to attach a profile to the TCP/IP plug-in would add it to the list shown above.</p>

<p><a name="993174"> </a>The order in which the profile is inserted into the list is determined by its priority (see the <code>priority</code> field of <a href="HLC_ConnMgrRef.html#995279"><code>CncInfoType</code></a>) relative to the existing profiles in the list. The list is ordered from highest to lowest priority and determines the order in which profiles are returned by <a href="HLC_ConnMgrRef.html#996089"><code>CncProfileFindNext()</code></a> when searching for profiles of the same connection type.</p>

<p><a name="997318"> </a>You can change the position of a profile in the list by calling <a href="HLC_ConnMgrRef.html#1055393"><code>CncObjectMoveItem()</code></a>. Note that this doesn't change the priority of the profile, however. The priority is used only once &#8212;to initially place the profile in the list.</p>

<h4 class="hcH4">
  <a name="993181"> </a>Locking, Unlocking, and Submitting Profiles
</h4>

<p><a name="1000012"> </a>Before you can perform most operations on a profile, such as editing it or configuring its components, you must lock the profile. This prevents other threads from trying to modify the profile at the same time. You can lock a profile by calling <a href="HLC_ConnMgrRef.html#996311"><code>CncProfileLock()</code></a>. (Note that <a href="HLC_ConnMgrRef.html#1105517"><code>CncProfileUngroup()</code></a> also locks a profile.)</p>

<p><a name="1000019"> </a>If you create a new profile with <a href="HLC_ConnMgrRef.html#996337"><code>CncProfileNew()</code></a>, the returned profile is automatically locked.</p>

<p><a name="993190"> </a>To save the changes when you are done changing a profile, call <a href="HLC_ConnMgrRef.html#996425"><code>CncProfileSubmit()</code></a>. This function submits the changes to the Connection Manager database and unlocks the profile.</p>

<p><a name="1000030"> </a>If you want to unlock a profile without saving any changes, call <a href="HLC_ConnMgrRef.html#996445"><code>CncProfileUnlock()</code></a>.</p>

<p><a name="1000034"> </a>Locks are counted and if you lock a profile more than once, but only unlock it once, it is still locked.</p>

<p><a name="1000039"> </a>Locks are cleaned up by the Connection Manager. If your application exits and leaves a profile locked, it will automatically be unlocked.</p>
<h3 class="hbH3">
  <a name="1000036"> </a>Configuring Components <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="993200"> </a>The communications components referenced by a profile typically have various parameters that can be set to control some aspect of the communications operation. For example, a TCP/IP plug-in might have parameters that specify the IP address, DNS address, timeout, and so forth.</p>

<p><a name="993201"> </a>Values for these parameters are stored in the items that are in a particular profile in the Connection Manager database. You can retrieve the parameter values for an item by calling <a href="HLC_ConnMgrRef.html#996203"><code>CncProfileGetParameters()</code></a> and set the parameter values by calling <a href="HLC_ConnMgrRef.html#996365"><code>CncProfileSetParameters()</code></a>. Both of these functions use parameter arrays that you can allocate by calling <a href="HLC_ConnMgrRef.html#995826"><code>CncParametersInit()</code></a>.</p>

<p><a name="995252"> </a>When you are done with the parameter array returned by <code>CncProfileGetParameters()</code>, call <a href="HLC_ConnMgrRef.html#995807"><code>CncParametersFree()</code></a> to free the memory used by the array.</p>

<p><a name="995681"> </a>To allow the user to complete or edit a profile or configure components, you can launch the Connection application by calling <a href="HLC_ConnMgrRef.html#995950"><code>CncProfileEdit()</code></a>. By setting a flag, you can control what form the application displays on launch. There are several options, such as the configuration form, profile creation form, partial profile completion form, etc.</p>
<h3 class="hbH3">
  <a name="995954"> </a>Invoking a Function in a Profile Plug-In <a href="#996635"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="995958"> </a>An application may want to programmatically invoke a function in a plug-in associated with a profile. You can do this by calling <a href="HLC_ConnMgrRef.html#1072696"><code>CncObjectControl()</code></a>. Using this call, you can send a request to the control function in a single plug-in or in all plug-ins in a profile. The control function in a plug-in accepts a request parameter that tells it what to do, and a parameter block that is associated with the request.</p>

<p><a name="996873"> </a>Plug-in developers define the requests that a plug-in can respond to. This feature allows plug-ins to expose proprietary features.</p>

<p><a name="1000845"> </a>One request that all plug-ins should respond to is the <code>kCncControlAvailability</code> request, which the Connection application uses to query all plug-ins about their availability.</p>

<h2 class="haH2">
  <a name="1001676"> </a>Summary of Connection Manager <a href="#996635"><span class="nav">^TOP^</span></a>
</h2>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="993232"> </a><b><span style="color: #000000;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">Connection Manager Functions</span></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993236"> </a><b>Session Open and Close</b></p>
    </td>
    <td><p class="tt"><a name="993238"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993243"> </a><a href="HLC_ConnMgrRef.html#995537"><code>CncCloseSession()</code></a><br><a href="HLC_ConnMgrRef.html#995647"><code>CncGetOrOpenSession()</code></a></p>
    </td>
    <td><p class="tt"><a name="993251"> </a><a href="HLC_ConnMgrRef.html#995671"><code>CncGetSession()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993253"> </a><b>Profile Management</b></p>
    </td>
    <td><p class="tt"><a name="993255"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993260"> </a><a href="HLC_ConnMgrRef.html#995604"><code>CncEdgeDelete()</code></a><br><a href="HLC_ConnMgrRef.html#995624"><code>CncEdgeNew()</code></a><br><a href="HLC_ConnMgrRef.html#1072696"><code>CncObjectControl()</code></a><br><a href="HLC_ConnMgrRef.html#1055393"><code>CncObjectMoveItem()</code></a><br><a href="HLC_ConnMgrRef.html#995848"><code>CncProfileAttach()</code></a><br><a href="HLC_ConnMgrRef.html#1056624"><code>CncProfileCopy()</code></a></p>
    </td>
    <td><p class="tt"><a name="995798"> </a><a href="HLC_ConnMgrRef.html#995950"><code>CncProfileEdit()</code></a><br><a href="HLC_ConnMgrRef.html#996268"><code>CncProfileInsertItem()</code></a><br><a href="HLC_ConnMgrRef.html#996311"><code>CncProfileLock()</code></a><br><a href="HLC_ConnMgrRef.html#996337"><code>CncProfileNew()</code></a><br><a href="HLC_ConnMgrRef.html#996445"><code>CncProfileUnlock()</code></a></p>
<p class="tt"><a name="993283"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993285"> </a><b>Connecting</b></p>
    </td>
    <td><p class="tt"><a name="993287"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993292"> </a><a href="HLC_ConnMgrRef.html#995559"><code>CncConnectReceiveState()</code></a><br><a href="HLC_ConnMgrRef.html#995870"><code>CncProfileConnect()</code></a></p>
    </td>
    <td><p class="tt"><a name="995820"> </a><a href="HLC_ConnMgrRef.html#1075366"><code>CncProfileDisconnect()</code></a><br><a href="HLC_ConnMgrRef.html#996013"><code>CncProfileFindConnect()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993302"> </a><b>Searching</b></p>
    </td>
    <td><p class="tt"><a name="993304"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993309"> </a><a href="HLC_ConnMgrRef.html#1076207"><code>CncObjectFindAll()</code></a><br><a href="HLC_ConnMgrRef.html#1121846"><code>CncProfileFindClose()</code></a></p>
    </td>
    <td><p class="tt"><a name="995835"> </a><a href="HLC_ConnMgrRef.html#996053"><code>CncProfileFindFirst()</code></a><br><a href="HLC_ConnMgrRef.html#996089"><code>CncProfileFindNext()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993319"> </a><b>Profile/String Conversion</b></p>
    </td>
    <td><p class="tt"><a name="993321"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993326"> </a><a href="HLC_ConnMgrRef.html#995901"><code>CncProfileDecode()</code></a></p>
    </td>
    <td><p class="tt"><a name="995850"> </a><a href="HLC_ConnMgrRef.html#995975"><code>CncProfileEncode()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993333"> </a><b>Plug-in Registration</b></p>
    </td>
    <td><p class="tt"><a name="993335"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993340"> </a><a href="HLC_ConnMgrRef.html#996483"><code>CncRegisterPluginModule()</code></a></p>
    </td>
    <td><p class="tt"><a name="993345"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993347"> </a><b>Database Record Operations</b></p>
    </td>
    <td><p class="tt"><a name="993349"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993354"> </a><a href="HLC_ConnMgrRef.html#995694"><code>CncInterfaceNew()</code></a><br><a href="HLC_ConnMgrRef.html#995716"><code>CncObjectDelete()</code></a><br><a href="HLC_ConnMgrRef.html#995733"><code>CncObjectGetIndex()</code></a></p>
    </td>
    <td><p class="tt"><a name="995862"> </a><a href="HLC_ConnMgrRef.html#995748"><code>CncObjectGetInfo()</code></a><br><a href="HLC_ConnMgrRef.html#995778"><code>CncObjectSetInfo()</code></a><br><a href="HLC_ConnMgrRef.html#996425"><code>CncProfileSubmit()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993373"> </a><b>Parameter Configuration</b></p>
    </td>
    <td><p class="tt"><a name="993375"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993380"> </a><a href="HLC_ConnMgrRef.html#995807"><code>CncParametersFree()</code></a></p>
    </td>
    <td><p class="tt"><a name="995880"> </a><a href="HLC_ConnMgrRef.html#995826"><code>CncParametersInit()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993387"> </a><b>Profile Item Operations</b></p>
    </td>
    <td><p class="tt"><a name="993389"> </a><b></b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="993394"> </a><a href="HLC_ConnMgrRef.html#995928"><code>CncProfileDeleteItem()</code></a><br><a href="HLC_ConnMgrRef.html#996118"><code>CncProfileGetItemId()</code></a><br><a href="HLC_ConnMgrRef.html#996143"><code>CncProfileGetItemIndex()</code></a></p>
    </td>
    <td><p class="tt"><a name="995892"> </a><a href="HLC_ConnMgrRef.html#996178"><code>CncProfileGetLength()</code></a><br><a href="HLC_ConnMgrRef.html#996203"><code>CncProfileGetParameters()</code></a><br><a href="HLC_ConnMgrRef.html#996365"><code>CncProfileSetParameters()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996895"> </a><b>Subprofile Operations</b></p>
    </td>
    <td><p class="tt"><a name="996881"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996887"> </a><a href="HLC_ConnMgrRef.html#1105955"><code>CncProfileRegroupSubmit()</code></a><br><a href="HLC_ConnMgrRef.html#996425"><code>CncProfileSubmit()</code></a></p>
    </td>
    <td><p class="tt"><a name="996889"> </a><a href="HLC_ConnMgrRef.html#1107178"><code>CncSubProfileAssign()</code></a></p>
    </td>
  </tr>
</table>

</div>




<p><a name="986245"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996&#8211;2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="HLC_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="HLC_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="HLC_ConnMgrPart.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="HLC_ConnMgrPlugins.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="HLC_IX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>