<html>
<head>
<title>(Protein) Text Services FEP Reference | Creating a Front-End Processor</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 11:09:47">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="995984"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="FEPTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="FEPTextServicesMgr.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="FEPTextServicesFepApdx.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="FEPIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">5 &nbsp;&nbsp;
Text Services FEP Reference</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Creating a Front-End Processor</p>
<p class="SubTitle">Exploring Palm OS&#174; </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1"><a href="FEPTextServicesFep.html">5  Text Services FEP Reference</a></h1>

   <h2 class="SideTOC2"><a href="#1025036">
   FEP Events</a></h2>

      <h3 class="SideTOC3"><a href="#1025709">
      tsmConfirmEvent</a></h3>

      <h3 class="SideTOC3"><a href="#1025710">
      tsmFepButtonEvent</a></h3>

      <h3 class="SideTOC3"><a href="#1025711">
      tsmFepModeEvent</a></h3>

      <h3 class="SideTOC3"><a href="#1025712">
      tsmFepChangeEvent</a></h3>

      <h3 class="SideTOC3"><a href="#1025713">
      tsmFepDisplayOptionsEvent</a></h3>

      <h3 class="SideTOC3"><a href="#1025714">
      tsmFepSelectOptionEvent</a></h3>

   <h2 class="SideTOC2"><a href="#995992">
   Text Services FEP Structures and Types</a></h2>

      <h3 class="SideTOC3"><a href="#996006">
      FepPanelAddWordParamsType</a></h3>

      <h3 class="SideTOC3"><a href="#996087">
      TsmFepActionType</a></h3>

      <h3 class="SideTOC3"><a href="#996290">
      TsmFepEventType</a></h3>

      <h3 class="SideTOC3"><a href="#996463">
      TsmFepInfoType</a></h3>

      <h3 class="SideTOC3"><a href="#996601">
      TsmFepStatusType</a></h3>

   <h2 class="SideTOC2"><a href="#996739">
   Text Services FEP Constants</a></h2>

      <h3 class="SideTOC3"><a href="#1043897">
      Button ID Constants</a></h3>

      <h3 class="SideTOC3"><a href="#996774">
      Error Codes</a></h3>

      <h3 class="SideTOC3"><a href="#1040476">
      Miscellaneous Constants</a></h3>

   <h2 class="SideTOC2"><a href="#1002687">
   Text Services FEP Launch Codes</a></h2>

      <h3 class="SideTOC3"><a href="#1002823">
      sysAppLaunchCmdFepPanelAddWord</a></h3>

   <h2 class="SideTOC2"><a href="#997025">
   Text Services FEP Functions</a></h2>

      <h3 class="SideTOC3"><a href="#997052">
      TsmFepCommitAction</a></h3>

      <h3 class="SideTOC3"><a href="#997186">
      TsmFepHandleEvent</a></h3>

      <h3 class="SideTOC3"><a href="#997333">
      TsmFepMapEvent</a></h3>

      <h3 class="SideTOC3"><a href="#997637">
      TsmFepOptionsList</a></h3>

      <h3 class="SideTOC3"><a href="#997750">
      TsmFepReset</a></h3>

      <h3 class="SideTOC3"><a href="#998065">
      TsmFepTerminate</a></h3>

      <h3 class="SideTOC3"><a href="#998168">
      TsmGetCurrentFepCreator</a></h3>

      <h3 class="SideTOC3"><a href="#998568">
      TsmGetSystemFepCreator</a></h3>

      <h3 class="SideTOC3"><a href="#1016886">
      TsmSetCurrentFepCreator</a></h3>

      <h3 class="SideTOC3"><a href="#1016531">
      TsmSetSystemFepCreator</a></h3>

   <h2 class="SideTOC2"><a href="#1016456">
   Text Services FEP Plugin Functions</a></h2>

      <h3 class="SideTOC3"><a href="#998661">
      TsmLibFepClose</a></h3>

      <h3 class="SideTOC3"><a href="#999041">
      TsmLibFepCommitAction</a></h3>

      <h3 class="SideTOC3"><a href="#999134">
      TsmLibFepDrawModeIndicator</a></h3>

      <h3 class="SideTOC3"><a href="#999492">
      TsmLibFepDrawOption</a></h3>

      <h3 class="SideTOC3"><a href="#999626">
      TsmLibFepHandleEvent</a></h3>

      <h3 class="SideTOC3"><a href="#999773">
      TsmLibFepMapEvent</a></h3>

      <h3 class="SideTOC3"><a href="#1000139">
      TsmLibFepOpen</a></h3>

      <h3 class="SideTOC3"><a href="#1000232">
      TsmLibFepReset</a></h3>

      <h3 class="SideTOC3"><a href="#1000412">
      TsmLibFepTerminate</a></h3>

      <h3 class="SideTOC3"><a href="#1000515">
      TsmLibGetFepInfo</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1001067"> </a>This chapter provides information about the FEP API as declared in <code>TextServicesFep.h</code> (see <a href="FEPTextServicesFepApdx.html#990565">Appendix A</a>). For source code examples, see <code>SampleFep.cpp</code> in the Sample FEP.</p>

<p><a name="1001073"> </a>This chapter also provides information about the system-level events specific to the Text Services Manager (TSM). These events and structures defined in the Palm OS<sup>&#174;</sup> header files <code>EventCodes.h </code>and <code>Event.h</code>.</p>
   <blockquote class = "bq"><a name="1021297"> </a><a href="FEPTextServicesFep.html#1025036">FEP Events</a></blockquote>
   <blockquote class = "bq"><a name="996001"> </a><a href="FEPTextServicesFep.html#995992">Text Services FEP Structures and Types</a></blockquote>
   <blockquote class = "bq"><a name="996748"> </a><a href="FEPTextServicesFep.html#996739">Text Services FEP Constants</a></blockquote>
   <blockquote class = "bq"><a name="1021019"> </a><a href="FEPTextServicesFep.html#1002687">Text Services FEP Launch Codes</a></blockquote>
   <blockquote class = "bq"><a name="997034"> </a><a href="FEPTextServicesFep.html#997025">Text Services FEP Functions</a></blockquote>
   <blockquote class = "bq"><a name="1017536"> </a><a href="FEPTextServicesFep.html#1016456">Text Services FEP Plugin Functions</a></blockquote>

<p><a name="1017512"> </a>Your FEP shared library must implement the API described in the section <a href="FEPTextServicesFep.html#1016456">"Text Services FEP Plugin Functions."</a></p>

<h2 class="haH2">
  <a name="1025036"> </a>FEP Events <a href="#995984"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1025709"> </a>tsmConfirmEvent <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1026040"> </a>Purpose 
</h4>

<p><a name="1026078"> </a>Optionally sent by a FEP when converted text has been confirmed, either explicitly by the user or as a result of the field losing the focus. </p>

<p><a name="1029172"> </a>For this event, the <a href="../Programming_Basics/Event.html#992950"><code>EventType</code></a> <code>data</code> field contains the structure shown in the Prototype section, below. </p>
<h4>
  <a name="1029173"> </a>Declared In 
</h4>
<code>Event.h<a name="1029174"> </a></code><h4>
  <a name="1030439"> </a>Prototype 
</h4>
<pre class="proto"><a name="1030759"></a>struct _TSMConfirmType {
   char *yomiText;
   uint16_t formID;
   uint16_t padding_1;
} 
</pre>
<h4>
  <a name="1032067"> </a>Fields 
</h4>

<dl>
<dt><a name="1032068"> </a><code>yomiText</code></dt>
<dd><a name="1032069"> </a>A pointer to the raw text that the user entered during conversion, which corresponds to the converted text being confirmed.</dd>

<dt><a name="1032070"> </a><code>formID</code></dt>
<dd><a name="1032071"> </a>The ID of the form that was active when the converted text was confirmed. This is useful for proper event processing when <code>tsmConfirmEvent</code> is being generated while one form is being closed and other form is opened: the event won't be processed until after the new form has become active.</dd>

<dt><a name="1032072"> </a><code>padding_1</code></dt>
<dd><a name="1032073"> </a>Padding bytes.</dd>

</dl>
<h4>
  <a name="1032074"> </a>Comments 
</h4>

<p><a name="1032075"> </a>An application (such as the Address Book) can use the data contained in this event to automatically set the data in a pronunciation field, instead of forcing users to re-enter the same text that they just passed to the FEP.</p>

<h3 class="hbH3">
  <a name="1025710"> </a>tsmFepButtonEvent <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1032314"> </a>Purpose 
</h4>

<p><a name="1037794"> </a>Tapping on a Text Services Manager input area button posts a <code>keyDownEvent</code> with a virtual character code (<code>vchrTsm1</code> through <code>vchrTsm4</code>) and the command bit set in the event's modifier field. If the <code>keyDownEvent</code>'s character code matches one of the four that correspond to the input area buttons, <code>SysHandleEvent()</code> calls the Text Services Manager to remap the event to be a <a href="FEPTextServicesFep.html#1025710"><code>tsmFepButtonEvent</code></a>.</p>

<p><a name="1038080"> </a>For this event, the <a href="../Programming_Basics/Event.html#992950"><code>EventType</code></a> <code>data</code> field contains the structure shown in the Prototype section, below. </p>
<h4>
  <a name="1032359"> </a>Declared In 
</h4>
<code>Event.h<a name="1037881"> </a></code><h4>
  <a name="1032407"> </a>Prototype 
</h4>
<pre class="proto"><a name="1032479"></a>struct _TSMFepButtonType {
   uint16_t buttonID;
} 
</pre>
<h4>
  <a name="1032480"> </a>Fields 
</h4>

<dl>
<dt><a name="1032481"> </a><code>buttonID</code></dt>
<dd><a name="1038250"> </a>This field can have one of the values defined in <a href="FEPTextServicesFep.html#1043897">"Button ID Constants."</a> Some FEPs may not use all of these values.</dd>

</dl>

<div><hr>
  <a name="1032482"> </a> <b>NOTE: </b> The <code>tsmFepButtonShorten</code> and <code>tsmFepButtonLengthen</code> values don't correspond to any of the four input area buttons; typically these values are generated by a physical keyboard, and are used to indicate clause shortening and lengthening.
<hr>
</div>

<h3 class="hbH3">
  <a name="1025711"> </a>tsmFepModeEvent <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1032503"> </a>Purpose 
</h4>

<p><a name="1038642"> </a>Used to change the FEP mode. This includes turning the FEP off, and turning it on (in its default mode). FEP mode changes must be handled through events to ensure proper FEP/field code synchronization.</p>

<p><a name="1038123"> </a>For this event, the <a href="../Programming_Basics/Event.html#992950"><code>EventType</code></a> <code>data</code> field contains the structure shown in the Prototype section, below. </p>
<h4>
  <a name="1032595"> </a>Declared In 
</h4>
<code>Event.h<a name="1037933"> </a></code><h4>
  <a name="1032829"> </a>Prototype 
</h4>
<pre class="proto"><a name="1032888"></a>struct _TSMFepModeEventType {
   uint16_t mode;
} 
</pre>
<h4>
  <a name="1032889"> </a>Fields 
</h4>

<dl>
<dt><a name="1032890"> </a><code>mode</code></dt>
<dd><a name="1032891"> </a>One of the constants described in <a href="FEPTextServicesMgr.html#996964">"TsmFepModeType."</a></dd>

</dl>

<h3 class="hbH3">
  <a name="1025712"> </a>tsmFepChangeEvent <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1032934"> </a>Purpose 
</h4>

<p><a name="1038692"> </a>Sent by the Text Services Manager when the FEP is changed, to make all threads aware of the change. This event is used only by the Text Services Manager and a FEP does not need to pay attention to it.</p>

<p><a name="1038745"> </a>For this event, the <a href="../Programming_Basics/Event.html#992950"><code>EventType</code></a> <code>data</code> field contains the structure shown in the Prototype section, below. </p>
<h4>
  <a name="1032978"> </a>Declared In 
</h4>
<code>Event.h<a name="1037977"> </a></code><h4>
  <a name="1033026"> </a>Prototype 
</h4>
<pre class="proto"><a name="1033091"></a>struct tsmFepChange {
   uint32_t creator;
} tsmFepChange
</pre>
<h4>
  <a name="1033092"> </a>Fields 
</h4>

<dl>
<dt><a name="1033093"> </a><code>creator</code></dt>
<dd><a name="1033094"> </a>Creator ID of the new FEP.</dd>

</dl>

<h3 class="hbH3">
  <a name="1025713"> </a>tsmFepDisplayOptionsEvent <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1033153"> </a>Purpose 
</h4>

<p><a name="1038207"> </a>Sent by the Text Services Manager when the user has requested that the FEP display the options list. This event is used only by the Text Services Manager and a FEP does not need to pay attention to it.</p>

<p><a name="1038829"> </a>For this event, the <a href="../Programming_Basics/Event.html#992950"><code>EventType</code></a> <code>data</code> field contains the structure shown in the Prototype section, below. </p>
<h4>
  <a name="1033459"> </a>Declared In 
</h4>
<code>Event.h<a name="1038021"> </a></code><h4>
  <a name="1034949"> </a>Prototype 
</h4>
<pre class="proto"><a name="1034997"></a>struct tsmFepDisplayOptions {
   uint16_t numOptions;
   uint16_t curOption;
   uint16_t maxOptionWidth;
} tsmFepDisplayOptions
</pre>
<h4>
  <a name="1034998"> </a>Fields 
</h4>

<dl>
<dt><a name="1034999"> </a><code>numOptions</code></dt>
<dd><a name="1035000"> </a>Number of options in the list.</dd>

<dt><a name="1035001"> </a><code>curOption</code></dt>
<dd><a name="1035002"> </a>The number of the currently selected option in the list. List items are numbered beginning with 0.</dd>

<dt><a name="1035003"> </a><code>maxOptionWidth</code></dt>
<dd><a name="1035004"> </a>The maximum option width in pixels.</dd>

</dl>

<h3 class="hbH3">
  <a name="1025714"> </a>tsmFepSelectOptionEvent <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1046268"> </a>Purpose 
</h4>

<p><a name="1046270"> </a>Sent by the Text Services Manager to the FEP when an item is selected in the FEP options list.</p>

<p><a name="1046274"> </a>For this event, the <a href="../Programming_Basics/Event.html#992950"><code>EventType</code></a> <code>data</code> field contains the structure shown in the Prototype section, below. </p>
<h4>
  <a name="1035165"> </a>Declared In 
</h4>
<code>Event.h<a name="1038057"> </a></code><h4>
  <a name="1035357"> </a>Prototype 
</h4>
<pre class="proto"><a name="1035584"></a>struct tsmFepSelectOption {
   int16_t selection;
} tsmFepSelectOption
</pre>
<h4>
  <a name="1035585"> </a>Fields 
</h4>

<dl>
<dt><a name="1035586"> </a><code>selection</code></dt>
<dd><a name="1035587"> </a>The number of the selected option. List items are numbered beginning with 0. </dd>

</dl>

<h2 class="haH2">
  <a name="995992"> </a>Text Services FEP Structures and Types <a href="#995984"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="996006"> </a>FepPanelAddWordParamsType Struct <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996017"> </a>Purpose 
</h4>

<p><a name="996023"> </a>The parameter block for the launch command <a href="FEPTextServicesFep.html#1002823"><code>sysAppLaunchCmdFepPanelAddWord</code></a>.</p>
<h4>
  <a name="996028"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="996034"> </a></code><h4>
  <a name="996039"> </a>Prototype 
</h4>
<pre class="proto"><a name="996045"></a>typedef struct {
   const char *wordP;
   size_t wordLen;
} FepPanelAddWordParamsType
</pre>
<h4>
  <a name="996050"> </a>Fields 
</h4>

<dl>
<dt><a name="996056"> </a><code>wordP</code></dt>
<dd><a name="996061"> </a>Pointer to the word to be added or looked up.</dd>

<dt><a name="996066"> </a><code>wordLen</code></dt>
<dd><a name="996071"> </a>Length of the word in <code>wordP</code>.</dd>

</dl>

<h3 class="hbH3">
  <a name="996087"> </a>TsmFepActionType Struct <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996098"> </a>Purpose 
</h4>

<p><a name="1005254"> </a>The FEP functions <a href="FEPTextServicesFep.html#999626"><code>TsmLibFepHandleEvent()</code></a> and <a href="FEPTextServicesFep.html#1000412"><code>TsmLibFepTerminate()</code></a> use this structure to tell the caller what needs to be done to update the text display to synchronize it with the FEP.</p>
<h4>
  <a name="996109"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="996115"> </a></code><h4>
  <a name="996120"> </a>Prototype 
</h4>
<pre class="proto"><a name="996126"></a>typedef struct {
   size_t dumpLength;
   size_t primedLength;
   Boolean updateText;
   Boolean updateSelection;
   Boolean handledEvent;
} TsmFepActionType
</pre>
<h4>
  <a name="996175"> </a>Fields 
</h4>

<dl>
<dt><a name="1005452"> </a><code>dumpLength</code></dt>
<dd><a name="1005453"> </a>Tells the caller how many bytes of text in the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a><code>.inlineText</code> data should be removed from the front of the inline area and made part of the regular (non-inline) text. A value of zero means that nothing is being dumped. </dd>

<dt><a name="996239"> </a><code>primedLength</code></dt>
<dd><a name="996244"> </a>The FEP uses this field to tell the caller how much of the priming text (passed to it in <a href="FEPTextServicesFep.html#996290"><code>TsmFepEventType</code></a>.<code>primeText</code>) it was able to accept or use. The caller uses this value to trim unused bytes from the end of the inline area, because initially it assumes that all of the selected (priming) text became inline text.</dd>

<dt><a name="996249"> </a><code>updateText</code></dt>
<dd><a name="996254"> </a>This field is set to <code>true</code> whenever the contents or length of the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a>.<code>inlineText</code> data has been changed.</dd>

<dt><a name="996259"> </a><code>updateSelection</code></dt>
<dd><a name="996264"> </a>This field is set to <code>true</code> whenever the clause or highlighting offsets in the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> structure have changed.</dd>

<dt><a name="996269"> </a><code>handledEvent</code></dt>
<dd><a name="996274"> </a>This field is <code>true</code> when <a href="FEPTextServicesFep.html#999626"><code>TsmLibFepHandleEvent()</code></a> has completely handled the event, and thus the caller should not do any further processing of the event.</dd>

</dl>

<h3 class="hbH3">
  <a name="996290"> </a>TsmFepEventType Struct <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996301"> </a>Purpose 
</h4>

<p><a name="1005600"> </a>This structure is passed to the <a href="FEPTextServicesFep.html#999626"><code>TsmLibFepHandleEvent()</code></a> function. It contains extra information required by the FEP to correctly handle the event. This structure is filled in by the field object, and is read-only; the FEP does not need to update any of the fields in this structure. </p>
<h4>
  <a name="996312"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="996318"> </a></code><h4>
  <a name="996323"> </a>Prototype 
</h4>
<pre class="proto"><a name="996329"></a>typedef struct {
   size_t penOffset;
   Boolean penLeading;
   Boolean formEvent;
   uint16_t padding;
   size_t maxInline;
   char *primeText;
   size_t primeOffset;
   size_t primeLen;
} TsmFepEventType
</pre>
<h4>
  <a name="996341"> </a>Fields 
</h4>

<dl>
<dt><a name="996350"> </a><code>penOffset</code></dt>
<dd><a name="1005647"> </a>The offset (in bytes) from the beginning of the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a>.<code>inlineText</code> data to the offset of the character located at the event's <code>screenX</code> and <code>screenY</code> location. This field is only valid for <code>penDownEvents</code>. </dd>

<dd><a name="996361"> </a>Note that this field will contain a negative number if the user taps on text before the start of the inline area, and it could also be past the end of the inline text area.</dd>

<dt><a name="996374"> </a><code>penLeading</code></dt>
<dd><a name="996387"> </a>Indicates whether a <code>penDownEvent</code> occurred on the left side of the character following <code>penOffset</code>, or the right side of the character preceding <code>penOffset</code>. The value is <code>true</code> if the <code>penDown</code> Event was on the left (leading edge) side of the following character. </dd>

<dt><a name="996392"> </a><code>formEvent</code></dt>
<dd><a name="996397"> </a>This field is <code>true</code> if <a href="FEPTextServicesFep.html#999626"><code>TsmLibFepHandleEvent()</code></a> is being called by the form code (when there is no active field), and thus the status record should not be modified.</dd>

<dt><a name="996402"> </a><code>padding</code></dt>
<dd><a name="996407"> </a>Padding bytes.</dd>

<dt><a name="996412"> </a><code>maxInline</code></dt>
<dd><a name="996417"> </a>The maximum number of bytes allowable in the inline text area. It is up to the FEP to constrain the results it passes back in the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> record such that <code>convertedLen</code> + <code>pendingLen</code> is always less than or equal to this limit. This limit is calculated by the field object, based on the amount of text in the field, the current size of the inline area, and the maximum allowable text in the field.</dd>

<dt><a name="996422"> </a><code>primeText</code></dt>
<dd><a name="1006179"> </a>A pointer to text used to "prime" the conversion process. If there is no active inline area, its value is determined as follows: the user selects text in a field, and then the user turns the FEP on, taps the mode change button, or taps the convert button.</dd>

<dd><a name="996427"> </a>The field code will set <code>primeText</code> to be the field's text pointer.</dd>

<dt><a name="996432"> </a><code>primeOffset</code></dt>
<dd><a name="996437"> </a>The offset to the beginning of the selected text defined by the <code>primeText</code> pointer.</dd>

<dt><a name="996442"> </a><code>primeLen</code></dt>
<dd><a name="996447"> </a>The length of the selected text defined by the <code>primeText</code> pointer.</dd>

</dl>

<div><hr>
  <a name="1006864"> </a> <b>NOTE: </b> The value of <code>primeLen</code> might be greater than the maximum amount of text that the FEP can handle. In that case, the FEP should ignore text beyond what it can handle, and set up the <a href="FEPTextServicesFep.html#996087"><code>TsmFepActionType</code></a><code>.primedLength</code> field with the amount of text it was able to use for the inline text. 
<hr>
</div>

<h3 class="hbH3">
  <a name="996463"> </a>TsmFepInfoType Struct <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996474"> </a>Purpose 
</h4>

<p><a name="996480"> </a>The <code>TsmFepInfoType</code> structure is returned by the <a href="FEPTextServicesFep.html#1000515"><code>TsmLibGetFepInfo()</code></a> function, which is usually called before the FEP is actually opened.</p>
<h4>
  <a name="996485"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="996491"> </a></code><h4>
  <a name="996496"> </a>Prototype 
</h4>
<pre class="proto"><a name="996502"></a>typedef struct {
   uint32_t apiVersion;
   uint32_t libVersion;
   uint32_t libMaker;
   CharEncodingType encoding;
   LmLanguageType language;
   size_t stackExtra;
   size_t fieldExtra;
} TsmFepInfoType
</pre>
<h4>
  <a name="996507"> </a>Fields 
</h4>

<dl>
<dt><a name="996513"> </a><code>apiVersion</code></dt>
<dd><a name="1007227"> </a>This field should always be set to <code>tsmFepAPIVersion</code>, which is a constant defined in <code>TextServicesFep.h</code> (see <a href="FEPTextServicesFepApdx.html#990565">Appendix A</a>). The <code>tsmAPIVersion</code> constant is a standard Palm OS version number of the format <br><code>x.y.z&lt;release stage&gt;&lt;release number&gt; </code></dd>

<dd><a name="1007232"> </a>and<code> </code>encoded as a 32-bit value. For example, version 1.12b3 would be encoded as 0x01122003.</dd>

<dd><a name="996518"> </a>The value in this field is used by the Text Services Manager to decide if the FEP implements an appropriate version of the API. If the value returned by the FEP matches the current API version number in the major and minor fields, then the FEP can be used. Otherwise the FEP is ignored.</dd>

<dt><a name="996523"> </a><code>libVersion</code></dt>
<dd><a name="996528"> </a>The version number for any custom APIs implemented by the FEP library. This field is useful for code that calls any of the library's extended functions; for example, a function that accesses the user dictionary.</dd>

<dt><a name="996540"> </a><code>libMaker</code></dt>
<dd><a name="996545"> </a>A four character "FEP Maker" code. This should always be the same as the FEP creator ID. Otherwise, by convention this code should match the creator code used by any associated panel or application that is part of the FEP software package.</dd>

<dt><a name="996550"> </a><code>encoding</code></dt>
<dd><a name="996555"> </a>A Text Manager character encoding value as defined in <code>PalmLocale.h</code>, for example <code>charEncodingPalmSJIS</code> for Japanese FEPs.</dd>

<dt><a name="996560"> </a><code>language</code></dt>
<dd><a name="996565"> </a>A Locale Manager language code as defined in <code>LocaleMgrTypes.h</code>; for example, <code>lJapanese</code> for Japanese FEPs.</dd>

<dt><a name="996570"> </a><code>stackExtra</code></dt>
<dd><a name="996575"> </a>The maximum amount of stack space in bytes that would be used by the FEP in response to the <a href="FEPTextServicesFep.html#999626"><code>TsmLibFepHandleEvent()</code></a> call.</dd>

<dt><a name="996580"> </a><code>fieldExtra</code></dt>
<dd><a name="1007588"> </a>The number of extra bytes needed to auto-expand "short" fields so that the user can enter enough pre-conversion text to correctly specify the post-conversion results. </dd>

<dd><a name="996585"> </a>For example, some Japanese Kanji characters could require up to ten bytes of text entry in order to specify the Hiragana characters that will be converted into two double-byte Kanji characters. In this example, six extra bytes would be required to set the last two characters in a field to the converted Kanji. This value is primarily used by the Category code when the user is editing the names of categories.</dd>

</dl>

<h3 class="hbH3">
  <a name="996601"> </a>TsmFepStatusType Struct <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996612"> </a>Purpose 
</h4>

<p><a name="1009038"> </a>This structure is allocated by <a href="FEPTextServicesFep.html#1000139"><code>TsmLibFepOpen()</code></a>, and returned to the caller. It is then passed to many of the FEP functions, until <a href="FEPTextServicesFep.html#998661"><code>TsmLibFepClose()</code></a> deallocates it. The FEP uses this structure to tell the field object code what to display, and how to display it. </p>
<h4>
  <a name="996623"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="996629"> </a></code><h4>
  <a name="996634"> </a>Prototype 
</h4>
<pre class="proto"><a name="996640"></a>typedef struct {
   char *inlineText;
   size_t convertedLen;
   size_t pendingLen;
   size_t selectStart;
   size_t selectEnd;
   size_t clauseStart;
   size_t clauseEnd;
} TsmFepStatusType
</pre>
<h4>
  <a name="996645"> </a>Fields 
</h4>

<dl>
<dt><a name="996651"> </a><code>inlineText</code></dt>
<dd><a name="996656"> </a>The reference number of the FEP shared library. This is filled in by the Text Services Manager after the call to <a href="FEPTextServicesFep.html#1000139"><code>TsmLibFepOpen()</code></a> succeeds.</dd>

<dt><a name="996661"> </a><code>convertedLen</code></dt>
<dd><a name="996666"> </a>A pointer to the text that is controlled by the FEP. This text is often called the "active input area" text.</dd>

<dt><a name="996671"> </a><code>pendingLen</code></dt>
<dd><a name="996676"> </a>The amount of text (in bytes) in the <code>inlineText</code> data that has been entered but not yet converted. This text always follows the converted text.</dd>

<dt><a name="996681"> </a><code>selectStart</code></dt>
<dd><a name="996686"> </a>The offset (in bytes) from the beginning of the <code>inlineText</code> data to the beginning of the selected text.</dd>

<dt><a name="996691"> </a><code>selectEnd</code></dt>
<dd><a name="996696"> </a>The offset (in bytes) from the beginning of the <code>inlineText</code> data to the end of the selected text. If there is an insertion point, but no selection range, then this value will be the same as <code>selectStart</code>.</dd>

<dt><a name="996708"> </a><code>clauseStart</code></dt>
<dd><a name="996713"> </a>The offset (in bytes) from the beginning of the <code>inlineText</code> data to the beginning of the current clause text. Only converted text can contain clauses. If there is no converted text, or no clause, then this field should contain zero.</dd>

<dt><a name="996718"> </a><code>clauseEnd</code></dt>
<dd><a name="996723"> </a>The offset (in bytes) from the beginning of the <code>inlineText</code> data to the end of the current clause text. If there is no converted text, or no clause, then this field should contain zero.</dd>

</dl>

<div><hr>
  <a name="1011049"> </a> <b>NOTE: </b> If the FEP is dumping text from the inline area into the field object, these offsets are still relative to the state of the inline text <i>before</i> any dumping has taken place. The <a href="FEPTextServicesFep.html#999041"><code>TsmLibFepCommitAction()</code></a> call should update the FEP's internal state to reflect the effect of dumping text.
<hr>
</div>

<div><hr>
  <a name="1011053"> </a> <b>NOTE: </b> The FEP typically adds extra information to the end of this record, to maintain private information about the session. 
<hr>
</div>

<h2 class="haH2">
  <a name="996739"> </a>Text Services FEP Constants <a href="#995984"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1043897"> </a>Button ID Constants <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1043898"> </a>Purpose 
</h4>

<p><a name="1043902"> </a>Possible values for the <code>buttonID</code> field in a <a href="FEPTextServicesFep.html#1025710"><code>tsmFepButtonEvent</code></a> event.</p>
<h4>
  <a name="1043903"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1043904"> </a></code><h4>
  <a name="1043905"> </a>Constants 
</h4>

<dl>
<dt><a name="1043907"> </a><code>#define tsmFepButtonConvert 0</code></dt>
<dd><a name="1043908"> </a>The Convert button.</dd>

<dt><a name="1043910"> </a><code>#define tsmFepButtonConfirm 1</code></dt>
<dd><a name="1043911"> </a>The Confirm button.</dd>

<dt><a name="1043913"> </a><code>#define tsmFepButtonMode 2</code></dt>
<dd><a name="1043914"> </a>The Mode button.</dd>

<dt><a name="1043916"> </a><code>#define tsmFepButtonOnOff 3</code></dt>
<dd><a name="1043917"> </a>The On/Off button.</dd>

<dt><a name="1043919"> </a><code>#define tsmFepButtonShorten 4</code></dt>
<dd><a name="1043920"> </a>The Shorten button.</dd>

<dt><a name="1043922"> </a><code>#define tsmFepButtonLengthen 5</code></dt>
<dd><a name="1043923"> </a>The Lengthen button.</dd>

</dl>
<h4>
  <a name="1043924"> </a>Comments 
</h4>

<p><a name="1043925"> </a>The <code>tsmFepButtonShorten</code> and <code>tsmFepButtonLengthen</code> values don't correspond to any of the four input area buttons; typically these values are generated by a physical keyboard, and are used to indicate clause shortening and lengthening.</p>

<h3 class="hbH3">
  <a name="996774"> </a>Error Codes <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996779"> </a>Purpose 
</h4>

<p><a name="996785"> </a>Error codes returned by FEP shared library functions.</p>
<h4>
  <a name="996790"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="996796"> </a></code><h4>
  <a name="996801"> </a>Constants 
</h4>

<dl>
<dt><a name="996807"> </a><code>#define tsmErrFepCantCommit (tsmErrorClass | 2)</code></dt>
<dd><a name="996812"> </a>The <a href="FEPTextServicesFep.html#999041"><code>TsmLibFepCommitAction()</code></a> function encountered an error.</dd>

<dt><a name="996817"> </a><code>#define tsmErrFepCustom (tsmErrorClass | 128)</code></dt>
<dd><a name="1046284"> </a>FEPs can return custom error codes starting from here.</dd>

<dt><a name="996827"> </a><code>#define tsmErrFepNeedCommit (tsmErrorClass | 1)</code></dt>
<dd><a name="996832"> </a>The FEP is waiting for a <a href="FEPTextServicesFep.html#999041"><code>TsmLibFepCommitAction()</code></a> call.</dd>

<dt><a name="996837"> </a><code>#define tsmErrFepNotOpen (tsmErrorClass | 3)</code></dt>
<dd><a name="996842"> </a>The FEP is not open.</dd>

<dt><a name="996847"> </a><code>#define tsmErrFepReentrancy (tsmErrorClass | 8)</code></dt>
<dd><a name="996852"> </a>The FEP is currently running code in another thread and cannot process the call.</dd>

<dt><a name="996857"> </a><code>#define tsmErrFepStillOpen (tsmErrorClass | 4)</code></dt>
<dd><a name="996862"> </a>The FEP has additional contexts that are still active.</dd>

<dt><a name="996867"> </a><code>#define tsmErrFepWrongAPI (tsmErrorClass | 5)</code></dt>
<dd><a name="1046373"> </a>The FEP library API version does not match the Text Services Manager API version.</dd>

<dt><a name="1046375"> </a><code>#define tsmErrFepWrongEncoding (tsmErrorClass | 6)</code></dt>
<dd><a name="1046376"> </a>The FEP has received data in the wrong encoding. Currently the OS doesn't do anything special when this error code is returned by the FEP.</dd>

<dt><a name="996887"> </a><code>#define tsmErrFepWrongLanguage (tsmErrorClass | 7)</code></dt>
<dd><a name="1046292"> </a>The FEP has received data in the wrong language. Currently the OS doesn't do anything special when this error code is returned by the FEP.</dd>

<dt><a name="996897"> </a><code>#define tsmErrUnimplemented (tsmErrorClass | 0)</code></dt>
<dd><a name="1046296"> </a>The FEP doesn't implement the function. Currently the OS doesn't do anything special when this error code is returned by the FEP.</dd>

</dl>

<h3 class="hbH3">
  <a name="1040476"> </a>Miscellaneous Constants <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1040477"> </a>Purpose 
</h4>

<p><a name="1040478"> </a>Miscellaneous constants.</p>
<h4>
  <a name="1040479"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1040480"> </a></code><h4>
  <a name="1040481"> </a>Constants 
</h4>

<dl>
<dt><a name="996907"> </a><code>#define tsmFepAPIVersion (sysMakeROMVersion(6, 0, 0, sysROMStageRelease, 0))</code></dt>
<dd><a name="996919"> </a>Text Services Manager FEP API version information.</dd>

<dt><a name="1046015"> </a><code>#define tsmFtrNumFepStackExtra 128</code></dt>
<dd><a name="1046016"> </a>Selector used for <code>FtrGet()</code> to get the maximum number of extra stack bytes required by the FEP.</dd>

<dt><a name="1040573"> </a><code>#define tsmFtrNumFepFieldExtra 129</code></dt>
<dd><a name="1045775"> </a>Selector used for <code>FtrGet()</code> to get the maximum number of extra field bytes required by the FEP.</dd>

<dt><a name="1040579"> </a><code>#define tsmInvalidFepCreator 0</code></dt>
<dd><a name="1040580"> </a>Creator code used to indicate no FEP, for getting and setting the current and system FEP.</dd>

</dl>

<h2 class="haH2">
  <a name="1002687"> </a>Text Services FEP Launch Codes <a href="#995984"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1002823"> </a>sysAppLaunchCmdFepPanelAddWord <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1002824"> </a>Purpose 
</h4>

<p><a name="1002825"> </a>Send this launch code to the FEP panel to add a word to the FEP user dictionary.</p>
<h4>
  <a name="1002826"> </a>Declared In 
</h4>
<code>CmnLaunchCodes.h<a name="1002827"> </a></code><h4>
  <a name="1002828"> </a>Prototype 
</h4>
<pre class="proto"><a name="1002829"></a>#define sysAppLaunchCmdFepPanelAddWord 87


</pre>
<h4>
  <a name="1002830"> </a>Parameters 
</h4>

<p><a name="1003878"> </a>The launch code's parameter block pointer references a <a href="FEPTextServicesFep.html#996006"><code>FepPanelAddWordParamsType</code></a> structure that indicates the word to be added. </p>

<h2 class="haH2">
  <a name="997025"> </a>Text Services FEP Functions <a href="#995984"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="997052"> </a>TsmFepCommitAction Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1011296"> </a>Purpose 
</h4>

<p><a name="1011297"> </a>Unlocks or deallocates any buffers used to pass information back to the caller in the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> record as a result of a <a href="FEPTextServicesFep.html#999626"><code>TsmLibFepHandleEvent()</code></a> or <a href="FEPTextServicesFep.html#1000412"><code>TsmLibFepTerminate()</code></a> call.</p>
<h4>
  <a name="1011298"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1011299"> </a></code><h4>
  <a name="997085"> </a>Prototype 
</h4>
<pre class="proto"><a name="997091"></a>status_t TsmFepCommitAction (
   void
)
</pre>
<h4>
  <a name="997096"> </a>Parameters 
</h4>

<p><a name="997102"> </a>None.</p>
<h4>
  <a name="997107"> </a>Returns 
</h4>

<p><a name="997113"> </a><code>errNone</code> if the call was successful. Returns <code>tsmErrFepReentrancy</code> if the FEP is currently running code in another thread and cannot process the call. A FEP can prevent this error by doing reference counting.</p>
<h4>
  <a name="997118"> </a>Comments 
</h4>

<p><a name="997133"> </a>This function also updates any status record or internal offsets that need adjusting because text is being dumped from the inline text area.</p>

<h3 class="hbH3">
  <a name="997186"> </a>TsmFepHandleEvent Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="997221"> </a>Purpose 
</h4>

<p><a name="997227"> </a>Tells the caller whether or not the FEP completely handled the event. Updates the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> record as appropriate, and sets fields in the <a href="FEPTextServicesFep.html#996087"><code>TsmFepActionType</code></a> record to tell the caller what needs to be updated.</p>
<h4>
  <a name="997232"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="997238"> </a></code><h4>
  <a name="997243"> </a>Prototype 
</h4>
<pre class="proto"><a name="997249"></a>status_t TsmFepHandleEvent (
   const EventType <code class="par">*inEventP</code>,
   const TsmFepEventType <code class="par">*inTsmEventP</code>,
   TsmFepStatusType <code class="par">**ioStatusP</code>,
   TsmFepActionType <code class="par">*outActionP</code>
)
</pre>
<h4>
  <a name="997254"> </a>Parameters 
</h4>

<dl>
<dt><a name="997260"> </a><code>&rarr;  <i>inEventP</i></code></dt>
<dd><a name="997265"> </a>A pointer to a system event record, such as a typical <code>penDownEvent</code> or <code>keyDownEvent</code>.</dd>

<dt><a name="997270"> </a><code>&rarr;  <i>inTsmEventP</i></code></dt>
<dd><a name="997275"> </a>A pointer to a <a href="FEPTextServicesFep.html#996290"><code>TsmFepEventType</code></a> structure, which contains extra information about the event.</dd>

<dt><a name="997280"> </a><code>&harr;  <i>ioStatusP</i></code></dt>
<dd><a name="997285"> </a>Pointer to a status pointer for this context.</dd>

<dt><a name="997290"> </a><code>&larr;  <i>outActionP</i></code></dt>
<dd><a name="997295"> </a>A pointer to a <a href="FEPTextServicesFep.html#996087"><code>TsmFepActionType</code></a> structure, which the FEP fills in with information that the caller needs to know to correctly update the display to reflect the current FEP state.</dd>

</dl>
<h4>
  <a name="997300"> </a>Returns 
</h4>

<p><a name="1012242"> </a>Return one of the following:</p>

<dl>
<dt><a name="1012254"> </a><code><code>errNone</code></code></dt>
<dd><a name="1012569"> </a>The event was handled successfully (<code>outActionP.handledEvent</code> is <code>true</code>), or the event was not completely handled by this function (<code>outActionP.handledEvent</code> is <code>false</code>).</dd>

<dt><a name="1012256"> </a><code><code>tsmErrFepReentrancy</code> </code></dt>
<dd><a name="1012637"> </a>The FEP is currently running code.</dd>

<dt><a name="1012258"> </a><code><code>tsmErrFepNeedCommit</code></code></dt>
<dd><a name="1012769"> </a>The FEP is waiting for a <a href="FEPTextServicesFep.html#999041"><code>TsmLibFepCommitAction()</code></a> call.</dd>

</dl>
<h4>
  <a name="1012835"> </a>See Also 
</h4>

<p><a name="1012842"> </a><a href="FEPTextServicesFep.html#1025036">FEP Events</a></p>

<h3 class="hbH3">
  <a name="997333"> </a>TsmFepMapEvent Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="997344"> </a>Purpose 
</h4>

<p><a name="997357"> </a>Determines whether or not an event should be remapped by the FEP. If it needs to be remapped, then it posts the remapped event to the event queue.</p>
<h4>
  <a name="997370"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="997394"> </a></code><h4>
  <a name="997421"> </a>Prototype 
</h4>
<pre class="proto"><a name="997451"></a>Boolean TsmFepMapEvent (
   const EventType <code class="par">*inEventP</code>
)
</pre>
<h4>
  <a name="997480"> </a>Parameters 
</h4>

<dl>
<dt><a name="997510"> </a><code>&rarr;  <i>inEventP</i></code></dt>
<dd><a name="997539"> </a>A pointer to the event record.</dd>

</dl>
<h4>
  <a name="997580"> </a>Returns 
</h4>

<p><a name="997610"> </a><code>true</code> if the event was remapped.</p>
<h4>
  <a name="997615"> </a>Comments 
</h4>

<p><a name="997621"> </a>This function is commonly used to remap FEP button shortcut characters (that is, space or linefeed) to their FEP button equivalents. For example, it maps the shift left and right arrow <code>keyDownEvents</code> to shorten/lengthen clause events. Note that the remapping is conditional on the state of the FEP. For example, a space is only remapped to a convert event if the FEP has inline text, otherwise it gets treated like a regular space character (no remapping).</p>

<h3 class="hbH3">
  <a name="997637"> </a>TsmFepOptionsList Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="997648"> </a>Purpose 
</h4>

<p><a name="997654"> </a>Pops up the list of options for the FEP.</p>
<h4>
  <a name="997659"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="997665"> </a></code><h4>
  <a name="997670"> </a>Prototype 
</h4>
<pre class="proto"><a name="997676"></a>void TsmFepOptionsList (
   uint16_t <code class="par">iNumOptions</code>,
   uint16_t <code class="par">iCurOption</code>,
   uint16_t <code class="par">iMaxOptionWidth</code>
)
</pre>
<h4>
  <a name="997681"> </a>Parameters 
</h4>

<dl>
<dt><a name="997687"> </a><code>&rarr;  <i>iNumOptions</i></code></dt>
<dd><a name="997692"> </a>Number of options in the list.</dd>

<dt><a name="997697"> </a><code>&rarr;  <i>iCurOption</i></code></dt>
<dd><a name="997702"> </a>The currently selected item.</dd>

<dt><a name="997707"> </a><code>&rarr;  <i>iMaxOptionWidth</i></code></dt>
<dd><a name="997712"> </a>Maximum width of the list in pixels.</dd>

</dl>
<h4>
  <a name="997717"> </a>Returns 
</h4>

<p><a name="997723"> </a>The index of the list item selected, or <code>noListSelection</code> if no item was selected.</p>
<h4>
  <a name="997728"> </a>Comments 
</h4>

<p><a name="1020068"> </a>This function queues an event to pop up the FEP options list. When this event is handled by <a href="FEPTextServicesFep.html#997186"><code>TsmFepHandleEvent()</code></a>, the <a href="FEPTextServicesFep.html#999492"><code>TsmLibFepDrawOption()</code></a> function is called to draw each item in the list. This function is passed the item number and the bounds in which the option item is to be drawn.</p>

<h3 class="hbH3">
  <a name="997750"> </a>TsmFepReset Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="997761"> </a>Purpose 
</h4>

<p><a name="997767"> </a>Calls through to the current FEP's <a href="FEPTextServicesFep.html#1000232"><code>TsmLibFepReset()</code></a> function, which resets the FEP by clearing all buffers and setting the state back to raw text. </p>
<h4>
  <a name="997772"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="997795"> </a></code><h4>
  <a name="997818"> </a>Prototype 
</h4>
<pre class="proto"><a name="997858"></a>status_t TsmFepReset (
   void
)
</pre>
<h4>
  <a name="997901"> </a>Parameters 
</h4>

<p><a name="997947"> </a>None.</p>
<h4>
  <a name="997992"> </a>Returns 
</h4>

<p><a name="998038"> </a><code>errNone</code> if the call was successful. Returns <code>tsmErrFepReentrancy</code> if the FEP is currently running code and cannot process the call.</p>
<h4>
  <a name="998043"> </a>Comments 
</h4>

<p><a name="998049"> </a>This function does not change the mode. It also ignores any pending commits (see <a href="FEPTextServicesFep.html#999041"><code>TsmLibFepCommitAction()</code></a>).</p>

<h3 class="hbH3">
  <a name="998065"> </a>TsmFepTerminate Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="998076"> </a>Purpose 
</h4>

<p><a name="998082"> </a>Calls through to the current FEP's <a href="FEPTextServicesFep.html#1000412"><code>TsmLibFepTerminate()</code></a> function, which ends the conversion session, if active, updates the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> record with the new status, and fills in the <a href="FEPTextServicesFep.html#996087"><code>TsmFepActionType</code></a> record to tell the caller what needs to be updated.</p>
<h4>
  <a name="998087"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="998093"> </a></code><h4>
  <a name="998098"> </a>Prototype 
</h4>
<pre class="proto"><a name="998104"></a>status_t TsmFepTerminate (
   TsmFepStatusType <code class="par">**ioStatusP</code>,
   TsmFepActionType <code class="par">*outActionP</code>
)
</pre>
<h4>
  <a name="998109"> </a>Parameters 
</h4>

<dl>
<dt><a name="998115"> </a><code>&harr;  <i>ioStatusP</i></code></dt>
<dd><a name="998120"> </a>Pointer to the FEP's status record.</dd>

<dt><a name="998125"> </a><code>&larr;  <i>outActionP</i></code></dt>
<dd><a name="998130"> </a>Pointer to the FEP's action record.</dd>

</dl>
<h4>
  <a name="998135"> </a>Returns 
</h4>

<p><a name="998141"> </a><code>errNone</code> if the call was successful. Returns <code>tsmErrFepReentrancy</code> if the FEP is currently running code and cannot process the call.</p>

<h3 class="hbH3">
  <a name="998168"> </a>TsmGetCurrentFepCreator Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="998179"> </a>Purpose 
</h4>

<p><a name="998185"> </a>Gets the creator ID of the current FEP.</p>
<h4>
  <a name="998190"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="998213"> </a></code><h4>
  <a name="998236"> </a>Prototype 
</h4>
<pre class="proto"><a name="998276"></a>Boolean TsmGetCurrentFepCreator (
   uint32_t <code class="par">*oFepCreatorP</code>
)
</pre>
<h4>
  <a name="998339"> </a>Parameters 
</h4>

<dl>
<dt><a name="998385"> </a><code>&larr;  <i>oFepCreatorP</i></code></dt>
<dd><a name="998430"> </a>Pointer to the current FEP creator ID. If there is no current FEP, then <code class="par">*oFepCreatorP</code> contains <code>tsmInvalidFepCreator</code>.</dd>

</dl>
<h4>
  <a name="998495"> </a>Returns 
</h4>

<p><a name="998541"> </a><code>true</code> if there is a current FEP.</p>
<h4>
  <a name="998557"> </a>See Also 
</h4>

<p><a name="998563"> </a><a href="FEPTextServicesFep.html#1016886"><code>TsmSetCurrentFepCreator()</code></a>, <a href="FEPTextServicesFep.html#998568"><code>TsmGetSystemFepCreator()</code></a></p>

<h3 class="hbH3">
  <a name="998568"> </a>TsmGetSystemFepCreator Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="998579"> </a>Purpose 
</h4>

<p><a name="998585"> </a>Gets the creator ID of the system FEP. The system FEP is the FEP that will be used to initialize the current FEP when you perform a soft-reset of the handheld.</p>
<h4>
  <a name="998590"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="998596"> </a></code><h4>
  <a name="998601"> </a>Prototype 
</h4>
<pre class="proto"><a name="998607"></a>Boolean TsmGetSystemFepCreator (
   uint32_t <code class="par">*oFepCreatorP</code>
)
</pre>
<h4>
  <a name="998612"> </a>Parameters 
</h4>

<dl>
<dt><a name="998618"> </a><code>&larr;  <i>oFepCreatorP</i></code></dt>
<dd><a name="998623"> </a>Pointer to the returned FEP plugin library creator ID, or <code>tsmInvalidFepCreator</code> if there is no system FEP.</dd>

</dl>
<h4>
  <a name="998628"> </a>Returns 
</h4>

<p><a name="998634"> </a><code>true</code> if there is a system FEP.</p>
<h4>
  <a name="1016882"> </a>See Also 
</h4>

<p><a name="1016883"> </a><a href="FEPTextServicesFep.html#1016531"><code>TsmSetSystemFepCreator()</code></a>, <a href="FEPTextServicesFep.html#998168"><code>TsmGetCurrentFepCreator()</code></a></p>

<h3 class="hbH3">
  <a name="1016886"> </a>TsmSetCurrentFepCreator Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1016514"> </a>Purpose 
</h4>

<p><a name="1016515"> </a>Sets the current FEP to be the FEP with the specified creator ID, opens it and makes it usable.</p>
<h4>
  <a name="1016516"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1016517"> </a></code><h4>
  <a name="1016518"> </a>Prototype 
</h4>
<pre class="proto"><a name="1016519"></a>status_t TsmSetCurrentFepCreator (
   uint32_t <code class="par">iFepCreator</code>
)
</pre>
<h4>
  <a name="1016520"> </a>Parameters 
</h4>

<dl>
<dt><a name="1016521"> </a><code>&rarr;  <i>iFepCreator</i></code></dt>
<dd><a name="1016522"> </a>FEP plugin library creator ID.</dd>

</dl>
<h4>
  <a name="1016523"> </a>Returns 
</h4>

<p><a name="1017180"> </a><code>errNone</code> if the current FEP was changed to the FEP with the specified creator ID. Otherwise, it returns one of the following result codes:</p>

<dl>
<dt><a name="1017182"> </a><code><code>tsmErrFepWrongAPI</code></code></dt>
<dd><a name="1017286"> </a>The FEP library API version does not match the Text Services Manager API version. </dd>

<dt><a name="1017184"> </a><code><code>sysInvalidRefNum</code></code></dt>
<dd><a name="1017290"> </a>The FEP library could not be opened. </dd>

<dt><a name="1017186"> </a><code><code>tsmErrFepStillOpen</code></code></dt>
<dd><a name="1017294"> </a>The previous FEP is still open.</dd>

</dl>
<h4>
  <a name="1017329"> </a>Comments 
</h4>

<p><a name="1017333"> </a>All FEP plugin libraries are of type <code>sysFileTFep</code>.</p>
<h4>
  <a name="1016527"> </a>See Also 
</h4>

<p><a name="1016528"> </a><a href="FEPTextServicesFep.html#998168"><code>TsmGetCurrentFepCreator()</code></a>, <a href="FEPTextServicesFep.html#1016531"><code>TsmSetSystemFepCreator()</code></a></p>

<h3 class="hbH3">
  <a name="1016531"> </a>TsmSetSystemFepCreator Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1016533"> </a>Purpose 
</h4>

<p><a name="1016534"> </a>Sets the creator ID of the system FEP.</p>
<h4>
  <a name="1016535"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1016536"> </a></code><h4>
  <a name="1016537"> </a>Prototype 
</h4>
<pre class="proto"><a name="1016538"></a>void TsmSetSystemFepCreator (
   uint32_t <code class="par">iFepCreator</code>
)
</pre>
<h4>
  <a name="1016539"> </a>Parameters 
</h4>

<dl>
<dt><a name="1016540"> </a><code>&rarr;  <i>iFepCreator</i></code></dt>
<dd><a name="1017445"> </a>FEP plugin library creator ID.</dd>

</dl>
<h4>
  <a name="1016542"> </a>Returns 
</h4>

<p><a name="1016543"> </a>Nothing.</p>
<h4>
  <a name="1016546"> </a>See Also 
</h4>

<p><a name="1016547"> </a><a href="FEPTextServicesFep.html#998568"><code>TsmGetSystemFepCreator()</code></a>, <a href="FEPTextServicesFep.html#1016886"><code>TsmSetCurrentFepCreator()</code></a></p>

<h2 class="haH2">
  <a name="1016456"> </a>Text Services FEP Plugin Functions <a href="#995984"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1017628"> </a>Your FEP shared library must implement the functions described in this section.</p>

<h3 class="hbH3">
  <a name="998661"> </a>TsmLibFepClose Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="998672"> </a>Purpose 
</h4>

<p><a name="998678"> </a>Deallocates a <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> structure previously returned by <a href="FEPTextServicesFep.html#1000139"><code>TsmLibFepOpen()</code></a>. If this closes the last active FEP session, then disposes of any shared information (for example, unlocks dictionary data).</p>
<h4>
  <a name="998683"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="998689"> </a></code><h4>
  <a name="998694"> </a>Prototype 
</h4>
<pre class="proto"><a name="998700"></a>status_t TsmLibFepClose (
   TsmFepStatusType <code class="par">*ioStatusP</code>
)
</pre>
<h4>
  <a name="998748"> </a>Parameters 
</h4>

<dl>
<dt><a name="998804"> </a><code>&harr;  <i>ioStatusP</i></code></dt>
<dd><a name="998863"> </a>Status pointer for this context.</dd>

</dl>
<h4>
  <a name="998952"> </a>Returns 
</h4>

<p><a name="1017867"> </a>Return one of the following:</p>

<dl>
<dt><a name="1017868"> </a><code><code>errNone</code></code></dt>
<dd><a name="1017916"> </a>No error; call succeeded.</dd>

<dt><a name="1017869"> </a><code><code>tsmErrFepNotOpen</code></code></dt>
<dd><a name="1018000"> </a>The FEP is not open.</dd>

<dt><a name="1017870"> </a><code><code>tsmErrFepReentrancy</code></code></dt>
<dd><a name="1018092"> </a>The FEP is currently running code in another thread.</dd>

<dt><a name="1017871"> </a><code><code>tsmErrFepStillOpen</code></code></dt>
<dd><a name="1018152"> </a>The FEP has additional contexts that are active.</dd>

</dl>
<h4>
  <a name="999019"> </a>Comments 
</h4>

<p><a name="999025"> </a>This function ignores any pending commits (see <a href="FEPTextServicesFep.html#999041"><code>TsmLibFepCommitAction()</code></a>).</p>
<h4>
  <a name="999030"> </a>See Also 
</h4>

<p><a name="999036"> </a><a href="FEPTextServicesFep.html#1000139"><code>TsmLibFepOpen()</code></a></p>

<h3 class="hbH3">
  <a name="999041"> </a>TsmLibFepCommitAction Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="999052"> </a>Purpose 
</h4>

<p><a name="999058"> </a>Unlocks or deallocates any buffers used to pass information back to the caller in the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> record as a result of a <a href="FEPTextServicesFep.html#999626"><code>TsmLibFepHandleEvent()</code></a> or <a href="FEPTextServicesFep.html#1000412"><code>TsmLibFepTerminate()</code></a> call.</p>
<h4>
  <a name="999063"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="999069"> </a></code><h4>
  <a name="999074"> </a>Prototype 
</h4>
<pre class="proto"><a name="999080"></a>status_t TsmLibFepCommitAction (
   TsmFepStatusType <code class="par">*ioStatusP</code>
)
</pre>
<h4>
  <a name="999085"> </a>Parameters 
</h4>

<dl>
<dt><a name="1018492"> </a><code>&harr;  <i>ioStatusP</i></code></dt>
<dd><a name="1018493"> </a>Status pointer for this context.</dd>

</dl>
<h4>
  <a name="999101"> </a>Returns 
</h4>

<p><a name="999107"> </a><code>errNone</code> if the call was successful. Returns <code>tsmErrFepReentrancy</code> if the FEP is currently running code in another thread and cannot process the call.</p>
<h4>
  <a name="999112"> </a>Comments 
</h4>

<p><a name="999118"> </a>This function also updates any status record or internal offsets that need adjusting because text is being dumped from the inline text area.</p>

<h3 class="hbH3">
  <a name="999134"> </a>TsmLibFepDrawModeIndicator Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="999145"> </a>Purpose 
</h4>

<p><a name="1018605"> </a>If the FEP is active, then draws a mode indicator which corresponds to the FEP's current mode.</p>
<h4>
  <a name="999156"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="999162"> </a></code><h4>
  <a name="999167"> </a>Prototype 
</h4>
<pre class="proto"><a name="999173"></a>Boolean TsmLibFepDrawModeIndicator (
   TsmFepModeType <code class="par">inFepMode</code>,
   uint16_t <code class="par">gsiState</code>,
   Coord <code class="par">x</code>,
   Coord <code class="par">y</code>
)
</pre>
<h4>
  <a name="999221"> </a>Parameters 
</h4>

<dl>
<dt><a name="999275"> </a><code>&rarr;  <i>inFepMode</i></code></dt>
<dd><a name="999328"> </a>The FEP input mode; see <a href="FEPTextServicesMgr.html#996964">"TsmFepModeType."</a> This is the current FEP mode as maintained by the server.</dd>

<dt><a name="999381"> </a><code>&rarr;  <i>gsiState</i></code></dt>
<dd><a name="999434"> </a>Mode indicator state. It can have the values defined by <a href="../Input_Services/In_ShiftIndicator.html#993905"><code>GsiShiftState</code></a> in <code>GraffitiShift.h</code>.</dd>

<dt><a name="999439"> </a><code>&rarr;  <i>x</i></code></dt>
<dd><a name="999444"> </a>x coordinate of the location where the character is to be drawn (left bound).</dd>

<dt><a name="999449"> </a><code>&rarr;  <i>y</i></code></dt>
<dd><a name="999454"> </a>y coordinate of the location where the character is to be drawn (top bound).</dd>

</dl>
<h4>
  <a name="999459"> </a>Returns 
</h4>

<p><a name="999465"> </a><code>true</code> if the call drew the mode indicator.</p>
<h4>
  <a name="999470"> </a>Comments 
</h4>

<p><a name="1018832"> </a>For Japanese, the recommended mode indicators are as follows:</p>


<div class="tablediv"><table cellspacing="0" class="tTableNR">

  <tr valign="top">
    <td><p class="tt"><a name="1018835"> </a><span style="color: #000000;  font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">FEP off, regular mode</span></p>
    </td>
    <td><p class="tt"><a name="1018837"> </a>lower-case, full-width Latin "a"</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1018839"> </a>FEP off, shifted mode</p>
    </td>
    <td><p class="tt"><a name="1018841"> </a>upper-case, full-width Latin "a"</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1018843"> </a>FEP on, default (Hiragana)</p>
    </td>
    <td><p class="tt"><a name="1018845"> </a>Hiragana "a"</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1018847"> </a>FEP on, Katakana</p>
    </td>
    <td><p class="tt"><a name="1018849"> </a>Katakana "a"</p>
    </td>
  </tr>
</table>

</div>


<p><a name="1018851"> </a>For Chinese handhelds, which may have multiple FEPs, use a character that will identify the FEP that is currently active. For example, the Palm OS standard Pinyin FEP uses the "pin" character to indicate that the FEP is on.</p>

<div><hr>
  <a name="1018852"> </a> <b>NOTE: </b> The mode indicator doesn't change based on the <i>state</i> of the FEP. For example, the FEP mode stays the same whether or not the inline session contains converted text.
<hr>
</div>

<div><hr>
  <a name="1018853"> </a> <b>TIP: </b> You can use the constants <code>kMaxGsiWidth</code> and <code>kMaxGsiHeight</code> to limit the size of your mode indicator. These constants are defined in <code>GraffitiShift.h</code>. All of the pixels in the rectangle defined by these constants must be set (that is, erased or redrawn) if the FEP draws the indicator, to ensure proper updating.
<hr>
</div>

<h3 class="hbH3">
  <a name="999492"> </a>TsmLibFepDrawOption Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="999503"> </a>Purpose 
</h4>

<p><a name="999509"> </a>Draws an option in the FEP options list.</p>
<h4>
  <a name="999514"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="999520"> </a></code><h4>
  <a name="999525"> </a>Prototype 
</h4>
<pre class="proto"><a name="999531"></a>void TsmLibFepDrawOption (
   const TsmFepStatusType <code class="par">*inStatusP</code>,
   uint16_t <code class="par">iItemNumber</code>,
   const RectangleType <code class="par">*iBounds</code>
)
</pre>
<h4>
  <a name="999536"> </a>Parameters 
</h4>

<dl>
<dt><a name="1048845"> </a><code>&rarr;  <i>inStatusP</i></code></dt>
<dd><a name="1048846"> </a>Pointer to the FEP status record.</dd>

<dt><a name="999542"> </a><code>&rarr;  <i>iItemNumber</i></code></dt>
<dd><a name="999547"> </a>The item number of the option to draw.</dd>

<dt><a name="999552"> </a><code>&rarr;  <i>iBounds</i></code></dt>
<dd><a name="999557"> </a>The bounds where the option is to be drawn.</dd>

</dl>
<h4>
  <a name="999562"> </a>Returns 
</h4>

<p><a name="999568"> </a>Nothing.</p>
<h4>
  <a name="999573"> </a>Comments 
</h4>

<p><a name="1020917"> </a>This function is called by the list code, once for each item in the list. This function should draw the appropriate options item within the bounds indicated by <code class="par">iBounds</code>.</p>

<h3 class="hbH3">
  <a name="999626"> </a>TsmLibFepHandleEvent Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="999661"> </a>Purpose 
</h4>

<p><a name="999667"> </a>Tells the caller whether or not the FEP completely handled the event. Updates the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> record as appropriate, and sets fields in the <a href="FEPTextServicesFep.html#996087"><code>TsmFepActionType</code></a> record to tell the caller what needs to be updated.</p>
<h4>
  <a name="999672"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="999678"> </a></code><h4>
  <a name="999683"> </a>Prototype 
</h4>
<pre class="proto"><a name="999689"></a>status_t TsmLibFepHandleEvent (
   const EventType <code class="par">*inEventP</code>,
   const TsmFepEventType <code class="par">*inTsmEventP</code>,
   TsmFepStatusType <code class="par">*ioStatusP</code>,
   TsmFepActionType <code class="par">*outActionP</code>
)
</pre>
<h4>
  <a name="999694"> </a>Parameters 
</h4>

<dl>
<dt><a name="999700"> </a><code>&rarr;  <i>inEventP</i></code></dt>
<dd><a name="999705"> </a>Pointer to a system event record, such as a typical <code>penDownEvent</code> or <code>keyDownEvent</code>.</dd>

<dt><a name="999710"> </a><code>&rarr;  <i>inTsmEventP</i></code></dt>
<dd><a name="999715"> </a>Pointer to a <a href="FEPTextServicesFep.html#996290"><code>TsmFepEventType</code></a> structure, which contains extra information about the event.</dd>

<dt><a name="999720"> </a><code>&harr;  <i>ioStatusP</i></code></dt>
<dd><a name="999725"> </a>Status pointer for this context.</dd>

<dt><a name="999730"> </a><code>&larr;  <i>outActionP</i></code></dt>
<dd><a name="999735"> </a>Pointer to a <a href="FEPTextServicesFep.html#996087"><code>TsmFepActionType</code></a> structure, which the FEP fills in with information that the caller needs to know to correctly update the display to reflect the current FEP state.</dd>

</dl>
<h4>
  <a name="999740"> </a>Returns 
</h4>

<p><a name="1039233"> </a>One of the following:</p>

<dl>
<dt><a name="1039234"> </a><code><code>errNone</code></code></dt>
<dd><a name="1039313"> </a>The event was handled successfully (<code class="par">outActionP</code><!-PS02-><span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">.handledEvent</span> is <code>true</code>), or the event was not completely handled by this function (<code class="par">outActionP</code><!-PS02-><span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">.handledEvent</span> is <code>false</code>).</dd>

<dt><a name="1039236"> </a><code><code>tsmErrFepReentrancy</code></code></dt>
<dd><a name="1039406"> </a>The FEP is currently running code.</dd>

<dt><a name="1039238"> </a><code><code>tsmErrFepNeedCommit</code></code></dt>
<dd><a name="1039463"> </a>The FEP is waiting for a <a href="FEPTextServicesFep.html#999041"><code>TsmLibFepCommitAction()</code></a> call.</dd>

</dl>

<h3 class="hbH3">
  <a name="999773"> </a>TsmLibFepMapEvent Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="999784"> </a>Purpose 
</h4>

<p><a name="999790"> </a>Determines whether or not an event should be remapped by the FEP. If it needs to be remapped, then this function posts the remapped event to the event queue.</p>
<h4>
  <a name="999795"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="999801"> </a></code><h4>
  <a name="999806"> </a>Prototype 
</h4>
<pre class="proto"><a name="999812"></a>Boolean TsmLibFepMapEvent (
   const TsmFepStatusType <code class="par">*inStatusP</code>,
   const EventType <code class="par">*inEventP</code>
)
</pre>
<h4>
  <a name="999836"> </a>Parameters 
</h4>

<dl>
<dt><a name="999892"> </a><code>&rarr;  <i>inStatusP</i></code></dt>
<dd><a name="999951"> </a>Pointer to the FEP status record.</dd>

<dt><a name="1000040"> </a><code>&rarr;  <i>inEventP</i></code></dt>
<dd><a name="1000101"> </a>Pointer to the event record.</dd>

</dl>
<h4>
  <a name="1000106"> </a>Returns 
</h4>

<p><a name="1000112"> </a><code>true</code> if the event was remapped.</p>
<h4>
  <a name="1000117"> </a>Comments 
</h4>

<p><a name="1039598"> </a>This function is commonly used to remap FEP button shortcut characters (that is, space or linefeed) to their FEP button equivalents. For example, it maps the shift left and right arrow <code>keyDownEvents</code> to shorten/lengthen clause events. Note that the remapping is conditional on the state of the FEP. For example, a space is only remapped to a convert event if the FEP has inline text, otherwise it gets treated like a regular space character (no remapping).</p>

<h3 class="hbH3">
  <a name="1000139"> </a>TsmLibFepOpen Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1000150"> </a>Purpose 
</h4>

<p><a name="1000156"> </a>Allocates and initializes a new instance of the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> structure, and returns this structure to the caller. If this is the first <code>TsmLibFepOpen()</code> call, it should also set up any shared information, such as dictionary data.</p>
<h4>
  <a name="1000161"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1000167"> </a></code><h4>
  <a name="1000172"> </a>Prototype 
</h4>
<pre class="proto"><a name="1000178"></a>status_t TsmLibFepOpen (
   TsmFepStatusType <code class="par">**outStatusP</code>
)
</pre>
<h4>
  <a name="1000183"> </a>Parameters 
</h4>

<dl>
<dt><a name="1000189"> </a><code>&larr;  <i>outStatusP</i></code></dt>
<dd><a name="1000194"> </a>Pointer to a pointer to the new instance (status) record.</dd>

</dl>
<h4>
  <a name="1000199"> </a>Returns 
</h4>

<p><a name="1000205"> </a><code>errNone</code> if the call was successful; otherwise, returns a standard error code that indicates the nature of the problem, such as <code>memErrNotEnoughSpace</code> or <code>dmErrCantFind</code>.</p>
<h4>
  <a name="1000210"> </a>Comments 
</h4>

<p><a name="1039857"> </a>Note that typically a FEP will allocate extra space at the end of the <code>TsmFepStatusType</code> structure to hold extra information about the session.</p>
<h4>
  <a name="1000221"> </a>See Also 
</h4>

<p><a name="1000227"> </a><a href="FEPTextServicesFep.html#998661"><code>TsmLibFepClose()</code></a></p>

<h3 class="hbH3">
  <a name="1000232"> </a>TsmLibFepReset Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1000250"> </a>Purpose 
</h4>

<p><a name="1000258"> </a>Resets the FEP (input method) by clearing all buffers and setting the state back to raw text. However, does not change the mode.</p>
<h4>
  <a name="1000269"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1000283"> </a></code><h4>
  <a name="1000296"> </a>Prototype 
</h4>
<pre class="proto"><a name="1000310"></a>status_t TsmLibFepReset (
   TsmFepStatusType <code class="par">*ioStatusP</code>
)
</pre>
<h4>
  <a name="1000327"> </a>Parameters 
</h4>

<dl>
<dt><a name="1000341"> </a><code>&harr;  <i>ioStatusP</i></code></dt>
<dd><a name="1000354"> </a>Status pointer for this context.</dd>

</dl>
<h4>
  <a name="1000371"> </a>Returns 
</h4>

<p><a name="1000385"> </a><code>errNone</code> if the call was successful. Returns <code>tsmErrFepReentrancy</code> if the FEP is currently running code and cannot process the call.</p>
<h4>
  <a name="1000390"> </a>Comments 
</h4>

<p><a name="1039659"> </a>This function ignores any pending commits (see <a href="FEPTextServicesFep.html#999041"><code>TsmLibFepCommitAction()</code></a>).</p>

<h3 class="hbH3">
  <a name="1000412"> </a>TsmLibFepTerminate Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1000423"> </a>Purpose 
</h4>

<p><a name="1000429"> </a>Ends the conversion session, if active. Updates the <a href="FEPTextServicesFep.html#996601"><code>TsmFepStatusType</code></a> record with the new status, and fills in the <a href="FEPTextServicesFep.html#996087"><code>TsmFepActionType</code></a> record to tell the caller what needs to be updated.</p>
<h4>
  <a name="1000434"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1000440"> </a></code><h4>
  <a name="1000445"> </a>Prototype 
</h4>
<pre class="proto"><a name="1000451"></a>status_t TsmLibFepTerminate (
   TsmFepStatusType <code class="par">*ioStatusP</code>,
   TsmFepActionType <code class="par">*outActionP</code>
)
</pre>
<h4>
  <a name="1000456"> </a>Parameters 
</h4>

<dl>
<dt><a name="1000462"> </a><code>&harr;  <i>ioStatusP</i></code></dt>
<dd><a name="1000467"> </a>Pointer to the FEP's status record</dd>

<dt><a name="1000472"> </a><code>&larr;  <i>outActionP</i></code></dt>
<dd><a name="1000477"> </a>Pointer to the FEP's action record.</dd>

</dl>
<h4>
  <a name="1000482"> </a>Returns 
</h4>

<p><a name="1000488"> </a><code>errNone</code> if the call was successful. Returns <code>tsmErrFepReentrancy</code> if the FEP is currently running code and cannot process the call.</p>

<h3 class="hbH3">
  <a name="1000515"> </a>TsmLibGetFepInfo Function <a href="#995984"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1000533"> </a>Purpose 
</h4>

<p><a name="1000541"> </a>Fills in the <a href="FEPTextServicesFep.html#996463"><code>TsmFepInfoType</code></a> structure with information about the FEP.</p>
<h4>
  <a name="1000552"> </a>Declared In 
</h4>
<code>TextServicesFep.h<a name="1000566"> </a></code><h4>
  <a name="1000579"> </a>Prototype 
</h4>
<pre class="proto"><a name="1000593"></a>status_t TsmLibGetFepInfo (
   TsmFepInfoType <code class="par">*outInfoP</code>
)
</pre>
<h4>
  <a name="1000610"> </a>Parameters 
</h4>

<dl>
<dt><a name="1000624"> </a><code>&larr;  <i>outInfoP</i></code></dt>
<dd><a name="1039786"> </a>Pointer to the information record to be filled in.</dd>

</dl>
<h4>
  <a name="1000654"> </a>Returns 
</h4>

<p><a name="1046741"> </a><code>errNone</code> if the call was successful. Returns <code>tsmErrFepReentrancy</code> if the FEP is currently running code and cannot process the call.</p>
<h4>
  <a name="1046743"> </a>Comments 
</h4>

<p><a name="1039803"> </a>This function can and will get called before the FEP library has been opened, so potentially no globals have been set up. This function should just fill in the information record with the available information and return.</p>

<p><a name="995980"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996&#8211;2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="FEPFront.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="FEPTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="FEPTextServicesMgr.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="FEPTextServicesFepApdx.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="FEPIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>