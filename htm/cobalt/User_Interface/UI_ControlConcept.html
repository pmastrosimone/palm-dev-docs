<html>
<head>
<title>(Protein) Working with Controls | User Interface </title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 11:42:11">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="1005083"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="UI_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_FormConcept.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_MenuConcept.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_IX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">3 &nbsp;&nbsp;
Working with Controls</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">User Interface </p>
<p class="SubTitle">Exploring Palm OS&#174; </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="UI_PartConcept.html">Part I: Concepts</a> </h1>
<h1 class="SideTOC1"><a href="UI_ControlConcept.html">3  Working with Controls</a></h1>

   <h2 class="SideTOC2"><a href="#1033858">
   Command Buttons</a></h2>

   <h2 class="SideTOC2"><a href="#1032118">
   Repeating Buttons</a></h2>

   <h2 class="SideTOC2"><a href="#1028784">
   Check Boxes</a></h2>

   <h2 class="SideTOC2"><a href="#1034389">
   Push Buttons</a></h2>

   <h2 class="SideTOC2"><a href="#1033272">
   Sliders </a></h2>

   <h2 class="SideTOC2"><a href="#1029631">
   Selector Triggers</a></h2>

   <h2 class="SideTOC2"><a href="#1029167">
   Pop-Up Triggers</a></h2>

   <h2 class="SideTOC2"><a href="#1027219">
   Category Controls</a></h2>

      <h3 class="SideTOC3"><a href="#1029989">
      Creating the Category Controls</a></h3>

      <h3 class="SideTOC3"><a href="#1036057">
      Category Controls for Non-schema Database Databases</a></h3>

      <h3 class="SideTOC3"><a href="#1030393">
      Category Controls for Schema Databases</a></h3>

   <h2 class="SideTOC2"><a href="#1035669">
   Scroll Bars</a></h2>

   <h2 class="SideTOC2"><a href="#1035663">
   Summary of Control Functions</a></h2>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1006081"> </a>Controls allow for user interaction when you add them to the forms in your application. Events in controls are handled by <a href="UI_Control.html#994545"><code>CtlHandleEvent()</code></a>. This chapter describes the following types of controls:</p>
   <blockquote class = "bq"><a name="1027555"> </a><a href="UI_ControlConcept.html#1033858">Command Buttons</a></blockquote>
   <blockquote class = "bq"><a name="1028570"> </a><a href="UI_ControlConcept.html#1032118">Repeating Buttons</a></blockquote>
   <blockquote class = "bq"><a name="1028955"> </a><a href="UI_ControlConcept.html#1028784">Check Boxes</a></blockquote>
   <blockquote class = "bq"><a name="1028574"> </a><a href="UI_ControlConcept.html#1034389">Push Buttons</a></blockquote>
   <blockquote class = "bq"><a name="1029506"> </a><a href="UI_ControlConcept.html#1033272">Sliders</a></blockquote>
   <blockquote class = "bq"><a name="1029761"> </a><a href="UI_ControlConcept.html#1029631">Selector Triggers</a></blockquote>
   <blockquote class = "bq"><a name="1027604"> </a><a href="UI_ControlConcept.html#1029167">Pop-Up Triggers</a></blockquote>
   <blockquote class = "bq"><a name="1027583"> </a><a href="UI_ControlConcept.html#1027219">Category Controls</a></blockquote>
   <blockquote class = "bq"><a name="1035989"> </a><a href="UI_ControlConcept.html#1035669">Scroll Bars</a></blockquote>

<p><a name="1033748"> </a>All of these except the category controls and the scroll bars are managed by the functions described in <a href="UI_Control.html#993254">Chapter 16, "Control Reference."</a> The category controls are a special case of the selector trigger and pop-up trigger controls that are only used to display database categories. Scroll bars are managed using a separate scroll bar API that is described in <a href="UI_Scrollbar.html#994290">Chapter 31, "Scroll Bar Reference."</a></p>

<h2 class="haH2">
  <a name="1033858"> </a>Command Buttons <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1033863"> </a><b>Command buttons</b> (see <a href="UI_ControlConcept.html#1032098">Figure 3.1</a>) display a text or graphic label in a rounded rectangle. The button frame can be changed although doing so is discouraged. </p>

<p class="FFigureCaption">
  <a name="1032098"> </a><b>Figure 3.1&nbsp;&nbsp;Buttons</b>
</p>
<div align="left"><img src="images/Buttons.jpg" height="40" width="480" border="0" hspace="0" vspace="0">
</div>

<p><a name="1006095"> </a>When the user taps a command button with the pen, the command button highlights until the user releases the pen or drags it outside the bounds of the command button.</p>

<p><a name="1033881"> </a>Applications use command buttons to allow the user to perform an action. Applications respond to the <a href="UI_Control.html#999609"><code>ctlSelectEvent</code></a> for a command button to perform its action. You may return either <code>true</code> or <code>false</code> after the <code>ctlSelectEvent</code> because Palm OS<sup>&#174;</sup> does not handle this event. </p>

<p><a name="1006099"> </a><a href="UI_ControlConcept.html#1006112">Table 3.1</a> shows the system events generated when the user interacts with the button and <code>CtlHandleEvent()</code>'s response to the events. </p>

<p class="caption"><a name="1006112"> </a><b>Table 3.1&nbsp;&nbsp;Event flow for command buttons </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1006118"> </a><b>User Action</b></p>
    </th>
    <th><p class="tt"><a name="1006120"> </a><b>System Response</b></p>
    </th>
    <th><p class="tt"><a name="1006122"> </a><b>CtlHandleEvent() Response</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006124"> </a>Pen goes down on a button.</p>
    </td>
    <td><p class="tt"><a name="1006130"> </a><a href="../Input_Services/In_LowEvents.html#994048"><code>penDownEvent</code></a> with the x and y coordinates stored in <a href="../Programming_Basics/Event.html#992950"><code>EventType</code></a>. </p>
    </td>
    <td><p class="tt"><a name="1006132"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
<p class="tt"><a name="1006133"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006135"> </a></p>
    </td>
    <td><p class="tt"><a name="1006141"> </a><a href="UI_Control.html#999483"><code>ctlEnterEvent</code></a> with button's ID number. </p>
    </td>
    <td><p class="tt"><a name="1006143"> </a>Inverts the button's display.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006145"> </a>Pen is lifted from button.</p>
    </td>
    <td><p class="tt"><a name="1006151"> </a><a href="../Input_Services/In_LowEvents.html#994097"><code>penUpEvent</code></a> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1006156"> </a>Adds the <code>ctlSelectEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006158"> </a>Pen is lifted outside button.</p>
    </td>
    <td><p class="tt"><a name="1006164"> </a><a href="../Input_Services/In_LowEvents.html#994097"><code>penUpEvent</code></a> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1006169"> </a>Adds the <a href="UI_Control.html#999517"><code>ctlExitEvent</code></a> to the event queue. </p>
    </td>
  </tr>
</table>

</div>


<h2 class="haH2">
  <a name="1032118"> </a>Repeating Buttons <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1028210"> </a>A <b>repeating button</b> can look like a command button. In contrast to a command button, however, the repeating button is selected repeatedly until the pen is lifted. The most common use of repeating buttons are for the scroll buttons displayed in the bottom right corner of many forms. </p>

<p><a name="1033975"> </a>Applications respond to the <a href="UI_Control.html#999557"><code>ctlRepeatEvent</code></a> for repeating buttons to perform the action of the button. Return <code>false</code> after handling the event to ensure that more repeat events are sent. </p>

<p><a name="1028214"> </a><a href="UI_ControlConcept.html#1028221">Table 3.2</a> shows the system events generated when the user interacts with the repeating button and <code>CtlHandleEvent()</code>'s response to the events. </p>

<p class="caption"><a name="1028221"> </a><b>Table 3.2&nbsp;&nbsp;Event flow for repeating buttons </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1028227"> </a><b>User Action</b></p>
    </th>
    <th><p class="tt"><a name="1028229"> </a><b>System Response</b></p>
    </th>
    <th><p class="tt"><a name="1028231"> </a><b>CtlHandleEvent() Response</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028233"> </a>Pen goes down on a repeating button.</p>
    </td>
    <td><p class="tt"><a name="1028239"> </a><code>penDownEvent</code> with the x and y coordinates stored in <code>EventType</code>. </p>
    </td>
    <td><p class="tt"><a name="1028241"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
<p class="tt"><a name="1028242"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028244"> </a></p>
    </td>
    <td><p class="tt"><a name="1028250"> </a><code>ctlEnterEvent</code> with button's ID number. </p>
    </td>
    <td><p class="tt"><a name="1028252"> </a>Adds the <code>ctlRepeatEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028254"> </a>Pen remains on repeating button. </p>
    </td>
    <td><p class="tt"><a name="1028260"> </a><code>ctlRepeatEvent</code> </p>
    </td>
    <td><p class="tt"><a name="1028262"> </a>Tracks the pen for a period of time, then sends another <code>ctlRepeatEvent</code> if the pen is still within the bounds of the control. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028264"> </a>Pen is dragged off the repeating button.</p>
    </td>
    <td><p class="tt"><a name="1028266"> </a></p>
    </td>
    <td><p class="tt"><a name="1028268"> </a>No <code>ctlRepeatEvent</code> occurs. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028270"> </a>Pen is dragged back onto the button. </p>
    </td>
    <td><p class="tt"><a name="1028276"> </a><code>ctlRepeatEvent</code> </p>
    </td>
    <td><p class="tt"><a name="1028278"> </a>See above. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028280"> </a>Pen is lifted from button.</p>
    </td>
    <td><p class="tt"><a name="1028286"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1028292"> </a>Adds the <code>ctlExitEvent</code> to the event queue. </p>
    </td>
  </tr>
</table>

</div>


<h2 class="haH2">
  <a name="1028784"> </a>Check Boxes <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1028788"> </a><b>Check boxes</b> (see <a href="UI_ControlConcept.html#1028791">Figure 3.2</a>) display a setting, either on (checked) or off (unchecked). Touching a check box with the pen toggles the setting. The check box appears as a square, which contains a check mark if the check box's setting is on. A check box can and should have a text label attached to it; selecting the label also toggles the check box. A check box may also be assigned a group ID to make the group of check boxes mutually exclusive; however, doing so is strongly discouraged. Use push buttons for a mutually exclusive set of options. </p>

<p class="FFigureCaption">
  <a name="1028791"> </a><b>Figure 3.2&nbsp;&nbsp;Check boxes</b>
</p>
<div align="left"><img src="images/checkbox2.jpg" height="54" width="480" border="0" hspace="0" vspace="0">
</div>

<p><a name="1034189"> </a>Applications generally manage check boxes in the following ways: </p>
<ul type="disc">
  <li><a name="1034768"> </a>Respond to the <code>ctlSelectEvent</code> for the check box. Upon receiving this event, retrieve the value of the check box using <a href="UI_Control.html#994503"><code>CtlGetValue()</code></a> and perform an action based on that value. You may return either <code>true</code> or <code>false</code> after the <code>ctlSelectEvent</code> because Palm OS does not handle this event. 
  <li><a name="1034193"> </a>If you want to set the initial value of a check box when the form is first displayed, use <a href="UI_Control.html#996118"><code>CtlSetValue()</code></a> or <a href="UI_Form.html#1002947"><code>FrmSetControlValue()</code></a> in response to the <a href="UI_Form.html#1089265"><code>frmOpenEvent</code></a>. 
</ul>

<p><a name="1028799"> </a><a href="UI_ControlConcept.html#1028806">Table 3.3</a> shows the system events generated when the user interacts with the check box and <code>CtlHandleEvent()</code>'s response to the events. </p>

<p class="caption"><a name="1028806"> </a><b>Table 3.3&nbsp;&nbsp;Event flow for check boxes </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1028812"> </a><b>User Action</b></p>
    </th>
    <th><p class="tt"><a name="1028814"> </a><b>Event Generated</b></p>
    </th>
    <th><p class="tt"><a name="1028816"> </a><b>CtlHandleEvent() Response</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028818"> </a>Pen goes down on check box.</p>
    </td>
    <td><p class="tt"><a name="1028824"> </a><code>penDownEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>. </p>
    </td>
    <td><p class="tt"><a name="1028826"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028828"> </a></p>
    </td>
    <td><p class="tt"><a name="1028834"> </a><code>ctlEnterEvent</code> with check box's ID number. </p>
    </td>
    <td><p class="tt"><a name="1028836"> </a>Tracks the pen until the user lifts it. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028838"> </a>Pen is lifted from check box.</p>
    </td>
    <td><p class="tt"><a name="1028844"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><ul type="disc">
  <li><a name="1028846"> </a>If the check box is unchecked, a check appears. 
  <li><a name="1028847"> </a>If the check box is already checked and is grouped, there is no change in appearance.
  <li><a name="1028848"> </a>If the check box is already checked and is ungrouped, the check disappears. 
</ul>

<p><a name="1028853"> </a>Adds the <code>ctlSelectEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028855"> </a>Pen is lifted outside box.</p>
    </td>
    <td><p class="tt"><a name="1028861"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1028866"> </a>Adds the <code>ctlExitEvent</code> to the event queue. </p>
    </td>
  </tr>
</table>

</div>


<h2 class="haH2">
  <a name="1034389"> </a>Push Buttons <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1034395"> </a><b>Push buttons</b> (see <a href="UI_ControlConcept.html#1028602">Figure 3.3</a>) have square corners. Touching a push button with the pen inverts the bounds. If the pen is released within the bounds, the button remains inverted. Push buttons are intended to be used to present several mutually exclusive options. When you create the push button resources, assign a nonzero group ID to all push buttons within a group. Doing so ensures that only one push button can be selected at a time. </p>

<p class="FFigureCaption">
  <a name="1028602"> </a><b>Figure 3.3&nbsp;&nbsp;Push buttons</b>
</p>
<div align="left"><img src="images/pushbuttons.gif" border="0" hspace="0" vspace="0">
</div>.

<p><a name="1034340"> </a>Applications manage push buttons using the functions <a href="UI_Form.html#997592"><code>FrmGetControlGroupSelection()</code></a> and <a href="UI_Form.html#1002873"><code>FrmSetControlGroupSelection()</code></a> to retrieve and set which push button in the sequence is selected.</p>

<p><a name="1028304"> </a><a href="UI_ControlConcept.html#1028318">Table 3.4</a> shows the system events generated when the user interacts with the push button and <code>CtlHandleEvent()</code>'s response to the events. </p>

<p class="caption"><a name="1028318"> </a><b>Table 3.4&nbsp;&nbsp;Event flow for push buttons </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1028324"> </a><b>User Action</b></p>
    </th>
    <th><p class="tt"><a name="1028326"> </a><b>System Response</b></p>
    </th>
    <th><p class="tt"><a name="1028328"> </a><b>CtlHandleEvent() Response</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028330"> </a>Pen goes down on a push button.</p>
    </td>
    <td><p class="tt"><a name="1028336"> </a><code>penDownEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>. </p>
    </td>
    <td><p class="tt"><a name="1028338"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
<p class="tt"><a name="1028339"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028341"> </a></p>
    </td>
    <td><p class="tt"><a name="1028347"> </a><code>ctlEnterEvent</code> with push button's ID number. </p>
    </td>
    <td><p class="tt"><a name="1028349"> </a>If push button is grouped and highlighted, no change. If push button is ungrouped and highlighted, it becomes unhighlighted. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028351"> </a>Pen is lifted from push button.</p>
    </td>
    <td><p class="tt"><a name="1028357"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1028363"> </a>Adds the <code>ctlSelectEvent</code> to the event queue. </p>
    </td>
  </tr>
</table>

</div>


<h2 class="haH2">
  <a name="1033272"> </a>Sliders  <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1006602"> </a><b>Sliders</b> (see <a href="UI_ControlConcept.html#1006605">Figure 3.4</a>) represent a value that falls within a particular range. For example, a slider might represent a value that can be between 0 and 10. </p>

<p class="FFigureCaption">
  <a name="1006605"> </a><b>Figure 3.4&nbsp;&nbsp;Slider </b>
</p>
<div align="left"><img src="images/Slider4.jpg" height="44" width="480" border="0" hspace="0" vspace="0">
</div>

<p><a name="1006610"> </a>There are four attributes that are unique to slider controls:</p>
<ul type="disc">
  <li><a name="1006611"> </a>The minimum value the slider can represent
  <li><a name="1006612"> </a>The maximum value the slider can represent 
  <li><a name="1006613"> </a>The current value 
  <li><a name="1006614"> </a>The page jump value, or the amount by which the value is increased or decreased when the user clicks to the left or right of the slider thumb 
</ul>

<p><a name="1006616"> </a>Palm OS supports two types of sliders: regular slider and feedback slider. Sliders and feedback sliders look alike but behave differently. Specifically, a regular slider control does not send events while the user is dragging its thumb. A feedback slider control sends an event each time the thumb moves one pixel, whether the pen has been lifted or not. </p>

<p><a name="1034404"> </a>Applications generally respond to the <code>ctlSelectEvent</code> for sliders or <code>ctlRepeatEvent</code> for feedback sliders. Upon receiving either one of these events, check the value of the slider using <a href="UI_Control.html#994503"><code>CtlGetValue()</code></a> and perform an action based on that value. You may return either <code>true</code> or <code>false</code> after the <code>ctlSelectEvent</code> because Palm OS does not handle this event. Return <code>false</code> for the <code>ctlRepeatEvent</code>. </p>

<p><a name="1006620"> </a><a href="UI_ControlConcept.html#1006627">Table 3.5</a> shows the system events generated when the user interfaces with a slider and how <code>CtlHandleEvent()</code> responds to the events. </p>

<p class="caption"><a name="1006627"> </a><b>Table 3.5&nbsp;&nbsp;Event flow for sliders </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1006633"> </a><b>User Action</b></p>
    </th>
    <th><p class="tt"><a name="1006635"> </a><b>System Response</b></p>
    </th>
    <th><p class="tt"><a name="1006637"> </a><b>CtlHandleEvent() Response</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006639"> </a>Pen tap on slider's background. </p>
    </td>
    <td><p class="tt"><a name="1006645"> </a><code>penDownEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>. </p>
    </td>
    <td><p class="tt"><a name="1006647"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006649"> </a></p>
    </td>
    <td><p class="tt"><a name="1006654"> </a><code>ctlEnterEvent</code> with slider's ID number. </p>
    </td>
    <td><p class="tt"><a name="1006656"> </a>Adds or subtracts the slider's page jump value from its current value, and adds a <code>ctlSelectEvent</code> with the new value to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006661"> </a>Pen goes down on the slider's thumb.</p>
    </td>
    <td><p class="tt"><a name="1006667"> </a><code>penDownEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>. </p>
    </td>
    <td><p class="tt"><a name="1006669"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006671"> </a></p>
    </td>
    <td><p class="tt"><a name="1006674"> </a><code>ctlEnterEvent</code> with slider's ID number. </p>
    </td>
    <td><p class="tt"><a name="1006676"> </a>Tracks the pen. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006678"> </a>Pen drags slider's thumb to the left or right. </p>
    </td>
    <td><p class="tt"><a name="1006680"> </a></p>
    </td>
    <td><p class="tt"><a name="1006682"> </a>Continues tracking the pen. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006684"> </a>Pen is lifted from slider.</p>
    </td>
    <td><p class="tt"><a name="1006690"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1006692"> </a>Adds the <code>ctlSelectEvent</code> with the slider's ID number and new value if the coordinates are within the bounds of the slider. </p>

<p><a name="1006696"> </a>Adds the <code>ctlExitEvent</code> if the coordinates are outside of the slider's bounds. </p>
    </td>
  </tr>
</table>

</div>


<p><a name="1006701"> </a><a href="UI_ControlConcept.html#1006708">Table 3.6</a> shows the system events generated when the user interacts with a feedback slider and <code>CtlHandleEvent()</code>'s response to the events. </p>

<p class="caption"><a name="1006708"> </a><b>Table 3.6&nbsp;&nbsp;Event flow for feedback sliders </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1006714"> </a><b>User Action</b></p>
    </th>
    <th><p class="tt"><a name="1006716"> </a><b>System Response</b></p>
    </th>
    <th><p class="tt"><a name="1006718"> </a><b>CtlHandleEvent() Response</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006720"> </a>Pen tap on slider's background. </p>
    </td>
    <td><p class="tt"><a name="1006726"> </a><code>penDownEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>. </p>
    </td>
    <td><p class="tt"><a name="1006728"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006730"> </a></p>
    </td>
    <td><p class="tt"><a name="1006735"> </a><code>ctlEnterEvent</code> with slider's ID number. </p>
    </td>
    <td><p class="tt"><a name="1006737"> </a>Adds or subtracts the slider's page jump value from its current value and then sends a <code>ctlRepeatEvent</code> with the slider's new value. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006739"> </a></p>
    </td>
    <td><p class="tt"><a name="1006744"> </a><code>ctlRepeatEvent</code> </p>
    </td>
    <td><p class="tt"><a name="1006746"> </a>Adds or subtracts the slider's page jump value from its current value repeatedly until the thumb reaches the pen position or the slider's minimum or maximum. Then sends a <code>ctlSelectEvent</code> with slider's ID number and new value. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006752"> </a>Pen goes down on the slider's thumb.</p>
    </td>
    <td><p class="tt"><a name="1006758"> </a><code>penDownEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>. </p>
    </td>
    <td><p class="tt"><a name="1006760"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006762"> </a></p>
    </td>
    <td><p class="tt"><a name="1006765"> </a><code>ctlEnterEvent</code> with slider's ID number. </p>
    </td>
    <td><p class="tt"><a name="1006767"> </a>Tracks the pen and updates the display. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006769"> </a>Pen drags slider's thumb to the left or right. </p>
    </td>
    <td><p class="tt"><a name="1006775"> </a><code>ctlRepeatEvent</code> with slider's ID number and new value. </p>
    </td>
    <td><p class="tt"><a name="1006777"> </a>Tracks the pen. Each time pen moves to the left or right, sends another <code>ctlRepeatEvent</code> if the pen is still within the bounds of the control. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006779"> </a>Pen is dragged off the slider vertically.</p>
    </td>
    <td><p class="tt"><a name="1006781"> </a></p>
    </td>
    <td><p class="tt"><a name="1006783"> </a><code>ctlRepeatEvent</code> with the slider's ID number and old value. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006785"> </a>Pen is dragged back onto the slider. </p>
    </td>
    <td><p class="tt"><a name="1006787"> </a></p>
    </td>
    <td><p class="tt"><a name="1006789"> </a><code>ctlRepeatEvent</code> with the slider's ID number and new value. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006791"> </a>Pen is lifted from slider.</p>
    </td>
    <td><p class="tt"><a name="1006797"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1034418"> </a>Adds the <code>ctlExitEvent</code> to the event queue. </p>
    </td>
  </tr>
</table>

</div>


<p><a name="1006806"> </a>Sliders are drawn using two bitmaps: one for the slider background, and the other for the thumb. You may use the default bitmaps to draw sliders, or you may specify your own bitmaps when you create the slider. </p>

<p><a name="1006807"> </a>The background bitmap you provide can be smaller than the slider's bounding rectangle. This allows you to provide one bitmap for sliders of several different sizes. If the background bitmap isn't as tall as the slider's bounding rectangle, it's vertically centered in the rectangle. If the bitmap isn't as wide as the slider's bounding rectangle, the bitmap is drawn twice. First, it's drawn left-justified in the left half of the bounding rectangle and clipped to exactly half of the rectangle's width. Then, it's drawn right-justified in the right half of the bounding rectangle and clipped to exactly half of the rectangle's width. (See <a href="UI_ControlConcept.html#1006812">Figure 3.5</a>.) Note that this means that the bitmap you provide must be at least half the width of the bounding rectangle. </p>

<p class="FFigureCaption">
  <a name="1006812"> </a><b>Figure 3.5&nbsp;&nbsp;Drawing a slider background</b>
</p>
<div align="left"><img src="images/SliderDrawing5.jpg" height="322" width="480" border="0" hspace="0" vspace="0">
</div>

<h2 class="haH2">
  <a name="1029631"> </a>Selector Triggers <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1029636"> </a>A <b>selector trigger</b> (see <a href="UI_ControlConcept.html#1029642">Figure 3.6</a>) displays a text label surrounded by a gray rectangular frame. If the text label changes, the width of the control expands or contracts to the width of the new label.</p>

<p class="FFigureCaption">
  <a name="1029642"> </a><b>Figure 3.6&nbsp;&nbsp;Selector trigger</b>
</p>
<div align="left"><img src="images/selector.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="1034472"> </a>When the selector trigger is tapped, it should display a dialog from which the user selects a new value to display in the trigger. Applications are responsible for implementing most of this behavior: </p>
<ul type="disc">
  <li><a name="1034676"> </a>Upon receiving the <a href="UI_Form.html#1089265"><code>frmOpenEvent</code></a> for the form that contains the selector trigger, set the initial value of the trigger using <a href="UI_Control.html#995869"><code>CtlSetLabel()</code></a>.
  <li><a name="1035927"> </a>Upon receiving a <code>ctlSelectEvent</code> for a selector trigger, call <a href="UI_Form.html#997081"><code>FrmDoDialog()</code></a> as described in <a href="UI_FormConcept.html#1004083">"Displaying Dialogs."</a> If the user then dismisses the dialog by tapping the OK button, use <code>CtlSetLabel()</code> to set the new value of the selector trigger. 
</ul>

<p><a name="1034679"> </a>Some forms that display category information for a single record use a selector trigger to do so. This selector trigger displays a pop-up list when tapped instead of a dialog. Such controls are considered exceptions to the rule of how selector triggers should behave and are not meant to be imitated. See <a href="UI_ControlConcept.html#1027219">"Category Controls"</a> for information on how to work with a category selector trigger. </p>

<p><a name="1034769"> </a>Note that selector triggers, unlike the button controls and slider controls, do not have a numeric value associated with them, so you should not use <a href="UI_Control.html#996118"><code>CtlSetValue()</code></a> or <a href="UI_Control.html#994503"><code>CtlGetValue()</code></a> on them. </p>

<p><a name="1034448"> </a><a href="UI_ControlConcept.html#1029653">Table 3.7</a> shows the system events generated when the user interacts with the selector trigger and <code>CtlHandleEvent()</code>'s response to the events. </p>

<p class="caption"><a name="1029653"> </a><b>Table 3.7&nbsp;&nbsp;Event flow for selector triggers </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1029659"> </a><b>User Action</b></p>
    </th>
    <th><p class="tt"><a name="1029661"> </a><b>System Response</b></p>
    </th>
    <th><p class="tt"><a name="1029663"> </a><b>CtlHandleEvent() Response</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029665"> </a>Pen goes down on a selector trigger.</p>
    </td>
    <td><p class="tt"><a name="1029671"> </a><code>penDownEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>. </p>
    </td>
    <td><p class="tt"><a name="1029673"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
<p class="tt"><a name="1029674"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029676"> </a></p>
    </td>
    <td><p class="tt"><a name="1029682"> </a><code>ctlEnterEvent</code> with selector trigger's ID number. </p>
    </td>
    <td><p class="tt"><a name="1029684"> </a>Inverts the button's display.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029686"> </a>Pen is lifted from the selector trigger.</p>
    </td>
    <td><p class="tt"><a name="1029692"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1029694"> </a>Adds the <code>ctlSelectEvent</code> to the event queue. </p>
    </td>
  </tr>
</table>

</div>


<h2 class="haH2">
  <a name="1029167"> </a>Pop-Up Triggers <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1029172"> </a>A<b> pop-up trigger</b> (see <a href="UI_ControlConcept.html#1029174">Figure 3.7</a>) displays a text label and a graphic element (always on the left) that signifies the control initiates a pop-up list. If the text label changes, the width of the control expands or contracts to the width of the new label plus the graphic element. </p>

<p class="FFigureCaption">
  <a name="1029174"> </a><b>Figure 3.7&nbsp;&nbsp;Pop-up trigger</b>
</p>
<div align="left"><img src="images/popup.gif" border="0" hspace="0" vspace="0">
</div>

<p><a name="1029186"> </a>To create a pop-up list in a resource editor, you must create both a pop-up trigger resource and a list resource. Do the following:</p>
<ol type="1">
  <li value="1"><a name="1029187"> </a>Add a pop-up trigger to your form. Use 0 as the width to have the pop-up trigger automatically resize based on the label. 
  <li value="2"><a name="1029188"> </a>Add a list at the same coordinates.
  <li value="3"><a name="1029189"> </a>Specify that the list is unusable. 
  <li value="4"><a name="1029190"> </a>Set the List ID in the pop-up trigger to match the ID of the list resource. 
</ol>

<p><a name="1034744"> </a>Applications generally manage pop-up triggers in the following ways: </p>
<ul type="disc">
  <li><a name="1034851"> </a>Set the initial label of the pop-up trigger when the form is first opened. Respond to the <code>frmOpenEvent</code> by calling <code>CtlSetLabel()</code>. 
  <li><a name="1034866"> </a>If the list items were statically created in the resource editor, respond to the <a href="UI_List.html#996554"><code>popSelectEvent</code></a> for a pop-up trigger and perform an action based on the selection passed in the event structure. Return <code>false</code> to allow the system to set the pop-up trigger's label to the text of the selected list item. 
  <li><a name="1034943"> </a>If you're dynamically creating the list elements at run-time, the system cannot set the trigger label for you. Respond to the <code>popSelectEvent</code> to both perform an action based on the selection and to set the trigger label using <code>CtlSetLabel()</code>. Return <code>true</code> to bypass the system default behavior. Otherwise, the application will crash. 
</ul>

<div><hr>
  <a name="1034906"> </a> <b>IMPORTANT: </b> Do <i>not</i> return <code>false</code> in response to the <code>ctlSelectEvent</code> for a pop-up trigger. If you do, the list won't pop up. 
<hr>
</div>

<p><a name="1034690"> </a>Some forms use a pop-up list to display database categories. See <a href="UI_ControlConcept.html#1027219">"Category Controls"</a> for information on how to work with such a list. </p>

<p><a name="1034971"> </a><a href="UI_ControlConcept.html#1029197">Table 3.8</a> shows the system events generated when the user interacts with the pop-up trigger and <code>CtlHandleEvent()</code>'s response to the events. Because pop-up triggers are used to display lists, also see <a href="UI_TableConcept.html#1026180">"Lists."</a> </p>

<p class="caption"><a name="1029197"> </a><b>Table 3.8&nbsp;&nbsp;Event flow for pop-up triggers </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1029203"> </a><b>User Action</b></p>
    </th>
    <th><p class="tt"><a name="1029205"> </a><b>System Response</b></p>
    </th>
    <th><p class="tt"><a name="1029207"> </a><b>CtlHandleEvent() Response</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029209"> </a>Pen goes down on the pop-up trigger.</p>
    </td>
    <td><p class="tt"><a name="1029215"> </a><code>penDownEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>. </p>
    </td>
    <td><p class="tt"><a name="1029217"> </a>Adds the <code>ctlEnterEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029219"> </a></p>
    </td>
    <td><p class="tt"><a name="1029225"> </a><code>ctlEnterEvent</code> with pop-up trigger's ID number. </p>
    </td>
    <td><p class="tt"><a name="1029227"> </a>Inverts the trigger's display.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029229"> </a>Pen is lifted from button.</p>
    </td>
    <td><p class="tt"><a name="1029235"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1029237"> </a>Adds the <code>ctlSelectEvent</code> to the event queue. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029239"> </a></p>
    </td>
    <td><p class="tt"><a name="1029245"> </a><code>ctlSelectEvent</code> with pop-up trigger's ID number. </p>
    </td>
    <td><p class="tt"><a name="1029251"> </a>Adds a <a href="UI_Window.html#1659238"><code>winEnterEvent</code></a> for the list's window to the event queue. Control passes to <a href="UI_Form.html#1000647"><code>FrmHandleEvent()</code></a>, which displays the list and adds a <code>popSelectEvent</code> to the event queue. Control then passes to <a href="UI_List.html#994520"><code>LstHandleEvent()</code></a>. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029265"> </a>Pen is lifted outside button.</p>
    </td>
    <td><p class="tt"><a name="1029271"> </a><code>penUpEvent</code> with the x and y coordinates stored in <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">EventType</span>.</p>
    </td>
    <td><p class="tt"><a name="1029277"> </a>Adds the <code>ctlExitEvent</code> to the event queue. </p>
    </td>
  </tr>
</table>

</div>


<h2 class="haH2">
  <a name="1027219"> </a>Category Controls <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1027220"> </a>Palm OS databases use <b>categories</b> to allow the user to group records logically into manageable lists. In the user interface, categories typically appear:</p>
<ul type="disc">
  <li><a name="1029784"> </a>In a pop-up list in a form's title bar if the form displays multiple database records. 
  <li><a name="1029786"> </a>In a pop-up list in dialogs (such as the Details dialog) that allow you to edit a single database record. 
  <li><a name="1029788"> </a>In a selector trigger in a form's title bar if the form allows you to edit a single database record. 
</ul>

<p><a name="1029789"> </a>The Category Manager allows you to easily create and work with these standard controls used for categories. The Category Manager contains two separate sets of APIs: one for non-schema Palm OS databases, and one for schema databases. This section describes how to use the Category Manager functions to manage category controls. For information on manipulating categories in a database, see <i>Exploring Palm OS: Memory, Databases, and Files</i>. </p>
<h3 class="hbH3">
  <a name="1029989"> </a>Creating the Category Controls <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1030000"> </a>You create a category pop-up list the same way you create any pop-up list. In your resource editor, do the following:</p>
<ol type="1">
  <li value="1"><a name="1030016"> </a>Create a pop-up trigger resource with a width of 0. 
  <li value="2"><a name="1030031"> </a>Add a list resource at the same coordinates as the pop-up trigger. Set the list to unusable. 
  <li value="3"><a name="1030017"> </a>Assign the list ID attribute of the pop-up trigger to be the resource ID of the list you created in the previous step. 
</ol>

<p><a name="1030056"> </a>To crate a category selector trigger, do the following:</p>
<ol type="1">
  <li value="1"><a name="1030068"> </a>Create a selector trigger with a width of 0. 
  <li value="2"><a name="1030069"> </a>Add a list at the same coordinates as the pop-up trigger. Set the list to unusable. 
</ol>

<p><a name="1036056"> </a>Because selector triggers are not normally associated with pop-up lists, the selector trigger does not have a list ID attribute for you to assign. The pop-up list for the selector trigger is managed through the Category Manager. </p>
<h3 class="hbH3">
  <a name="1036057"> </a>Category Controls for Non-schema Database Databases <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1036059"> </a>For the most part, you can handle category controls for classic Palm OS databases using only these calls: </p>
<ul type="disc">
  <li><a name="1027232"> </a>Call <a href="UI_Category.html#1032582"><code>CategoryInitialize()</code></a> when you create a new database as described in <a href="UI_ControlConcept.html#1027256">"Initializing Categories in a Non-schema Database"</a> below). 
  <li><a name="1027239"> </a>Call <a href="UI_Category.html#1032707"><code>CategorySetTriggerLabel()</code></a> to set the category pop-up or selector trigger's label when the form is opened (as described in <a href="UI_ControlConcept.html#1027343">"Initializing the Category Trigger for Non-schema Databases"</a>). 
  <li><a name="1027246"> </a>Call <a href="UI_Category.html#1032621"><code>CategorySelect()</code></a> when the user selects the category trigger (as described in <a href="UI_ControlConcept.html#1027384">"Managing a Category Pop-up List for a Non-schema Database"</a>).
</ul>

<p><a name="1027250"> </a>You typically don't need to use the other Category Manager functions unless you want more control over what happens when the user selects the category trigger. </p>

<h4 class="hcH4">
  <a name="1027256"> </a>Initializing Categories in a Non-schema Database
</h4>

<p><a name="1027257"> </a>Before you can use the category functions on a non-schema database, you must set up the database appropriately. The category functions expect to find information at a certain location. If the information is not there, the functions will fail. </p>

<p><a name="1027262"> </a>Category information is stored in the <a href="UI_Category.html#1032200"><code>AppInfoType</code></a> structure within the non-schema database's application info block. The application info block may contain any information that your database needs. If you want to use the Category Manager, the first field in the application info block must be an <code>AppInfoType</code> structure. </p>

<p><a name="1027266"> </a>The <code>AppInfoType</code> structure maps category names to category indexes and category unique IDs. Category names are displayed in the user interface. Category indexes are used to associate a database record with a category. That is, the database record's attributes contain the index of the category to which the record belongs. Category unique IDs are used when synchronizing the database with the desktop computer. </p>

<p><a name="1027267"> </a>To initialize the <code>AppInfoType</code> structure, you call <a href="UI_Category.html#1032582"><code>CategoryInitialize()</code></a>, passing a string list resource containing category names. This function creates as many category indexes and unique IDs as are necessary. You only need to make this call when the database is first created or when you newly assign the application info block to the database. </p>

<p><a name="1027273"> </a>The string list resource is an <code>appInfoStringsRsc</code> (<code>'tAIS'</code>) resource. It contains predefined categories that new users see when they start the application for the first time. Note that the call to <code>CategoryInitialize()</code> is the only place where you use an <code>appInfoStringsRsc</code>. Follow these guidelines when creating the resource: </p>
<ul type="disc">
  <li><a name="1027274"> </a>Place any categories that you don't want the user to be able to change at the beginning of the list. For example, it's common to have at least one uneditable category named Unfiled, so it should be the first item in the list. 
  <li><a name="1027275"> </a>The string list must have 16 entries. Typically, you don't want to predefine 16 categories. You might define one or two and leave the remaining entries blank. The unused slots should have 0 length. 
  <li><a name="1027276"> </a>Keep in mind that there is a limit of 16 categories. That includes both the predefined categories and the categories your users will create. 
  <li><a name="1027277"> </a>Each category name has a maximum length defined by the <code>dmCategoryLength</code> constant (currently, 16 bytes).
  <li><a name="1027279"> </a>Don't include strings for "All" or "Edit Categories." While these two items often appear in category lists, they are not categories, and they are treated differently by the category functions. 
</ul>

<p><a name="1027283"> </a><a href="UI_ControlConcept.html#1027287">Listing 3.1</a> shows an example function that creates and initializes a database with an application info block. Notice that because the application info block is stored with the database, you allocate memory for it using <code>DmNewHandle()</code>, not with <code>MemHandleNew()</code>. </p>
<p class="CCodeCaption">
  <a name="1027287"> </a><b>Listing 3.1&nbsp;&nbsp;Creating a database with an app info block</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
typedef struct {<a name="1027288"> </a>
   AppInfoType appInfo;<a name="1027289"> </a>
   uint16_t myCustomAppInfo;<a name="1027290"> </a>
} MyAppInfoType;<a name="1027291"> </a>
<a name="1035587"> </a>
DatabaseID gDbID;<a name="1035592"> </a>
DmOpenRef gDbP;<a name="1034979"> </a>
 <a name="1027292"> </a>
Err CreateAndOpenDatabase(DmOpenRef *dbPP, uint16_t mode)<a name="1027293"> </a>
{<a name="1027294"> </a>
   status_t error = errNone;<a name="1027295"> </a>
   DmOpenRef dbP;<a name="1027296"> </a>
   MemHandle appInfoHandle;<a name="1027298"> </a>
   DatabaseID dbID;<a name="1027299"> </a>
   MyAppInfoType *appInfoP;<a name="1027301"> </a>
   DmDatabaseInfoType myDbInfo;<a name="1030190"> </a>
<a name="1027302"> </a>
   // Create the database. <a name="1027303"> </a>
   error = DmCreateDatabase (MyDBName, MyDBCreator, MyDBType, false);<a name="1027304"> </a>
   if (error &lt; 0) return error;<a name="1027306"> </a>
<a name="1027307"> </a>
   // Open the database. <a name="1027308"> </a>
   dbP = DmOpenDatabaseByTypeCreator(MyDBType, MyDBCreator, mode);<a name="1027309"> </a>
   if (!dbP) return (dmErrCantOpen);<a name="1027311"> </a>
<a name="1027312"> </a>
   // Get database ID so we can initialize app info block.<a name="1027313"> </a>
   if (DmGetOpenInfo(dbP, &amp;dbID, NULL, NULL, NULL))<a name="1027315"> </a>
      return dmErrInvalidParam;<a name="1027316"> </a>
<a name="1027317"> </a>
   // Allocate app info in storage heap. <a name="1027318"> </a>
   appInfoHandle = DmNewHandle(dbP, sizeof(MyAppInfoType));<a name="1027319"> </a>
   if (!appInfoHandle) return dmErrMemError;<a name="1027320"> </a>
<a name="1027321"> </a>
   // Associate app info with database. <a name="1030227"> </a>
   error = DmDatabaseInfo(dbID, &amp;myDbInfo);<a name="1030195"> </a>
   if (error &lt; 0) return error;<a name="1030207"> </a>
   myDbInfo-&gt;pAppInfoHandle = appInfoHandle;<a name="1027323"> </a>
   DmSetDatabaseInfo(dbID, &amp;myDbInfo);<a name="1027324"> </a>
<a name="1027326"> </a>
   // Initialize app info block to 0. <a name="1027327"> </a>
   appInfoP = MemHandleLock(h);<a name="1027328"> </a>
   DmSet(appInfoP, 0, sizeof(MyAppInfoType), 0); <a name="1027329"> </a>
 <a name="1027330"> </a>
   // Get a DmOpenRef to the resource database that contains the app info <a name="1035157"> </a>
   // strings resource. <a name="1035170"> </a>
   if (!gDbP) {<a name="1035044"> </a>
      if ((error = SysGetModuleDatabase(SysGetRefNum(), &amp;gDbID, &amp;gDbP)) &lt; <a name="1035066"> </a>
         errNone)<a name="1035148"> </a>
         return error;<a name="1034987"> </a>
   }<a name="1035118"> </a>
   // Initialize the categories.<a name="1027331"> </a>
   CategoryInitialize ((AppInfoPtr)appInfoP, gDbP, MyLocalizedAppInfoStr);<a name="1027332"> </a>
 <a name="1027334"> </a>
   // Unlock the app info block.<a name="1027335"> </a>
   MemPtrUnlock(appInfoP);<a name="1027336"> </a>
 <a name="1027337"> </a>
   // Set the output parameter and return. <a name="1027338"> </a>
   *dbPP = dbP;<a name="1027339"> </a>
   return error;<a name="1027340"> </a>
}<a name="1027341"> </a>
</pre><div class="CodeRule"><hr></div>


<h4 class="hcH4">
  <a name="1027343"> </a>Initializing the Category Trigger for Non-schema Databases
</h4>

<p><a name="1027344"> </a>When a form is opened, you need to set the text that the category trigger (whether pop-up or selector trigger) should display. To do this, use <a href="UI_Category.html#1032521"><code>CategoryGetName()</code></a> to look up the name in the <code>AppInfoType</code> structure and then use <a href="UI_Category.html#1032707"><code>CategorySetTriggerLabel()</code></a> to set the label. </p>

<p><a name="1027353"> </a>For the main form of the application, it's common to store the index of the previously selected category in a preference and restore it when the application starts up again. </p>

<p><a name="1027354"> </a>Forms that display information from a single record may show that record's category in a selector trigger or pop-up list. You can retrieve the record's category using <a href="../Memory_Databases_Files/DataMgr.html#1000470"><code>DmGetRecordCategory()</code></a>. </p>

<p><a name="1027363"> </a><a href="UI_ControlConcept.html#1027365">Listing 3.2</a> shows how to set the trigger label to match the category for a particular database record. </p>
<p class="CCodeCaption">
  <a name="1027365"> </a><b>Listing 3.2&nbsp;&nbsp;Setting the category trigger label (non-schema database)</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
uint8_t category;<a name="1027366"> </a>
char categoryName [dmCategoryLength];<a name="1027367"> </a>
ControlType *ctl;<a name="1027368"> </a>
 <a name="1027369"> </a>
// If current category is All, we need to look <a name="1027370"> </a>
// up category.<a name="1027371"> </a>
if (CurrentCategory == dmAllCategories) <a name="1027372"> </a>
   DmGetRecordCategory (AddrDB, CurrentRecord, &amp;category); <a name="1027373"> </a>
else <a name="1027376"> </a>
   category = CurrentCategory;<a name="1027377"> </a>
CategoryGetName (AddrDB, category, categoryName);<a name="1027378"> </a>
ctl = FrmGetObjectPtr(frm, <a name="1027380"> </a>
   FrmGetObjectIndex(frm, objectID));<a name="1030333"> </a>
CategorySetTriggerLabel (ctl, categoryName);<a name="1027382"> </a>
</pre><div class="CodeRule"><hr></div>


<h4 class="hcH4">
  <a name="1027384"> </a>Managing a Category Pop-up List for a Non-schema Database
</h4>

<p><a name="1027385"> </a>When the user taps the category pop-up trigger, call <a href="UI_Category.html#1032621"><code>CategorySelect()</code></a>. That is, call <code>CategorySelect()</code> in response to a <a href="UI_Control.html#999609"><code>ctlSelectEvent</code></a> when the ID stored in the event matches the ID of the category's trigger. The <code>CategorySelect()</code> function displays the pop-up list, manages the user selection, displays the Edit Categories modal dialog as necessary, and sets the trigger label to the item the user selected. </p>

<p><a name="1027394"> </a><a href="UI_ControlConcept.html#1027395">Listing 3.3</a> shows a typical call to <code>CategorySelect()</code>: </p>
<p class="CCodeCaption">
  <a name="1027395"> </a><b>Listing 3.3&nbsp;&nbsp;Calling CategorySelect() </b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
categoryEdited = CategorySelect (AddrDB, frm, <a name="1027396"> </a>
  ListCategoryTrigger, ListCategoryList, true, &amp;category, <a name="1027397"> </a>
  CategoryName, 1, NULL, categoryDefaultEditCategoryString);<a name="1027398"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1027399"> </a>This example uses the following as parameters: </p>
<ul type="disc">
  <li><a name="1027400"> </a><code>AddrDB</code> is the database with the categories to be displayed. 
  <li><a name="1027401"> </a><code>frm</code>, <code>ListCategoryTrigger</code>, and <code>ListCategoryList</code> identify the form, pop-up or selector trigger resource, and list resource. 
  <li><a name="1027402"> </a><code>true</code> indicates that the list should contain an "All" item. The "All" item should appear only in forms that display multiple records. It should not appear in forms that display a single record because selecting it would have no meaning. 
  <li><a name="1027403"> </a><code>category</code> and <code>CategoryName</code> are pointers to the index and name of the currently selected category. When you call this function, these two parameters should specify the category currently displayed in the pop-up trigger. Unfiled is the default. 
  <li><a name="1027404"> </a>The number 1 is the number of uneditable categories. <code>CategorySelect()</code> needs this information when the user chooses the Edit Categories list item. Categories that the user cannot edit should not appear in the Edit Categories dialog. 
   <p><a name="1027405"> </a>Because uneditable categories are assumed to be at the beginning of the category list, passing 1 for this parameter means that <code>CategorySelect()</code> does not allow the user to edit the category at index 0. </p>
  <li><a name="1030345"> </a><code>NULL</code> is passed because this call uses the default title for the Edit Categories list item. If you want to change the name of this list item to something else, you must pass the resource database that contains the string resource you want to use for this list item. 
  <li><a name="1027406"> </a><code>categoryDefaultEditCategoryString</code> is a constant that means include an Edit Categories item in the list and use the default string for its name ("Edit Categories" on US English ROMs). 
   <p><a name="1027407"> </a>To use a different name (for example, if you don't have enough room for the default name), pass the ID of a string resource containing the desired name and pass a reference to its resource database in the parameter before it. </p>
   <p><a name="1027408"> </a>In some cases, you might not want to include the Edit Categories item. If so, pass the constant <code>categoryHideEditCategory</code>. </p>
</ul>

<p><a name="1027418"> </a>The <code>CategorySelect()</code> return value is somewhat tricky: <code>CategorySelect()</code> returns <code>true</code> if the user edited the category list, <code>false</code> otherwise. That is, if the user chose the Edit Categories item and added, deleted, or changed category names, the function returns <code>true</code>. If the user never selects Edit Categories, the function returns <code>false</code>. In most cases, a user simply selects a different category from the existing list without editing categories. In such cases, <code>CategorySelect()</code> returns <code>false</code>. </p>

<p><a name="1027419"> </a>This means you should not rely solely on the return value to see if you need to take action. Instead, you should store the value that you passed for the category index and compare it to the index that <code>CategorySelect()</code> passes back. For example: </p>
<p class="CCodeCaption">
  <a name="1027420"> </a><b>Listing 3.4&nbsp;&nbsp;CategorySelect() return value</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
int16_t category;<a name="1027421"> </a>
Boolean categoryEdited;<a name="1027422"> </a>
 <a name="1027423"> </a>
category = CurrentCategory;<a name="1027424"> </a>
 <a name="1027425"> </a>
categoryEdited = CategorySelect (AddrDB, frm, <a name="1027426"> </a>
  ListCategoryTrigger, ListCategoryList, true, &amp;category,<a name="1027427"> </a>
  CategoryName, 1, NULL, categoryDefaultEditCategoryString);<a name="1027428"> </a>
 <a name="1027429"> </a>
if ( categoryEdited || (category != CurrentCategory)) {<a name="1027430"> </a>
  /* user changed category selection or edited category list. <a name="1027431"> </a>
     Do something. */<a name="1027432"> </a>
}<a name="1027433"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1027434"> </a>If the user has selected a different category, you probably want to do one of two things: </p>
<ul type="disc">
  <li><a name="1027435"> </a>Update the display so that only records in that category are displayed. See the function <code>ListViewUpdateRecords()</code> in the Address Book example application for sample code. 
  <li><a name="1027436"> </a>Change the current record's category from the previous category to the newly selected category. See the function <code>EditViewSelectCategory()</code> in the Address Book example application for sample code. 
</ul>

<p><a name="1027437"> </a>Note that the <code>CategorySelect()</code> function handles the results of the Edit Categories dialog for you. It adds, deletes, and renames items in the database's <code>AppInfoType</code> structure. If the user deletes a category that contains records, it moves those records to the Unfiled category. If the user changes the name of an existing category to the name of another existing category, it prompts the user and, if confirmed, moves the records from the old category to the new category. Therefore, you never have to worry about managing the category list after a call to <code>CategorySelect()</code>. </p>
<h3 class="hbH3">
  <a name="1030393"> </a>Category Controls for Schema Databases <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1030837"> </a>The category rules differ between non-schema databases and schema databases in the following ways: </p>
<ul type="disc">
  <li><a name="1030856"> </a>In schema databases, you can have up to 255 categories. In non-schema databases, the limit is 16. 
  <li><a name="1030865"> </a>In schema databases, a database record can be assigned to multiple categories. In non-schema databases, a record can only belong to one category. 
  <li><a name="1030873"> </a>In schema databases, the category information is stored in a private structure within the database. In non-schema databases, you must define an <code>AppInfoType</code> structure and store it in the database. 
  <li><a name="1030896"> </a>In schema databases, the Database Manager keeps track of whether a category can be modified or not. In non-schema databases, the Database Manager has no notion of whether the category can be edited. 
</ul>

<p><a name="1030394"> </a>For the most part, you can handle category controls for schema Palm OS databases using only these calls: </p>
<ul type="disc">
  <li><a name="1030399"> </a>Call <a href="UI_Category.html#1033276"><code>CatMgrInitialize()</code></a> when you create a new database as described in <a href="UI_ControlConcept.html#1030421">"Initializing Categories in a Schema Database"</a> below). 
  <li><a name="1030407"> </a>Call <a href="UI_Category.html#1033594"><code>CatMgrSetTriggerLabel()</code></a> to set the category pop-up or selector trigger's label when the form is opened (as described in <a href="UI_ControlConcept.html#1027343">"Initializing the Category Trigger for Non-schema Databases"</a>). 
  <li><a name="1030415"> </a>Call <a href="UI_Category.html#1033463"><code>CatMgrSelectFilter()</code></a> when the user selects the pop-up list on a form that uses categories to filter the display (as described in <a href="UI_ControlConcept.html#1027384">"Managing a Category Pop-up List for a Non-schema Database"</a>).
  <li><a name="1030681"> </a>Call <a href="UI_Category.html#1033393"><code>CatMgrSelectEdit()</code></a> when the user selects a selector trigger or pop-up list on a form that changes a database record's category. 
</ul>

<p><a name="1030419"> </a>You typically don't need to use the other Category Manager functions unless you want more control over what happens when the user selects the category trigger. </p>

<h4 class="hcH4">
  <a name="1030421"> </a>Initializing Categories in a Schema Database
</h4>

<p><a name="1030422"> </a>Before you can use the category functions, you must set up the schema database appropriately. The category functions expect to find information at a certain location. If the information is not there, the functions will fail. </p>

<p><a name="1030427"> </a>Category information is stored in a private structure within the schema database. This structure maps category names to category unique IDs. Category names are displayed in the user interface. Category IDs are used when storing category information in each database record and when synchronizing the schema database with the desktop computer. </p>

<p><a name="1030432"> </a>To initialize this private structure, you call <a href="UI_Category.html#1033276"><code>CatMgrInitialize()</code></a>, passing a string list resource containing category names. This function creates as many category IDs as are necessary. You only need to make this call when the database is first created. </p>

<p><a name="1030438"> </a>The string list resource is an <code>appInfoStringsRsc</code> (<code>'tAIS'</code>) resource. It contains predefined categories that new users see when they start the application for the first time. Note that the call to <code>CatMgrInitialize()</code> is the only place where you use an <code>appInfoStringsRsc</code>. Follow these guidelines when creating the resource: </p>
<ul type="disc">
  <li><a name="1030947"> </a>The string list may contain up to 255 entries. Typically you don't want to predefine 255 categories. 
  <li><a name="1035984"> </a>Each category name has a maximum length defined by the <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">catCategoryNameLength</span> constant (currently 31+1 bytes). 
  <li><a name="1030949"> </a>It's common to have at least one category named Unfiled as the first item in the list. Records that aren't a member of any category are displayed under "Unfiled." 
  <li><a name="1030950"> </a>Don't include strings for the "All" or "Edit Categories" items that you see in a categories pop-up list. When displaying the category list, the category manager will automatically generated list entries for these items. 
  <li><a name="1030979"> </a>If you want any of the predefined categories to be uneditable by the user, call <a href="UI_Category.html#1033520"><code>CatMgrSetEditable()</code></a> and pass false as the editable attribute. 
</ul>

<p><a name="1030448"> </a><a href="UI_ControlConcept.html#1027287">Listing 3.1</a> shows an example function that creates and initializes a schema database with category information. </p>
<p class="CCodeCaption">
  <a name="1030452"> </a><b>Listing 3.5&nbsp;&nbsp;Creating a schema database with categories</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
DatabaseID gDbID;<a name="1035604"> </a>
DmOpenRef gDbP;<a name="1035605"> </a>
<a name="1030458"> </a>
Err CreateAndOpenDatabase(DmOpenRef *dbPP, uint16_t mode)<a name="1035626"> </a>
{<a name="1030459"> </a>
   status_t error = errNone;<a name="1030460"> </a>
   DmOpenRef dbP;<a name="1030461"> </a>
   DatabaseID dbID;<a name="1030463"> </a>
   DmDatabaseInfoType *myDbInfo;<a name="1030465"> </a>
   MemHandle myAppInfoStringsH;<a name="1035577"> </a>
<a name="1030466"> </a>
   // Create the database. <a name="1030467"> </a>
   error = DbCreateDatabase (MyDBName, MyDBCreator, MyDBType, numSchemas,<a name="1030468"> </a>
      schemaList, &amp;dbID);<a name="1037422"> </a>
   if (error &lt; 0) return error;<a name="1030469"> </a>
<a name="1030470"> </a>
   // Open the database. <a name="1030471"> </a>
   dbP = DbOpenDatabase(dbID, mode, dbShareNone);<a name="1030472"> </a>
   if (!dbP) return (dmErrCantOpen);<a name="1030473"> </a>
<a name="1030474"> </a>
   // Get a DmOpenRef to the resource database that contains the app info <a name="1035563"> </a>
   // strings resource. Lock down the resource.<a name="1035564"> </a>
   if (!gDbP) {<a name="1035565"> </a>
      if ((error = SysGetModuleDatabase(SysGetRefNum(), &amp;gDbID, &amp;gDbP)) &lt; <a name="1035566"> </a>
         errNone)<a name="1035567"> </a>
         return error;<a name="1035568"> </a>
   }<a name="1036084"> </a>
   myAppInfoStringsH = DmGetResource(gDbP, appInfoStringRsc, <a name="1036085"> </a>
      MyLocalizedAppInfoStr);<a name="1036086"> </a>
<a name="1036087"> </a>
   // Initialize the categories.<a name="1030493"> </a>
   CatMgrInitialize(dbP, myAppInfoStringsH);<a name="1030494"> </a>
<a name="1030499"> </a>
   // Set the output parameter and return. <a name="1030780"> </a>
   *dbPP = dbP;<a name="1030500"> </a>
   return error;<a name="1030501"> </a>
}<a name="1030502"> </a>
</pre><div class="CodeRule"><hr></div>


<h4 class="hcH4">
  <a name="1030504"> </a>Initializing the Category Trigger for a Schema Database
</h4>

<p><a name="1030505"> </a>When a form is opened, you need to set the text that the category trigger (whether pop-up or selector trigger) should display. To do this, use <a href="UI_Category.html#1033594"><code>CatMgrSetTriggerLabel()</code></a>. </p>

<p><a name="1030514"> </a>For the main form of the application, it's common to store the ID of the previously selected category in a preference and restore it when the application starts up again. </p>

<p><a name="1030515"> </a>Forms that display information from a single record from a schema database may show that record's category membership in a selector trigger or pop-up list. You can retrieve the record's category using <a href="../Memory_Databases_Files/SchemaDatabases.html#998391"><code>DbGetCategory()</code></a>. Keep in mind that the record may belong to many categories. The Category Manager functions display multiple categories as a comma-separated list. </p>

<p><a name="1030523"> </a><a href="UI_ControlConcept.html#1027365">Listing 3.2</a> shows how to set the trigger label to match the category for a particular database record. </p>
<p class="CCodeCaption">
  <a name="1030525"> </a><b>Listing 3.6&nbsp;&nbsp;Setting the category trigger label (schema database)</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
CategoryID categoryIDs[];<a name="1030526"> </a>
uint32_t numCategories;<a name="1031136"> </a>
ControlType *ctl;<a name="1030528"> </a>
char *nameP;<a name="1031175"> </a>
<a name="1031176"> </a>
// Allocate memory for the nameP string, which will <a name="1031177"> </a>
// contain the trigger's label. <a name="1031178"> </a>
nameP = (char *)MemPtrNew(catCategoryNameLength);<a name="1031184"> </a>
 <a name="1030529"> </a>
// If current category is All or Multiple, we need to look <a name="1030530"> </a>
// up category membership <a name="1030531"> </a>
if ((CurrentCategory == catIDAll) || <a name="1030532"> </a>
   (CurrentCategory == catIDMultiple)) <a name="1031133"> </a>
   DbGetCategory (schemaDB, CurrentRecord, &amp;numCategories, <a name="1031160"> </a>
      &amp;categoryIDs); <a name="1031161"> </a>
else <a name="1031162"> </a>
   category = CurrentCategory;<a name="1030535"> </a>
ctl = FrmGetObjectPtr(frm, <a name="1030537"> </a>
   FrmGetObjectIndex(frm, objectID));<a name="1030538"> </a>
CategorySetTriggerLabel (schemaDB, categoryIDs, <a name="1030539"> </a>
   numCategories, ctl, nameP);<a name="1031169"> </a>
<a name="1031201"> </a>
// Upon frmCloseEvent, free nameP and call <a name="1031210"> </a>
// DbReleaseStorage() if categoryIDs is not NULL. <a name="1031227"> </a>
</pre><div class="CodeRule"><hr></div>


<h4 class="hcH4">
  <a name="1030541"> </a>Managing a Category Pop-up List for a Schema Database
</h4>

<p><a name="1030542"> </a>When the user taps the category pop-up trigger on a form that manages a schema database, call <a href="UI_Category.html#1033463"><code>CatMgrSelectFilter()</code></a> if the pop-up list filters the display of multiple records or <a href="UI_Category.html#1033393"><code>CatMgrSelectEdit()</code></a> if the pop-up list chooses a new category for a single record. That is, call one of these functions in response to a <a href="UI_Control.html#999609"><code>ctlSelectEvent</code></a> when the ID stored in the event matches the ID of the category's trigger. These functions display the pop-up list, manage the user selection, display the Edit Categories modal dialog as necessary, and set the trigger label to the item the user selected. </p>

<p><a name="1030552"> </a><a href="UI_ControlConcept.html#1030553">Listing 3.7</a> shows a typical call to <code>CatMgrSelectEdit()</code>. The call to <code>CatMgrSelectFilter()</code> is similar. </p>
<p class="CCodeCaption">
  <a name="1030553"> </a><b>Listing 3.7&nbsp;&nbsp;Calling CatMgrSelectEdit() </b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
uint8_t category;<a name="1031321"> </a>
CategoryID inCategoryIDs[], outCategoryIDs[];<a name="1031322"> </a>
uint32_t numInCategories, numOutCategories;<a name="1031323"> </a>
ControlType *ctl;<a name="1031324"> </a>
char *labelString;<a name="1031325"> </a>
<a name="1030554"> </a>
//Allocate space for labelString. outCategoryIDs space is <a name="1031332"> </a>
// allocated for you. <a name="1031370"> </a>
labelString = (char *)MemPtrNew(catCategoryNameLength);<a name="1031372"> </a>
<a name="1031369"> </a>
categoryEdited = CatMgrSelectEdit (schemaDB, frm, <a name="1031368"> </a>
   ListCategoryTrigger, labelString, ListCategoryList, true<a name="1030555"> </a>
   inCategoryIDs, numInCategories, outCategoryIDs, <a name="1031315"> </a>
   &amp;numOutCategories, true, NULL);<a name="1031365"> </a>
<a name="1031379"> </a>
// Upon frmCloseEvent, deallocate labelString and call <a name="1031380"> </a>
// CatMgrFreeSelectedCategories() to free the category <a name="1031381"> </a>
// list allocated by CatMgrSelectEdit(). <a name="1031382"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1030557"> </a>This example uses the following as parameters to <code>CatMgrSelectEdit()</code>: </p>
<ul type="disc">
  <li><a name="1030558"> </a><code>schemaDB</code> is the schema database with the categories to be displayed. 
  <li><a name="1030559"> </a><code>frm</code>, <code>ListCategoryTrigger</code>, and <code>ListCategoryList</code> identify the form, pop-up or selector trigger resource, and list resource. 
  <li><a name="1030560"> </a><code>labelString</code> contains the text displayed in the category label. This string must be at least <code>catCategoryNameLength</code>. If you've got a lot of space to display the name, you might allocate a larger string. 
  <li><a name="1031391"> </a><code>true</code> indicates that a record can belong to multiple categories. The Category Manager adds a "Multiple" item to the list. If the user selects this item, it displays a dialog from which the user selects multiple categories. 
   <p><a name="1031577"> </a>To disallow this behavior, pass <code>false</code> instead. Note that <code>CatMgrSelectFilter()</code> does not take this parameter. It does not allow the selection of multiple categories to display. </p>
  <li><a name="1031410"> </a><code>inCategoryIDs</code> contains a list of the category IDs to which the record currently belongs and <code>numInCategories</code> contains the number of elements in <code>inCategoryIDs</code>. 
  <li><a name="1031423"> </a>Upon return, <code>outCategoryIDs</code> contains a list of the category IDs that the user selected, and <code>numOutCategories</code> contains the number of elements in <code>outCategoryIDs</code>. If the user does not change the selection, <code>outCategoryIDs</code> is <code>NULL</code>. 
  <li><a name="1030564"> </a><code>true</code> indicates that the pop-up list should contain the Edit Categories list item. 
  <li><a name="1031471"> </a><code>NULL</code> indicates that the default string should be used for the Edit Categories list item. 
</ul>

<p><a name="1031501"> </a>When the pop-up list is displayed, <code>inCategoryIDs</code> represents the record's category membership. If the user selects items in the list, this category membership changes, the function returns <code>true</code>, and <code>outCategoryIDs</code> reflects the new set of categories to which the record should now belong. This list supersedes the current category membership list. Your application is responsible for updating the record to reflect the new membership. In the case of <code>CatMgrSelectFilter()</code>, your application is responsible for updating the display to reflect the new selection. </p>

<p><a name="1030589"> </a>Note that the <code>CatMgrSelectEdit()</code> and <code>CatMgrSelectFilter()</code> functions handle the results of the Edit Categories dialog for you. They add, delete, and rename items in the database's private category structure. If the user deletes a category that contains records, they remove membership in that category from any existing records. If the user changes the name of an existing category to the name of another existing category, they prompt the user and, if confirmed, moves the records from the old category to the new category. Therefore, you never have to worry about managing the category list after a call to <code>CatMgrSelectEdit()</code> or <code>CatMgrSelectFilter()</code>. </p>

<h2 class="haH2">
  <a name="1035669"> </a>Scroll Bars <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1035676"> </a>A <b>scroll bar</b> is a control that is used to scroll user interface elements that are longer or wider than the screen. You can attach scroll bars to fields or tables and the system sends the appropriate events when the end user interacts with the scroll bar (see <a href="UI_ControlConcept.html#1035681">Figure 3.8</a>). </p>

<p class="FFigureCaption">
  <a name="1035681"> </a><b>Figure 3.8&nbsp;&nbsp;Scroll bar</b>
</p>
<div align="left"><img src="images/scrollbar8.jpg" height="224" width="480" border="0" hspace="0" vspace="0">
</div>

<p><a name="1035689"> </a>To do to include a scroll bar in your user interface, do the following: </p>
<ol type="1">
  <li value="1"><a name="1035690"> </a>Create a scroll bar UI resource in your resource file. 
   <p><a name="1035691"> </a>Provide the ID and the bounds for the scroll bar rectangle. The height has to match the UI element you want to attach it to. The width should be 7 standard coordinates.</p>
  <li value="2"><a name="1035692"> </a>Provide a minimum and maximum value as well as a page size. 
  <li><a name="1035693"> </a>Minimum is usually 0.
  <li><a name="1035694"> </a>Maximum is usually 0 and set programmatically.
  <li><a name="1035695"> </a>The page size determines how many lines the scroll bar moves when the text scrolls. 
  <li value="3"><a name="1036153"> </a>In the UI element that is to be scrolled, set the attribute that indicates that it has a scroll bar attached to it. (You can also do this programmatically.) 
</ol>

<p><a name="1035704"> </a>There are two ways in which the scroll bar and the user interface element that it's attached to need to interact: </p>
<ul type="disc">
  <li><a name="1035705"> </a>When the user adds or removes text, the scroll bar needs to know about the change in size. 
   <p><a name="1035710"> </a>If the "has scroll bar" attribute is set for a field, you'll receive a <a href="UI_Field.html#1007883"><code>fldChangedEvent</code></a> whenever the field's size changes. Your application should handle these events by computing new values for the scroll bar's minimum, maximum, and current position and then use <a href="UI_Scrollbar.html#994180"><code>SclSetScrollBar()</code></a> to update it. </p>
   <p><a name="1035718"> </a>If a table has a scroll bar attached, you should keep track of when the table's size changes. Whenever it does, you should compute new values for the scroll bar's minimum, maximum, and current position and then use <code>SclSetScrollBar()</code> to update it. </p>
   <p><a name="1035720"> </a>You should also call <code>SclSetScrollBar()</code> when the form is initialized to set the current position of the scroll bar. </p>
  <li><a name="1035721"> </a>When the user moves the scroll bar, the text needs to move accordingly. This can either happen dynamically (as the user moves the scroll bar) or statically (after the user has released the scroll bar). 
   <p><a name="1035722"> </a>The system sends the following scroll bar events:</p>
  <ul type="disc">
    <li><a name="1035727"> </a><a href="UI_Scrollbar.html#994834"><code>sclEnterEvent</code></a> is sent when a <code>penDownEvent</code> occurs within the bounds of the scroll bar. 
    <li><a name="1035732"> </a><a href="UI_Scrollbar.html#994900"><code>sclRepeatEvent</code></a> is sent when the user drags the scroll bar. 
    <li><a name="1035737"> </a><a href="UI_Scrollbar.html#994861"><code>sclExitEvent</code></a> is sent when the user lifts the pen. This event is sent regardless of previous <code>sclRepeatEvent</code>s. 
   <p><a name="1035738"> </a>Applications that want to support immediate-mode scrolling (that is, scrolling happens as the user drags the pen) need to watch for occurrences of <code>sclRepeatEvent</code>. In response to this event, call the scrolling function associated with the UI element (<a href="UI_Field.html#997935"><code>FldScrollField()</code></a> or your own scrolling function in the case of tables).</p>
   <p><a name="1035745"> </a>Applications that don't support immediate-mode scrolling should ignore occurrences of <code>sclRepeatEvent</code> and wait only for the <code>sclExitEvent</code>. </p>
  </ul>
</ul>

<h2 class="haH2">
  <a name="1035663"> </a>Summary of Control Functions <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1029352"> </a><b>Control Functions</b></p>
    </th>
    <th><p class="tt"><a name="1029354"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029356"> </a><b>Displaying a Control</b></p>
    </td>
    <td><p class="tt"><a name="1029358"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029363"> </a><a href="UI_Control.html#1004221"><code>CtlShowControl()</code></a><br><a href="UI_Control.html#993755"><code>CtlDrawCheckboxControl()</code></a></p>
    </td>
    <td><p class="tt"><a name="1029375"> </a><a href="UI_Control.html#993805"><code>CtlDrawControl()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1035472"> </a><b>Enabling/Disabling</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1035459"> </a><a href="UI_Control.html#995558"><code>CtlSetEnabled()</code></a><br><a href="UI_Control.html#994675"><code>CtlHideControl()</code></a></p>
    </td>
    <td><p class="tt"><a name="1035467"> </a><a href="UI_Control.html#993851"><code>CtlEnabled()</code></a><br><a href="UI_Control.html#993893"><code>CtlEraseControl()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029384"> </a><b>Control's Value</b></p>
    </td>
    <td><p class="tt"><a name="1029386"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029391"> </a><a href="UI_Form.html#1054241"><code>FrmGetControlValue()</code></a><br><a href="UI_Control.html#994503"><code>CtlGetValue()</code></a><br><a href="UI_Form.html#997592"><code>FrmGetControlGroupSelection()</code></a><br><a href="UI_Control.html#994441"><code>CtlGetSliderValues()</code></a> </p>
    </td>
    <td><p class="tt"><a name="1029400"> </a><a href="UI_Form.html#1002947"><code>FrmSetControlValue()</code></a><br><a href="UI_Control.html#996118"><code>CtlSetValue()</code></a><br><a href="UI_Form.html#1002873"><code>FrmSetControlGroupSelection()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029402"> </a><b>Label</b></p>
    </td>
    <td><p class="tt"><a name="1029404"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029409"> </a><a href="UI_Control.html#995869"><code>CtlSetLabel()</code></a></p>
    </td>
    <td><p class="tt"><a name="1029414"> </a><a href="UI_Control.html#994375"><code>CtlGetLabel()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029436"> </a><b>Event Handling</b></p>
    </td>
    <td><p class="tt"><a name="1029438"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029443"> </a><a href="UI_Control.html#994545"><code>CtlHandleEvent()</code></a></p>
    </td>
    <td><p class="tt"><a name="1029445"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029447"> </a><b>Setting up controls </b></p>
    </td>
    <td><p class="tt"><a name="1029449"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029454"> </a><a href="UI_Control.html#995791"><code>CtlSetGraphics()</code></a> </p>
    </td>
    <td><p class="tt"><a name="1029462"> </a><a href="UI_Control.html#995982"><code>CtlSetSliderValues()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029464"> </a><b>Debugging </b></p>
    </td>
    <td><p class="tt"><a name="1029466"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029471"> </a><a href="UI_Control.html#994717"><code>CtlHitControl()</code></a></p>
    </td>
    <td><p class="tt"><a name="1029476"> </a><a href="UI_Control.html#996230"><code>CtlValidatePointer()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1035432"> </a><b>Dynamically Creating a Control</b></p>
    </td>
    <td><p class="tt"><a name="1035434"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1035413"> </a><a href="UI_Control.html#1002155"><code>CtlNewGraphicControl()</code></a> <br><a href="UI_Control.html#995009"><code>CtlNewControl()</code></a></p>
    </td>
    <td><p class="tt"><a name="1035424"> </a><a href="UI_Control.html#995460"><code>CtlNewSliderControl()</code></a> </p>
    </td>
  </tr>
</table>

</div>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1027440"> </a><b>Category Manager Functions</b></p>
    </th>
    <th><p class="tt"><a name="1027442"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1027444"> </a><b>Category Controls for Non-schema Databases</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1031608"> </a><a href="UI_Category.html#1032356"><code>CategoryCreateList()</code></a><br><a href="UI_Category.html#1032416"><code>CategoryEdit()</code></a><br><a href="UI_Category.html#1032462"><code>CategoryFind()</code></a><br><a href="UI_Category.html#1032484"><code>CategoryFreeList()</code></a><br><a href="UI_Category.html#1032521"><code>CategoryGetName()</code></a><br><a href="UI_Category.html#1032562"><code>CategoryGetNext()</code></a></p>
    </td>
    <td><p class="tt"><a name="1031610"> </a><a href="UI_Category.html#1032582"><code>CategoryInitialize()</code></a><br><a href="UI_Category.html#1032621"><code>CategorySelect()</code></a><br><a href="UI_Category.html#1032678"><code>CategorySetName()</code></a><br><a href="UI_Category.html#1032707"><code>CategorySetTriggerLabel()</code></a><br><a href="UI_Category.html#1032736"><code>CategoryTruncateName()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1031728"> </a><b>Category Controls for Schema Databases</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1031724"> </a><a href="UI_Category.html#1032813"><code>CatMgrCreateList()</code></a><br><a href="UI_Category.html#1032895"><code>CatMgrEdit()</code></a><br><a href="UI_Category.html#1032936"><code>CatMgrFind()</code></a><br><a href="UI_Category.html#1032975"><code>CatMgrFreeList()</code></a><br><a href="UI_Category.html#1033025"><code>CatMgrFreeSelectedCategories()</code></a><br><a href="UI_Category.html#1033152"><code>CatMgrGetName()</code></a></p>
    </td>
    <td><p class="tt"><a name="1031726"> </a><a href="UI_Category.html#1033194"><code>CatMgrGetNext()</code></a><br><a href="UI_Category.html#1033276"><code>CatMgrInitialize()</code></a><br><a href="UI_Category.html#1033393"><code>CatMgrSelectEdit()</code></a><br><a href="UI_Category.html#1033463"><code>CatMgrSelectFilter()</code></a><br><a href="UI_Category.html#1033556"><code>CatMgrSetName()</code></a><br><a href="UI_Category.html#1033594"><code>CatMgrSetTriggerLabel()</code></a><br><a href="UI_Category.html#1033631"><code>CatMgrTruncateName()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1031942"> </a><b>Obtaining Category Information for Schema Databases</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1031949"> </a><a href="UI_Category.html#1032753"><code>CatMgrAdd()</code></a><br><a href="UI_Category.html#1033047"><code>CatMgrGetAllItemLabel()</code></a><br><a href="UI_Category.html#1033071"><code>CatMgrGetEditable()</code></a><br><a href="UI_Category.html#1033107"><code>CatMgrGetID()</code></a></p>
    </td>
    <td><p class="tt"><a name="1031987"> </a><a href="UI_Category.html#1033238"><code>CatMgrGetUnfiledItemLabel()</code></a><br><a href="UI_Category.html#1033322"><code>CatMgrNumCategories()</code></a><br><a href="UI_Category.html#1033357"><code>CatMgrRemove()</code></a><br><a href="UI_Category.html#1033520"><code>CatMgrSetEditable()</code></a></p>
    </td>
  </tr>
</table>

</div>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1035818"> </a><b>Scroll Bar Functions</b></p>
    </th>
    <th><p class="tt"><a name="1035820"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1035825"> </a><a href="UI_Scrollbar.html#994180"><code>SclSetScrollBar()</code></a> <br><a href="UI_Scrollbar.html#994134"><code>SclHandleEvent()</code></a></p>
    </td>
    <td><p class="tt"><a name="1035833"> </a><a href="UI_Scrollbar.html#994072"><code>SclGetScrollBar()</code></a> <br><a href="UI_Scrollbar.html#993645"><code>SclDrawScrollBar()</code></a></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1003252"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 2003&#8211;2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="UI_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="UI_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_FormConcept.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_MenuConcept.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_IX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>