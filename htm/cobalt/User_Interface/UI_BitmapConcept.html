<html>
<head>
<title>(Protein) Working with Bitmaps | User Interface </title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 11:59:20">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="1005083"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="UI_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_Drawing.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_UIColorListConcept.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_IX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">9 &nbsp;&nbsp;
Working with Bitmaps</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">User Interface </p>
<p class="SubTitle">Exploring Palm OS&#174; </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="UI_PartConcept.html">Part I: Concepts</a> </h1>
<h1 class="SideTOC1"><a href="UI_BitmapConcept.html">9  Working with Bitmaps</a></h1>

   <h2 class="SideTOC2"><a href="#1032821">
   Bitmap Format</a></h2>

      <h3 class="SideTOC3"><a href="#1032832">
      Versions of Bitmap Support</a></h3>

      <h3 class="SideTOC3"><a href="#1032844">
      Bitmap Families</a></h3>

      <h3 class="SideTOC3"><a href="#1032937">
      Color Tables and Bitmaps</a></h3>

      <h3 class="SideTOC3"><a href="#1037230">
      PNG Files</a></h3>

   <h2 class="SideTOC2"><a href="#1008025">
   Displaying a Bitmap on the Screen</a></h2>

   <h2 class="SideTOC2"><a href="#1027536">
   Creating a Bitmap Programmatically</a></h2>

   <h2 class="SideTOC2"><a href="#1027903">
   How Palm OS Displays Bitmaps</a></h2>

      <h3 class="SideTOC3"><a href="#1032701">
      Displaying Bitmaps from a Bitmap Family</a></h3>

      <h3 class="SideTOC3"><a href="#1027124">
      Drawing High-Density Bitmaps</a></h3>

   <h2 class="SideTOC2"><a href="#1032043">
   Summary of Bitmap Support</a></h2>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1007719"> </a>A <b>bitmap</b> is a graphic displayed by Palm OS<sup>&#174;</sup>. You create a bitmap resource using your resource editor, or you can create a bitmap programmatically. </p>

<p><a name="1029118"> </a>This chapter covers:</p>
   <blockquote class = "bq"><a name="1029119"> </a><a href="UI_BitmapConcept.html#1032821">Bitmap Format</a></blockquote>
   <blockquote class = "bq"><a name="1033019"> </a><a href="UI_BitmapConcept.html#1008025">Displaying a Bitmap on the Screen</a></blockquote>
   <blockquote class = "bq"><a name="1033042"> </a><a href="UI_BitmapConcept.html#1027536">Creating a Bitmap Programmatically</a></blockquote>
   <blockquote class = "bq"><a name="1033047"> </a><a href="UI_BitmapConcept.html#1027903">How Palm OS Displays Bitmaps</a></blockquote>
   <blockquote class = "bq"><a name="1033051"> </a><a href="UI_BitmapConcept.html#1032043">Summary of Bitmap Support</a></blockquote>

<p><a name="1033162"> </a>Before you read this chapter, it is strongly suggested that you be familiar with the concepts introduced in <a href="UI_Screen.html#995096">Chapter 1, "The Display,"</a> and <a href="UI_Drawing.html#1083817">Chapter 8, "Drawing."</a></p>

<h2 class="haH2">
  <a name="1032821"> </a>Bitmap Format <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1032822"> </a>Programmatically, a bitmap or bitmap family is represented by a <a href="UI_Bitmap.html#1003681"><code>BitmapType</code></a> structure. This structure is simply a header. It is followed by the bitmap data in the same memory block. Bitmaps are also allowed to have their own color tables. When a bitmap has its own color table, it is stored between the bitmap header and the bitmap data. </p>

<p><a name="1032831"> </a>This section describes how the <a href="UI_Bitmap.html#1003681"><code>BitmapType</code></a> stores bitmap data. See <a href="UI_BitmapConcept.html#1027903">"How Palm OS Displays Bitmaps"</a> to learn how Palm OS uses this bitmap data to determine what to display on the screen. </p>
<h3 class="hbH3">
  <a name="1032832"> </a>Versions of Bitmap Support <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1032834"> </a>The <code>BitmapType</code> structure contains one of four versions of bitmap encodings. (The <code>version</code> field specifies which one is used.) </p>
<ul type="disc">
  <li><a name="1032835"> </a>Version 0 encoding is supported by all Palm OS releases. This encoding supports monochrome bitmaps only. 
  <li><a name="1032836"> </a>Version 1 encoding is supported on Palm OS 3.0 and later. This encoding supports 1, 2, and 4-bit grayscale bitmaps and adds support for <b>bitmap families</b>. 
  <li><a name="1032837"> </a>Version 2 encoding is supported on Palm OS 3.5 and later. This encoding supports 1, 2, 4, 8 and 16-bit color bitmaps, transparency indices, and RLE compression. 
   <p><a name="1032838"> </a>With a version 2 bitmap, you can specify one index value as a transparent color at creation time. The transparency index is an alternative to masking. The system does not draw bits that have the transparency index value. </p>
   <p><a name="1032841"> </a>When a bitmap with a transparency index is rendered at a depth other than the one at which it was created, the transparent color is first translated to the corresponding depth color, and the resulting color is named transparent. This may result in a group of colors becoming transparent. </p>
  <li><a name="1032842"> </a>Version 3 encoding is supported on Palm OS Garnet and later devices with high-density displays. Version 3 adds support for bitmaps of varying densities.
</ul>
<h3 class="hbH3">
  <a name="1032844"> </a>Bitmap Families <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1032845"> </a>A <code>BitmapType</code> structure represents either a single bitmap or a bitmap family. A <b>bitmap family</b> is a group of bitmaps, each containing the same drawing but at a different bit depth (sometimes called the pixel depth) or density. <a href="UI_BitmapConcept.html#1032852">Figure 9.1</a> shows a bitmap family for a single display density. </p>

<p class="FFigureCaption">
  <a name="1032852"> </a><b>Figure 9.1&nbsp;&nbsp;Single-density bitmap family</b>
</p>
<div align="left"><img src="images/UI_BitmapConceptb.jpg" height="315" width="580" border="0" hspace="0" vspace="0">
</div>

<p><a name="1034028"> </a>Bitmaps in a bitmap family are grouped by density. For backward compatibility, the linked list of low density bitmaps occur first, and remain ordered from low to high bit depths. If the family contains high-density bitmaps, the high-density bitmaps follow the low-density bitmaps, again ordered from low to high bit depths. If the family contains multiple densities, then the density sets are ordered from low to high density.</p>

<p><a name="1034033"> </a><a href="UI_BitmapConcept.html#1032932">Figure 9.2</a> illustrates the process of traversing the bitmaps in a bitmap family. </p>

<p class="FFigureCaption">
  <a name="1032932"> </a><b>Figure 9.2&nbsp;&nbsp;Linked list of bitmaps in a bitmap family</b>
</p>
<div align="left"><img src="images/Flowchart2.jpg" height="591" width="480" border="0" hspace="0" vspace="0">
</div>
<h3 class="hbH3">
  <a name="1032937"> </a>Color Tables and Bitmaps <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1032938"> </a>As mentioned previously, bitmaps can have their own color tables attached to them. If a bitmap has its own color table, the system must create a conversion table to convert the draw window before it can draw the bitmap. This conversion is a drain on performance, so using custom color tables with bitmaps is strongly discouraged. </p>

<p><a name="1033351"> </a>You can still change the color table used by the current draw windows with the <a href="UI_Window.html#1530544"><code>WinPalette()</code></a> function before drawing the bitmap and change it back to the default afterwards. Note that <code>WinPalette()</code> no longer affects what is already drawn onto the screen. It only affects future drawing. </p>
<h3 class="hbH3">
  <a name="1037230"> </a>PNG Files <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1037235"> </a>In addition to the bitmap format described in this section, Palm OS supports the display of PNG formatted files. To add a PNG file to your resource, use <code>RAW_RESOURCE</code> as shown in <a href="UI_BitmapConcept.html#1037241">Listing 9.1</a>. </p>
<p class="CCodeCaption">
  <a name="1037241"> </a><b>Listing 9.1&nbsp;&nbsp;Creating a PNG resource</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
&lt;RAW_RESOURCE RESOURCE_ID="1000" COMMENT="PNG file"&gt;
   &lt;RES_TYPE&gt;'pngf'&lt;/RES_TYPE&gt;<a name="1037280"> </a>
   &lt;DATA_FILE&gt;"./MyPictures/Picture1.png"&lt;/DATA_FILE&gt;<a name="1037288"> </a>
&lt;/RAW_RESOURCE&gt;<a name="1037302"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1037307"> </a>To display the PNG on the screen, you must create a <a href="UI_GraphicContext.html#1169790"><code>GcBitmapHandle</code></a> for the resource using <a href="UI_Form.html#1329509"><code>FrmGetBitmapHandle()</code></a> or <a href="UI_GraphicContext.html#1170870"><code>GcLoadBitmap()</code></a>. This is described further in the next section. Note that you must create a <code>GcBitmapHandle</code>; the <code>BitmapType</code> structures do not accept PNG files. </p>

<h2 class="haH2">
  <a name="1008025"> </a>Displaying a Bitmap on the Screen <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1029162"> </a>There are two ways to statically display a bitmap on a screen: </p>
<ul type="disc">
  <li><a name="1029163"> </a>If the bitmap should always be displayed at a fixed location, in your resource file create a form bitmap resource in addition to the bitmap. The <b>form bitmap </b>specifies where the bitmap should be displayed. 
  <li><a name="1029229"> </a>If the bitmap might move or you do not know the location where it should be displayed until runtime, use the <a href="UI_GraphicContext.html#1170306"><code>GcDrawBitmapAt()</code></a> function to display it. Because this is a graphics context function, as described in <a href="UI_Drawing.html#1083817">Chapter 8, "Drawing,"</a> you need to first obtain access to the graphics context. See <a href="UI_BitmapConcept.html#1032195">Listing 9.2</a>. 
</ul>
<p class="CCodeCaption">
  <a name="1032195"> </a><b>Listing 9.2&nbsp;&nbsp;Drawing a bitmap </b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
GcHandle gc;<a name="1032285"> </a>
FormType *formP;<a name="1034593"> </a>
GcBitmapHandle gcBitmap;<a name="1032363"> </a>
...<a name="1032288"> </a>
<a name="1032396"> </a>
//Obtain the graphics context and draw the bitmap.<a name="1035283"> </a>
while (/* some condition */) {<a name="1035284"> </a>
   //Load the bitmap from the resource file and convert it. <a name="1032436"> </a>
   gcBitmap = FrmGetBitmapHandle(formP, myAppDB, bitmapRsc, 
      rscID, 0);<a name="1032415"> </a>
   if (!gcBitmap)<a name="1034697"> </a>
      return memErrNotEnoughSpace;<a name="1034698"> </a>
<a name="1032405"> </a>
   GcGetCurrentContext(gc);<a name="1032295"> </a>
   if (gc) {<a name="1032487"> </a>
      GcDrawBitmapAt(gc, gcBitmap, NULL, x, y);<a name="1033733"> </a>
      GcReleaseContext(gc);<a name="1033734"> </a>
   }<a name="1033756"> </a>
}<a name="1033735"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1034889"> </a>Before you can call <code>GcDrawBitmapAt()</code>, you must obtain a <code>GcBitmapHandle</code> for the bitmap. In most cases, you can do so using <a href="UI_Form.html#1329509"><code>FrmGetBitmapHandle()</code></a>, which loads the specified bitmap resource from the database, locks it, and converts it into a format that can be displayed on the screen more efficiently. For example, it converts big-endian bitmaps to little-endian format. This function also caches the bitmap handle and returns the cached handle on subsequent calls, ensuring that the bitmap is only loaded and converted once. The memory associated with the bitmap cache is freed when the form is freed. </p>

<p><a name="1037381"> </a>If you're performing animation, doing a slide show, or otherwise drawing a lot of bitmaps to the form, don't use <code>FrmGetBitmapHandle()</code>. If you do, you may quickly fill the bitmap cache. Instead, load the bitmap (or PNG) from the resource file, and create the <code>GcBitmapHandle</code> using <a href="UI_GraphicContext.html#1170870"><code>GcLoadBitmap()</code></a>. In this case when you are finished with the bitmap, you'll need to call <a href="UI_GraphicContext.html#1171079"><code>GcReleaseBitmap()</code></a> to remove the memory associated with the <code>GcBitmapHandle</code> and then free the bitmap. </p>

<p><a name="1035293"> </a>Alternatively, you can use <a href="UI_GraphicContext.html#1170627"><code>GcDrawRawBitmapAt()</code></a>, which converts a <code>BitmapType</code> to a <code>GcBitmapHandle</code>, draws the bitmap on the screen, and then removes the memory associated with the <code>GcBitmapHandle</code>. You are responsible for loading the bitmap from the resource and releasing it when you are finished. </p>

<h2 class="haH2">
  <a name="1027536"> </a>Creating a Bitmap Programmatically <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1008040"> </a>If you want to create or modify a bitmap programmatically, do the following:</p>
<ol type="1">
  <li value="1"><a name="1029541"> </a>Use <a href="UI_Bitmap.html#998464"><code>BmpCreate()</code></a> to create a <a href="UI_Bitmap.html#1003681"><code>BitmapType</code></a> structure. 
  <li value="2"><a name="1029596"> </a>Pass the <code>BitmapType</code> to <a href="UI_GraphicContext.html#994782"><code>GcCreateBitmapContext()</code></a>. Doing so creates a graphics context representing the bitmap. 
  <li value="3"><a name="1029625"> </a>Draw to the graphics context returned from the previous step using the Graphics Context path definition and drawing functions described in <a href="UI_Drawing.html#1083817">Chapter 8, "Drawing."</a>
  <li value="4"><a name="1029657"> </a>Release the graphics context when you are finished (<a href="UI_GraphicContext.html#994064"><code>GcReleaseContext()</code></a>). 
</ol>
<p class="CCodeCaption">
  <a name="1008049"> </a><b>Listing 9.3&nbsp;&nbsp;Programmatically creating a bitmap</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
BitmapType *bmpP;<a name="1008050"> </a>
GcHandle gc;<a name="1008051"> </a>
 <a name="1008053"> </a>
bmpP = BmpCreate(10, 10, 8, NULL, &amp;error);<a name="1008054"> </a>
if (bmpP) {<a name="1008055"> </a>
  gc = GcCreateBitmapContext(bmpP);<a name="1008056"> </a>
  if (gc) {<a name="1008057"> </a>
      GcSetColor(gc, 0, 0, 0, 255);<a name="1029733"> </a>
      GcRoundRect(gc, 0, 0, 50, 15, 3, 3);<a name="1029734"> </a>
      GcPaint(gc);<a name="1029736"> </a>
      /* etc */<a name="1008060"> </a>
      GcReleaseContext(gc);<a name="1029752"> </a>
  }<a name="1008061"> </a>
}<a name="1008062"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1032516"> </a>A few items of note about programmatically creating a bitmap: </p>
<ul type="disc">
  <li><a name="1032583"> </a><code>BmpCreate()</code> always creates a version 2 bitmap, which is a low-density bitmap. To create a high-density bitmap, you need to call <a href="UI_Bitmap.html#993998"><code>BmpCreateBitmapV3()</code></a> after calling <code>BmpCreate()</code>. 
  <li><a name="1032603"> </a>Even if you are creating a low-density bitmap, the coordinates that you pass to the graphics context drawing functions are interpreted as native coordinates by default. If you prefer to work in standard coordinates, call <a href="UI_GraphicContext.html#1124904"><code>GcSetCoordinateSystem()</code></a>. 
</ul>

<h2 class="haH2">
  <a name="1027903"> </a>How Palm OS Displays Bitmaps <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1032698"> </a>This section describes how Palm OS draws bitmaps. It covers how Palm OS chooses a bitmap from the bitmap family and how it deals with differences between the bitmap's density and the draw window's density. </p>
<h3 class="hbH3">
  <a name="1032701"> </a>Displaying Bitmaps from a Bitmap Family <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1030700"> </a>The algorithm that is used to determine which bitmap to display depends upon the density of the draw window. The <b>draw window</b> is not always the screen. It can be an off-screen window created with the <a href="UI_Window.html#1480700"><code>WinCreateOffscreenWindow()</code></a> function or a bitmap context created with <a href="UI_GraphicContext.html#994782"><code>GcCreateBitmapContext()</code></a>. </p>

<p><a name="1030448"> </a>If the draw window is single density, single-density bitmaps are always favored over double-density bitmaps, regardless of source bitmap depth. If the draw window is double density, however, the color domain match (color vs. grayscale) is favored over a double-density bitmap with a color domain mismatch. <a href="UI_BitmapConcept.html#1030484">Listing 9.4</a> shows the algorithm used to determine which bitmap to display.</p>
<p class="CCodeCaption">
  <a name="1030484"> </a><b>Listing 9.4&nbsp;&nbsp;Algorithm for choosing which bitmap to display</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
If draw window is low density {<a name="1027904"> </a>
    Favor low-density over double-density<a name="1027905"> </a>
    If draw window is color {<a name="1027906"> </a>
        Favor color bitmap<a name="1027907"> </a>
    } else {<a name="1027908"> </a>
        Favor grayscale, picking greatest depth<a name="1027909"> </a>
          less than or equal to draw window's<a name="1027910"> </a>
          depth<a name="1027911"> </a>
    }<a name="1027912"> </a>
} else {<a name="1027913"> </a>
        If draw window is color {<a name="1027914"> </a>
            Favor color<a name="1027915"> </a>
        } else {<a name="1027916"> </a>
            Favor grayscale<a name="1027917"> </a>
        }<a name="1027918"> </a>
    }<a name="1027919"> </a>
}<a name="1027920"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1027921"> </a><a href="UI_BitmapConcept.html#1027927">Table 9.1</a> provides the results of applying this algorithm. The two left columns represent the draw window's depth and density. The third column lists the bitmap selection preferences, ordered from best to worst (a 'd' in this third column indicates double-density).</p>

<p class="caption"><a name="1027927"> </a><b>Table 9.1&nbsp;&nbsp;Double-density algorithm results </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="1027933"> </a><b>Draw Window </b></p>
    </th>
    <th colspan="1" rowspan="2"><p class="tt"><a name="1027937"> </a><b>Bitmap selection preferences</b></p>
    </th>
  </tr>
  <tr valign="top">
    <th><p class="tt"><a name="1027939"> </a><b>Depth</b></p>
    </th>
    <th><p class="tt"><a name="1027941"> </a><b>Density</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027945"> </a>1</p>
    </td>
    <td><p class="tt"><a name="1027947"> </a>Single</p>
    </td>
    <td><p class="tt"><a name="1027949"> </a>1, 2, 4, 8, 16</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027951"> </a>2</p>
    </td>
    <td><p class="tt"><a name="1027953"> </a>Single</p>
    </td>
    <td><p class="tt"><a name="1027955"> </a>2, 1, 4, 8, 16</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027957"> </a>4</p>
    </td>
    <td><p class="tt"><a name="1027959"> </a>Single</p>
    </td>
    <td><p class="tt"><a name="1027961"> </a>4, 2, 1, 8, 16</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027963"> </a>8</p>
    </td>
    <td><p class="tt"><a name="1027965"> </a>Single</p>
    </td>
    <td><p class="tt"><a name="1027967"> </a>8, 16, 4, 2, 1</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027969"> </a>16</p>
    </td>
    <td><p class="tt"><a name="1027971"> </a>Single</p>
    </td>
    <td><p class="tt"><a name="1027973"> </a>16, 8, 4, 2, 1</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027975"> </a>1</p>
    </td>
    <td><p class="tt"><a name="1027977"> </a>Double</p>
    </td>
    <td><p class="tt"><a name="1027979"> </a>1d, 2d, 4d, 1, 2, 4, 8d, 16d, 8, 16</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027981"> </a>2</p>
    </td>
    <td><p class="tt"><a name="1027983"> </a>Double</p>
    </td>
    <td><p class="tt"><a name="1027985"> </a>2d, 1d, 4d, 2, 1, 4, 8d, 16d, 8, 16</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027987"> </a>4</p>
    </td>
    <td><p class="tt"><a name="1027989"> </a>Double</p>
    </td>
    <td><p class="tt"><a name="1027991"> </a>4d, 2d, 1d, 4, 2, 1, 8d, 16d, 8, 16</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027993"> </a>8</p>
    </td>
    <td><p class="tt"><a name="1027995"> </a>Double</p>
    </td>
    <td><p class="tt"><a name="1027997"> </a>8d, 16d, 8, 16, 4d, 2d, 1d, 4, 2, 1</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1027999"> </a>16</p>
    </td>
    <td><p class="tt"><a name="1028001"> </a>Double</p>
    </td>
    <td><p class="tt"><a name="1028003"> </a>16d, 8d, 16, 8, 4d, 2d, 1d, 4, 2, 1</p>
    </td>
  </tr>
</table>

</div>

<h3 class="hbH3">
  <a name="1027124"> </a>Drawing High-Density Bitmaps <a href="#1005083"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1027143"> </a>The rendering system uses the <code>density</code> field in the source and destination bitmaps (where the destination bitmap is the bitmap representing the draw window) to determine an appropriate scaling factor. Because standard density bitmaps must be scaled for high-density displays, some handhelds with high-density screens may use graphic accelerators. Nevertheless, the software rendering system incorporates pixel-scaling logic for when the destination is an off-screen window.</p>

<p><a name="1031966"> </a>The coordinate system affects the placement and dimensions of graphic primitives. It does not affect bitmap contents, however. You can create bitmaps that contain either low- or high-density bitmap data. Palm OS uses the coordinate system to determine where to place the top left corner of the bitmap on the screen, while the rendering system uses the bitmap structure's <code>density</code> field to determine if it needs to stretch or shrink the bitmap data as it blits.</p>

<p><a name="1027144"> </a>When scaling down from a density of <code>kDensityDouble</code> to <code>kDensityLow</code>, the software shrinks the bitmap data. The result is almost always a poorer quality image when compared with a bitmap originally generated with a density of <code>kDensityLow</code>.</p>

<p><a name="1027145"> </a>The following examples demonstrate the above concepts.</p>
<ul type="disc">
  <li><a name="1027146"> </a><i>An application draws a low-density bitmap to a double-density screen.</i>
   <p><a name="1027147"> </a>The source data is a 16 by 16 bitmap. The application calls</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
GcSetCoordinateSystem(gc, kCoordinatesStandard);<a name="1027148"> </a>
GcDrawBitmapAt(gc, bitmapH, NULL, 31, 23);<a name="1030993"> </a>
</pre><div class="CodeRule"><hr></div>

   <p><a name="1027149"> </a>with the intention of placing the bitmap on the screen beginning at standard coordinates (31, 23). Because the device has a double-density screen, the scaling factor is 2.0. The coordinates are converted to native coordinates (62, 46). </p>
   <p><a name="1027151"> </a>The rendering system recognizes the bitmap as low density, based upon the version of its <a href="UI_Bitmap.html#1003681"><code>BitmapType</code></a> structure, and pixel-doubles the source data when blitting to the double-density screen.</p>
   <p><a name="1027155"> </a><a href="UI_BitmapConcept.html#1027156">Figure 9.3</a> shows the source data on the left, with low-density window coordinates for the top-left and bottom-right corners. The illustration on the right shows the result as displayed on the screen, with top-left coordinates scaled and bitmap data pixel-doubled.</p>
</ul>

<p class="FFigureCaption">
  <a name="1027156"> </a><b>Figure 9.3&nbsp;&nbsp;Low-density bitmap on a double-density screen</b>
</p>
<div align="left"><img src="images/Checkmarks.gif" border="0" hspace="0" vspace="0">
</div>
   <p><a name="1034429"> </a>Note that it's not necessary to use standard coordinates to display low-density bitmaps. The coordinate system only determines <i>where</i> the bitmap is displayed, not <i>how</i> the bitmap is displayed. The advantage to using standard coordinates is that you only have to compute one set of coordinates for all supported displays. </p>
<ul type="disc">
  <li><a name="1027161"> </a><i>An application draws a double-density bitmap to a double-density screen.</i>
   <p><a name="1027162"> </a>The source data is a 32 by 32 double-density bitmap:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
GcDrawBitmapAt(gc, bitmapH, NULL, 61, 45);<a name="1031265"> </a>
</pre><div class="CodeRule"><hr></div>

   <p><a name="1031323"> </a>By default, the Graphics Context functions use native coordinates, which in this case are double-density coordinates. The double-density coordinates (61, 45) allow the application to position the bitmap more precisely on the screen; these coordinates are equivalent to coordinates (30.5, 22.5) in the standard coordinate system.</p>
   <p><a name="1031391"> </a>Because the screen bitmap has the same density, the rendering system copies the source data to the screen unchanged.</p>
</ul>

<p class="FFigureCaption">
  <a name="1027167"> </a><b>Figure 9.4&nbsp;&nbsp;Double-density bitmap on a double-density screen</b>
</p>
<div align="left"><img src="images/OneCheckmark.gif" border="0" hspace="0" vspace="0">
</div>
<ul type="disc">
  <li><a name="1027185"> </a><i>An application draws a double-density bitmap to a low-density screen.</i>
   <p><a name="1027186"> </a>If an application includes only high-density bitmaps, the rendering system needs to shrink them when drawing them to the screen. The application can determine the screen density like this:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
uint32_t density;<a name="1027187"> </a>
err = WinScreenGetAttribute(winScreenDensity, &amp;density);<a name="1027188"> </a>
</pre><div class="CodeRule"><hr></div>

   <p><a name="1031861"> </a>Understanding that the destination is low density, the application uses the standard coordinate system:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
GcSetCoordinateSystem(gc, kCoordinatesStandard);<a name="1027190"> </a>
GcDrawBitmapAt(gc, bitmapH, NULL, 31, 23);<a name="1031869"> </a>
</pre><div class="CodeRule"><hr></div>

   <p><a name="1027191"> </a>Because the destination window is low density, and because the passed coordinates are standard coordinates, Palm OS does not scale the passed coordinates. The rendering system, however, recognizes that the source bitmap has a density of <code>kDensityDouble</code> and shrinks the data to one-half the original size when blitting it to the low-density screen.</p>
</ul>

<p class="FFigureCaption">
  <a name="1027192"> </a><b>Figure 9.5&nbsp;&nbsp;Double-density bitmap on a low-density screen</b>
</p>
<div align="left"><img src="images/HighToLow.gif" border="0" hspace="0" vspace="0">
</div>
   <p><a name="1034470"> </a>The result, shown in <a href="UI_BitmapConcept.html#1027192">Figure 9.5</a> on the right, is poor. Because of this, for an application to look good on both low and high-density screens it should include both low and high-density bitmaps.</p>

<h2 class="haH2">
  <a name="1032043"> </a>Summary of Bitmap Support <a href="#1005083"><span class="nav">^TOP^</span></a>
</h2>



<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1028102"> </a><b>Bitmap Functions</b></p>
    </th>
    <th><p class="tt"><a name="1028104"> </a><b></b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028990"> </a><b>Obtaining bitmap data</b></p>
    </td>
    <td><p class="tt"><a name="1028992"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028983"> </a><b><a href="UI_Bitmap.html#1028437"><code>BmpGetBits()</code></a></b></p>
    </td>
    <td><p class="tt"><a name="1028988"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028956"> </a><b>Working with bitmap families</b></p>
    </td>
    <td><p class="tt"><a name="1028958"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028946"> </a><b><a href="UI_Bitmap.html#995358"><code>BmpGetNextBitmap()</code></a></b></p>
    </td>
    <td><p class="tt"><a name="1028954"> </a><a href="UI_Bitmap.html#995465"><code>BmpGetNextBitmapAnyDensity()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028838"> </a><b>Creating and deleting bitmap</b></p>
    </td>
    <td><p class="tt"><a name="1028840"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028846"> </a><b><a href="UI_Bitmap.html#998464"><code>BmpCreate()</code></a><span style="color: #000000;  font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline"><br></span><a href="UI_Bitmap.html#994368"><code>BmpDelete()</code></a></b></p>
    </td>
    <td><p class="tt"><a name="1028848"> </a><a href="UI_Bitmap.html#993998"><code>BmpCreateBitmapV3()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028681"> </a><b>Obtaining size information</b></p>
    </td>
    <td><p class="tt"><a name="1028683"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028688"> </a><a href="UI_GraphicContext.html#1198394"><code>GcGetBitmapDensity()</code></a><br><a href="UI_GraphicContext.html#1198411"><code>GcGetBitmapDepth()</code></a><br><a href="UI_GraphicContext.html#1198428"><code>GcGetBitmapHeight()</code></a><br><a href="UI_GraphicContext.html#1198445"><code>GcGetBitmapWidth()</code></a></p>
    </td>
    <td><p class="tt"><a name="1028726"> </a><a href="UI_Bitmap.html#995507"><code>BmpGetSizes()</code></a><br><a href="UI_Bitmap.html#996129"><code>BmpSize()</code></a><br><a href="UI_Bitmap.html#995044"><code>BmpGetDimensions()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028871"> </a><b>Obtaining attributes</b></p>
    </td>
    <td><p class="tt"><a name="1028873"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028879"> </a><a href="UI_Bitmap.html#995607"><code>BmpGetVersion()</code></a><br><a href="UI_Bitmap.html#995561"><code>BmpGetTransparentValue()</code></a><br><a href="UI_Bitmap.html#994490"><code>BmpGetBitDepth()</code></a><br><a href="UI_Bitmap.html#1031003"><code>BmpGetPixelFormat()</code></a></p>
    </td>
    <td><p class="tt"><a name="1028881"> </a><a href="UI_Bitmap.html#994700"><code>BmpGetCompressionType()</code></a><br><a href="UI_Bitmap.html#995002"><code>BmpGetDensity()</code></a><br><a href="UI_GraphicContext.html#1198683"><code>GcIsBitmapAlphaOnly()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029002"> </a><b>Setting attributes</b></p>
    </td>
    <td><p class="tt"><a name="1029004"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028998"> </a><a href="UI_Bitmap.html#995733"><code>BmpSetDensity()</code></a></p>
    </td>
    <td><p class="tt"><a name="1029000"> </a><a href="UI_Bitmap.html#995779"><code>BmpSetTransparentValue()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029024"> </a><b>Compressing bitmaps</b></p>
    </td>
    <td><p class="tt"><a name="1029026"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029028"> </a><a href="UI_Bitmap.html#993610"><code>BmpCompress()</code></a></p>
    </td>
    <td><p class="tt"><a name="1029030"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028788"> </a><b>Obtaining color table information</b></p>
    </td>
    <td><p class="tt"><a name="1028790"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028778"> </a><a href="UI_Bitmap.html#993312"><code>BmpColortableSize()</code></a><br><a href="UI_Bitmap.html#1004865"><code>ColorTableEntries()</code></a></p>
    </td>
    <td><p class="tt"><a name="1028786"> </a><a href="UI_Bitmap.html#994658"><code>BmpGetColortable()</code></a><br></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1032071"> </a><b>Drawing bitmaps</b></p>
    </td>
    <td><p class="tt"><a name="1032073"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1032079"> </a><a href="UI_GraphicContext.html#994782"><code>GcCreateBitmapContext()</code></a><br><a href="UI_GraphicContext.html#1170306"><code>GcDrawBitmapAt()</code></a><br><a href="UI_GraphicContext.html#994064"><code>GcReleaseContext()</code></a></p>
    </td>
    <td><p class="tt"><a name="1032081"> </a><a href="UI_GraphicContext.html#1170306"><code>GcDrawBitmapAt()</code></a><br><a href="UI_GraphicContext.html#1171079"><code>GcReleaseBitmap()</code></a><br><a href="UI_GraphicContext.html#1120182"><code>GcPaintBitmap()</code></a></p>
    </td>
  </tr>
</table>

</div>


<p><a name="1003252"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 2003&#8211;2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="UI_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="UI_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_Drawing.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_UIColorListConcept.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="UI_IX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>