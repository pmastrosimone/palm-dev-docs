<html>
<head>
<title>(Protein) Expansion Manager | System Management</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 11:27:36">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="992934"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="SysMgt_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ErrTryCatch.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="FatalAlert.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SysMgt_IX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">25 &nbsp;&nbsp;
Expansion Manager</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">System Management</p>
<p class="SubTitle">Exploring Palm OS&#174; </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="SysMgt_Part2.html">Part II: Reference</a> </h1>
<h1 class="SideTOC1"><a href="ExpansionMgr.html">25  Expansion Manager</a></h1>

   <h2 class="SideTOC2"><a href="#992942">
   Expansion Manager Structures and Types</a></h2>

      <h3 class="SideTOC3"><a href="#1016914">
      CardMetricsType</a></h3>

      <h3 class="SideTOC3"><a href="#992980">
      ExpCardInfoType</a></h3>

   <h2 class="SideTOC2"><a href="#993232">
   Expansion Manager Constants</a></h2>

      <h3 class="SideTOC3"><a href="#996523">
      Expansion Manager Error Codes</a></h3>

      <h3 class="SideTOC3"><a href="#999014">
      Defined Media Types</a></h3>

      <h3 class="SideTOC3"><a href="#1000032">
      Capability Flags</a></h3>

      <h3 class="SideTOC3"><a href="#1001674">
      Enumeration Constants</a></h3>

      <h3 class="SideTOC3"><a href="#1017852">
      Partition Type Flags</a></h3>

      <h3 class="SideTOC3"><a href="#993264">
      Miscellaneous Expansion Manager Constants</a></h3>

   <h2 class="SideTOC2"><a href="#993484">
   Expansion Manager Functions and Macros</a></h2>

      <h3 class="SideTOC3"><a href="#993765">
      ExpCardInfo</a></h3>

      <h3 class="SideTOC3"><a href="#993811">
      ExpCardIsFilesystemSupported</a></h3>

      <h3 class="SideTOC3"><a href="#993861">
      ExpCardMediaType</a></h3>

      <h3 class="SideTOC3"><a href="#993907">
      ExpCardMetrics</a></h3>

      <h3 class="SideTOC3"><a href="#994237">
      ExpCardPresent</a></h3>

      <h3 class="SideTOC3"><a href="#994428">
      ExpCardSectorRead</a></h3>

      <h3 class="SideTOC3"><a href="#994521">
      ExpCardSectorWrite</a></h3>

      <h3 class="SideTOC3"><a href="#994583">
      ExpSlotCustomControl</a></h3>

      <h3 class="SideTOC3"><a href="#995065">
      ExpSlotEnumerate</a></h3>

      <h3 class="SideTOC3"><a href="#995429">
      ExpSlotMediaType</a></h3>

      <h3 class="SideTOC3"><a href="#995475">
      ExpSlotPowerCheck</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="992936"> </a>This chapter contains reference material for the Expansion Manager, which applications use to work with the handheld's expansion slots. Note that to perform filesystem operations on the media in the slot you use the VFS Manager, which is documented in <i>Exploring Palm OS: Memory, Databases, and Files</i>.</p>

<p><a name="1013682"> </a>This chapter is organized into the following sections:</p>
   <blockquote class = "bq"><a name="992948"> </a><a href="ExpansionMgr.html#992942">Expansion Manager Structures and Types</a></blockquote>
   <blockquote class = "bq"><a name="993238"> </a><a href="ExpansionMgr.html#993232">Expansion Manager Constants</a></blockquote>
   <blockquote class = "bq"><a name="993499"> </a><a href="ExpansionMgr.html#993484">Expansion Manager Functions and Macros</a></blockquote>

<p><a name="992938"> </a>The header file <code>ExpansionMgr.h</code> declares the API that this chapter describes.</p>

<p><a name="992940"> </a>For basic Expansion Manager concepts and instructions on using the Expansion Manager APIs, see <a href="Expansion.html#1000865">Chapter 5, "Expansion."</a></p>

<h2 class="haH2">
  <a name="992942"> </a>Expansion Manager Structures and Types <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="1016914"> </a>CardMetricsType Struct <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1016916"> </a>Purpose 
</h4>

<p><a name="1016917"> </a>Contains information about the physical structure of the card: the type of information that may be needed by a file system in order to format volumes on the card, for instance. This structure is passed as a parameter in <a href="ExpansionMgr.html#993907"><code>ExpCardMetrics()</code></a>.</p>
<h4>
  <a name="1016921"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="1017166"> </a></code><h4>
  <a name="1016923"> </a>Prototype 
</h4>
<pre class="proto"><a name="1016924"></a>typedef struct CardMetricsTag {
   uint32_t totalSectors;
   uint16_t bytesPerSector;
   uint16_t sectorsPerHead;
   uint16_t headsPerCylinder;
   uint16_t reserved1;
   uint8_t sectorsPerBlock;
   uint8_t partitionType;
   uint8_t bootIndicator;
   uint8_t reserved2;
   uint32_t partitionStart;
   uint32_t partitionSize;
} CardMetricsType, *CardMetricsPtr
</pre>
<h4>
  <a name="1016925"> </a>Fields 
</h4>

<dl>
<dt><a name="1016926"> </a><code>totalSectors</code></dt>
<dd><a name="1016927"> </a>The total number of sectors accessible. Some media may contain extra sectors in case one goes bad, or for storing configuration information, but they are handled internally to the block device driver, and not accessible to applications.</dd>

<dt><a name="1016934"> </a><code>bytesPerSector</code></dt>
<dd><a name="1016935"> </a>The number of bytes in one sector. Currently for Palm OS, this must be 512.</dd>

<dt><a name="1016936"> </a><code>sectorsPerHead</code></dt>
<dd><a name="1016937"> </a>The number of Sectors per Head as given by guidelines in the specification for this media type. Even though all Palm OS disk accesses are LBA, this is for compatibility when filling out MBRs and PBRs. If the media guidelines don't specify, this value is set to 0.</dd>

<dt><a name="1016938"> </a><code>headsPerCylinder</code></dt>
<dd><a name="1016939"> </a>The number of Heads per Cylinder as given by guidelines in the specification for this media type. Even though all Palm OS disk accesses are LBA, this is for compatibility when filling out MBRs and PBRs. If the media guidelines don't specify, this value is set to 0.</dd>

<dt><a name="1016940"> </a><code>reserved1</code></dt>
<dd><a name="1016941"> </a>Reserved</dd>

<dt><a name="1016942"> </a><code>sectorsPerBlock</code></dt>
<dd><a name="1016943"> </a>A suggested number of Sectors per Block (Cluster) as given by guidelines in the specification for this media type. If the media guidelines don't specify, this value is set to 0.</dd>

<dt><a name="1016944"> </a><code>partitionType</code></dt>
<dd><a name="1016945"> </a>The suggested partition type (System ID) of the first partition as given by guidelines in the specification for this media type. If the media guidelines don't specify, this value is set to <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">slotDrvrNonBootablePartition</span>. See <a href="ExpansionMgr.html#1017852">"Partition Type Flags"</a> for a list of defined partition types.</dd>

<dt><a name="1016946"> </a><code>bootIndicator</code></dt>
<dd><a name="1016947"> </a>The suggested bootability of the first partition as given by guidelines in the specification for this media type. Generally, <code>0x80</code> (<span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">slotDrvrBootablePartition)</span>is bootable, while the default boot partition <code>0x00</code> (<span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">slotDrvrNonBootablePartition</span>) is not-bootable. If the media guidelines don't specify, this value is set to <code>0xFF</code>.</dd>

<dt><a name="1016948"> </a><code>reserved2</code></dt>
<dd><a name="1016949"> </a>Reserved</dd>

<dt><a name="1016950"> </a><code>partitionStart</code></dt>
<dd><a name="1016951"> </a>The suggested starting sector of the first partition as given by guidelines in the specification for this media type. If this value is set to zero, and the partition size value is non-zero, the media guidelines suggest to not use an MBR, and only use a PBR at sector 0. If the media guidelines don't specify, the partition size value is set to 0.</dd>

<dt><a name="1016952"> </a><code>partitionSize</code></dt>
<dd><a name="1016953"> </a>The suggested size of the first partition as given by guidelines in the specification for this media type. If the media guidelines don't specify, this value is set to 0, and the partition start parameter is ignored.</dd>

</dl>

<h3 class="hbH3">
  <a name="992980"> </a>ExpCardInfoType Struct <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="992985"> </a>Purpose 
</h4>

<p><a name="996101"> </a>The <code>ExpCardInfoType</code> declaration defines a structure that is passed to <a href="ExpansionMgr.html#993765"><code>ExpCardInfo()</code></a>. This structure is used to determine the characteristics of the card loaded in the slot. It is initialized by the underlying block device driver with the following information. </p>
<h4>
  <a name="992990"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="992993"> </a></code><h4>
  <a name="992995"> </a>Prototype 
</h4>
<pre class="proto"><a name="992998"></a>typedef struct ExpCardInfoTag {
   uint32_t capabilityFlags;
   char 
manufacturerStr[expCardInfoStringMaxLen+1];
   char productStr[expCardInfoStringMaxLen+1];
   char deviceClassStr[expCardInfoStringMaxLen+1];
   char 
deviceUniqueIDStr[expCardInfoStringMaxLen+1];
} ExpCardInfoType, *ExpCardInfoPtr
</pre>
<h4>
  <a name="993012"> </a>Fields 
</h4>

<dl>
<dt><a name="993063"> </a><code>capabilityFlags</code></dt>
<dd><a name="996161"> </a>Describes the capabilities of the card. See <a href="ExpansionMgr.html#1000032">"Capability Flags"</a> for the set of flags that are currently supported.</dd>

<dt><a name="993163"> </a><code>manufacturerStr</code></dt>
<dd><a name="993213"> </a>Names the manufacturer of the card. For example "Palm" or "Motorola".</dd>

<dt><a name="993215"> </a><code>productStr</code></dt>
<dd><a name="993217"> </a>Name of the product. For example "SafeBackup 32MB".</dd>

<dt><a name="993219"> </a><code>deviceClassStr</code></dt>
<dd><a name="993221"> </a>Describes the type of card, for example, "Backup" or "Ethernet".</dd>

<dt><a name="993223"> </a><code>deviceUniqueIDStr</code></dt>
<dd><a name="993225"> </a>Unique identifier for the product. A serial number for example. This value is set to the empty string if no identifier exists.</dd>

</dl>

<h2 class="haH2">
  <a name="993232"> </a>Expansion Manager Constants <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="996523"> </a>Expansion Manager Error Codes <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996748"> </a>Purpose 
</h4>

<p><a name="996859"> </a>Error codes returned by the various Expansion Manager functions.</p>
<h4>
  <a name="996978"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="997403"> </a></code><h4>
  <a name="997502"> </a>Constants 
</h4>

<dl>
<dt><a name="998648"> </a><code>#define expErrCardBadSector (expErrorClass | 8)</code></dt>
<dd><a name="998649"> </a>The card supports the block device driver block read/write API but the sector is bad.</dd>

<dt><a name="998651"> </a><code>#define expErrCardNoSectorReadWrite (expErrorClass | 6)</code></dt>
<dd><a name="998652"> </a>The card does not support the block device driver block read/write API.</dd>

<dt><a name="998654"> </a><code>#define expErrCardNotPresent (expErrorClass | 3)</code></dt>
<dd><a name="998655"> </a>There is no card present in the given slot.</dd>

<dt><a name="998657"> </a><code>#define expErrCardProtectedSector (expErrorClass | 9)</code></dt>
<dd><a name="998658"> </a>The card supports the block device driver block read/write API but the sector is protected.</dd>

<dt><a name="998660"> </a><code>#define expErrCardReadOnly (expErrorClass | 7)</code></dt>
<dd><a name="998661"> </a>The card supports the block device driver block read/write API but the card is read only.</dd>

<dt><a name="998663"> </a><code>#define expErrEnumerationEmpty (expErrorClass | 13)</code></dt>
<dd><a name="998664"> </a>There are no values remaining to enumerate.</dd>

<dt><a name="998666"> </a><code>#define expErrIncompatibleAPIVer (expErrorClass | 14)</code></dt>
<dd><a name="998667"> </a>The API version of the underlying block device driver is not supported by this version of Expansion Manager.</dd>

<dt><a name="998669"> </a><code>#define expErrInvalidSlotRefNum (expErrorClass | 4)</code></dt>
<dd><a name="998670"> </a>The slot reference number is not valid.</dd>

<dt><a name="998672"> </a><code>#define expErrNotEnoughPower (expErrorClass | 2)</code></dt>
<dd><a name="998673"> </a>The required power is not available.</dd>

<dt><a name="998675"> </a><code>#define expErrNotOpen (expErrorClass | 10)</code></dt>
<dd><a name="998676"> </a>The block device driver library has not been opened.</dd>

<dt><a name="998678"> </a><code>#define expErrSlotDeallocated (expErrorClass | 5)</code></dt>
<dd><a name="998679"> </a>The slot reference number is within the valid range, but the slot has been deallocated.</dd>

<dt><a name="998681"> </a><code>#define expErrStillOpen (expErrorClass | 11)</code></dt>
<dd><a name="998682"> </a>The block device driver library is still open; it may have been opened more than once.</dd>

<dt><a name="998684"> </a><code>#define expErrUnimplemented (expErrorClass | 12)</code></dt>
<dd><a name="998685"> </a>The call is unimplemented.</dd>

<dt><a name="998687"> </a><code>#define expErrUnsupportedOperation (expErrorClass | 1)</code></dt>
<dd><a name="998688"> </a>The operation is unsupported or undefined.</dd>

</dl>

<h3 class="hbH3">
  <a name="999014"> </a>Defined Media Types <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="999019"> </a>Purpose 
</h4>

<p><a name="999032"> </a>The following media types are defined by the Expansion Manager. These media types are used with the function <a href="../Memory_Databases_Files/VFSMgr.html#997667"><code>VFSVolumeInfo()</code></a> in the <code>VolumeInfoType.mediaType</code> field. The media type is also passed as a parameter to the <a href="../Memory_Databases_Files/VFSMgr.html#997241"><code>VFSRegisterDefaultDirectory()</code></a> and <a href="../Memory_Databases_Files/VFSMgr.html#997400"><code>VFSUnregisterDefaultDirectory()</code></a> functions.</p>
<h4>
  <a name="999140"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="999183"> </a></code><h4>
  <a name="999216"> </a>Constants 
</h4>

<dl>
<dt><a name="999855"> </a><code>#define expMediaType_Any 'wild'</code></dt>
<dd><a name="999856"> </a>Matches all media types when looking up a default directory</dd>

<dt><a name="999858"> </a><code>#define expMediaType_CompactFlash 'cfsh'</code></dt>
<dd><a name="999859"> </a>Compact Flash</dd>

<dt><a name="999861"> </a><code>#define expMediaType_MacSim 'PSim'</code></dt>
<dd><a name="999862"> </a>Host file system emulated by the Mac Simulator</dd>

<dt><a name="999864"> </a><code>#define expMediaType_MemoryStick 'mstk'</code></dt>
<dd><a name="999865"> </a>Memory stick</dd>

<dt><a name="999867"> </a><code>#define expMediaType_MultiMediaCard 'mmcd'</code></dt>
<dd><a name="999868"> </a>MultiMedia Card</dd>

<dt><a name="999870"> </a><code>#define expMediaType_PoserHost 'pose'</code></dt>
<dd><a name="999871"> </a>Host file system emulated by the Palm OS<sup>&#174;</sup> Emulator</dd>

<dt><a name="999873"> </a><code>#define expMediaType_RAMDisk 'ramd'</code></dt>
<dd><a name="999874"> </a>A RAM disk based media</dd>

<dt><a name="999876"> </a><code>#define expMediaType_SecureDigital 'sdig'</code></dt>
<dd><a name="999877"> </a>Secure Digital </dd>

<dt><a name="999879"> </a><code>#define expMediaType_SmartMedia 'smed'</code></dt>
<dd><a name="999880"> </a>SmartMedia </dd>

</dl>

<h3 class="hbH3">
  <a name="1000032"> </a>Capability Flags <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1000041"> </a>Purpose 
</h4>

<p><a name="1000064"> </a>Describes the capabilities of the expansion card.</p>
<h4>
  <a name="1000073"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="1000084"> </a></code><h4>
  <a name="1000093"> </a>Constants 
</h4>

<dl>
<dt><a name="1000125"> </a><code>#define expCapabilityHasStorage (0x00000001)</code></dt>
<dd><a name="1000126"> </a>The card supports reading and (possibly) writing.</dd>

<dt><a name="1000128"> </a><code>#define expCapabilityReadOnly (0x00000002)</code></dt>
<dd><a name="1000129"> </a>The card is read only.</dd>

<dt><a name="1000131"> </a><code>#define expCapabilitySerial (0x00000004)</code></dt>
<dd><a name="1000132"> </a>The card supports a simple serial interface.</dd>

</dl>

<h3 class="hbH3">
  <a name="1001674"> </a>Enumeration Constants <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1001694"> </a>Purpose 
</h4>

<p><a name="1001800"> </a>Control the process of slot enumeration when using <a href="ExpansionMgr.html#995065"><code>ExpSlotEnumerate()</code></a>.</p>
<h4>
  <a name="1001816"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="1001836"> </a></code><h4>
  <a name="1001875"> </a>Constants 
</h4>

<dl>
<dt><a name="1002293"> </a><code>#define expIteratorStart (0L)</code></dt>
<dd><a name="1002294"> </a>Supply this value to <a href="ExpansionMgr.html#995065"><code>ExpSlotEnumerate()</code></a> to begin enumeration.</dd>

<dt><a name="1002296"> </a><code>#define expIteratorStop (0xffffffffL)</code></dt>
<dd><a name="1002297"> </a>When enumeration reaches the last slot, <a href="ExpansionMgr.html#995065"><code>ExpSlotEnumerate()</code></a> sets its slot iterator parameter to this value.</dd>

<dt><a name="1002586"> </a><code>#define expInvalidSlotRefNum (0)</code></dt>
<dd><a name="1002592"> </a>When enumerating slots, if the handheld has no expansion slots <a href="ExpansionMgr.html#995065"><code>ExpSlotEnumerate()</code></a> sets its slot reference number parameter to this value.</dd>

</dl>

<h3 class="hbH3">
  <a name="1017852"> </a>Partition Type Flags <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1017988"> </a>Purpose 
</h4>

<p><a name="1018126"> </a>The suggested partition type (System ID) of the first partition as given by guidelines in the specification for the media type.</p>
<h4>
  <a name="1018168"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="1018306"> </a></code><h4>
  <a name="1018344"> </a>Constants 
</h4>

<dl>
<dt><a name="1019085"> </a><code>#define slotDrvrBootablePartition (0x80)</code></dt>
<dd><a name="1019237"> </a>The partition is bootable.</dd>

<dt><a name="1019318"> </a><code>#define slotDrvrNonBootablePartition (0x00)</code></dt>
<dd><a name="1019364"> </a>The partition is non-bootable. </dd>

<dt><a name="1019319"> </a><code>#define slotDrvrPartitionTypeFAT12 (0x01)</code></dt>
<dd><a name="1019396"> </a>The partition is formatted as FAT12.</dd>

<dt><a name="1019320"> </a><code>#define slotDrvrPartitionTypeFAT16Over32MB (0x06)</code></dt>
<dd><a name="1019428"> </a>The partition is formatted as FAT16 and exceeds 32 MB.</dd>

<dt><a name="1019089"> </a><code>#define slotDrvrPartitionTypeFAT16Under32MB (0x04)</code></dt>
<dd><a name="1019452"> </a>The partition is formatted as FAT16 but is less than 32 MB in size.</dd>

<dt><a name="1028873"> </a><code>#define slotDrvrPartitionTypeFAT32 (0x0b)</code></dt>
<dd><a name="1028874"> </a>The partition is formatted as FAT32.</dd>

</dl>
<h4>
  <a name="1019988"> </a>Comments 
</h4>

<p><a name="1020113"> </a>The partition type is returned in the <code>partitionType</code> field of the <a href="ExpansionMgr.html#1016914"><code>CardMetricsType</code></a> structure by a call to <a href="ExpansionMgr.html#993907"><code>ExpCardMetrics()</code></a>. The returned value is a combination of one of the <code>slotDrvrPartitionType...</code> flags and either <code>slotDrvrBootablePartition</code> or <code>slotDrvrNonBootablePartition</code>. A value of zero (equivalent to <code>slotDrvrNonBootablePartition</code>) is returned if the media guidelines don't specify a partition type.</p>

<h3 class="hbH3">
  <a name="993264"> </a>Miscellaneous Expansion Manager Constants <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993266"> </a>Purpose 
</h4>

<p><a name="993269"> </a>The Expansion Manager also defines these constants.</p>
<h4>
  <a name="993271"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="993274"> </a></code><h4>
  <a name="993276"> </a>Constants 
</h4>

<dl>
<dt><a name="993303"> </a><code>#define expCardInfoStringMaxLen (31)</code></dt>
<dd><a name="993305"> </a>Maximum length (not including the terminating null character) of the strings in the <a href="ExpansionMgr.html#992980"><code>ExpCardInfoType</code></a> structure.</dd>

<dt><a name="993379"> </a><code>#define expFtrIDVersion (0)</code></dt>
<dd><a name="1002862"> </a>To obtain the version of the Expansion Manager, call <a href="FeatureMgr.html#992990"><code>FtrGet()</code></a> , supplying a feature creator of <code>sysFileCExpansionMgr</code> and this constant for the feature number.</dd>

<dt><a name="993383"> </a><code>#define expHandledSound (0x02)</code></dt>
<dd><a name="993385"> </a></dd>

<dt><a name="993387"> </a><code>#define expHandledVolume (0x01)</code></dt>
<dd><a name="993389"> </a></dd>

<dt><a name="993451"> </a><code>#define expMgrVersionNum ((uint16_t)300)</code></dt>
<dd><a name="1002994"> </a>The current version of the Expansion Manager. To obtain the version of the Expansion Manager running on the handheld, call <a href="FeatureMgr.html#992990"><code>FtrGet()</code></a>, supplying a feature creator of <code>sysFileCExpansionMgr</code> and a feature number of <code>expFtrIDVersion</code>.</dd>

</dl>

<h2 class="haH2">
  <a name="993484"> </a>Expansion Manager Functions and Macros <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="993765"> </a>ExpCardInfo Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993770"> </a>Purpose 
</h4>

<p><a name="993773"> </a>Obtains information about a card in a given slot.</p>
<h4>
  <a name="993775"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="993778"> </a></code><h4>
  <a name="993780"> </a>Prototype 
</h4>
<pre class="proto"><a name="993783"></a>status_t ExpCardInfo (
   uint16_t <code class="par">slotRefNum</code>,
   ExpCardInfoType <code class="par">*infoP</code>
)
</pre>
<h4>
  <a name="993785"> </a>Parameters 
</h4>

<dl>
<dt><a name="993788"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="993790"> </a>Slot number.</dd>

<dt><a name="993792"> </a><code>&larr;  <i>infoP</i></code></dt>
<dd><a name="993794"> </a>Pointer to <a href="ExpansionMgr.html#992980"><code>ExpCardInfoType</code></a> structure. </dd>

</dl>
<h4>
  <a name="993796"> </a>Returns 
</h4>

<p><a name="1003468"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1003529"> </a><code><code>expErrCardNotPresent</code></code></dt>
<dd><a name="1003675"> </a>There is no card present in the specified slot.</dd>

<dt><a name="1003469"> </a><code><code>expErrInvalidSlotRefNum</code></code></dt>
<dd><a name="1003470"> </a>The specified slot number is invalid.</dd>

<dt><a name="1003471"> </a><code><code>expErrSlotDeallocated</code></code></dt>
<dd><a name="1003472"> </a>The specified slot number is within the valid range but has been deallocated.</dd>

</dl>
<h4>
  <a name="993801"> </a>Comments 
</h4>

<p><a name="1003789"> </a>This function returns information about a card, including whether the card supports secondary storage or is strictly read-only, by filling in the <code>ExpCardInfoType</code> structure's fields.</p>
<h4>
  <a name="993806"> </a>See Also 
</h4>

<p><a name="1003851"> </a><a href="ExpansionMgr.html#994237"><code>ExpCardPresent()</code></a>, <a href="ExpansionMgr.html#995065"><code>ExpSlotEnumerate()</code></a></p>

<h3 class="hbH3">
  <a name="993811"> </a>ExpCardIsFilesystemSupported Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993820"> </a>Purpose 
</h4>

<p><a name="993823"> </a>Determine whether a particular file system type is natively supported by the media in the defined slot.</p>
<h4>
  <a name="993825"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="993828"> </a></code><h4>
  <a name="993830"> </a>Prototype 
</h4>
<pre class="proto"><a name="993833"></a>Boolean ExpCardIsFilesystemSupported (
   uint16_t <code class="par">slotRefNum</code>,
   uint32_t <code class="par">filesystemType</code>
)
</pre>
<h4>
  <a name="993835"> </a>Parameters 
</h4>

<dl>
<dt><a name="993838"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="993840"> </a>Slot reference number.</dd>

<dt><a name="993842"> </a><code>&rarr;  <i>filesystemType</i></code></dt>
<dd><a name="993844"> </a>One of the file system types that this library implements. See <a href="../Memory_Databases_Files/VFSMgr.html#1011713">"Defined File Systems"</a> in the VFS Manager chapter of <i>Exploring Palm OS: Memory, Databases, and Files</i> for a list of file system types.</dd>

</dl>
<h4>
  <a name="993846"> </a>Returns 
</h4>

<p><a name="993849"> </a>Returns <code>true</code> if the specified file system is supported, or <code>false</code> if either the file system is not supported or if an error occurred.</p>
<h4>
  <a name="993851"> </a>Comments 
</h4>

<p><a name="1010870"> </a><i>Native support</i> means that formatting the media for another type of file system will probably break the media when used with other devices (such as digital cameras, voice recorders etc.) for which it was designed.</p>

<p><a name="1010871"> </a>The VFS Manager uses this function to determine the best file system to be used when formatting media in a slot, and to warn the user before formatting media with an incompatible type. </p>

<h3 class="hbH3">
  <a name="993861"> </a>ExpCardMediaType Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993866"> </a>Purpose 
</h4>

<p><a name="993869"> </a>Determine the media type of the card in the given slot.</p>
<h4>
  <a name="993871"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="993874"> </a></code><h4>
  <a name="993876"> </a>Prototype 
</h4>
<pre class="proto"><a name="993879"></a>status_t ExpCardMediaType (
   uint16_t <code class="par">slotRefNum</code>,
   uint32_t <code class="par">*mediaTypeP</code>
)
</pre>
<h4>
  <a name="993881"> </a>Parameters 
</h4>

<dl>
<dt><a name="993884"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="993886"> </a>Slot reference number.</dd>

<dt><a name="1012183"> </a><code>&larr;  <i>mediaTypeP</i></code></dt>
<dd><a name="1012230"> </a>Set to the media type of the card in the given slot. See <a href="ExpansionMgr.html#999014">"Defined Media Types"</a> for a list of possible media types.</dd>

</dl>
<h4>
  <a name="1012185"> </a>Returns 
</h4>

<p><a name="1012254"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1012255"> </a><code><code>expErrNotOpen</code></code></dt>
<dd><a name="1012256"> </a>Block device driver library has not been opened</dd>

<dt><a name="1012257"> </a><code><code>expErrInvalidSlotRefNum</code></code></dt>
<dd><a name="1012258"> </a>Slot reference number is not valid.</dd>

<dt><a name="1012259"> </a><code>expErrCardNotPresent</code></dt>
<dd><a name="1012260"> </a>No card is present in the specified slot.</dd>

</dl>
<h4>
  <a name="993897"> </a>Comments 
</h4>

<p><a name="1012359"> </a>This function sets the <code class="par">mediaTypeP</code> to reflect the kind of media that is in the slot. Supported media types are defined in <code>ExpansionMgr.h</code>. The media type is used by <a href="../Memory_Databases_Files/VFSMgr.html#997667"><code>VFSVolumeInfo()</code></a>, <a href="../Memory_Databases_Files/VFSMgr.html#997241"><code>VFSRegisterDefaultDirectory()</code></a>, and <a href="../Memory_Databases_Files/VFSMgr.html#997400"><code>VFSUnregisterDefaultDirectory()</code></a> (see <i>Exploring Palm OS: Memory, Databases, and Files</i> for information on the VFS Manager).</p>
<h4>
  <a name="993902"> </a>See Also 
</h4>

<p><a name="1011593"> </a><a href="ExpansionMgr.html#995429"><code>ExpSlotMediaType()</code></a></p>

<h3 class="hbH3">
  <a name="993907"> </a>ExpCardMetrics Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993912"> </a>Purpose 
</h4>

<p><a name="993915"> </a>Get all of the information about the physical structure of the card. The returned information is of the type that may be needed by a file system in order to format volumes on the card.</p>
<h4>
  <a name="993917"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="993934"> </a></code><h4>
  <a name="993954"> </a>Prototype 
</h4>
<pre class="proto"><a name="993991"></a>status_t ExpCardMetrics (
   uint16_t <code class="par">slotRefNum</code>,
   CardMetricsPtr <code class="par">cardMetricsP</code>
)
</pre>
<h4>
  <a name="994051"> </a>Parameters 
</h4>

<dl>
<dt><a name="994094"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="994136"> </a>Slot reference number.</dd>

<dt><a name="994178"> </a><code>&larr;  <i>cardMetricsP</i></code></dt>
<dd><a name="994220"> </a>Filled in on return with information on the physical layout of the card. Note that if the <code>reservedRangesP</code> field of this structure is filled in, it is the responsibility of the caller to dispose of this memory allocated by this function. Refer to <a href="ExpansionMgr.html#1016914">"CardMetricsType"</a> for a description of the fields in this structure.</dd>

</dl>
<h4>
  <a name="994222"> </a>Returns 
</h4>

<p><a name="1010427"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1010428"> </a><code><code>expErrNotOpen</code></code></dt>
<dd><a name="1010429"> </a>Block device driver library has not been opened</dd>

<dt><a name="1010430"> </a><code><code>expErrInvalidSlotRefNum</code></code></dt>
<dd><a name="1010431"> </a>Slot reference number is not valid.</dd>

<dt><a name="1010526"> </a><code>expErrCardNotPresent</code></dt>
<dd><a name="1010532"> </a>No card is present in the specified slot.</dd>

</dl>
<h4>
  <a name="994232"> </a>See Also 
</h4>

<p><a name="1010556"> </a><a href="ExpansionMgr.html#994521"><code>ExpCardSectorWrite()</code></a></p>

<h3 class="hbH3">
  <a name="994237"> </a>ExpCardPresent Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="994242"> </a>Purpose 
</h4>

<p><a name="994245"> </a>Determines if a card is present in the given slot. </p>
<h4>
  <a name="994247"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="994250"> </a></code><h4>
  <a name="994252"> </a>Prototype 
</h4>
<pre class="proto"><a name="994255"></a>status_t ExpCardPresent (
   uint16_t <code class="par">slotRefNum</code>
)
</pre>
<h4>
  <a name="994257"> </a>Parameters 
</h4>

<dl>
<dt><a name="994260"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="994262"> </a>Slot number.</dd>

</dl>
<h4>
  <a name="994264"> </a>Returns 
</h4>

<p><a name="1003932"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1003933"> </a><code><code>expErrCardNotPresent</code></code></dt>
<dd><a name="1003934"> </a>There is no card present in the specified slot.</dd>

<dt><a name="1003935"> </a><code><code>expErrInvalidSlotRefNum</code></code></dt>
<dd><a name="1003936"> </a>The specified slot number is invalid.</dd>

<dt><a name="1003937"> </a><code><code>expErrSlotDeallocated</code></code></dt>
<dd><a name="1003938"> </a>The specified slot number is within the valid range but has been deallocated.</dd>

</dl>
<h4>
  <a name="994269"> </a>Comments 
</h4>

<p><a name="1003975"> </a>The Expansion Manager passes the call through to the appropriate block device driver.</p>
<h4>
  <a name="994274"> </a>See Also 
</h4>

<p><a name="1003985"> </a><a href="ExpansionMgr.html#993765"><code>ExpCardInfo()</code></a>, <a href="ExpansionMgr.html#995065"><code>ExpSlotEnumerate()</code></a></p>

<h3 class="hbH3">
  <a name="994428"> </a>ExpCardSectorRead Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="994433"> </a>Purpose 
</h4>

<p><a name="1008609"> </a>Read contiguous 512-byte sectors from the card in a specified slot.</p>
<h4>
  <a name="994438"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="994441"> </a></code><h4>
  <a name="994443"> </a>Prototype 
</h4>
<pre class="proto"><a name="994446"></a>status_t ExpCardSectorRead (
   uint16_t <code class="par">slotRefNum</code>,
   uint32_t <code class="par">sectorNumber</code>,
   uint8_t <code class="par">*bufferP</code>,
   uint32_t <code class="par">*numSectorsP</code>
)
</pre>
<h4>
  <a name="994448"> </a>Parameters 
</h4>

<dl>
<dt><a name="994451"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="1008617"> </a>Slot reference number.</dd>

<dt><a name="994455"> </a><code>&rarr;  <i>sectorNumber</i></code></dt>
<dd><a name="1008621"> </a>The sector from which to start reading.</dd>

<dt><a name="994459"> </a><code>&larr;  <i>bufferP</i></code></dt>
<dd><a name="994461"> </a>Buffer that will receive the sectors read from the card. This buffer must be a multiple of 512 bytes long.</dd>

<dt><a name="994463"> </a><code>&harr;  <i>numSectorsP</i></code></dt>
<dd><a name="1008639"> </a>When calling this function, set this to the number of sectors to read. Upon return, it is set to the number of sectors actually read.</dd>

</dl>
<h4>
  <a name="994467"> </a>Returns 
</h4>

<p><a name="1009170"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009171"> </a><code><code>expErrNotOpen</code></code></dt>
<dd><a name="1009172"> </a>Block device driver library has not been opened</dd>

<dt><a name="1009173"> </a><code><code>expErrInvalidSlotRefNum</code></code></dt>
<dd><a name="1009174"> </a>Slot reference number is not valid.</dd>

<dt><a name="1009175"> </a><code><code>expErrCardNoSectorReadWrite</code></code></dt>
<dd><a name="1009176"> </a>The card does not support the block read/write API.</dd>

<dt><a name="1009179"> </a><code>expErrCardBadSector</code></dt>
<dd><a name="1009180"> </a>One of the requested sectors is bad.</dd>

<dt><a name="1009181"> </a><code>expErrCardProtectedSector</code></dt>
<dd><a name="1009182"> </a>One of the requested sectors is protected.</dd>

<dt><a name="1009183"> </a><code><code>expErrCardNotPresent</code></code></dt>
<dd><a name="1009184"> </a>No card is present.</dd>

</dl>
<h4>
  <a name="994486"> </a>Comments 
</h4>

<p><a name="1009054"> </a>This function is used by the file system library to read data from the media. Information such as the MBR, PBR, Volume Label, and data itself are all obtained using this function. Applications normally use one of the VFS Manager read functions, which in turn call this one. </p>
<h4>
  <a name="994500"> </a>See Also 
</h4>

<p><a name="1009115"> </a><a href="ExpansionMgr.html#994521"><code>ExpCardSectorWrite()</code></a></p>

<h3 class="hbH3">
  <a name="994521"> </a>ExpCardSectorWrite Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="994534"> </a>Purpose 
</h4>

<p><a name="994537"> </a>Write contiguous 512-byte sectors to the card in a specified slot.</p>
<h4>
  <a name="994539"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="994542"> </a></code><h4>
  <a name="994544"> </a>Prototype 
</h4>
<pre class="proto"><a name="994547"></a>status_t ExpCardSectorWrite (
   uint16_t <code class="par">slotRefNum</code>,
   uint32_t <code class="par">sectorNumber</code>,
   uint8_t <code class="par">*bufferP</code>,
   uint32_t <code class="par">*numSectorsP</code>
)
</pre>
<h4>
  <a name="994549"> </a>Parameters 
</h4>

<dl>
<dt><a name="994552"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="994554"> </a>Slot reference number.</dd>

<dt><a name="994556"> </a><code>&rarr;  <i>sectorNumber</i></code></dt>
<dd><a name="994558"> </a>The sector at which to start writing.</dd>

<dt><a name="994560"> </a><code>&rarr;  <i>bufferP</i></code></dt>
<dd><a name="994562"> </a>Buffer containing the data being written to the card, or <code>NULL</code> to clear the number of sectors indicated in <code class="par">numSectorsP</code>. This buffer must be a multiple of 512 bytes long.</dd>

<dt><a name="994564"> </a><code>&harr;  <i>numSectorsP</i></code></dt>
<dd><a name="994566"> </a>When calling this function, set this to the number of sectors to write. Upon return, it is set to the number of sectors actually written.</dd>

</dl>
<h4>
  <a name="994568"> </a>Returns 
</h4>

<p><a name="1007607"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1007608"> </a><code><code>expErrNotOpen</code></code></dt>
<dd><a name="1007609"> </a>Block device driver library has not been opened</dd>

<dt><a name="1007701"> </a><code><code>expErrInvalidSlotRefNum</code></code></dt>
<dd><a name="1007703"> </a>Slot reference number is not valid.</dd>

<dt><a name="1007705"> </a><code><code>expErrCardNoSectorReadWrite</code></code></dt>
<dd><a name="1007707"> </a>The card does not support the block read/write API.</dd>

<dt><a name="1007709"> </a><code>expErrCardReadOnly</code></dt>
<dd><a name="1007711"> </a>The card is read only</dd>

<dt><a name="1007713"> </a><code>expErrCardBadSector</code></dt>
<dd><a name="1007715"> </a>One of the requested sectors is bad.</dd>

<dt><a name="1007717"> </a><code>expErrCardProtectedSector</code></dt>
<dd><a name="1007719"> </a>One of the requested sectors is protected.</dd>

<dt><a name="1007721"> </a><code><code>expErrCardNotPresent</code></code></dt>
<dd><a name="1007723"> </a>No card is present.</dd>

</dl>
<h4>
  <a name="994573"> </a>Comments 
</h4>

<p><a name="1008129"> </a>This function is used by the file system library to write data to the media. Information such as the Volume Label, File Name, File Attributes, as well as the files and directories themselves are all created with this function. Applications normally use one of the VFS Manager write functions, which in turn call this one.</p>

<h3 class="hbH3">
  <a name="994583"> </a>ExpSlotCustomControl Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="994588"> </a>Purpose 
</h4>

<p><a name="994591"> </a>Handle a custom call for a particular slot.</p>
<h4>
  <a name="994593"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="994596"> </a></code><h4>
  <a name="994598"> </a>Prototype 
</h4>
<pre class="proto"><a name="994601"></a>status_t ExpSlotCustomControl (
   uint16_t <code class="par">slotRefNum</code>,
   uint32_t <code class="par">apiCreator</code>,
   uint16_t <code class="par">apiSelector</code>,
   void <code class="par">*valueP</code>,
   uint16_t <code class="par">*valueLenP</code>
)
</pre>
<h4>
  <a name="994603"> </a>Parameters 
</h4>

<dl>
<dt><a name="1014065"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="1014066"> </a>Slot reference number.</dd>

<dt><a name="994614"> </a><code>&rarr;  <i>apiCreator</i></code></dt>
<dd><a name="994664"> </a>Registered creator code.</dd>

<dt><a name="994666"> </a><code>&rarr;  <i>apiSelector</i></code></dt>
<dd><a name="994668"> </a>Custom operation to perform. The value of this parameter also determines what kind of data is used with <code class="par">valueP</code>.</dd>

<dt><a name="994670"> </a><code>&harr;  <i>valueP</i></code></dt>
<dd><a name="994672"> </a>Buffer containing data specific to the operation specified in <code class="par">apiSelector</code>. </dd>

<dt><a name="994674"> </a><code>&harr;  <i>valueLenP</i></code></dt>
<dd><a name="994676"> </a>Size of the <code class="par">valueP</code> buffer on entry, size of data written to <code class="par">valueP</code> on exit.</dd>

</dl>
<h4>
  <a name="994678"> </a>Returns 
</h4>

<p><a name="1006743"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1006976"> </a><code><code>expErrNotOpen</code></code></dt>
<dd><a name="1006978"> </a>Block device driver library has not been opened</dd>

<dt><a name="1006980"> </a><code><code>expErrUnsupportedOperation</code></code></dt>
<dd><a name="1006982"> </a>The selector and/or creator is unsupported or undefined.</dd>

<dt><a name="1006984"> </a><code>sysErrParamErr</code></dt>
<dd><a name="1006986"> </a><code class="par">valueP</code> buffer is too small</dd>

</dl>
<h4>
  <a name="994683"> </a>Comments 
</h4>

<p><a name="1007403"> </a>This function is used to make custom calls to the block device driver, calls beyond what is supported by the VFS and Expansion Managers. Depending on the block device driver, custom calls might allow you to do such things as read and write physical blocks on the media, obtain special information for diagnostics, or help with debugging.</p>

<p><a name="1007404"> </a>Block device drivers identify each call by a registered creator code and a selector.</p>

<h3 class="hbH3">
  <a name="995065"> </a>ExpSlotEnumerate Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="995070"> </a>Purpose 
</h4>

<p><a name="1004317"> </a>Iterates through valid slot numbers.</p>
<h4>
  <a name="995075"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="995078"> </a></code><h4>
  <a name="995080"> </a>Prototype 
</h4>
<pre class="proto"><a name="995083"></a>status_t ExpSlotEnumerate (
   uint16_t <code class="par">*slotRefNumP</code>,
   uint32_t <code class="par">*slotIteratorP</code>
)
</pre>
<h4>
  <a name="995085"> </a>Parameters 
</h4>

<dl>
<dt><a name="995088"> </a><code>&larr;  <i>slotRefNumP</i></code></dt>
<dd><a name="995090"> </a>Reference number of the currently-enumerated slot.</dd>

<dt><a name="995092"> </a><code>&rarr;  <i>slotIteratorP</i></code></dt>
<dd><a name="995094"> </a>Pointer to the index of the last entry enumerated. For the first iteration, initialize this parameter to the constant <code>expIteratorStart</code>. Upon return this references the next entry in the directory. If this is the last entry, this parameter is set to <code>expIteratorStop</code>.</dd>

</dl>
<h4>
  <a name="995096"> </a>Returns 
</h4>

<p><a name="1004393"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1004397"> </a><code><code>expErrEnumerationEmpty</code></code></dt>
<dd><a name="1004420"> </a>There are no slots left to enumerate. <code class="par">slotRefNumP</code> is set to the slot number of the currently enumerated slot or <code>invalidSlotRefNum</code> if there are no slots.</dd>

</dl>
<h4>
  <a name="995101"> </a>Comments 
</h4>

<p><a name="1004441"> </a>This function iterates through the device's slots. The first time this function is called, set <code>*</code><code class="par">slotIteratorP</code> to <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">expIteratorStart</span> to find the initial slot. Once set this value is changed with each subsequent call to this function until it reaches the maximum number of slots, at which point <code>ExpSlotEnumerate()</code> sets <code>*</code><code class="par">slotIteratorP</code> to <code>expIteratorStop</code>.</p>
<h4>
  <a name="1004442"> </a>Example 
</h4>

<p><a name="1004443"> </a>The following is an example of how <code>ExpSlotEnumerate()</code> should be used:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
<code>UInt16 slotRefNum;</code><a name="1004444"> </a>
<code>UInt32 slotIterator = expIteratorStart;</code><a name="1004445"> </a>
<code>while (slotIterator != expIteratorStop) {</code><a name="1004446"> </a>
<code>   if ((err = ExpSlotEnumerate(&amp;slotRefNum,</code><a name="1004447"> </a>
<code>            &amp;slotIterator)) == errNone) {</code><a name="1004448"> </a>
<code>      // do something with the slotRefNum</code><a name="1004449"> </a>
<code>   else {</code><a name="1004450"> </a>
<code>      // handle error (by breaking out of the</code><a name="1004451"> </a>
<code>      // loop, most likely</code><a name="1004452"> </a>
<code>   }</code><a name="1004453"> </a>
<code>}</code><a name="1004454"> </a>
</pre><div class="CodeRule"><hr></div>

<h4>
  <a name="995106"> </a>See Also 
</h4>

<p><a name="1004516"> </a><a href="ExpansionMgr.html#993765"><code>ExpCardInfo()</code></a>, <a href="ExpansionMgr.html#994237"><code>ExpCardPresent()</code></a></p>

<h3 class="hbH3">
  <a name="995429"> </a>ExpSlotMediaType Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="995434"> </a>Purpose 
</h4>

<p><a name="995437"> </a>Determine the media type supported by the given slot.</p>
<h4>
  <a name="995439"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="995442"> </a></code><h4>
  <a name="995444"> </a>Prototype 
</h4>
<pre class="proto"><a name="995447"></a>status_t ExpSlotMediaType (
   uint16_t <code class="par">slotRefNum</code>,
   uint32_t <code class="par">*mediaTypeP</code>
)
</pre>
<h4>
  <a name="995449"> </a>Parameters 
</h4>

<dl>
<dt><a name="995452"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="995454"> </a>Slot reference number.</dd>

<dt><a name="995456"> </a><code>&larr;  <i>mediaTypeP</i></code></dt>
<dd><a name="995458"> </a>Set to the media type supported by the given slot. See <a href="ExpansionMgr.html#999014">"Defined Media Types"</a> for a list of possible media types.</dd>

</dl>
<h4>
  <a name="995460"> </a>Returns 
</h4>

<p><a name="1005000"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1005001"> </a><code><code>expErrInvalidSlotRefNum</code></code></dt>
<dd><a name="1005002"> </a>The specified slot number is invalid.</dd>

<dt><a name="1005019"> </a><code>expErrNotOpen</code></dt>
<dd><a name="1005483"> </a>The block device driver library has not been opened.</dd>

</dl>
<h4>
  <a name="995465"> </a>Comments 
</h4>

<p><a name="1005475"> </a>This function returns the type of media that is supported by the slot, irrespective of whether there is a card in the slot.</p>
<h4>
  <a name="1012085"> </a>See Also 
</h4>

<p><a name="1012089"> </a><a href="ExpansionMgr.html#993861"><code>ExpCardMediaType()</code></a></p>

<h3 class="hbH3">
  <a name="995475"> </a>ExpSlotPowerCheck Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="995480"> </a>Purpose 
</h4>

<p><a name="995483"> </a>Determine if enough power is available to complete an operation before starting it.</p>
<h4>
  <a name="995497"> </a>Declared In 
</h4>
<code>ExpansionMgr.h<a name="995518"> </a></code><h4>
  <a name="995542"> </a>Prototype 
</h4>
<pre class="proto"><a name="995569"></a>status_t ExpSlotPowerCheck (
   uint16_t <code class="par">slotRefNum</code>,
   uint16_t <code class="par">operationFlags</code>,
   uint16_t <code class="par">readBlocks</code>,
   uint16_t <code class="par">writeBlocks</code>
)
</pre>
<h4>
  <a name="995607"> </a>Parameters 
</h4>

<dl>
<dt><a name="995634"> </a><code>&rarr;  <i>slotRefNum</i></code></dt>
<dd><a name="995660"> </a>Slot reference number.</dd>

<dt><a name="995686"> </a><code>&rarr;  <i>operationFlags</i></code></dt>
<dd><a name="1005495"> </a>Flags for specific operations. The two flags currently supported are:</dd>

<dl>
<dt><a name="1005496"> </a><code><code>slotLibPowerFlag_WakeUp</code></code></dt>
<dd><a name="1005502"> </a>Add the power required to bring the slot hardware out of low-power mode.</dd>

<dt><a name="995712"> </a><code><code>slotLibPowerFlag_FormatMedia</code></code></dt>
<dd><a name="1005505"> </a>Add the power required to perform a low-level format of the card media.</dd>

</dl>
<dt><a name="995714"> </a><code>&rarr;  <i>readBlocks</i></code></dt>
<dd><a name="995716"> </a>Add the power required to read <i>n</i> blocks into main memory</dd>

<dt><a name="995718"> </a><code>&rarr;  <i>writeBlocks</i></code></dt>
<dd><a name="995720"> </a>Add the power required to write <i>n</i> blocks onto the card media</dd>

</dl>
<h4>
  <a name="995722"> </a>Returns 
</h4>

<p><a name="1005517"> </a>Returns <code>errNone</code> if the necessary power is available, <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">expErrNotEnoughPower</span> if the necessary power is <i>not</i> available, or one of the following if an error occurred:</p>

<dl>
<dt><a name="1005518"> </a><code><code>expErrInvalidSlotRefNum</code></code></dt>
<dd><a name="1005519"> </a>The specified slot number is invalid.</dd>

<dt><a name="1005520"> </a><code>expErrNotOpen</code></dt>
<dd><a name="1005521"> </a>The block device driver library has not been opened.</dd>

<dt><a name="1005540"> </a><code><code>expErrCardNoSectorReadWrite</code></code></dt>
<dd><a name="1005542"> </a>The card does not support the read/write API, but readBlocks or writeBlocks was non-zero.</dd>

<dt><a name="1005544"> </a><code>expErrCardNotPresent</code></dt>
<dd><a name="1005546"> </a>No card is present.</dd>

</dl>
<h4>
  <a name="1005679"> </a>Comments 
</h4>

<p><a name="1005733"> </a>This function adds up all the power indicated by the parameters and returns <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">expErrNotEnoughPower</span> if there isn't enough battery power to perform the operation, <code>errNone</code> if there is, or an error code if the operation couldn't be completed successfully.</p>

<p><a name="1005734"> </a>When formatting a volume, for example, pass <code>slotLibPowerFlag_FormatMedia</code> to indicate power is needed for a low level format of the card, and pass a number greater than zero for <code class="par">writeBlocks</code> to indicate power is required to install an empty file system.</p>

<p><a name="992930"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996&#8211;2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="SysMgt_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="SysMgt_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ErrTryCatch.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="FatalAlert.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SysMgt_IX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>