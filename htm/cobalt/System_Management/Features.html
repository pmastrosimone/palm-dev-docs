<html>
<head>
<title>(Protein) Features | System Management</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 11:27:10">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="993067"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="SysMgt_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="AttnsAndAlarms.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="PreferenceConcepts.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SysMgt_IX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">2 &nbsp;&nbsp;
Features</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">System Management</p>
<p class="SubTitle">Exploring Palm OS&#174; </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="SysMgt_Part1.html">Part I: Concepts</a> </h1>
<h1 class="SideTOC1"><a href="Features.html">2  Features</a></h1>

   <h2 class="SideTOC2"><a href="#992922">
   The Operating System Version Feature</a></h2>

   <h2 class="SideTOC2"><a href="#992981">
   Application-Defined Features</a></h2>

   <h2 class="SideTOC2"><a href="#992986">
   Using the Feature Manager</a></h2>

   <h2 class="SideTOC2"><a href="#993007">
   Feature Memory</a></h2>

      <h3 class="SideTOC3"><a href="#986245">
      Feature Memory Limitations</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="992899"> </a>A <b>feature</b> is a 32-bit value that has special meaning to both the feature publisher and to users of that feature. Features can be published by the system or by applications. </p>

<p><a name="992900"> </a>Each feature is identified by a feature creator and a feature number: </p>
<ul type="disc">
  <li><a name="992901"> </a>The feature creator is a unique creator registered with PalmSource, Inc. You usually use the creator type of the application that publishes the feature. 
  <li><a name="992902"> </a>The feature number is any 32-bit value used to distinguish between different features of a particular creator.
</ul>

<p><a name="992903"> </a>Once a feature is published, it remains present until it is explicitly unregistered or the handheld is reset. A feature published by an application sticks around even after the application quits.</p>

<p><a name="992904"> </a>This section introduces the Feature Manager by discussing these topics: </p>
<ul type="disc">
  <li><a name="992908"> </a><a href="Features.html#992922">The Operating System Version Feature</a>
  <li><a name="992912"> </a><a href="Features.html#992981">Application-Defined Features</a>
  <li><a name="992916"> </a><a href="Features.html#992986">Using the Feature Manager</a>
  <li><a name="992920"> </a><a href="Features.html#993007">Feature Memory</a>
</ul>

<h2 class="haH2">
  <a name="992922"> </a>The Operating System Version Feature <a href="#993067"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="992924"> </a>As an example of what features are used for, the version of the operating system is stored in a feature. This feature is published by the system and contains a 32-bit representation of the operating system version. The operating system version has a feature creator of <code>sysFtrCreator</code> and a feature number of <code>sysFtrNumROMVersion</code>. To obtain the operating system version you call <a href="FeatureMgr.html#992990"><code>FtrGet()</code></a>, like this:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
err = FtrGet(sysFtrCreator, sysFtrNumROMVersion,
   &amp;romVersion);<a name="993365"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="993355"> </a>On Palm OS Cobalt, the value written to <code>romVersion</code> by this call is <code>0x06003000</code>. This indicates that the operating system version is 6.0, and that it is a release ROM.</p>

<p><a name="993392"> </a>If your code is dependant on a particular Palm OS version, you'll want to obtain the value of the <code>sysFtrNumROMVersion</code> feature and compare it to a known base value. Rather than hard wiring an obscure constant like one of the above into your code, however, you can use the <code>sysMakeROMVersion</code> macro (defined in <code>SystemMgr.h</code>) to construct a version number for comparison purposes. It takes five parameters:</p>
<ul type="disc">
  <li><a name="992959"> </a>Major version number
  <li><a name="992960"> </a>Minor version number
  <li><a name="992961"> </a>Fix level
  <li><a name="992962"> </a>Build stage (either <code>sysROMStageDevelopment</code>,<br><code>sysROMStageAlpha</code>, <code>sysROMStageBeta</code>, or<br><code>sysROMStageRelease</code>)
  <li><a name="992963"> </a>Build number
</ul>

<p><a name="992964"> </a>The fix level and build number parameters are normally set to zero, while build stage is usually set to <code>sysROMStageRelease</code>. Simply check to see whether <code>sysFtrNumROMVersion</code> is greater than or equal to the version number constructed with <code>sysMakeROMVersion</code>, as shown here:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
// See if we're on ROM version 6.0 or later.<a name="992965"> </a>
FtrGet(sysFtrCreator, sysFtrNumROMVersion, &amp;romVersion);<a name="992966"> </a>
if (romVersion &gt;= sysMakeROMVersion(6, 0, 0,<a name="992967"> </a>
    sysROMStageRelease, 0)) {<a name="992968"> </a>
   ....<a name="992969"> </a>
}<a name="992970"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="994240"> </a>Other system features are defined in <code>SystemMgr.h</code>; see <a href="SystemMgr.html#1002334">"System Features"</a> for a complete list. Checking for the presence of system features allows an application to be compatible with multiple versions of the system by refining its behavior depending on which capabilities are actually present in the device. For instance, the blitter's capabilities can be determined by checking the version number of the Window Manager. If the Window Manager version is 4 or greater, "high-density" displays (greater than 160 by 160 pixels) are supported. If the Window Manager version is 5 or greater, quarter-VGA displays (320 by 240 pixels) are supported. (Note, however, that just because the blitter is capable of working with a quarter-VGA display, for example, that doesn't mean that the handheld actually <i>has</i> a quarter-VGA display. For that, you need to check the attributes of the screen with <a href="../User_Interface/UI_Window.html#1535987"><code>WinScreenGetAttribute()</code></a>.) </p>

<p><a name="993456"> </a>In some cases the presence or absence of a feature is also important. For instance, the VFS Manager may or may not be present on a given device. If it is not present, the <a href="FeatureMgr.html#992990"><code>FtrGet()</code></a> call returns an error. See <a href="../Memory_Databases_Files/VFS.html#994832">"Checking for the Presence of the VFS Manager"</a> for more on checking for the VFS Manager feature.</p>

<div><hr>
  <a name="992973"> </a> <b>IMPORTANT: </b> Not all features are guaranteed to be present on any given device. Always check for specific features rather than relying on the system version number to determine if a specific API set is available. 
<hr>
</div>

<h2 class="haH2">
  <a name="992981"> </a>Application-Defined Features <a href="#993067"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="992983"> </a>Applications may find the Feature Manager useful for their own private use. For example, an application may want to publish a feature that contains a pointer to some private data it needs for processing launch codes. Or, an application might use features to hold small pieces of data that must persist across application launches.</p>

<p><a name="993552"> </a>The feature manager maintains one feature table in RAM, and one feature table in ROM. Application-defined features are stored in the RAM feature table. System features are stored in the ROM feature table. Note, however, that the contents of the ROM feature table are copied into the RAM feature table at system startup.</p>

<h2 class="haH2">
  <a name="992986"> </a>Using the Feature Manager <a href="#993067"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="992991"> </a>To check whether a particular feature is present, call <a href="FeatureMgr.html#992990"><code>FtrGet()</code></a> and pass it the feature creator ID and feature number. If the feature exists, <code>FtrGet()</code> returns the 32-bit value of the feature. If the feature doesn't exist, an error code is returned.</p>

<p><a name="992992"> </a>To publish a new feature or change the value of an existing one, call <a href="FeatureMgr.html#993944"><code>FtrSet()</code></a> and pass the feature creator ID, feature number, and the 32-bit value of the feature. A published feature remains available until it is explicitly removed by a call to <a href="FeatureMgr.html#993994"><code>FtrUnregister()</code></a> or until the system resets; simply quitting an application doesn't remove a feature published by that application. Upon reset, all features and feature pointers are cleared out and must be re-initialized by the appropriate component.</p>

<p><a name="993002"> </a>You can get a complete list of all published features by calling <a href="FeatureMgr.html#993401"><code>FtrGetByIndex()</code></a> repeatedly. The first time you call <code>FtrGetByIndex()</code>, pass an index value of 0. Increment the index value by 1 on subsequent calls until <code>FtrGetByIndex()</code> returns an error. Note that although <code>FtrGetByIndex()</code> accepts a parameter that specifies whether to search the ROM feature table or the RAM feature table, the contents of the ROM table are copied into the RAM table at system startup. Thus, the RAM feature table contains all feature values.</p>

<h2 class="haH2">
  <a name="993007"> </a>Feature Memory <a href="#993067"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="993585"> </a>Feature memory provides quick, efficient access to data that persists between invocations of an application. The values stored in feature memory persist until the handheld is reset or until you explicitly free the memory. Feature memory is memory allocated from the storage heap. Thus, you write to feature memory using <a href="../Memory_Databases_Files/DataMgr.html#1007510"><code>DmWrite()</code></a>, which means that writing to feature memory is no faster than writing to a database. However, feature memory can provide more efficient access to that data in certain circumstances.</p>

<p><a name="993018"> </a>To allocate a chunk of feature memory, call <a href="FeatureMgr.html#993808"><code>FtrPtrNew()</code></a>, specifying a feature creator, a feature number, the number of bytes to allocate, and a location where the Feature Manager can write a pointer to the newly allocated memory chunk. For example:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
FtrPtrNew(appCreator, myFtrMemFtr, 32, &amp;ftrMem);<a name="993019"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="993020"> </a>Elsewhere in your application, you can obtain the pointer to the feature memory chunk using <a href="FeatureMgr.html#993711"><code>FtrPtrGet()</code></a>. </p>

<p><a name="993026"> </a>Feature memory is considered a performance optimization. The conditions under which you'd use it are not common, and you probably won't find them in a typical application. </p>

<p><a name="993051"> </a>One potential use of feature memory is to "publish" data from your application or library to other applications when that data doesn't fit in a normal 32-bit feature value. For example, suppose you are writing a communications library and you want to publish an icon that client applications can use to draw the current connection state. The library can use <code>FtrPtrNew()</code> to allocate a feature memory chunk and store an icon representing the current state in that location. Applications can then use <code>FtrPtrGet()</code> to access the icon and display the connection state on the screen. </p>
<h3 class="hbH3">
  <a name="986245"> </a>Feature Memory Limitations <a href="#993067"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="993625"> </a>Feature pointer memory is allocated from the storage heap as part of a "features" temporary database, so applications must use <a href="../Memory_Databases_Files/DataMgr.html#1007510"><code>DmWrite()</code></a> to write to feature pointers. (While a feature pointer's contents are modified via <code>DmWrite()</code>, you modify the pointer itself using <a href="FeatureMgr.html#993886"><code>FtrPtrResize()</code></a> or <a href="FeatureMgr.html#997379"><code>FtrPtrFree()</code></a>.) </p>

<p><a name="993678"> </a>If one thread or process modifies the feature pointer while another one is using it, the result is undefined. This is generally not a problem because feature pointers are usually private and used by only one application at a time, so synchronization is never required.  However, it is important to note that feature pointers are not a good foundation for sharing memory across threads or processes in Palm OS Cobalt, and you should not use them for that purpose.</p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996&#8211;2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="SysMgt_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="SysMgt_TOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="AttnsAndAlarms.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="PreferenceConcepts.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SysMgt_IX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>