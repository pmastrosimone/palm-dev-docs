<html>
<head>
<title>(Protein) Authorization Manager | Security and Cryptography</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 11:24:46">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="992934"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="SecurityAndCryptographyTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="AmPluginSignedCode.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CertificateMgr.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SecurityAndCryptographyIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">7 &nbsp;&nbsp;
Authorization Manager</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Security and Cryptography</p>
<p class="SubTitle">Exploring Palm OS </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="SecurityAndCrypto_Part2.html">Part II: Reference</a> </h1>
<h1 class="SideTOC1"><a href="azm.html">7  Authorization Manager</a></h1>

   <h2 class="SideTOC2"><a href="#992942">
   Authorization Manager Structures and Types</a></h2>

      <h3 class="SideTOC3"><a href="#992950">
      AzmActionType</a></h3>

      <h3 class="SideTOC3"><a href="#992975">
      AzmNotificationType</a></h3>

      <h3 class="SideTOC3"><a href="#993255">
      AzmRuleSetType</a></h3>

   <h2 class="SideTOC2"><a href="#993280">
   Authorization Manager Constants</a></h2>

      <h3 class="SideTOC3"><a href="#993323">
      Miscellaneous Authorization Manager Constants</a></h3>

      <h3 class="SideTOC3"><a href="#994005">
      Authorization Manager Error Codes</a></h3>

   <h2 class="SideTOC2"><a href="#993541">
   Authorization Manager Functions and Macros</a></h2>

      <h3 class="SideTOC3"><a href="#993577">
      AzmAddRule</a></h3>

      <h3 class="SideTOC3"><a href="#993631">
      AzmGetSyncBypass</a></h3>

      <h3 class="SideTOC3"><a href="#996987">
      AzmNonInteractiveAuthorize</a></h3>

      <h3 class="SideTOC3"><a href="#997438">
      AzmSetSyncBypass</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="994438"> </a>The Authorization Manager is the top-level component in the security suite that enables protection of objects in the operating system. The Authorization Manager is designed around the Access Control List paradigm.</p>

<p><a name="994439"> </a>The Authorization Manager maintains a list of rule-set containers that represent protected objects. Associated with each rule-set container is the protected object's fully-qualified name as defined by the creator of the protected object and one or more rules specifying how the object referenced by the Access Control List container is protected. Each rule is an association between one or more actions that could be performed on the object and the set of authentications required to perform those actions.</p>

<p><a name="994440"> </a>The Authorization Manager relies on the managers of objects to provide a fully-qualified name for the objects they want to protect, and to define what actions can be performed on those objects.</p>

<p><a name="992936"> </a>The remainder of this chapter documents the Authorization Manager APIs. It is organized into the following sections:</p>
   <blockquote class = "bq"><a name="992948"> </a><a href="azm.html#992942">Authorization Manager Structures and Types</a></blockquote>
   <blockquote class = "bq"><a name="993293"> </a><a href="azm.html#993280">Authorization Manager Constants</a></blockquote>
   <blockquote class = "bq"><a name="993547"> </a><a href="azm.html#993541">Authorization Manager Functions and Macros</a></blockquote>

<p><a name="992938"> </a>The header file <code>azm.h</code> declares the API that this chapter describes.</p>

<p><a name="992940"> </a></p>

<h2 class="haH2">
  <a name="992942"> </a>Authorization Manager Structures and Types <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="992950"> </a>AzmActionType Typedef <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="992955"> </a>Purpose 
</h4>

<p><a name="995623"> </a>Defines a bitmap of actions. Each bit in the <code>AzmActionType</code> value corresponds to a different rule.</p>
<h4>
  <a name="992960"> </a>Declared In 
</h4>
<code>azm.h<a name="992963"> </a></code><h4>
  <a name="992965"> </a>Prototype 
</h4>
<pre class="proto"><a name="992968"></a>typedef uint32_t AzmActionType
</pre>

<h3 class="hbH3">
  <a name="992975"> </a>AzmNotificationType Struct <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="992980"> </a>Purpose 
</h4>

<p><a name="992983"> </a>Data structure that accompanies notifications sent by the Authorization Manager.</p>
<h4>
  <a name="992985"> </a>Declared In 
</h4>
<code>azm.h<a name="992988"> </a></code><h4>
  <a name="992990"> </a>Prototype 
</h4>
<pre class="proto"><a name="992993"></a>typedef struct {
   union {
      struct {
         uint8_t name [azmRuleSetNameMaxLength];
         uint32_t length;
      } ruleSetDestroyed;
   } data;
   uint16_t version;
   uint16_t padding;
} AzmNotificationType
</pre>
<h4>
  <a name="993007"> </a>Fields 
</h4>

<dl>
<dt><a name="996036"> </a><code>data</code></dt>
<dd><a name="996037"> </a>A union of structures, one for each of the notifications that can be sent.</dd>

<dl>
<dt><a name="995933"> </a><code>ruleSetDestroyed</code></dt>
<dd><a name="995934"> </a>The <code>data</code> variant that applies to <code>AzmNotificationRuleSetDestroyed</code> notifications. This structure has two fields: the name of the rule-set being destroyed, and the length of that name.</dd>

</dl>
<dt><a name="993242"> </a><code>version</code></dt>
<dd><a name="993244"> </a>The version of the <code>AzmNotificationType</code> structure. The structure as detailed above is version 1.</dd>

<dt><a name="993246"> </a><code>padding</code></dt>
<dd><a name="993248"> </a>Padding bytes.</dd>

</dl>

<h3 class="hbH3">
  <a name="993255"> </a>AzmRuleSetType Typedef <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993260"> </a>Purpose 
</h4>

<p><a name="993263"> </a>An opaque handle to an rule-set container managed by the Authorization Manager.</p>
<h4>
  <a name="993265"> </a>Declared In 
</h4>
<code>azm.h<a name="993268"> </a></code><h4>
  <a name="993270"> </a>Prototype 
</h4>
<pre class="proto"><a name="993273"></a>typedef uint32_t AzmRuleSetType
</pre>

<h2 class="haH2">
  <a name="993280"> </a>Authorization Manager Constants <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="993323"> </a>Miscellaneous Authorization Manager Constants <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993331"> </a>Purpose 
</h4>

<p><a name="993342"> </a>The header file <code>azm.h</code> also declares these constants.</p>
<h4>
  <a name="993352"> </a>Declared In 
</h4>
<code>azm.h<a name="993363"> </a></code><h4>
  <a name="993373"> </a>Constants 
</h4>

<dl>
<dt><a name="993384"> </a><code>#define azmActionModify 0x80000000</code></dt>
<dd><a name="996258"> </a>Predefined MODIFY action. This action may <i>not</i> be redefined. This is an Authorization Manager-specific action which gates the modification of a rule-set container. A modification of a rule-set container is defined as creation (always allowed), addition or modification of ACE entries, or destruction.</dd>

<dt><a name="993404"> </a><code>#define azmCreator 'azm_'</code></dt>
<dd><a name="993414"> </a>Creator ID used for the vault that contains secure databases.</dd>

<dt><a name="993496"> </a><code>#define azmInvalidRuleSet 0xFFFFFFFF</code></dt>
<dd><a name="993498"> </a>Rule-set handle value representing an invalid rule-set.</dd>

<dt><a name="993500"> </a><code>#define azmMaxTokenNodes 2</code></dt>
<dd><a name="993502"> </a>Maximum number of token nodes.</dd>

<dt><a name="993504"> </a><code>#define azmMaxTokensInNode 8</code></dt>
<dd><a name="993506"> </a>Maximum number of tokens that can be placed into a single node.</dd>

<dt><a name="993508"> </a><code>#define azmMaxTokensInTree azmMaxTokenNodes * azmMaxTokensInNode</code></dt>
<dd><a name="993510"> </a>The maximum number of tokens that can occur in an access rule.</dd>

<dt><a name="993512"> </a><code>#define AzmNotificationRuleSetDestroyed 0x1</code></dt>
<dd><a name="993514"> </a>"Rule-set destroyed" notification callback opcode.</dd>

<dt><a name="993520"> </a><code>#define azmRuleFormatLength 60</code></dt>
<dd><a name="996227"> </a>The maximum length in bytes (including the null terminator) of a rule format string.</dd>

<dt><a name="993524"> </a><code>#define azmRuleSetNameMaxLength 20</code></dt>
<dd><a name="993526"> </a>The maximum length, in bytes, of an Authorization Manager rule-set name.</dd>

<dt><a name="993528"> </a><code>#define AzmServiceName "psysAuthorizationMgr"</code></dt>
<dd><a name="996249"> </a>The name under which the Authorization Manager is registered with the Service Manager.</dd>

<dt><a name="993532"> </a><code>#define azmSyncRuleSet 0x00800000</code></dt>
<dd><a name="993534"> </a>Handle to the rule-set container for synchronization.</dd>

</dl>

<h3 class="hbH3">
  <a name="994005"> </a>Authorization Manager Error Codes <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="994006"> </a>Purpose 
</h4>

<p><a name="994007"> </a>Error codes returned by the various Authorization Manager functions.</p>
<h4>
  <a name="994008"> </a>Declared In 
</h4>
<code>azm.h<a name="994009"> </a></code><h4>
  <a name="994010"> </a>Constants 
</h4>

<dl>
<dt><a name="994267"> </a><code>#define azmErrAlreadyExists (azmErrorClass | 19)</code></dt>
<dd><a name="994268"> </a>The specified rule-set already exists.</dd>

<dt><a name="994270"> </a><code>#define azmErrAuthorizationFailed (azmErrorClass | 9)</code></dt>
<dd><a name="994271"> </a>The authorization request has failed.</dd>

<dt><a name="994273"> </a><code>#define azmErrBackupInProgress (azmErrorClass | 17)</code></dt>
<dd><a name="994274"> </a>A backup is in progress.</dd>

<dt><a name="994276"> </a><code>#define azmErrBadParam (azmErrorClass | 1)</code></dt>
<dd><a name="995531"> </a>One of the supplied parameters is invalid.</dd>

<dt><a name="994279"> </a><code>#define azmErrInvalidParameter (azmErrorClass | 18)</code></dt>
<dd><a name="994280"> </a>One of the supplied parameters is invalid.</dd>

<dt><a name="994282"> </a><code>#define azmErrInvalidReference (azmErrorClass | 8)</code></dt>
<dd><a name="994283"> </a>The reference to the rule-set container is invalid.</dd>

<dt><a name="994285"> </a><code>#define azmErrInvalidRuleSyntax (azmErrorClass | 16)</code></dt>
<dd><a name="994286"> </a>The syntax of the supplied rule definition is invalid.</dd>

<dt><a name="994288"> </a><code>#define azmErrInvalidTokenReference (azmErrorClass | 15)</code></dt>
<dd><a name="994289"> </a>The token reference is invalid.</dd>

<dt><a name="994291"> </a><code>#define azmErrMaxRuleSets (azmErrorClass | 5)</code></dt>
<dd><a name="994292"> </a>The system already has the maximum number of rule sets allowed.</dd>

<dt><a name="994294"> </a><code>#define azmErrMemory (azmErrorClass | 6)</code></dt>
<dd><a name="994295"> </a>The Authorization Manager encountered a memory error. This may indicate a possible out-of-memory condition.</dd>

<dt><a name="994297"> </a><code>#define azmErrMgrAlreadyRegistered (azmErrorClass | 13)</code></dt>
<dd><a name="994298"> </a>The manager creator ID is already registered.</dd>

<dt><a name="994300"> </a><code>#define azmErrMgrNotRegistered (azmErrorClass | 10)</code></dt>
<dd><a name="994301"> </a>A request was recieved from an unregistered manager.</dd>

<dt><a name="994303"> </a><code>#define azmErrNotFound (azmErrorClass | 12)</code></dt>
<dd><a name="994304"> </a>The rule-set being looked up was not found.</dd>

<dt><a name="994306"> </a><code>#define azmErrNotImplemented (azmErrorClass | 2)</code></dt>
<dd><a name="994307"> </a>The Authorization Manager attempted to perform an unimplemented operation.</dd>

<dt><a name="994309"> </a><code>#define azmErrNotOpen (azmErrorClass | 3)</code></dt>
<dd><a name="994310"> </a>The library has not been opened.</dd>

<dt><a name="994312"> </a><code>#define azmErrOutOfMemory (azmErrorClass | 7)</code></dt>
<dd><a name="994313"> </a>There is insufficient memory to complete the requested operation.</dd>

<dt><a name="994315"> </a><code>#define azmErrRestrictedAPI (azmErrorClass | 11)</code></dt>
<dd><a name="994316"> </a>This call can only be made from a registered manager.</dd>

<dt><a name="994318"> </a><code>#define azmErrStillOpen (azmErrorClass | 4)</code></dt>
<dd><a name="994319"> </a>The library is opened by others and cannot be closed.</dd>

<dt><a name="994321"> </a><code>#define azmErrTooManyTokensInRule (azmErrorClass | 14)</code></dt>
<dd><a name="994322"> </a>You have exceeded the limit on the number of tokens per rule.</dd>

</dl>

<h2 class="haH2">
  <a name="993541"> </a>Authorization Manager Functions and Macros <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="993577"> </a>AzmAddRule Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993582"> </a>Purpose 
</h4>

<p><a name="994805"> </a>Adds an access rule to an existing rule-set container for a specific action bitmap.</p>
<h4>
  <a name="993587"> </a>Declared In 
</h4>
<code>azm.h<a name="993590"> </a></code><h4>
  <a name="993592"> </a>Prototype 
</h4>
<pre class="proto"><a name="993595"></a>status_t AzmAddRule (
   AzmRuleSetType <code class="par">ruleset</code>,
   AzmActionType <code class="par">action</code>,
   char *rulefmt,
   ...
)
</pre>
<h4>
  <a name="993597"> </a>Parameters 
</h4>

<dl>
<dt><a name="993600"> </a><code>&rarr;  <i>ruleset</i></code></dt>
<dd><a name="993602"> </a>A valid handle to a rule-set container managed by the Authorization Manager.</dd>

<dt><a name="993604"> </a><code>&rarr;  <i>action</i></code></dt>
<dd><a name="993606"> </a>Bitmap of actions to apply these rules to.</dd>

<dt><a name="993608"> </a><code>&rarr;  <i>rulefmt</i></code></dt>
<dd><a name="993610"> </a>A rule format string of the form: <code>[%t]+ (OR [%t]*)?</code>. This string should not exceed <span style="color: #000000;  font-family: Courier; font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">azmRuleFormatLength</span> bytes in length.</dd>

<dt><a name="993612"> </a><code>&rarr;  <i>...</i></code></dt>
<dd><a name="993614"> </a>A variable argument list containing a valid <a href="Am.html#994072"><code>AmTokenType</code></a> for each "<code>%t</code>" in the rule format string.</dd>

</dl>
<h4>
  <a name="993616"> </a>Returns 
</h4>

<p><a name="993619"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="994995"> </a><code>azmErrParam</code></dt>
<dd><a name="995013"> </a>The rule format string is invalid.</dd>

<dt><a name="994996"> </a><code>azmErrMemory</code></dt>
<dd><a name="995016"> </a>Out of memory, or the Authorization Manager detected an invalid internal memory structure.</dd>

<dt><a name="994998"> </a><code>azmErrInvalidReference</code></dt>
<dd><a name="995022"> </a><code class="par">ruleset</code> is invalid.</dd>

<dt><a name="994999"> </a><code>azmErrAuthorizationFailed</code></dt>
<dd><a name="995025"> </a>The modify rule-set rule was not authenticated properly.</dd>

<dt><a name="996399"> </a><code>azmErrTooManyTokensInRule</code></dt>
<dd><a name="996417"> </a>Your rule has too many tokens. A given rule cannot have more than <code>azmMaxTokensInTree</code> tokens.</dd>

</dl>
<h4>
  <a name="993621"> </a>Comments 
</h4>

<p><a name="994658"> </a>The rule format string is in the canonical form "<code>%t (OR %t)</code>". That is, at least one "<code>%t</code>".  This may be followed by " OR %t" to indicate the right hand side of the ACE rule. In the right hand side of the ACE rule there may be zero or more "%t" references.</p>

<p><a name="994664"> </a>There must be a valid <a href="Am.html#994072"><code>AmTokenType</code></a> in the variable argument list for each "%t" in the rule format string.</p>

<p><a name="998758"> </a>If the action referenced in the function call already has a rule associated with it, the rule is replaced. See <a href="../Memory_Databases_Files/SchemaDatabases.html#1025368">"Schema Database Access Rule Action Types"</a> of <i>Exploring Palm OS: Memory, Databases, Files</i> for the set of constants that correspond to those schema database actions for which you can set access rules. For an example of how to use this function to secure a schema database, see <a href="SecurityConcepts.html#993550">"Securing Databases."</a></p>

<p><a name="994667"> </a></p>

<p><a name="995027"> </a>Although this function is usually called by applications, it can be called from anywhere. However, in order for the call to succeed you must pass the rule-set container modify rule. To create a rule that allows access to anyone, use the well-known system token <code>amEmptyToken</code> and create a rule that only contains that token for the action you wish to allow free access to. For example,</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
AmGetTokenBySystemId(&amp;token, "empty");<a name="995029"> </a>
AzmAddRule(ruleSetRef, action, "%t",  token);<a name="995030"> </a>
</pre><div class="CodeRule"><hr></div>


<h3 class="hbH3">
  <a name="993631"> </a>AzmGetSyncBypass Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993640"> </a>Purpose 
</h4>

<p><a name="993645"> </a>Get the state of the sync bypass flags. </p>
<h4>
  <a name="993653"> </a>Declared In 
</h4>
<code>azm.h<a name="993664"> </a></code><h4>
  <a name="993674"> </a>Prototype 
</h4>
<pre class="proto"><a name="993685"></a>status_t AzmGetSyncBypass (
   AzmRuleSetType <code class="par">ruleset</code>,
   uint32_t <code class="par">*statebitfield</code>
)
</pre>
<h4>
  <a name="993699"> </a>Parameters 
</h4>

<dl>
<dt><a name="993710"> </a><code>&rarr;  <i>ruleset</i></code></dt>
<dd><a name="993720"> </a>A reference to the rule-set container for which the bypass settings are being requested.</dd>

<dt><a name="993730"> </a><code>&larr;  <i>statebitfield</i></code></dt>
<dd><a name="995205"> </a>A bitmap of the actions. If a bit is set for a specific action then its bypass flag is set.</dd>

</dl>
<h4>
  <a name="993742"> </a>Returns 
</h4>

<p><a name="995251"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="995272"> </a><code>azmErrInvalidReference</code></dt>
<dd><a name="995279"> </a><code class="par">ruleset</code> is invalid</dd>

<dt><a name="995273"> </a><code>azmErrBadParam</code></dt>
<dd><a name="995286"> </a><code class="par">statebitfield</code> is <code>NULL</code>.</dd>

</dl>
<h4>
  <a name="993747"> </a>Comments 
</h4>

<p><a name="995314"> </a>Upon return <code>*</code><code class="par">statebitfield</code> contains a 1 for each state that has bypass enabled. Checking for a flag is easy. For instance, to see if sync bypass it set for ACTION_READ, simply do the following:</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
if ((stateBitField &amp; ACTION_READ) &gt; 0)<a name="995315"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="995468"> </a>Note that it is not possible to set a sync bypass for Authorization Manager actions such as ACTION_MODIFY.</p>
<h4>
  <a name="993752"> </a>See Also 
</h4>

<p><a name="993755"> </a><a href="azm.html#997438"><code>AzmSetSyncBypass()</code></a></p>

<h3 class="hbH3">
  <a name="996987"> </a>AzmNonInteractiveAuthorize Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="997041"> </a>Purpose 
</h4>

<p><a name="997072"> </a>Authorize an action given a rule-set reference.</p>
<h4>
  <a name="997089"> </a>Declared In 
</h4>
<code>azm.h<a name="997120"> </a></code><h4>
  <a name="997133"> </a>Prototype 
</h4>
<pre class="proto"><a name="997164"></a>status_t AzmNonInteractiveAuthorize (
   AzmRuleSetType ruleSet,
   AzmActionType action,
   uint32_t appIdentityKeyId
)
</pre>
<h4>
  <a name="997211"> </a>Parameters 
</h4>

<dl>
<dt><a name="997240"> </a><code>&rarr;  <i>ruleSet</i></code></dt>
<dd><a name="997546"> </a>A valid handle to a rule-set container managed by the Authorization Manager.</dd>

<dt><a name="997329"> </a><code>&rarr;  <i>action</i></code></dt>
<dd><a name="997366"> </a>A bitmap of the action to authorize. Only one action may be authorized. </dd>

<dt><a name="997370"> </a><code>&rarr;  <i>appIdentityKeyId</i></code></dt>
<dd><a name="997371"> </a>The keyID for the application ID key that was passed in to the manager during the action request message.</dd>

</dl>
<h4>
  <a name="997372"> </a>Returns 
</h4>

<p><a name="997375"> </a><code>errNone</code> if the authorization request succeeds. Otherwise, this function returns one of the following:</p>

<dl>
<dt><a name="997473"> </a><code>azmErrInvalidReference</code></dt>
<dd><a name="997583"> </a>The reference to the Authorization Manager rule-set container is invalid.</dd>

<dt><a name="997606"> </a><code>azmErrParam</code></dt>
<dd><a name="997639"> </a>The action paarameter is empty. That is, it has a value of 0.</dd>

<dt><a name="997672"> </a><code>azmErrMemory</code></dt>
<dd><a name="997701"> </a>An internal memory error occurred.</dd>

<dt><a name="997726"> </a><code>azmErrAuthorizationFailed</code></dt>
<dd><a name="997743"> </a>Authorization failed.</dd>

</dl>
<h4>
  <a name="997424"> </a>Comments 
</h4>

<p><a name="997427"> </a>The authorization function treats all interactive tokens as failed authentications (without calling the Authentication Manager for authentication), therefore the result is whether a non-interactive authorization succeeds. This means that the device won't bother the user while this function is in operation.</p>

<p><a name="997768"> </a>The rule-set container must have been created prior to calling this function.</p>

<h3 class="hbH3">
  <a name="997438"> </a>AzmSetSyncBypass Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993762"> </a>Purpose 
</h4>

<p><a name="995421"> </a>Set the state of the sync bypass flags.</p>
<h4>
  <a name="993767"> </a>Declared In 
</h4>
<code>azm.h<a name="993770"> </a></code><h4>
  <a name="993772"> </a>Prototype 
</h4>
<pre class="proto"><a name="993775"></a>status_t AzmSetSyncBypass (
   AzmRuleSetType <code class="par">ruleset</code>,
   AzmActionType <code class="par">action</code>,
   Boolean <code class="par">state</code>
)
</pre>
<h4>
  <a name="993777"> </a>Parameters 
</h4>

<dl>
<dt><a name="993780"> </a><code>&rarr;  <i>ruleset</i></code></dt>
<dd><a name="995374"> </a>A reference to the rule-set container for which the bypass settings are to be modified.</dd>

<dt><a name="993784"> </a><code>&rarr;  <i>action</i></code></dt>
<dd><a name="995382"> </a>A bitmap of the actions. If a bit is set for a specific action then its bypass flag is set, otherwise it is cleared.</dd>

<dt><a name="993788"> </a><code>&rarr;  <i>state</i></code></dt>
<dd><a name="993790"> </a>What state to set the relationship to: <code>true</code> corresponds to "allow sync," while <code>false</code> corresponds to "disallow sync."</dd>

</dl>
<h4>
  <a name="993792"> </a>Returns 
</h4>

<p><a name="995388"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="995393"> </a><code>AzmErrInvalidReference</code></dt>
<dd><a name="995408"> </a><code class="par">ruleset</code> is invalid.</dd>

<dt><a name="995394"> </a><code>AzmErrAuthorizationFailed</code></dt>
<dd><a name="995413"> </a>Authorization of the rule-set container modify rule failed. You must be the manager that created the rule-set.</dd>

</dl>
<h4>
  <a name="993797"> </a>Comments 
</h4>

<p><a name="995358"> </a>Every rule-set can have a set of sync-bypass flags associated with it.  These bypass flags can be enabled or disabled on a per-action basis.</p>

<p><a name="995359"> </a>When sync-bypass is enabled for a specific action, an authenticated sync agent will be able to complete that action successfully.  (The sync-bypass rules takes care of authenticating sync agents). For example, if a data manager object (protected database) sets sync bypass for the READ action, a sync agent such as HotSync can access the contents of the database for READ only, thus enabling one-way sync.</p>

<p><a name="995363"> </a>Although this function can be called from anywhere, only callers that pass the ACTION_MODIFY rule will succeed in setting a bypass flag.</p>
<h4>
  <a name="993802"> </a>See Also 
</h4>

<p><a name="993805"> </a><a href="azm.html#993631"><code>AzmGetSyncBypass()</code></a></p>

<p><a name="992930"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996&#8211;2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="SecurityAndCrypto_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="SecurityAndCryptographyTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="AmPluginSignedCode.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CertificateMgr.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SecurityAndCryptographyIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>