<html>
<head>
<title>(Protein) Signature Verification Library | Security and Cryptography</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource_HTML_2003 20041101">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.6.2138">
<META NAME="LASTUPDATED" CONTENT="11/22/04 11:25:06">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="992934"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="SecurityAndCryptographyTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SecurityServices.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SslLib.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SecurityAndCryptographyIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">15 &nbsp;&nbsp;
Signature Verification Library</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">Security and Cryptography</p>
<p class="SubTitle">Exploring Palm OS </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="SecurityAndCrypto_Part2.html">Part II: Reference</a> </h1>
<h1 class="SideTOC1"><a href="SignVfy.html">15  Signature Verification Library</a></h1>

   <h2 class="SideTOC2"><a href="#992942">
   Signature Verification Library Structures and Types</a></h2>

      <h3 class="SideTOC3"><a href="#992950">
      SignCertificateBlockType</a></h3>

      <h3 class="SideTOC3"><a href="#1011198">
      SignCertificateIDType</a></h3>

      <h3 class="SideTOC3"><a href="#993145">
      SignSignatureBlockType</a></h3>

      <h3 class="SideTOC3"><a href="#1008095">
      SignGetNumSignaturesPtrType</a></h3>

      <h3 class="SideTOC3"><a href="#1008108">
      SignGetShLibCertIdListPtrType</a></h3>

      <h3 class="SideTOC3"><a href="#1008121">
      SignVerifySignatureByIDPtrType</a></h3>

      <h3 class="SideTOC3"><a href="#1008134">
      SignVerifySignatureByIndexPtrType</a></h3>

   <h2 class="SideTOC2"><a href="#993241">
   Signature Verification Library Constants</a></h2>

      <h3 class="SideTOC3"><a href="#993269">
      Signature Verification Library Entry Points</a></h3>

      <h3 class="SideTOC3"><a href="#996067">
      Signature Verification Library Errors</a></h3>

   <h2 class="SideTOC2"><a href="#993389">
   Signature Verification Library Functions and Macros</a></h2>

      <h3 class="SideTOC3"><a href="#993409">
      SignGetCertificateByID</a></h3>

      <h3 class="SideTOC3"><a href="#993471">
      SignGetCertificateByIndex</a></h3>

      <h3 class="SideTOC3"><a href="#993550">
      SignGetDigest</a></h3>

      <h3 class="SideTOC3"><a href="#993596">
      SignGetNumCertificates</a></h3>

      <h3 class="SideTOC3"><a href="#993681">
      SignGetNumSignatures</a></h3>

      <h3 class="SideTOC3"><a href="#993735">
      SignGetOverlayCertIdList</a></h3>

      <h3 class="SideTOC3"><a href="#993806">
      SignGetShLibCertIdList</a></h3>

      <h3 class="SideTOC3"><a href="#993856">
      SignGetSignatureByID</a></h3>

      <h3 class="SideTOC3"><a href="#993910">
      SignGetSignatureByIndex</a></h3>

      <h3 class="SideTOC3"><a href="#993960">
      SignVerifySignatureByID</a></h3>

      <h3 class="SideTOC3"><a href="#994302">
      SignVerifySignatureByIndex</a></h3>

</div>
</td>

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>

<!--END SIDETOC-->

<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="992948"> </a>Signed code in Palm OS Cobalt is used to validate the authenticity of a program resource. There are several types of resources that can be signed in Palm OS Cobalt, including applications, system patches, shared libraries, system components (add-ons), and system drivers. All of these resources are packaged as PRC files and then loaded onto the device. The APIs in the Signature Verification Library can be used to verify a PRC's signature on the device.</p>

<p><a name="1010514"> </a>This chapter provides reference documentation for the Signature Verification Library. This chapter is organized into the following sections:</p>
   <blockquote class = "bq"><a name="1009714"> </a><a href="SignVfy.html#992942">Signature Verification Library Structures and Types</a></blockquote>
   <blockquote class = "bq"><a name="993247"> </a><a href="SignVfy.html#993241">Signature Verification Library Constants</a></blockquote>
   <blockquote class = "bq"><a name="993395"> </a><a href="SignVfy.html#993389">Signature Verification Library Functions and Macros</a></blockquote>

<p><a name="992938"> </a>The header file <code>SignVfy.h</code> declares the API that this chapter describes.</p>

<p><a name="992940"> </a></p>

<h2 class="haH2">
  <a name="992942"> </a>Signature Verification Library Structures and Types <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="992950"> </a>SignCertificateBlockType Struct <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="992955"> </a>Purpose 
</h4>

<p><a name="996014"> </a>Data structure that references a signature block.</p>
<h4>
  <a name="992960"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="992963"> </a></code><h4>
  <a name="992965"> </a>Prototype 
</h4>
<pre class="proto"><a name="992968"></a>typedef struct {
   uint16_t encoding;
   SignCertificateIDType certificateID;
} SignCertificateBlockType
</pre>
<h4>
  <a name="992970"> </a>Fields 
</h4>

<dl>
<dt><a name="992973"> </a><code>encoding</code></dt>
<dd><a name="992975"> </a>The certificate encoding. </dd>

<dt><a name="992977"> </a><code>certificateID</code></dt>
<dd><a name="992979"> </a>The certificate ID.</dd>

</dl>
<h4>
  <a name="992981"> </a>Comments 
</h4>

<p><a name="995785"> </a>The certificate structure returned by <a href="SignVfy.html#993471"><code>SignGetCertificateByIndex()</code></a> and <a href="SignVfy.html#993409"><code>SignGetCertificateByID()</code></a> is byte buffer that contains the X.509 representation of the certificate. The signature verification library does not attempt to interpret the X.509 representation of the certificate; that task is left up to the certificate manager.</p>

<h3 class="hbH3">
  <a name="1011198"> </a>SignCertificateIDType Typedef <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="992991"> </a>Purpose 
</h4>

<p><a name="992994"> </a>Contains a certificate ID.</p>
<h4>
  <a name="992996"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="992999"> </a></code><h4>
  <a name="993001"> </a>Prototype 
</h4>
<pre class="proto"><a name="993004"></a>typedef uint8_t SignCertificateIDType[20]
</pre>
<h4>
  <a name="993036"> </a>Comments 
</h4>

<p><a name="993089"> </a>The certificate ID holds the SHA1 digest of the certificate public key.</p>

<h3 class="hbH3">
  <a name="993145"> </a>SignSignatureBlockType Struct <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993206"> </a>Purpose 
</h4>

<p><a name="993209"> </a>Data structure that references a signature block.</p>
<h4>
  <a name="993211"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993214"> </a></code><h4>
  <a name="993216"> </a>Prototype 
</h4>
<pre class="proto"><a name="993219"></a>typedef struct {
   uint32_t index;
   SignCertificateIDType certificateID;
   uint32_t signingDate;
} SignSignatureBlockType
</pre>
<h4>
  <a name="993221"> </a>Fields 
</h4>

<dl>
<dt><a name="993224"> </a><code>index</code></dt>
<dd><a name="993226"> </a>Index position of the signature block in the sign resource.</dd>

<dt><a name="993228"> </a><code>certificateID</code></dt>
<dd><a name="993230"> </a>ID of the certificate used to verify this signature.</dd>

<dt><a name="993232"> </a><code>signingDate</code></dt>
<dd><a name="993234"> </a>Date when the PRC file was signed.</dd>

</dl>

<h3 class="hbH3">
  <a name="1008095"> </a>SignGetNumSignaturesPtrType Typedef <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1008097"> </a>Purpose 
</h4>

<p><a name="1008101"> </a>Pointer to the <a href="SignVfy.html#993681"><code>SignGetNumSignatures()</code></a> function.</p>
<h4>
  <a name="1008102"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="1008103"> </a></code><h4>
  <a name="1008104"> </a>Prototype 
</h4>
<pre class="proto"><a name="1008105"></a>typedef status_t (*SignGetNumSignaturesPtrType)


   (DmOpenRef <code class="par">dbP</code>, uint16_t <code class="par">*sigCountP</code>)


</pre>

<h3 class="hbH3">
  <a name="1008108"> </a>SignGetShLibCertIdListPtrType Typedef <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1008110"> </a>Purpose 
</h4>

<p><a name="1008114"> </a>Pointer to the <a href="SignVfy.html#1008108"><code>SignGetShLibCertIdListPtrType()</code></a> function.</p>
<h4>
  <a name="1008115"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="1008116"> </a></code><h4>
  <a name="1008117"> </a>Prototype 
</h4>
<pre class="proto"><a name="1017126"></a>typedef status_t (*SignGetShLibCertIdListPtrType)


   (DmOpenRef <code class="par">dbP</code>, uint8_t <code class="par">*certIdList</code>,


   uint32_t <code class="par">*certIdListSize</code>)


</pre>

<h3 class="hbH3">
  <a name="1008121"> </a>SignVerifySignatureByIDPtrType Typedef <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1008123"> </a>Purpose 
</h4>

<p><a name="1008127"> </a>Pointer to the <a href="SignVfy.html#993960"><code>SignVerifySignatureByID()</code></a> function.</p>
<h4>
  <a name="1008128"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="1008129"> </a></code><h4>
  <a name="1008130"> </a>Prototype 
</h4>
<pre class="proto"><a name="1008131"></a>typedef status_t (*SignVerifySignatureByIDPtrType)


   (DmOpenRef <code class="par">dbP</code>,


   const SignCertificateIDType <code class="par">certificateID</code>)


</pre>

<h3 class="hbH3">
  <a name="1008134"> </a>SignVerifySignatureByIndexPtrType Typedef <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="1008136"> </a>Purpose 
</h4>

<p><a name="1008140"> </a>Pointer to the <a href="SignVfy.html#994302"><code>SignVerifySignatureByIndex()</code></a> function.</p>
<h4>
  <a name="1008141"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="1008142"> </a></code><h4>
  <a name="1008143"> </a>Prototype 
</h4>
<pre class="proto"><a name="1008144"></a>typedef status_t


   (*SignVerifySignatureByIndexPtrType)


   (DmOpenRef <code class="par">dbP</code>, uint16_t <code class="par">index</code>)


</pre>

<h2 class="haH2">
  <a name="993241"> </a>Signature Verification Library Constants <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="993269"> </a>Signature Verification Library Entry Points <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993271"> </a>Purpose 
</h4>

<p><a name="993274"> </a>Each of the functions in the Signature Verification Library is identified by its entry point. These constants define those entry points.</p>
<h4>
  <a name="993276"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993279"> </a></code><h4>
  <a name="993281"> </a>Constants 
</h4>

<dl>
<dt><a name="993284"> </a><code>#define entryNumSignGetCertificateByID (7)</code></dt>
<dt><a name="993288"> </a><code>#define entryNumSignGetCertificateByIndex (5)</code></dt>
<dt><a name="993296"> </a><code>#define entryNumSignGetDigest (8)</code></dt>
<dt><a name="993300"> </a><code>#define entryNumSignGetNumCertificates (3)</code></dt>
<dt><a name="993304"> </a><code>#define entryNumSignGetNumSignatures (2)</code></dt>
<dt><a name="993308"> </a><code>#define entryNumSignGetOverlayCertIdList (9)</code></dt>
<dt><a name="993312"> </a><code>#define entryNumSignGetShLibCertIdList (10)</code></dt>
<dt><a name="993316"> </a><code>#define entryNumSignGetSignatureByID (6)</code></dt>
<dt><a name="993320"> </a><code>#define entryNumSignGetSignatureByIndex (4)</code></dt>
<dt><a name="993324"> </a><code>#define entryNumSignVerifySignatureByID (1)</code></dt>
<dt><a name="993328"> </a><code>#define entryNumSignVerifySignatureByIndex (0)</code></dt>
</dl>

<h3 class="hbH3">
  <a name="996067"> </a>Signature Verification Library Errors <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996108"> </a>Purpose 
</h4>

<p><a name="996111"> </a>Error codes returned by the various Signature Verification Library functions.</p>
<h4>
  <a name="996176"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="996205"> </a></code><h4>
  <a name="996232"> </a>Constants 
</h4>

<dl>
<dt><a name="993332"> </a><code>#define signErrBufferTooSmall (signErrorClass | 10)</code></dt>
<dd><a name="1008653"> </a>The supplied buffer was too small. The required size has been returned through the length parameter.</dd>

<dt><a name="993336"> </a><code>#define signErrDigestMismatch (signErrorClass | 7)</code></dt>
<dd><a name="1008671"> </a>The signed digest does not match the calculated PRC digest.</dd>

<dt><a name="993340"> </a><code>#define signErrIndexOutOfBounds (signErrorClass | 3)</code></dt>
<dd><a name="1008877"> </a>The specified index is outside the range of certificate or signature indexes for the PRC.</dd>

<dt><a name="1008879"> </a><code>#define signErrInvalidCertResource (signErrorClass | 5)</code></dt>
<dd><a name="1008986"> </a>The <code>'cert'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="993348"> </a><code>#define signErrInvalidParams (signErrorClass | 9)</code></dt>
<dd><a name="993350"> </a>One or more function parameters is invalid.</dd>

<dt><a name="993352"> </a><code>#define signErrInvalidResourceInDB (signErrorClass | 12)</code></dt>
<dd><a name="1009026"> </a>The PRC contains an invalid resource.</dd>

<dt><a name="993360"> </a><code>#define signErrInvalidSignatureBlock (signErrorClass | 6)</code></dt>
<dd><a name="1009065"> </a>The signature block is invalid.</dd>

<dt><a name="993364"> </a><code>#define signErrInvalidSignResource (signErrorClass | 4)</code></dt>
<dd><a name="1009109"> </a>The <code>'sign'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="993368"> </a><code>#define signErrNoCertResource (signErrorClass | 2)</code></dt>
<dd><a name="1009149"> </a>No <code>'cert'</code> resource exists in the PRC file.</dd>

<dt><a name="993372"> </a><code>#define signErrNoSignResource (signErrorClass | 1)</code></dt>
<dd><a name="1009193"> </a>No <code>'sign'</code> resource exists in the PRC file.</dd>

<dt><a name="993376"> </a><code>#define signErrNotFound (signErrorClass | 8)</code></dt>
<dd><a name="1009240"> </a>A certificate or signature with the specified ID was not found.</dd>

<dt><a name="993380"> </a><code>#define signErrOutOfMemory (signErrorClass | 11)</code></dt>
<dd><a name="1009281"> </a>There was insufficient memory to complete the operation.</dd>

</dl>

<h2 class="haH2">
  <a name="993389"> </a>Signature Verification Library Functions and Macros <a href="#992934"><span class="nav">^TOP^</span></a>
</h2>


<h3 class="hbH3">
  <a name="993409"> </a>SignGetCertificateByID Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993414"> </a>Purpose 
</h4>

<p><a name="993417"> </a>Get a certificate by its ID.</p>
<h4>
  <a name="993419"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993422"> </a></code><h4>
  <a name="993424"> </a>Prototype 
</h4>
<pre class="proto"><a name="993427"></a>status_t SignGetCertificateByID (
   DmOpenRef <code class="par">dbP</code>,
      const SignCertificateIDType <code class="par">certificateID</code>,
      SignCertificateBlockType <code class="par">*certificateBlock</code>,
      uint32_t <code class="par">*certificateLength</code>,
      uint8_t <code class="par">*certificateData</code>
)
</pre>

<dl>
<dt><a name="993432"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="993434"> </a>Pointer to an open PRC database from which to get certificates.</dd>

<dt><a name="993436"> </a><code>&rarr;  <i>certificateID</i></code></dt>
<dd><a name="993442"> </a>The 20-byte ID of the certificate.</dd>

<dt><a name="993444"> </a><code>&larr;  <i>certificateBlockP</i></code></dt>
<dd><a name="993446"> </a>The PRC's certificate block. See <a href="SignVfy.html#992950"><code>SignCertificateBlockType</code></a>.</dd>

<dt><a name="993448"> </a><code>&harr;  <i>certificateLength</i></code></dt>
<dd><a name="993450"> </a>When calling this function, <code>*</code><code class="par">certificateLength</code> should contain the size of the buffer indicated by <code class="par">certificateData</code>. Upon return, it contains the length of the returned certificate data. If a <code>NULL</code> pointer was passed in for <code class="par">certificateData</code>, <code>signErrBufferTooSmall</code> is returned and the required length is returned through this parameter.</dd>

<dt><a name="993452"> </a><code>&larr;  <i>certificateData</i></code></dt>
<dd><a name="993454"> </a>A pointer to a caller-allocated buffer to receive the certificate data. To determine how large this buffer should be, set this parameter to <code>NULL</code>; upon return <code>*</code><code class="par">certificateLength </code>will contain the needed buffer size. After allocating a buffer of the proper size, call this function again to obtain the certificate.</dd>

</dl>
<h4>
  <a name="993456"> </a>Returns 
</h4>

<p><a name="993459"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009414"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1009415"> </a><code class="par">certificateBlockP </code>is <code>NULL</code>.</dd>

<dt><a name="998442"> </a><code>signErrNoCertResource</code></dt>
<dd><a name="998551"> </a>No <code>'cert'</code> resource exists in the PRC file.</dd>

<dt><a name="998443"> </a><code>signErrInvalidCertResource</code></dt>
<dd><a name="998554"> </a>The <code>'cert'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="998444"> </a><code>signErrNotFound</code></dt>
<dd><a name="998557"> </a>A certificate with the specified ID was not found.</dd>

<dt><a name="998445"> </a><code>signErrBufferTooSmall</code></dt>
<dd><a name="998562"> </a>The supplied buffer was too small. The required size has been returned through the <code class="par">certificateLength</code> parameter.</dd>

<dt><a name="998446"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="998573"> </a>The <code class="par">certificateLength</code> parameter was set to <code>NULL</code>.</dd>

</dl>
<h4>
  <a name="993461"> </a>Comments 
</h4>

<p><a name="993464"> </a>The ID of a certificate is the SHA1 digest of the DER encoded <code>SubjectPublicKeyInfo</code> field in the certificate, including the sequence tag and length.</p>

<p><a name="998587"> </a>The certificate structure returned by this function is a byte buffer that contains the X.509 representation of the certificate. The signature verification library does not attempt to interpret the X.509 representation of the certificate; that task is left up to the Certificate Manager.</p>
<h4>
  <a name="993466"> </a>See Also 
</h4>

<p><a name="993469"> </a><a href="SignVfy.html#993471"><code>SignGetCertificateByIndex()</code></a>, <a href="SignVfy.html#993596"><code>SignGetNumCertificates()</code></a>, <a href="SignVfy.html#993856"><code>SignGetSignatureByID()</code></a></p>

<h3 class="hbH3">
  <a name="993471"> </a>SignGetCertificateByIndex Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993476"> </a>Purpose 
</h4>

<p><a name="993479"> </a>Get a certificate given its index in the sign resource's certificate block list.</p>
<h4>
  <a name="993481"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993484"> </a></code><h4>
  <a name="993486"> </a>Prototype 
</h4>
<pre class="proto"><a name="993489"></a>status_t SignGetCertificateByIndex (
   DmOpenRef <code class="par">dbP</code>,
      uint16_t <code class="par">index</code>,
      SignCertificateBlockType <code class="par">*certificateBlock</code>,
      uint32_t <code class="par">*certificateLength</code>,
      uint8_t <code class="par">*certificateData</code>
)
</pre>
<h4>
  <a name="993491"> </a>Parameters 
</h4>

<dl>
<dt><a name="993494"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="999241"> </a>Pointer to an open PRC database from which to get certificates.</dd>

<dt><a name="993498"> </a><code>&rarr;  <i>index</i></code></dt>
<dd><a name="993500"> </a>The position of the certificate within the certificate block list.</dd>

<dt><a name="999229"> </a><code>&larr;  <i>certificateBlockP</i></code></dt>
<dd><a name="999230"> </a>The PRC's certificate block. See <a href="SignVfy.html#992950"><code>SignCertificateBlockType</code></a>.</dd>

<dt><a name="999234"> </a><code>&harr;  <i>certificateLength</i></code></dt>
<dd><a name="999235"> </a>When calling this function, <code>*</code><code class="par">certificateLength</code> should contain the size of the buffer indicated by <code class="par">certificateData</code>. Upon return, it contains the length of the returned certificate data. If a <code>NULL</code> pointer was passed in for <code class="par">certificateData</code>, <code>signErrBufferTooSmall</code> is returned and the required length is returned through this parameter.</dd>

<dt><a name="999236"> </a><code>&larr;  <i>certificateData</i></code></dt>
<dd><a name="999237"> </a>A pointer to a caller-allocated buffer to receive the certificate data. To determine how large this buffer should be, set this parameter to <code>NULL</code>; upon return <code>*</code><code class="par">certificateLength </code>will contain the needed buffer size. After allocating a buffer of the proper size, call this function again to obtain the certificate.</dd>

</dl>
<h4>
  <a name="993518"> </a>Returns 
</h4>

<p><a name="999281"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009390"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1009391"> </a><code class="par">certificateBlockP</code> is <code>NULL</code>.</dd>

<dt><a name="999282"> </a><code>signErrNoCertResource</code></dt>
<dd><a name="999283"> </a>No <code>'cert'</code> resource exists in the PRC file.</dd>

<dt><a name="999284"> </a><code>signErrInvalidCertResource</code></dt>
<dd><a name="999285"> </a>The <code>'cert'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="999286"> </a><code>signErrIndexOutOfBounds</code></dt>
<dd><a name="999287"> </a>The specified index is outside the range of certificate indexes for the PRC's certificate block.</dd>

<dt><a name="999288"> </a><code>signErrBufferTooSmall</code></dt>
<dd><a name="999289"> </a>The supplied buffer was too small. The required size has been returned through the <code class="par">certificateLength</code> parameter.</dd>

<dt><a name="999290"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="999291"> </a>The <code class="par">certificateLength</code> parameter was set to <code>NULL</code>.</dd>

</dl>
<h4>
  <a name="999292"> </a>Comments 
</h4>

<p><a name="999293"> </a>The ID of a certificate is the SHA1 digest of the DER encoded <code>SubjectPublicKeyInfo</code> field in the certificate, including the sequence tag and length.</p>

<p><a name="999294"> </a>The certificate structure returned by this function is a byte buffer that contains the X.509 representation of the certificate. The signature verification library does not attempt to interpret the X.509 representation of the certificate; that task is left up to the Certificate Manager.</p>
<h4>
  <a name="993545"> </a>See Also 
</h4>

<p><a name="999530"> </a><a href="SignVfy.html#993409"><code>SignGetCertificateByID()</code></a>, <a href="SignVfy.html#993596"><code>SignGetNumCertificates()</code></a>, <a href="SignVfy.html#993910"><code>SignGetSignatureByIndex()</code></a></p>

<h3 class="hbH3">
  <a name="993550"> </a>SignGetDigest Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993555"> </a>Purpose 
</h4>

<p><a name="993558"> </a>Calculate the digest of a PRC.</p>
<h4>
  <a name="993560"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993563"> </a></code><h4>
  <a name="993565"> </a>Prototype 
</h4>
<pre class="proto"><a name="993568"></a>status_t SignGetDigest (
   DmOpenRef <code class="par">dbP</code>,
      APHashInfoType <code class="par">*hashinfo</code>
)
</pre>
<h4>
  <a name="993570"> </a>Parameters 
</h4>

<dl>
<dt><a name="993573"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="1000404"> </a>Pointer to an open PRC database for which the digest is to be calculated.</dd>

<dt><a name="1011580"> </a><code>&harr;  <i>hashinfo</i></code></dt>
<dd><a name="1011584"> </a>An initialized <a href="CPMLibCommon.html#1006140"><code>APHashInfoType</code></a> structure.</dd>

</dl>
<h4>
  <a name="1011585"> </a>Returns 
</h4>

<p><a name="1011586"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1001375"> </a><code>signErrOutOfMemory</code></dt>
<dd><a name="1001633"> </a>There was insufficient memory to complete the operation.</dd>

<dt><a name="1001376"> </a><code>signErrInvalidResourceInDB</code></dt>
<dd><a name="1001693"> </a>The PRC contains an invalid resource.</dd>

</dl>
<h4>
  <a name="993586"> </a>Comments 
</h4>

<p><a name="993589"> </a>The caller is responsible for calling <a href="CPMLibARMInterface.html#995582"><code>CPMLibHashFinal()</code></a> and releasing any resources allocated by the Crytographic Provider Manager with <a href="CPMLibARMInterface.html#997128"><code>CPMLibReleaseHashInfo()</code></a>.</p>

<h3 class="hbH3">
  <a name="993596"> </a>SignGetNumCertificates Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993601"> </a>Purpose 
</h4>

<p><a name="993604"> </a>Get the number of certificates in the <code>'cert'</code> resource.</p>
<h4>
  <a name="993606"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993609"> </a></code><h4>
  <a name="993611"> </a>Prototype 
</h4>
<pre class="proto"><a name="993614"></a>status_t SignGetNumCertificates (
   DmOpenRef <code class="par">dbP</code>,
      uint16_t <code class="par">*num</code>
)
</pre>
<h4>
  <a name="993616"> </a>Parameters 
</h4>

<dl>
<dt><a name="993619"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="1001737"> </a>Pointer to an open PRC database from which to get certificates.</dd>

<dt><a name="993623"> </a><code>&larr;  <i>num</i></code></dt>
<dd><a name="993625"> </a>The number of certificates in the <code>'cert'</code> resource.</dd>

</dl>
<h4>
  <a name="993627"> </a>Returns 
</h4>

<p><a name="1001810"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009334"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1009335"> </a><code class="par">num</code> is <code>NULL</code>.</dd>

<dt><a name="1001750"> </a><code>signErrNoCertResource</code></dt>
<dd><a name="1001979"> </a>No <code>'cert'</code> resource exists in the PRC file.</dd>

<dt><a name="1001751"> </a><code>signErrInvalidCertResource</code></dt>
<dd><a name="1002022"> </a>The <code>'cert'</code> resource is malformed, or invalid in some way.</dd>

</dl>
<h4>
  <a name="993660"> </a>See Also 
</h4>

<p><a name="993671"> </a><a href="SignVfy.html#993471"><code>SignGetCertificateByIndex()</code></a>, <a href="SignVfy.html#993681"><code>SignGetNumSignatures()</code></a></p>

<h3 class="hbH3">
  <a name="993681"> </a>SignGetNumSignatures Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993694"> </a>Purpose 
</h4>

<p><a name="994993"> </a>Get the number of signatures in the <code>'sign'</code> resource.</p>
<h4>
  <a name="993699"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993702"> </a></code><h4>
  <a name="993704"> </a>Prototype 
</h4>
<pre class="proto"><a name="993707"></a>status_t SignGetNumSignatures (
   DmOpenRef <code class="par">dbP</code>,
      uint16_t <code class="par">*sigCountP</code>
)
</pre>
<h4>
  <a name="993709"> </a>Parameters 
</h4>

<dl>
<dt><a name="1002156"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="1002157"> </a>Pointer to an open PRC database from which to get signatures.</dd>

<dt><a name="993716"> </a><code>&larr;  <i>sigCountP</i></code></dt>
<dd><a name="1002209"> </a>The number of signature blocks in the <code>'sign'</code> resource.</dd>

</dl>
<h4>
  <a name="993720"> </a>Returns 
</h4>

<p><a name="1002351"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009331"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1009332"> </a><code class="par">sigCountP</code> is <code>NULL</code>.</dd>

<dt><a name="1002352"> </a><code>signErrNoSignResource</code></dt>
<dd><a name="1002353"> </a>No <code>'sign'</code> resource exists in the PRC file.</dd>

<dt><a name="1002354"> </a><code>signErrInvalidSignResource</code></dt>
<dd><a name="1002355"> </a>The <code>'sign'</code> resource is malformed, or invalid in some way.</dd>

</dl>
<h4>
  <a name="993730"> </a>See Also 
</h4>

<p><a name="1002823"> </a><a href="SignVfy.html#993596"><code>SignGetNumCertificates()</code></a>, <a href="SignVfy.html#993910"><code>SignGetSignatureByIndex()</code></a></p>

<h3 class="hbH3">
  <a name="993735"> </a>SignGetOverlayCertIdList Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993740"> </a>Purpose 
</h4>

<p><a name="993743"> </a>Get the list of certificate IDs that will validate an overlay for a signed base PRC.</p>
<h4>
  <a name="993745"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993748"> </a></code><h4>
  <a name="1020180"> </a>Prototype 
</h4>
<pre class="proto"><a name="1020181"></a>status_t SignGetOverlayCertIdList (
   DmOpenRef <code class="par">dbP</code>,
      uint8_t <code class="par">*certIdList</code>,
   uint32_t <code class="par">*certIdListSize</code>
)
</pre>
<h4>
  <a name="993755"> </a>Parameters 
</h4>

<dl>
<dt><a name="1003404"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="1003405"> </a>Pointer to an open PRC database from which to get certificates.</dd>

<dt><a name="993762"> </a><code>&larr;  <i>certIdList</i></code></dt>
<dd><a name="993764"> </a>Pointer to a byte buffer tht receives the certificate IDs. To determine how large this buffer should be, set this parameter to <code>NULL</code>; upon return <code>*</code><code class="par">certIdListSize </code>will contain the needed buffer size. After allocating a buffer of the proper size, call this function again to obtain the certificate ID list.</dd>

<dt><a name="993766"> </a><code>&harr;  <i>certIdListSize</i></code></dt>
<dd><a name="1004005"> </a>When calling this function, <code>*</code><code class="par">certIdListSize</code> should contain the size of the buffer indicated by <code class="par">certIdList</code>. Upon return, it contains the length of the returned certificate data. If a <code>NULL</code> pointer was passed in for <code class="par">certIdList</code>, <code>signErrBufferTooSmall</code> is returned and the required length is returned through this parameter. </dd>

</dl>
<h4>
  <a name="993774"> </a>Returns 
</h4>

<p><a name="1004886"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009483"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1009484"> </a><code class="par">certIDListSize </code>is <code>NULL</code>.</dd>

<dt><a name="1004923"> </a><code>signErrNoSignResource</code></dt>
<dd><a name="1005430"> </a>No <code>'sign'</code> resource exists in the PRC file.</dd>

<dt><a name="1004924"> </a><code>signErrInvalidSignResource</code></dt>
<dd><a name="1005440"> </a>The <code>'sign'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="1004925"> </a><code>signErrBufferTooSmall</code></dt>
<dd><a name="1005841"> </a>The supplied buffer was too small. The required size has been returned through the <code class="par">certIdListSize</code> parameter.</dd>

<dt><a name="1004926"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1005852"> </a>The <code class="par">certIdListSize</code> parameter was set to <code>NULL</code>.</dd>

</dl>
<h4>
  <a name="993801"> </a>See Also 
</h4>

<p><a name="993804"> </a><a href="SignVfy.html#993806"><code>SignGetShLibCertIdList()</code></a></p>

<h3 class="hbH3">
  <a name="993806"> </a>SignGetShLibCertIdList Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993811"> </a>Purpose 
</h4>

<p><a name="993814"> </a>Get the list of certificate IDs that will validate a shared library (patch) for the signed base PRC.</p>
<h4>
  <a name="993816"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993819"> </a></code><h4>
  <a name="993821"> </a>Prototype 
</h4>
<pre class="proto"><a name="993824"></a>status_t SignGetShLibCertIdList (
   DmOpenRef <code class="par">dbP</code>,
      uint8_t <code class="par">*certIdList</code>,
   uint32_t <code class="par">*certIdListSize</code>
)
</pre>
<h4>
  <a name="993826"> </a>Parameters 
</h4>

<dl>
<dt><a name="1005910"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="1005911"> </a>Pointer to an open PRC database from which to get certificates.</dd>

<dt><a name="1005912"> </a><code>&larr;  <i>certIdList</i></code></dt>
<dd><a name="1005913"> </a>Pointer to a byte buffer tht receives the certificate IDs. To determine how large this buffer should be, set this parameter to <code>NULL</code>; upon return <code>*</code><code class="par">certIdListSize </code>will contain the needed buffer size. After allocating a buffer of the proper size, call this function again to obtain the certificate ID list.</dd>

<dt><a name="1005914"> </a><code>&harr;  <i>certIdListSize</i></code></dt>
<dd><a name="1005915"> </a>When calling this function, <code>*</code><code class="par">certIdListSize</code> should contain the size of the buffer indicated by <code class="par">certIdList</code>. Upon return, it contains the length of the returned certificate data. If a <code>NULL</code> pointer was passed in for <code class="par">certIdList</code>, <code>signErrBufferTooSmall</code> is returned and the required length is returned through this parameter. </dd>

</dl>
<h4>
  <a name="993841"> </a>Returns 
</h4>

<p><a name="1006013"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009493"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1009494"> </a><code class="par">certIDListSize </code>is <code>NULL</code>.</dd>

<dt><a name="1006014"> </a><code>signErrNoSignResource</code></dt>
<dd><a name="1006015"> </a>No <code>'sign'</code> resource exists in the PRC file.</dd>

<dt><a name="1006016"> </a><code>signErrInvalidSignResource</code></dt>
<dd><a name="1006017"> </a>The <code>'sign'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="1006018"> </a><code>signErrBufferTooSmall</code></dt>
<dd><a name="1006019"> </a>The supplied buffer was too small. The required size has been returned through the <code class="par">certIdListSize</code> parameter.</dd>

<dt><a name="1006020"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1006021"> </a>The <code class="par">certIdListSize</code> parameter was set to <code>NULL</code>.</dd>

</dl>
<h4>
  <a name="1006022"> </a>See Also 
</h4>

<p><a name="1006026"> </a><a href="SignVfy.html#993735"><code>SignGetOverlayCertIdList()</code></a></p>

<h3 class="hbH3">
  <a name="993856"> </a>SignGetSignatureByID Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993861"> </a>Purpose 
</h4>

<p><a name="993864"> </a>Get a signature block given the ID of the signing certificate.</p>
<h4>
  <a name="993866"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993869"> </a></code><h4>
  <a name="993871"> </a>Prototype 
</h4>
<pre class="proto"><a name="993874"></a>status_t SignGetSignatureByID (
   DmOpenRef <code class="par">dbP</code>,
      const SignCertificateIDType <code class="par">certificateID</code>,
      SignSignatureBlockType <code class="par">*signatureBlockP</code>
)
</pre>
<h4>
  <a name="993876"> </a>Parameters 
</h4>

<dl>
<dt><a name="993879"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="999649"> </a>Pointer to an open PRC database from which to get signatures.</dd>

<dt><a name="999650"> </a><code>&rarr;  <i>certificateID</i></code></dt>
<dd><a name="999707"> </a>The 20-byte ID of the certificate.</dd>

<dt><a name="999708"> </a><code>&larr;  <i>signatureBlockP</i></code></dt>
<dd><a name="999709"> </a>The returned signature block, which contains meta-data about the signature.</dd>

</dl>
<h4>
  <a name="993895"> </a>Returns 
</h4>

<p><a name="999867"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009463"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1009464"> </a><code class="par">signatureBlockP </code>is <code>NULL</code>.</dd>

<dt><a name="999868"> </a><code>signErrNoSignResource</code></dt>
<dd><a name="999869"> </a>No <code>'sign'</code> resource exists in the PRC file.</dd>

<dt><a name="999870"> </a><code>signErrInvalidSignResource</code></dt>
<dd><a name="999871"> </a>The <code>'sign'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="999872"> </a><code>signErrNotFound</code></dt>
<dd><a name="999873"> </a>A signature with the specified certificate ID was not found.</dd>

</dl>
<h4>
  <a name="993900"> </a>Comments 
</h4>

<p><a name="993903"> </a>A signature block ID is the ID of the public certificate that can be used to verify the signature.</p>
<h4>
  <a name="993905"> </a>See Also 
</h4>

<p><a name="993908"> </a><a href="SignVfy.html#993409"><code>SignGetCertificateByID()</code></a>, <a href="SignVfy.html#993681"><code>SignGetNumSignatures()</code></a>, <a href="SignVfy.html#993910"><code>SignGetSignatureByIndex()</code></a>, <a href="SignVfy.html#993960"><code>SignVerifySignatureByID()</code></a></p>

<h3 class="hbH3">
  <a name="993910"> </a>SignGetSignatureByIndex Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993915"> </a>Purpose 
</h4>

<p><a name="993918"> </a>Get a signature block given its index position in the signature block list.</p>
<h4>
  <a name="993920"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993923"> </a></code><h4>
  <a name="993925"> </a>Prototype 
</h4>
<pre class="proto"><a name="993928"></a>status_t SignGetSignatureByIndex (
   DmOpenRef <code class="par">dbP</code>,
      uint16_t <code class="par">index</code>,
      SignSignatureBlockType <code class="par">*signatureBlockP</code>
)
</pre>
<h4>
  <a name="993930"> </a>Parameters 
</h4>

<dl>
<dt><a name="1000073"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="1000074"> </a>Pointer to an open PRC database from which to get signatures.</dd>

<dt><a name="1000195"> </a><code>&rarr;  <i>index</i></code></dt>
<dd><a name="1000196"> </a>The position of the signature within the signature block list.</dd>

<dt><a name="1000134"> </a><code>&larr;  <i>signatureBlockP</i></code></dt>
<dd><a name="1000135"> </a>The returned signature block, which contains meta-data about the signature.</dd>

</dl>
<h4>
  <a name="993945"> </a>Returns 
</h4>

<p><a name="1000262"> </a>Returns <code>errNone</code> if the operation completed successfully, or one of the following otherwise:</p>

<dl>
<dt><a name="1009367"> </a><code>signErrInvalidParameter</code></dt>
<dd><a name="1009368"> </a><code class="par">signatureBlockP</code> is <code>NULL</code>.</dd>

<dt><a name="1000263"> </a><code>signErrNoSignResource</code></dt>
<dd><a name="1000264"> </a>No <code>'sign'</code> resource exists in the PRC file.</dd>

<dt><a name="1000265"> </a><code>signErrInvalidSignResource</code></dt>
<dd><a name="1000266"> </a>The <code>'sign'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="1000306"> </a><code>signErrIndexOutOfBounds</code></dt>
<dd><a name="1000307"> </a>The specified index is outside the range of signature indexes for the PRC's signature block.</dd>

</dl>
<h4>
  <a name="993950"> </a>Comments 
</h4>

<p><a name="1000311"> </a>A signature block ID is the ID of the public certificate that can be used to verify the signature.</p>
<h4>
  <a name="993955"> </a>See Also 
</h4>

<p><a name="1000325"> </a><a href="SignVfy.html#993471"><code>SignGetCertificateByIndex()</code></a>, <a href="SignVfy.html#993681"><code>SignGetNumSignatures()</code></a>, <a href="SignVfy.html#993856"><code>SignGetSignatureByID()</code></a>, <a href="SignVfy.html#994302"><code>SignVerifySignatureByIndex()</code></a></p>

<h3 class="hbH3">
  <a name="993960"> </a>SignVerifySignatureByID Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="993965"> </a>Purpose 
</h4>

<p><a name="993968"> </a>Verify the signature block referenced by the specified ID. The ID is that of the certificate used for verification of the digital signature block.</p>
<h4>
  <a name="993970"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="993973"> </a></code><h4>
  <a name="993975"> </a>Prototype 
</h4>
<pre class="proto"><a name="994004"></a>status_t SignVerifySignatureByID (
   DmOpenRef <code class="par">dbP</code>,
      const SignCertificateIDType <code class="par">certificateID</code>
)
</pre>
<h4>
  <a name="994060"> </a>Parameters 
</h4>

<dl>
<dt><a name="1006192"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="1006193"> </a>Pointer to an open PRC database from which to get signatures.</dd>

<dt><a name="1006194"> </a><code>&rarr;  <i>certificateID</i></code></dt>
<dd><a name="1006195"> </a>The 20-byte ID of the certificate.</dd>

</dl>
<h4>
  <a name="994287"> </a>Returns 
</h4>

<p><a name="1006404"> </a>Returns <code>errNone</code> if the signature block is valid, or one of the following if an error occurred:</p>

<dl>
<dt><a name="1006405"> </a><code>signErrNoSignResource</code></dt>
<dd><a name="1006880"> </a>No <code>'sign'</code> resource exists in the PRC file.</dd>

<dt><a name="1006406"> </a><code>signErrInvalidSignResource</code></dt>
<dd><a name="1006559"> </a>The <code>'sign'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="1006407"> </a><code>signErrInvalidSignatureBlock</code></dt>
<dd><a name="1006562"> </a>The signature block is invalid.</dd>

<dt><a name="1006408"> </a><code>signErrDigestMismatch</code></dt>
<dd><a name="1006568"> </a>The signed digest does not match the calculated PRC digest.</dd>

</dl>
<h4>
  <a name="994297"> </a>See Also 
</h4>

<p><a name="994300"> </a><a href="SignVfy.html#993856"><code>SignGetSignatureByID()</code></a>, <a href="SignVfy.html#994302"><code>SignVerifySignatureByIndex()</code></a></p>

<h3 class="hbH3">
  <a name="994302"> </a>SignVerifySignatureByIndex Function <a href="#992934"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="994307"> </a>Purpose 
</h4>

<p><a name="1006574"> </a>Verify the signature block referenced by the specified index.</p>
<h4>
  <a name="994312"> </a>Declared In 
</h4>
<code>SignVfy.h<a name="994315"> </a></code><h4>
  <a name="994317"> </a>Prototype 
</h4>
<pre class="proto"><a name="994320"></a>status_t SignVerifySignatureByIndex   (
   DmOpenRef <code class="par">dbP</code>,
   uint16_t <code class="par">index</code>
)
</pre>
<h4>
  <a name="994322"> </a>Parameters 
</h4>

<dl>
<dt><a name="1006606"> </a><code>&rarr;  <i>dbP</i></code></dt>
<dd><a name="1006607"> </a>Pointer to an open PRC database from which to get signatures.</dd>

<dt><a name="994329"> </a><code>&rarr;  <i>index</i></code></dt>
<dd><a name="1006833"> </a>The position of the signature within the signature block list.</dd>

</dl>
<h4>
  <a name="994333"> </a>Returns 
</h4>

<p><a name="1006884"> </a>Returns <code>errNone</code> if the signature block is valid, or one of the following if an error occurred:</p>

<dl>
<dt><a name="1006885"> </a><code>signErrNoSignResource</code></dt>
<dd><a name="1006886"> </a>No <code>'sign'</code> resource exists in the PRC file.</dd>

<dt><a name="1006887"> </a><code>signErrInvalidSignResource</code></dt>
<dd><a name="1006888"> </a>The <code>'sign'</code> resource is malformed, or invalid in some way.</dd>

<dt><a name="1006950"> </a><code>signErrIndexOutOfBounds</code></dt>
<dd><a name="1006934"> </a>The specified index is outside the range of certificate indexes for the PRC's certificate block.</dd>

<dt><a name="1006889"> </a><code>signErrInvalidSignatureBlock</code></dt>
<dd><a name="1006890"> </a>The signature block is invalid.</dd>

<dt><a name="1006891"> </a><code>signErrDigestMismatch</code></dt>
<dd><a name="1006892"> </a>The signed digest does not match the calculated PRC digest.</dd>

</dl>
<h4>
  <a name="994343"> </a>See Also 
</h4>

<p><a name="1006648"> </a><a href="SignVfy.html#993910"><code>SignGetSignatureByIndex()</code></a>, <a href="SignVfy.html#993960"><code>SignVerifySignatureByID()</code></a></p>

<p><a name="992930"> </a></p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1996&#8211;2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="SecurityAndCrypto_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="SecurityAndCryptographyTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SecurityServices.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SslLib.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SecurityAndCryptographyIX.html">Index</a>
</p>
</td>
</tr>
</table>
<!-- END FOOTER -->

</body>
</html>