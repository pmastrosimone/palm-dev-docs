<HTML>

<HEAD>
<SMALLSCREENIGNORE> 
<LINK HREF="copy_of_palmos.css" REL="stylesheet" TYPE="text/css">
<LINK HREF="document.css" REL="StyleSheet" TYPE="text/css" media="screen">
<!-- SCRIPT_START -->
<!-- SCRIPT_END -->
</SMALLSCREENIGNORE>
<TITLE>Localized Applications</TITLE>

<META NAME="PALMTEMPLATE" CONTENT="1006-002 Palm HTML 20020513">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks Publisher Professional Edition 6.0.7">
<META NAME="TEMPLATEBASE" CONTENT="Palm HTML 20010625">
<META NAME="LASTUPDATED" CONTENT="12/13/02 10:05:59">
<META HTTP-EQUIV="content-type" CONTENT="text/html;charset=ISO-8859-1">

</HEAD>

<BODY LEFTMARGIN="0" MARGINWIDTH="0" TOPMARGIN="0" MARGINHEIGHT="0">
<SMALLSCREENIGNORE> 
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
	<td><a name="1021391"></a>
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr height="35"> 
          <td height="35" colspan="2" bgcolor="#6699CC">&nbsp;</td>
        </tr>
        <tr valign="top"> 
          <td width="160" align="left"><a href="http://www.palmos.com"><img src="images/bigorb.gif" width="160" height="110" border="0"></a></td>
          <td align="left" width="100%"> 
            </SMALLSCREENIGNORE>
            <!-- CONTENTCELL_START -->
            <img border="0" height="45" src="images/orb_bkgrnd_600.gif" width="600"><br>
            <!--PAGENAV_START-->
            <SPAN CLASS="subnav">&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/index.html">Home</a> 
              &nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/">Developers</a> 
              &nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/support/">Development Support</a>
              &nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/support/docs/">Documentation</a></span><BR>
             <img src="images/pixel_ltblue.gif" width="600" height="1" border="0" vspace="2"><br>
             <h2 class="HeadDocPage">11  Localized Applications</h2>
             <img src="images/pixel_ltblue.gif" width="600" height="1" border="0" vspace="2"><br>
             &nbsp;<span class="subnav"><a href="CompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="SystemFeatures.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="DebuggingStrats.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CompanionIX.html">Index</a></span>  
            <!--PAGENAV_END-->
          </td>
        </tr>
      </table>
    </td>
			</tr>
  <tr>
				<td> 
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
							<td>&nbsp;&nbsp;&nbsp;</td>
						</tr>
        <tr>
		<td valign="top" width="10">&nbsp;&nbsp;&nbsp;</td>
		<td valign="top" width="175">
			<p class="SideTitle">Title - <br><a href="Companion_Front.html">Palm OS® Programmer's Companion</a></p>
			<p class="SideTOC1-PartTab">Volume I </p>
			<p class="SideTOC1"><a href="Localization.html">11  Localized Applications</a></p>
			
<p class="SideTOC2">
<a href="#1021435">Localization Guidelines
</a></p>

<p class="SideTOC2">
<a href="#1021462">Using Overlays to Localize Resources
</a></p>

<p class="SideTOC2">
<a href="#1021504">Dates
</a></p>

<p class="SideTOC2">
<a href="#1021601">Numbers
</a></p>

<p class="SideTOC2">
<a href="#1021643">Obtaining Locale Information
</a></p>

<p class="SideTOC2">
<a href="#1021765">Notes on the Japanese Implementation
</a></p>

<p class="SideTOC3">
<a href="#1021788">Japanese Character Encoding
</a></p>

<p class="SideTOC3">
<a href="#1021791">Japanese Character Input
</a></p>

<p class="SideTOC3">
<a href="#1021798">The Calculator Button
</a></p>

<p class="SideTOC3">
<a href="#1021801">Displaying Japanese Strings on UI Objects
</a></p>

<p class="SideTOC3">
<a href="#1021804">Displaying Error Messages
</a></p>

<p class="SideTOC2">
<a href="#1021816">Summary of Localization
</a></p>

		</td>

		<td width="5">&nbsp;&nbsp;</td>
		<td width="1" bgcolor="#6699cc">&nbsp;</td>
		<td width="5">&nbsp;&nbsp;</td>
		<td> 

				<!-- CONTENT_START -->

<p class="Body">
  <a name="1021393"> </a>When you write an application, or any other type of software, you need to take special care when working with characters, strings, numbers, and dates, as different countries represent these items in different ways. This chapter describes how to write code that works properly for any language that is supported by Palm OS<sup>®</sup>. he chapter covers:
</p>

  <a name="1021397"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021435">Localization Guidelines</a></p>

  <a name="1021401"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021462">Using Overlays to Localize Resources</a></p>

  <a name="1021405"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021504">Dates</a></p>

  <a name="1021409"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021601">Numbers</a></p>

  <a name="1021413"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021643">Obtaining Locale Information</a></p>

  <a name="1021417"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021765">Notes on the Japanese Implementation</a></p>

  <a name="1021421"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021816">Summary of Localization</a></p>
<p class="Body">
  <a name="1021425"> </a>In addition to this chapter, also see <a href="Text.html#1006349">Chapter 8, "Text,"</a> which describes how to work with text and characters in a way that makes your application easily localizable. 
</p>
<div class="NINoteImportant"><hr>
  <a name="1021426"> </a> <span style="color: #333;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">NOTE:  </span> PalmOSGlue provides backward compatibility for many of the functions described in this chapter. When a function has a PalmOSGlue equivalent, that equivalent is shown in parentheses following the function name. See <a href="Nutshell.html#970278">"Backward Compatibility with PalmOSGlue"</a> for more information on PalmOSGlue. 
<hr>
</div>
<p class="Body">
  <a name="1021430"> </a>This chapter does not cover how to actually perform localization of resources. For more information on this subject, see the <i>Palm OS Programming Development Tools Guide</i>.
</p>

<h2 class="HaHeadA">
  <a name="1021435"> </a>Localization Guidelines 
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021437"> </a>If there is a possibility that your application is going to be localized, you should follow these guidelines when you start planning the application. It's a good idea to follow these guidelines even if you don't think your application is going to be localized. 
</p>

  <a name="1021438"> </a><p class="B1Bullet"> &#8226; If you use the English language version of the software as a guide when designing the layout of the screen, try to allow:</p>
  <a name="1021439"> </a><p class="B2BulletSub"> -	 extra space for strings </p>  <a name="1021440"> </a><p class="B2BulletSub"> -	 larger dialogs than the English version requires</p>
  <a name="1021441"> </a><p class="B1Bullet"> &#8226; Don't put language-dependent strings in code. If you have to display text directly on the screen, remember that a one-line warning or message in one language may need more than one line in another language. See the section <a href="Text.html#1006519">"Strings"</a> in <a href="Text.html#1006349">Chapter 8, "Text,"</a> for further discussion. </p>

  <a name="1021448"> </a><p class="B1Bullet"> &#8226; Don't depend on the physical characteristics of a string, such as the number of characters, the fact that it contains a particular substring, or any other attribute that might disappear in translation. </p>

  <a name="1021449"> </a><p class="B1Bullet"> &#8226; Database names must use only 7-bit ASCII characters (0x20 through 0x7E). If an actual PDB name is displayed to the user, the application should have a way of associating a localizable name (resource based, if possible) with each database.</p>

  <a name="1021450"> </a><p class="B1Bullet"> &#8226; Use the functions described in this chapter when working with characters, strings, numbers, and dates. </p>

  <a name="1021451"> </a><p class="B1Bullet"> &#8226; Consider using string templates as described in the section <a href="Text.html#1006766">"Dynamically Creating String Content"</a> in <a href="Text.html#1006349">Chapter 8</a>. Use as many parameters as possible to give localizers greater flexibility. Avoid building sentences by concatenating substrings together, as this often causes translation problems. </p>

  <a name="1021458"> </a><p class="B1Bullet"> &#8226; Abbreviations may be the best way to accommodate the particularly scarce screen real estate on the Palm Powered<sup>&#8482;</sup> handheld. </p>

  <a name="1021459"> </a><p class="B1Bullet"> &#8226; Remember that user interface elements such as lists, fields, and tips scroll if you need more space. </p>
<p class="Body">
  <a name="1021460"> </a>The book <i>Palm OS User Interface Guidelines</i> provides further user interface guidelines. 
</p>

<h2 class="HaHeadA">
  <a name="1021462"> </a>Using Overlays to Localize Resources 
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021464"> </a>Palm OS version 3.5 adds support for localizing resource databases through <b>overlays</b>. Localization overlays provide a method for localizing a software module without requiring a recompile or modification of the software. Each overlay database is a separate resource database that provides an appropriately localized set of resources for a single software module (the PRC file, or <b>base database</b>) and a single target <b>locale</b> (language and country). 
</p>
<p class="Body">
  <a name="1021465"> </a>No requirements are placed on the base database, so for example, third parties can construct localization overlays for existing applications without forcing any modifications by the original application developer. In rare cases, you might want to disable the use of overlays to prevent third parties from creating overlays for your application. To do so, you should include an <span style="font-family: monospace">'xprf'=0</span> resource (symbolically named <span style="font-family: monospace">sysResTExtPrefs</span>) in the database and set its <span style="font-family: monospace">disableOverlays</span> flag. This resource is defined in <span style="font-family: monospace">UIResources.r</span>. 
</p>
<p class="Body">
  <a name="1021468"> </a>An overlay database has the same creator as the base database, but its type is <span style="font-family: monospace">'ovly'</span>, and a suffix identifying the target locale is appended to its name. For example, <span style="font-family: monospace">Datebook.prc</span> might be overlaid with a database named <span style="font-family: monospace">Datebook_jpJP</span>, which indicates that this overlay is for Japan. Each overlay database has an <span style="font-family: monospace">'ovly'</span>=1000 resource specifying the base database's type, the target locale, and information necessary to identify the correct version of the base database for which it was designed. 
</p>
<p class="Body">
  <a name="1021469"> </a>The Palm OS SDK provides tools that you can use to create overlays. See the "PRC to Overlay Tool"<i> </i>chapter in the <i>Palm OS Programming Development Tools Guide</i> for more information on creating overlays. 
</p>
<p class="Body">
  <a name="1021474"> </a>When a PRC file is opened on a system that supports overlays, the Overlay Manager determines what the current locale is for this handheld, and it looks for an overlay matching the base database and the locale. The overlay database's name must match the base database's name, its suffix must match the locale's suffix, and it must have an <span style="font-family: monospace">'ovly'</span>=1000 resource that matches the base database. If the name, suffix, and overlay resource are all correct, the overlay is opened in addition to the PRC file. When the PRC file is closed, its overlay is closed as well. 
</p>
<p class="Body">
  <a name="1021475"> </a>The overlay is opened in read-only mode and is hidden from the programmer. When you open a database, you'll receive a reference to the base database, not the overlay. You can simply make Resource Manager calls like you normally would, and the Resource Manager accesses the overlay where appropriate. 
</p>
<p class="Body">
  <a name="1021476"> </a>When accessing a localizable resource, do not use functions that search for a resource only in the database you specify. For example: 
</p>
<pre  class="Preformatted">
// WRONG! searches only one database. <a name="1021477"> </a>
DmOpenRef dbP = DmNextOpenResDatabase(NULL);<a name="1021479"> </a>
UInt16 resIndex = DmFindResource(dpP, strRsc, <a name="1021481"> </a>
  strRscID);<a name="1021482"> </a>
MemHandle resH = DmGetResourceIndex(dbP, <a name="1021484"> </a>
  resIndex);<a name="1021485"> </a>
</pre>
<p class="Body">
  <a name="1021486"> </a>In the example above, <span style="font-family: monospace">dbP</span> is a reference to the most recently opened database, which is typically the overlay version of the database. Passing this reference to <span style="font-family: monospace">DmFindDatabase</span> means that you are searching only the overlay database for the resource. If you're searching for a non-localized resource, <span style="font-family: monospace">DmFindResource</span> won't be able to locate it. Instead, you should use <span style="font-family: monospace">DmGet1Resource</span>, which searches the most recently opened database and its overlay for a resource, or <span style="font-family: monospace">DmGetResource</span>, which searches all open databases and their overlays. 
</p>
<pre  class="Preformatted">
// Right. DmGet1Resource searches both <a name="1021487"> </a>
// databases. <a name="1021488"> </a>
MemHandle resH = DmGet1Resource(strRsc, <a name="1021490"> </a>
  strRscID);<a name="1021491"> </a>
// Or use DmGetResource to search all open <a name="1021492"> </a>
// databases.<a name="1021493"> </a>
MemHandle resH = DmGetResource(strRsc, <a name="1021495"> </a>
  strRscID);<a name="1021496"> </a>
</pre>
<p class="Body">
  <a name="1021497"> </a>The Data Manager only opens an overlay if the resource database is opened in read-only mode. If you open a resource database in read-write mode, the associated overlay is not opened. What's more, if you modify the an overlaid resource in the base database, the checksum in the overlay's <span style="font-family: monospace">'ovly'</span> resource becomes invalid, which prevents the overlay from being used at all. Thus if you change the resource database, you must also change the overlay database. 
</p>
<p class="Body">
  <a name="1021498"> </a>You typically don't work with the Overlay Manager directly although it does provide a few public functions. One potentially useful function is <a href="OverlayMgr.html#1141467"><span style="font-family: monospace">OmGetCurrentLocale</span></a> (or <span style="font-family: monospace">OmGlueGetCurrentLocale</span>), which returns a structure identifying the locale on this handheld. 
</p>

<h2 class="HaHeadA">
  <a name="1021504"> </a>Dates 
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021505"> </a>If your application deals with dates and times, it should abide by the values the user has set in the system preference for date and time display. The default preferences at startup are vary among locales, and the default values can be overridden by the user. 
</p>
<p class="Body">
  <a name="1021510"> </a>To check the system preferences call <a href="Preferences.html#1146319"><span style="font-family: monospace">PrefGetPreference</span></a> with one of the values listed in the second column of <a href="Localization.html#1021520">Table 11.1</a>. The third column lists an enumerated type that helps you interpret the value. 
</p>

<h5 class="TgTable">
  <a name="1021578"> </a>

<table border="1" cellpadding="5" cellspacing="0">
  <caption><a name="1021520"> </a><div class="TableTitle">Table 11.1  Date and time preferences </div></caption>
  <tr bgcolor="#CCCCCC" valign="top">
    <th><a name="1021526"> </a><div class="CellHeading">Preference</div></th>
    <th><a name="1021528"> </a><div class="CellHeading">Name</div></th>
    <th><a name="1021530"> </a><div class="CellHeading">Returns a value of type</div></th>
  </tr>
  <tr valign="top">
    <td><a name="1021532"> </a><div class="CellBody">Date formats (i.e., month first or day first)</div></td>
    <td><a name="1021535"> </a><div class="CellBody"><span style="font-family: monospace">prefDateFormat</span>, <span style="font-family: monospace">prefLongDateFormat</span> </div></td>
    <td><a name="1021540"> </a><div class="CellBody"><a href="DateAndTimeManager.html#1173564"><span style="font-family: monospace">DateFormatType</span></a></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021542"> </a><div class="CellBody">Time formats (i.e., use a 12-hour clock or use a 24-hour clock)</div></td>
    <td><a name="1021545"> </a><div class="CellBody"><span style="font-family: monospace">prefTimeFormat</span> </div></td>
    <td><a name="1021550"> </a><div class="CellBody"><a href="DateAndTimeManager.html#1173999"><span style="font-family: monospace">TimeFormatType</span></a></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021552"> </a><div class="CellBody">Start day of week (i.e., Sunday or Monday)</div></td>
    <td><a name="1021555"> </a><div class="CellBody"><span style="font-family: monospace">prefWeekStartDay</span> </div></td>
    <td><a name="1021557"> </a><div class="CellBody">0 (Sunday) or 1 (Monday)</div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021559"> </a><div class="CellBody">Local time zone</div></td>
    <td><a name="1021562"> </a><div class="CellBody"><span style="font-family: monospace">prefMinutesWestOfGMT</span> </div><a name="1021563"> </a><div class="CellBody">(before Palm OS 4.0), </div><a name="1021565"> </a><div class="CellBody"><span style="font-family: monospace">prefTimeZone</span> (Palm OS 4.0 and higher) </div></td>
    <td><a name="1021567"> </a><div class="CellBody">Minutes east of Greenwich Mean Time (GMT), also known as Universal Coordinated Time (UTC). </div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021569"> </a><div class="CellBody">Daylight savings time adjustment </div></td>
    <td><a name="1021571"> </a><div class="CellBody"><span style="font-family: monospace">prefDaylightSavings</span> (before Palm OS 4.0), </div><a name="1021572"> </a><div class="CellBody"><span style="font-family: monospace">prefDaylightSavingAdjustment </span>(Palm OS 4.0 and higher)</div></td>
    <td><a name="1021574"> </a><div class="CellBody">Before 4.0, the <a href="DateAndTimeManager.html#1173769"><span style="font-family: monospace">DaylightSavingsTypes</span></a> described the daylight savings adjustment. In Palm OS 4.0 and higher, the preference is stored as the number of minutes by which to adjust the current time. </div></td>
  </tr>
</table>




</h5><div class="NINoteImportant"><hr>
  <a name="1021580"> </a> <span style="color: #333;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">IMPORTANT:  </span> The <span style="font-family: monospace">prefMinutesWestOfGMT</span> preference mentioned above is not the same as the <span style="font-family: monospace">prefTimeZone</span> preference. The <span style="font-family: monospace">prefMinutesWestOfGMT</span> returns an unsigned value ranging from 0 to 1440. The <span style="font-family: monospace">prefTimeZone</span> preference ranges from -720 to 720. 
<hr>
</div>
<p class="Body">
  <a name="1021584"> </a>To work with dates in your code, use the Date and Time Manager API. It contains functions such as <a href="DateAndTimeManager.html#1174444"><span style="font-family: monospace">DateToAscii</span></a>, <a href="DateAndTimeManager.html#1174567"><span style="font-family: monospace">DayOfMonth</span></a>, <a href="DateAndTimeManager.html#1174587"><span style="font-family: monospace">DayOfWeek</span></a>, <a href="DateAndTimeManager.html#1174636"><span style="font-family: monospace">DaysInMonth</span></a>, and <a href="DateAndTimeManager.html#1174207"><span style="font-family: monospace">DateTemplateToAscii</span></a>, which allow you to work with dates independent of the user's preference settings. 
</p>

<h2 class="HaHeadA">
  <a name="1021601"> </a>Numbers 
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021602"> </a>If your application displays large numbers or floating-point numbers, you must check and make sure you are using the appropriate thousands separator and decimal separator for the handheld's country by doing the following (see <a href="Localization.html#1021624">Listing 11.1</a>):
</p>
  <a name="1021606"> </a><p class="N1NumList">1.	  Store numbers using US conventions, which means using a "," as the thousands separator and a decimal point (.) as the decimal separator. </p>  <a name="1023461"> </a><p class="N1NumList">2.	  Use <span style="font-family: monospace">PrefGetPreference</span> and <a href="MiscSys.html#1216182"><span style="font-family: monospace">LocGetNumberSeparators</span></a> to retrieve information about how the number should be displayed.</p>  <a name="1023470"> </a><p class="N1NumList">3.	  Use <a href="StringManager.html#1154622"><span style="font-family: monospace">StrLocalizeNumber</span></a> to perform the localization. </p>  <a name="1023471"> </a><p class="N1NumList">4.	  If a user enters a number that you need to manipulate in some way, convert it to the US conventions using <a href="StringManager.html#1154515"><span style="font-family: monospace">StrDelocalizeNumber</span></a>. </p><p class="CCodeCaption">
  <a name="1021624"> </a>Listing 11.1  Working with numbers
</p>
<div class="CodeRule"><hr></div><pre class="CodeBlock">
// store numbers using US conventions. <a name="1021625"> </a>
Char *jackpot = "20,000,000.00";<a name="1021626"> </a>
Char thou; // thousand separator<a name="1021627"> </a>
Char dp; // decimal separator<a name="1021628"> </a>
 <a name="1021629"> </a>
// Retrieve user's preferred number format. <a name="1021630"> </a>
LocGetNumberSeparators((NumberFormatType)<a name="1021631"> </a>
   PrefGetPreference(prefNumberFormat), &amp;thou, <a name="1021632"> </a>
      &amp;dp);<a name="1021633"> </a>
// Localize jackpot number. Converts "," to thou <a name="1021634"> </a>
// and "." to dp. <a name="1021635"> </a>
StrLocalizeNumber(jackpot, thou, dp);<a name="1021636"> </a>
// Display string. <a name="1021637"> </a>
// Assume inputString is a number user entered, <a name="1021638"> </a>
// convert it to US conventions this way. Converts <a name="1021639"> </a>
// thou to "," and dp to "."<a name="1021640"> </a>
StrDelocalizeNumber(inputNumber, thou, dp);<a name="1021641"> </a>
</pre><div class="CodeRule"><hr></div>

<h2 class="HaHeadA">
  <a name="1021643"> </a>Obtaining Locale Information 
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021644"> </a>Some applications may require information about the current locale. For example, many applications need to know the format for displaying dates or numbers, which is determined in part by the current locale (and described in more detail in the section <a href="Localization.html#1021504">"Dates"</a> and <a href="Localization.html#1021601">"Numbers"</a> in this chapter). Other applications may need other information, such as the country name. 
</p>
<p class="Body">
  <a name="1021651"> </a>The information that most applications require is stored in the system preferences structure and can be obtained using <a href="Preferences.html#1146319"><span style="font-family: monospace">PrefGetPreference</span></a>. This is the recommended way of obtaining locale-specific settings because the user can override many of these settings. Applications should always honor the user's preferences rather than the locale defaults. 
</p>
<p class="Body">
  <a name="1021657"> </a>Other locale-specific settings can not be set by the user and are not stored in the system preferences. Instead, these settings are stored in a private resource that contains information about several possible locales, including the locale currently used by the system. For example, the user cannot change the symbol used for the local currency. If your application needs this information, it must use the Locale Manager function <a href="LocaleMgr.html#1129972"><span style="font-family: monospace">LmGetLocaleSetting</span></a> to retrieve it. The Locale Manager is new in Palm OS 4.0, but for backwards compatibility you can use the corresponding PalmOSGlue function <span style="font-family: monospace">LmGlueGetLocaleSetting</span>. <a href="Localization.html#1021667">Listing 11.2</a> shows how to use <span style="font-family: monospace">LmGlueGetLocaleSetting</span>. 
</p>
<p class="CCodeCaption">
  <a name="1021667"> </a>Listing 11.2  Retrieving a locale setting using Locale Manager
</p>
<div class="CodeRule"><hr></div><pre class="CodeBlock">
LmLocaleType locale;<a name="1021668"> </a>
Char currencySymbol[kMaxCurrencySymbolLen+1];<a name="1021669"> </a>
UInt16 index;<a name="1021670"> </a>
 <a name="1021671"> </a>
// Find out what the current locale is. <a name="1021672"> </a>
OmGlueGetCurrentLocale(&amp;locale);<a name="1021673"> </a>
 <a name="1021674"> </a>
// Find out which index in the locale resource <a name="1021675"> </a>
// contains info about that locale. <a name="1021676"> </a>
LmGlueLocaleToIndex(&amp;locale, &amp;index);<a name="1021677"> </a>
 <a name="1021678"> </a>
// Get the currency symbol stored in the locale at <a name="1021679"> </a>
// that index. <a name="1021680"> </a>
LmGlueGetLocaleSetting(index, lmChoiceCurrencySymbol, <a name="1021681"> </a>
   currencySymbol, sizeof(currencySymbol));<a name="1021682"> </a>
</pre><div class="CodeRule"><hr></div>
<p class="Body">
  <a name="1021686"> </a><a href="Localization.html#1021693">Table 11.2</a> shows which types of information about the current locale should be retrieved from the system preferences and which types should be retrieved from the locale resource. Of course, if you want to retrieve information about a different locale or if you want to look up the default used for the current locale, you would always use the Locale Manager instead of the Preferences Manager. 
</p>

<h5 class="TgTable">
  <a name="1021763"> </a>

<table border="1" cellpadding="5" cellspacing="0">
  <caption><a name="1021693"> </a><div class="TableTitle">Table 11.2  Obtaining locale information  </div></caption>
  <tr bgcolor="#CCCCCC" valign="top">
    <th><a name="1021697"> </a><div class="CellHeading">Value</div></th>
    <th><a name="1021699"> </a><div class="CellHeading">Function used to retrieve value</div></th>
  </tr>
  <tr valign="top">
    <td><a name="1021701"> </a><div class="CellBody">Language code </div></td>
    <td><a name="1021703"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefLanguage)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021705"> </a><div class="CellBody">Locale description </div></td>
    <td><a name="1021707"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefLocale)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021709"> </a><div class="CellBody">Country code</div></td>
    <td><a name="1021711"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefCountry)</span> </div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021713"> </a><div class="CellBody">Country name </div></td>
    <td><a name="1021715"> </a><div class="CellBody"><span style="font-family: monospace">LmGlueGetLocaleSetting(..., lmChoiceCountryName, ...)</span> </div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021717"> </a><div class="CellBody">Currency name </div></td>
    <td><a name="1021719"> </a><div class="CellBody"><span style="font-family: monospace">LmGlueGetLocaleSetting(..., lmChoiceCurrencyName, ...)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021721"> </a><div class="CellBody">Currency symbol </div></td>
    <td><a name="1021723"> </a><div class="CellBody"><span style="font-family: monospace">LmGlueGetLocaleSetting(..., lmChoiceCurrencySymbol, ...)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021725"> </a><div class="CellBody">Unique currency symbol </div></td>
    <td><a name="1021727"> </a><div class="CellBody"><span style="font-family: monospace">LmGlueGetLocaleSetting(..., lmChoiceUniqueCurrencySymbol, ...)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021729"> </a><div class="CellBody">Measurement system (metric or English) </div></td>
    <td><a name="1021731"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefMeasurementSystem)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021733"> </a><div class="CellBody">Number formats </div></td>
    <td><a name="1021735"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefNumberFormat)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021737"> </a><div class="CellBody">Number of decimal places for monetary values</div></td>
    <td><a name="1021739"> </a><div class="CellBody"><span style="font-family: monospace">LmGlueGetLocaleSetting(..., lmChoiceCurrencyDecimalPlaces, ...)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021741"> </a><div class="CellBody">Starting day of the week </div></td>
    <td><a name="1021743"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefWeekStartDay)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021745"> </a><div class="CellBody">Date formats </div></td>
    <td><a name="1021747"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefDateFormat)</span> </div><a name="1021748"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefLongDateFormat)</span> </div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021750"> </a><div class="CellBody">Time format </div></td>
    <td><a name="1021752"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefTimeFormat)</span></div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021754"> </a><div class="CellBody">Time zone </div></td>
    <td><a name="1021756"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefMinutesWestOfGMT)</span> (pre 4.0)</div><a name="1021757"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefTimeZone)</span> (4.0 and higher)</div></td>
  </tr>
  <tr valign="top">
    <td><a name="1021759"> </a><div class="CellBody">Daylight savings time </div></td>
    <td><a name="1021761"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefDaylightSavings)</span> (pre 4.0)</div><a name="1021762"> </a><div class="CellBody"><span style="font-family: monospace">PrefGetPreference(prefDaylightSavingAdjustment) </span>(4.0 and higher)</div></td>
  </tr>
</table>




</h5>
<h2 class="HaHeadA">
  <a name="1021765"> </a>Notes on the Japanese Implementation 
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021766"> </a>This section describes programming practices for applications that are to be localized for Japanese use. It covers:
</p>

  <a name="1021770"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021788">Japanese Character Encoding</a></p>

  <a name="1021774"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021791">Japanese Character Input</a></p>

  <a name="1021778"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021798">The Calculator Button</a></p>

  <a name="1021782"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021801">Displaying Japanese Strings on UI Objects</a></p>

  <a name="1021786"> </a><p class="B1Bullet"> &#8226; <a href="Localization.html#1021804">Displaying Error Messages</a></p>

<h2 class="HBHeadB">
  <a name="1021788"> </a>Japanese Character Encoding
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021789"> </a>The character encoding used on Japanese systems is based on Microsoft code page 932. The complete 932 character set (JIS level 1 and 2) is supported in both the standard and large font sizes. The bold versions of these two fonts contain bolded versions of the glyphs found in the 7-bit ASCII range, but on some handhelds, the single-byte Katakana characters and the multi-byte characters are not bolded. 
</p>

<h2 class="HBHeadB">
  <a name="1021791"> </a>Japanese Character Input
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021792"> </a>On current Japanese handhelds, users enter Japanese text using Latin (ASCII) characters, and special software called a front-end processor (FEP) transliterates this text into Hiragana or Katakana characters. The user can then ask the FEP to phonetically convert Hiragana characters into a mixture of Hiragana and Kanji (Kana-Kanji conversion).
</p>
<p class="Body">
  <a name="1021793"> </a>Four input area icons added to the Japanese handheld control the FEP transliteration and conversion process. These four FEP buttons are arranged vertically between the current left-most icons and the input area. The top-most FEP button tells the FEP to attempt Kana-Kanji conversion on the inline text. The next button confirms the inline text and terminates the inline conversion session. The third button toggles the transliteration mode between Hiragana and Katakana. The last button toggles the FEP on and off.
</p>
<p class="Body">
  <a name="1021794"> </a>Japanese text entry is always inline, which means that transliteration and conversion happen directly inside of a field. The field code passes events to the FEP, which then returns information about the appropriate text to display. 
</p>
<p class="Body">
  <a name="1021795"> </a>During inline conversion, the Graffiti<sup>®</sup> or Graffiti 2 space stroke acts as a shortcut for the conversion FEP button and the return stroke acts as a shortcut for the confirm FEP button. 
</p>

<h2 class="HBHeadB">
  <a name="1021798"> </a>The Calculator Button
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021799"> </a>On current Japanese handhelds, the Calculator silkscreen button doesn't generate a <span style="font-family: monospace">calcChr</span>. Instead, it generates a <span style="font-family: monospace">keyDown</span> event with the event's <span style="font-family: monospace">data.keyDown.chr</span> field set to <span style="font-family: monospace">keyboardChr</span> and it's <span style="font-family: monospace">data.keyDown.modifiers</span> field set to <span style="font-family: monospace">commandKeyMask</span>.
</p>

<h2 class="HBHeadB">
  <a name="1021801"> </a>Displaying Japanese Strings on UI Objects
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021802"> </a>To conserve screen space, you should use half-width Katakana characters on user interface elements (such as buttons, menu items, labels, and pop-up lists) whenever the string contains only Katakana characters. If the string contains a mix of Katakana and either Hiragana, Kanji, or Romaji, then use the full-width Katakana characters instead. 
</p>

<h2 class="HBHeadB">
  <a name="1021804"> </a>Displaying Error Messages
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="1021809"> </a>You may have code that uses the macros <a href="ErrorManager.html#1103684"><span style="font-family: monospace">ErrFatalDisplayIf</span></a> and <a href="ErrorManager.html#1103711"><span style="font-family: monospace">ErrNonFatalDisplayIf</span></a> to determine error conditions. If the error condition occurs, the system displays the file name and line number at which the error occurred along with the message that you passed to the macro. Often these messages are hard-coded strings. On Japanese systems, the Palm OS traps the messages passed to these two macros and displays a generic message explaining that an error has occurred. 
</p>
<p class="Body">
  <a name="1021814"> </a>You should only use <span style="font-family: monospace">ErrFatalDisplayIf</span> and <span style="font-family: monospace">ErrNonFatalDisplayIf</span> for totally unexpected errors. Do not use them for errors that you believe your end users will see. If you wish to inform your users of an error, use a localizable resource to display the error message instead of <span style="font-family: monospace">ErrFatalDisplayIf</span> or <span style="font-family: monospace">ErrNonFatalDisplayIf</span>. 
</p>

<h2 class="HaHeadA">
  <a name="1021816"> </a>Summary of Localization 
<a href="#1021391"><img src="images/top.gif" border="0"></a></h2>


<h5 class="TgTable">
  <a name="1021835"> </a>

<table border="1" cellpadding="5" cellspacing="0">
  <caption></caption>
  <tr bgcolor="#CCCCCC" valign="top">
    <th><a name="1021819"> </a><div class="CellHeading">Localizing Numbers</div></th>
    <th><a name="1021821"> </a><div class="CellHeading"><br></div></th>
  </tr>
  <tr valign="top">
    <td><a name="1021826"> </a><div class="CellBody"><a href="StringManager.html#1154622">StrLocalizeNumber</a><br><a href="MiscSys.html#1216182">LocGetNumberSeparators</a></div></td>
    <td><a name="1021834"> </a><div class="CellBody"><a href="StringManager.html#1154515">StrDelocalizeNumber</a></div></td>
  </tr>
</table>




</h5>
<h5 class="TgTable">
  <a name="1021855"> </a>

<table border="1" cellpadding="5" cellspacing="0">
  <caption></caption>
  <tr bgcolor="#CCCCCC" valign="top">
    <th><a name="1021838"> </a><div class="CellHeading">Locale Manager</div></th>
    <th><a name="1021840"> </a><div class="CellHeading"><br></div></th>
  </tr>
  <tr valign="top">
    <td><a name="1021845"> </a><div class="CellBody"><a href="LocaleMgr.html#1129972">LmGetLocaleSetting</a></div><a name="1021849"> </a><div class="CellBody"><a href="LocaleMgr.html#1130225">LmLocaleToIndex</a></div></td>
    <td><a name="1021854"> </a><div class="CellBody"><a href="LocaleMgr.html#1130196">LmGetNumLocales</a></div></td>
  </tr>
</table>




</h5>
<h5 class="TgTable">
  <a name="1021871"> </a>

<table border="1" cellpadding="5" cellspacing="0">
  <caption></caption>
  <tr bgcolor="#CCCCCC" valign="top">
    <th><a name="1021858"> </a><div class="CellHeading">International Manager</div></th>
    <th><a name="1021860"> </a><div class="CellHeading"><br></div></th>
  </tr>
  <tr valign="top">
    <td><a name="1021865"> </a><div class="CellBody"><a href="MiscSys.html#1216119">IntlGetRoutineAddress</a></div></td>
    <td><a name="1021870"> </a><div class="CellBody"><a href="MiscSys.html#1216150">IntlSetRoutineAddress</a></div></td>
  </tr>
</table>




</h5>
<h5 class="TgTable">
  <a name="1021906"> </a>

<table border="1" cellpadding="5" cellspacing="0">
  <caption></caption>
  <tr bgcolor="#CCCCCC" valign="top">
    <th><a name="1021874"> </a><div class="CellHeading">Overlay Manager</div></th>
    <th><a name="1021876"> </a><div class="CellHeading"><br></div></th>
  </tr>
  <tr valign="top">
    <td><a name="1021881"> </a><div class="CellBody"><a href="OverlayMgr.html#1141467">OmGetCurrentLocale</a><br><a href="OverlayMgr.html#1141502">OmGetIndexedLocale</a><br><a href="OverlayMgr.html#1141572">OmGetRoutineAddress</a><br><a href="OverlayMgr.html#1141704">OmSetSystemLocale</a> </div></td>
    <td><a name="1021895"> </a><div class="CellBody"><a href="OverlayMgr.html#1141601">OmGetSystemLocale</a><br><a href="OverlayMgr.html#1141637">OmLocaleToOverlayDBName</a><br><a href="OverlayMgr.html#1141675">OmOverlayDBNameToLocale</a></div><a name="1021905"> </a><div class="CellBody"><a href="OverlayMgr.html#1141543">OmGetNextSystemLocale</a></div></td>
  </tr>
</table>




</h5>
&nbsp;<br>
				<!-- CONTENT_END -->

		</td>
		<td width="5">&nbsp;&nbsp;</td>
	</tr>
      </table>
    </td>
			</tr>
  <tr>
				<td>
					<table border="0" cellpadding="0" cellspacing="0" width="760">
        <!-- CONTENTCELL_END -->
        <tr valign="top"> 
          <td width="10">&nbsp;<!-- FOOTER_START --></td>
          <td width="72">&nbsp;</td>
          <td width="25" bgcolor="white" background="images/bkgrnd.gif">&nbsp;</td>
          <td width="600"> 
            <table border="0" cellpadding="0" cellspacing="0" width="600">
              <tr> 
                <td><img src="images/rule_10-1-5_ltblue.gif" width="600" height="16" border="0"></td>
              </tr>
              <tr> 
                <td> 
                  <p align="center" class="footer"> ©2002 PalmSource, Inc. and its affiliates.  All rights reserved. 
<a href="http://www.palmos.com/dev/training/">Training</a>&nbsp;|&nbsp;<a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a>&nbsp;|&nbsp;<a href="http://www.palmos.com/">Palm&nbsp;OS&nbsp;Platform</a>&nbsp;|&nbsp;<a href="Companion_Front.html" target="_blank">Legal Notices</a>&nbsp;<br>
												<!-- FOOTER_END --><br>
											</p>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
				</td>
			</tr>
</table>
</BODY>
</HTML>