<HTML>

<HEAD>
<SMALLSCREENIGNORE> 
<LINK HREF="copy_of_palmos.css" REL="stylesheet" TYPE="text/css">
<LINK HREF="document.css" REL="StyleSheet" TYPE="text/css" media="screen">
<!-- SCRIPT_START -->
<!-- SCRIPT_END -->
</SMALLSCREENIGNORE>
<TITLE>Clipboard</TITLE>

<META NAME="PALMTEMPLATE" CONTENT="1006-002 Palm HTML 20020513">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks Publisher Professional Edition 6.0.7">
<META NAME="TEMPLATEBASE" CONTENT="Palm HTML 20010625">
<META NAME="LASTUPDATED" CONTENT="12/13/02 10:09:46">
<META HTTP-EQUIV="content-type" CONTENT="text/html;charset=ISO-8859-1">

</HEAD>

<BODY LEFTMARGIN="0" MARGINWIDTH="0" TOPMARGIN="0" MARGINHEIGHT="0">
<SMALLSCREENIGNORE> 
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
	<td><a name="987845"></a>
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr height="35"> 
          <td height="35" colspan="2" bgcolor="#6699CC">&nbsp;</td>
        </tr>
        <tr valign="top"> 
          <td width="160" align="left"><a href="http://www.palmos.com"><img src="images/bigorb.gif" width="160" height="110" border="0"></a></td>
          <td align="left" width="100%"> 
            </SMALLSCREENIGNORE>
            <!-- CONTENTCELL_START -->
            <img border="0" height="45" src="images/orb_bkgrnd_600.gif" width="600"><br>
            <!--PAGENAV_START-->
            <SPAN CLASS="subnav">&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/index.html">Home</a> 
              &nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/">Developers</a> 
              &nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/support/">Development Support</a>
              &nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/support/docs/">Documentation</a></span><BR>
             <img src="images/pixel_ltblue.gif" width="600" height="1" border="0" vspace="2"><br>
             <h2 class="HeadDocPage">6  Clipboard</h2>
             <img src="images/pixel_ltblue.gif" width="600" height="1" border="0" vspace="2"><br>
             &nbsp;<span class="subnav"><a href="ReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Category.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="Control.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="ReferenceIX.html">Index</a></span>  
            <!--PAGENAV_END-->
          </td>
        </tr>
      </table>
    </td>
			</tr>
  <tr>
				<td> 
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
							<td>&nbsp;&nbsp;&nbsp;</td>
						</tr>
        <tr>
		<td valign="top" width="10">&nbsp;&nbsp;&nbsp;</td>
		<td valign="top" width="175">
			<p class="SideTitle">Title - <br><a href="Reference_Front.html">Palm OS® Programmer's API Reference</a></p>
			<p class="SideTOC1-PartTab">Palm OS® 5 SDK </p>
			<p class="SideTOC1-PartTab">Part I: User Interface</a> </p>
			<p class="SideTOC1"><a href="Clipboard.html">6  Clipboard</a></p>
			
<p class="SideTOC2">
<a href="#987857">Clipboard Data Structures
</a></p>

<p class="SideTOC3">
<a href="#987859">ClipboardFormatType
</a></p>

<p class="SideTOC2">
<a href="#987885">Clipboard Functions
</a></p>

<p class="SideTOC3">
<a href="#987888">ClipboardAddItem
</a></p>

<p class="SideTOC3">
<a href="#987916">ClipboardAppendItem
</a></p>

<p class="SideTOC3">
<a href="#987945">ClipboardGetItem
</a></p>

		</td>

		<td width="5">&nbsp;&nbsp;</td>
		<td width="1" bgcolor="#6699cc">&nbsp;</td>
		<td width="5">&nbsp;&nbsp;</td>
		<td> 

				<!-- CONTENT_START -->

<p class="Body">
  <a name="987846"> </a>This chapter provides reference material for the clipboard API defined in <span style="font-family: monospace">Clipboard.h</span>. It covers:
</p>

  <a name="987851"> </a><p class="B1Bullet"> &#8226; <a href="Clipboard.html#987857">Clipboard Data Structures</a></p>

  <a name="987855"> </a><p class="B1Bullet"> &#8226; <a href="Clipboard.html#987885">Clipboard Functions</a></p>

<h2 class="HaHeadA">
  <a name="987857"> </a>Clipboard Data Structures 
<a href="#987845"><img src="images/top.gif" border="0"></a></h2>


<h2 class="HBHeadB">
  <a name="987859"> </a>ClipboardFormatType
<a href="#987845"><img src="images/top.gif" border="0"></a></h2>

<p class="Body">
  <a name="987861"> </a>The <span style="font-family: monospace">ClipboardFormatType</span> enum specifies the type of data to add to the clipboard or retrieve from the clipboard. 
</p>
<pre  class="Preformatted">
enum clipboardFormats { <a name="987862"> </a>
  clipboardText, <a name="987863"> </a>
  clipboardInk, <a name="987864"> </a>
  clipboardBitmap };<a name="987865"> </a>
typedef enum clipboardFormats <a name="987866"> </a>
  ClipboardFormatType;<a name="987867"> </a>
</pre>

<h4 class="HCHeadC">
  <a name="987868"> </a>Value Descriptions
</h4>

<h5 class="TgTable">
  <a name="987882"> </a>

<table width="450" border="0" cellpadding="5" cellspacing="0">
  <caption></caption>
  <tr valign="top">
    <td><a name="987871"> </a><div class="CellBody"><span style="font-family: monospace">clipboardText</span> </div></td>
    <td><a name="987873"> </a><div class="CellBody">Textual data. This is the most commonly used clipboard.</div></td>
  </tr>
  <tr valign="top">
    <td><a name="987875"> </a><div class="CellBody"><span style="font-family: monospace">clipboardInk</span> </div></td>
    <td><a name="987877"> </a><div class="CellBody">Reserved.</div></td>
  </tr>
  <tr valign="top">
    <td><a name="987879"> </a><div class="CellBody"><span style="font-family: monospace">clipboardBitmap</span> </div></td>
    <td><a name="987881"> </a><div class="CellBody">Bitmap data. </div></td>
  </tr>
</table>




</h5><p class="Body">
  <a name="987883"> </a>Clipboards for each type of data are separately maintained. That is, if you add a string of text to the clipboard, then add a bitmap, then ask to retrieve a <span style="font-family: monospace">clipboardText</span> item from the clipboard, you will receive the string you added before the bitmap; the bitmap does not overwrite textual data and vice versa. 
</p>

<h2 class="HaHeadA">
  <a name="987885"> </a>Clipboard Functions 
<a href="#987845"><img src="images/top.gif" border="0"></a></h2>


<h2 class="HBHeadB">
  <a name="987888"> </a>ClipboardAddItem
<a href="#987845"><img src="images/top.gif" border="0"></a></h2>

<h4 class="RefSide">
  <a name="987889"> </a>Purpose 
</h4>
<p class="Body">
  <a name="987890"> </a>Add the item passed to the specified clipboard. Replaces the current item (if any) of that type. 
</p>
<h4 class="RefSide">
  <a name="987891"> </a>Declared In 
</h4>
<p class="Body">
  <a name="987892"> </a>Clipboard.h
</p>
<h4 class="RefSide">
  <a name="987893"> </a>Prototype 
</h4>
<p class="RefPrototype">
  <a name="987894"> </a>void ClipboardAddItem <br>(const ClipboardFormatType format,<br>const void *ptr, UInt16 length)
</p>
<h4 class="RefSide">
  <a name="987895"> </a>Parameters 
</h4>
<h5 class="P1"><a name="987896"> </a><div class="P1Parameter"><table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td width="180" valign="top">-&gt; <span style="font-family: monospace">format</span></td><td valign="top">Text, ink, bitmap, etc. See <a href="Clipboard.html#987859"><span style="font-family: monospace">ClipboardFormatType</span></a>.</td>
  </tr>
</table>
</div></h5>
<h5 class="P1"><a name="987900"> </a><div class="P1Parameter"><table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td width="180" valign="top">-&gt; <span style="font-family: monospace">ptr</span></td><td valign="top">Pointer to the item to place on the clipboard.</td>
  </tr>
</table>
</div></h5>
<h5 class="P1"><a name="987901"> </a><div class="P1Parameter"><table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td width="180" valign="top">-&gt; <span style="font-family: monospace">length</span></td><td valign="top">Size in bytes of the item to place on the clipboard.</td>
  </tr>
</table>
</div></h5>
<h4 class="RefSide">
  <a name="987902"> </a>Result 
</h4>
<p class="Body">
  <a name="987903"> </a>Returns nothing.
</p>
<h4 class="RefSide">
  <a name="987904"> </a>Comments 
</h4>
<p class="Body">
  <a name="987905"> </a>The clipboard makes a copy of the data that you pass to this function. Thus, you may free any data that you've passed to the clipboard without destroying the contents of the clipboard. You may also add constant data or stack-based data to the clipboard.
</p>
<div class="NWNoteWarning"><hr>
  <a name="989253"> </a> <span style="color: #FF0000;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">WARNING!  </span> You can't add null-terminated strings to the clipboard.
<hr>
</div>
<h4 class="RefSide">
  <a name="987906"> </a>See Also 
</h4>
<p class="Body">
  <a name="987913"> </a><a href="Field.html#998401"><span style="font-family: monospace">FldCut</span></a>, <a href="Field.html#998373"><span style="font-family: monospace">FldCopy</span></a> 
</p>

<h2 class="HBHeadB">
  <a name="987916"> </a>ClipboardAppendItem
<a href="#987845"><img src="images/top.gif" border="0"></a></h2>

<h4 class="RefSide">
  <a name="987917"> </a>Purpose 
</h4>
<p class="Body">
  <a name="987918"> </a>Append data to the item on the clipboard. 
</p>
<h4 class="RefSide">
  <a name="987919"> </a>Declared In 
</h4>
<p class="Body">
  <a name="987920"> </a>Clipboard.h
</p>
<h4 class="RefSide">
  <a name="987921"> </a>Prototype 
</h4>
<p class="RefPrototype">
  <a name="987922"> </a>Err ClipboardAppendItem<br>(const ClipboardFormatType format,<br>const void *ptr, UInt16 length)
</p>
<h4 class="RefSide">
  <a name="987923"> </a>Parameters 
</h4>
<h5 class="P1"><a name="987924"> </a><div class="P1Parameter"><table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td width="180" valign="top">-&gt; <span style="font-family: monospace">format</span></td><td valign="top">Text, ink, bitmap, etc. See <a href="Clipboard.html#987859"><span style="font-family: monospace">ClipboardFormatType</span></a>. This function is intended to be used only for the <span style="font-family: monospace">clipboardText</span> format. </td>
  </tr>
</table>
</div></h5>
<h5 class="P1"><a name="987928"> </a><div class="P1Parameter"><table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td width="180" valign="top">-&gt; <span style="font-family: monospace">ptr</span></td><td valign="top">Pointer to the data to append to the item on the clipboard.</td>
  </tr>
</table>
</div></h5>
<h5 class="P1"><a name="987929"> </a><div class="P1Parameter"><table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td width="180" valign="top">-&gt; <span style="font-family: monospace">length</span></td><td valign="top">Size in bytes of the data to append to the clipboard.</td>
  </tr>
</table>
</div></h5>
<h4 class="RefSide">
  <a name="987930"> </a>Result 
</h4>
<p class="Body">
  <a name="987932"> </a>0 upon success or <span style="font-family: monospace">memErrNotEnoughSpace</span> if there is not enough space to append the data to the clipboard. 
</p>
<h4 class="RefSide">
  <a name="987933"> </a>Comments 
</h4>
<p class="Body">
  <a name="987937"> </a>This function differs from <a href="Clipboard.html#987888"><span style="font-family: monospace">ClipboardAddItem</span></a> in that it does not overwrite data already on the clipboard. It allows you to create a large text item on the clipboard from several small disjointed pieces. When other applications retrieve the text from the clipboard, it's retrieved as a single unit. 
</p>
<p class="Body">
  <a name="987938"> </a>This function simply appends the specified item to the item already on the clipboard without attempting to parse the format. It's assumed that you'll call it several times over a relatively short interval and that no other application will attempt to retrieve text from the clipboard before your application is finished appending. 
</p>
<h4 class="RefSide">
  <a name="987939"> </a>Compatibility 
</h4>
<p class="Body">
  <a name="987943"> </a>Implemented only if <a href="CompatibilityApdx.html#970392">3.2 New Feature Set</a> is present.
</p>

<h2 class="HBHeadB">
  <a name="987945"> </a>ClipboardGetItem
<a href="#987845"><img src="images/top.gif" border="0"></a></h2>

<h4 class="RefSide">
  <a name="987946"> </a>Purpose 
</h4>
<p class="Body">
  <a name="987947"> </a>Return the handle of the contents of the clipboard of a specified type and the length of a clipboard item.
</p>
<h4 class="RefSide">
  <a name="987948"> </a>Declared In 
</h4>
<p class="Body">
  <a name="987949"> </a>Clipboard.h
</p>
<h4 class="RefSide">
  <a name="987950"> </a>Prototype 
</h4>
<p class="RefPrototype">
  <a name="987951"> </a>MemHandle ClipboardGetItem<br>(const ClipboardFormatType format, UInt16 *length)
</p>
<h4 class="RefSide">
  <a name="987952"> </a>Parameters 
</h4>
<h5 class="P1"><a name="987953"> </a><div class="P1Parameter"><table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td width="180" valign="top">-&gt; <span style="font-family: monospace">format</span></td><td valign="top">Text, ink, bitmap, etc. See <a href="Clipboard.html#987859"><span style="font-family: monospace">ClipboardFormatType</span></a>.</td>
  </tr>
</table>
</div></h5>
<h5 class="P1"><a name="987957"> </a><div class="P1Parameter"><table border="0" cellpadding="5" cellspacing="0">
  <tr>
    <td width="180" valign="top">&lt;- <span style="font-family: monospace">length</span></td><td valign="top">The length in bytes of the clipboard item is returned here.</td>
  </tr>
</table>
</div></h5>
<h4 class="RefSide">
  <a name="987958"> </a>Result 
</h4>
<p class="Body">
  <a name="987959"> </a>Handle of the clipboard item.
</p>
<h4 class="RefSide">
  <a name="987960"> </a>Comments 
</h4>
<p class="Body">
  <a name="987961"> </a>The handle returned is a handle to the actual clipboard chunk. It is not suitable for passing to any API that modifies memory (such as <a href="Field.html#999807"><span style="font-family: monospace">FldSetTextHandle</span></a>). Consider this to be read-only access to the chunk. Copy the contents of the clipboard to your application's own storage as soon as possible and use that reference instead of the handle returned by this function. 
</p>
<p class="Body">
  <a name="987965"> </a>Don't free the handle returned by this function; it is freed when a new item is added to the clipboard. 
</p>
<p class="Body">
  <a name="987966"> </a>Text retrieved from the clipboard does not have a null terminator. You must use the <span style="font-family: monospace">length</span> parameter to determine the length in bytes of the string you've retrieved. 
</p>
&nbsp;<br>
				<!-- CONTENT_END -->

		</td>
		<td width="5">&nbsp;&nbsp;</td>
	</tr>
      </table>
    </td>
			</tr>
  <tr>
				<td>
					<table border="0" cellpadding="0" cellspacing="0" width="760">
        <!-- CONTENTCELL_END -->
        <tr valign="top"> 
          <td width="10">&nbsp;<!-- FOOTER_START --></td>
          <td width="72">&nbsp;</td>
          <td width="25" bgcolor="white" background="images/bkgrnd.gif">&nbsp;</td>
          <td width="600"> 
            <table border="0" cellpadding="0" cellspacing="0" width="600">
              <tr> 
                <td><img src="images/rule_10-1-5_ltblue.gif" width="600" height="16" border="0"></td>
              </tr>
              <tr> 
                <td> 
                  <p align="center" class="footer"> ©2002 PalmSource, Inc. and its affiliates.  All rights reserved. 
<a href="http://www.palmos.com/dev/training/">Training</a>&nbsp;|&nbsp;<a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a>&nbsp;|&nbsp;<a href="http://www.palmos.com/">Palm&nbsp;OS&nbsp;Platform</a>&nbsp;|&nbsp;<a href="Reference_Front.html" target="_blank">Legal Notices</a>&nbsp;<br>
												<!-- FOOTER_END --><br>
											</p>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
				</td>
			</tr>
</table>
</BODY>
</HTML>