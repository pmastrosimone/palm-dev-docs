<html>
<head>
<title>Palm OS Common Language API | C/C++ Sync Suite Reference</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="KEYWORDS" CONTENT="C, C++, C/C++ Sync Suite, common language, language, load, DLL, localization, reference, API, CDK, conduit, conduits, Windows">
<META NAME="DESCRIPTION" CONTENT="Provides reference details on the Palm Common Language API in the C/C++ Sync Suite.">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource HTML 20040609">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks Publisher Professional Edition 6.0.7">
<META NAME="LASTUPDATED" CONTENT="06/28/04 08:30:10">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="1000833"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="C++SyncReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CRef_HSLog.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CRef_ExpMgr.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="C++SyncReferenceIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">8 &nbsp;&nbsp;
Palm OS Common Language API</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">C/C++ Sync Suite Reference</p>
<p class="SubTitle">Palm OS&#174; Conduit Development Kit for Windows, Version 6.0.1 </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1-PartTab"><a href="CRef_Part_Conduit.html">Part II: Conduit APIs</a> </h1>
<h1 class="SideTOC1"><a href="CRef_CmnLang.html">8  Palm OS Common Language API</a></h1>

   <h2 class="SideTOC2"><a href="#1000934">
   Palm OS Common Language Constants</a></h2>

   <h2 class="SideTOC2"><a href="#996188">
   Palm OS Common Language Functions</a></h2>

      <h3 class="SideTOC3"><a href="#996339">
      PalmFreeLanguage</a></h3>

      <h3 class="SideTOC3"><a href="#996442">
      PalmGetResourceVersion</a></h3>

      <h3 class="SideTOC3"><a href="#996742">
      PalmGetVersion</a></h3>

      <h3 class="SideTOC3"><a href="#996830">
      PalmLoadLanguage</a></h3>

</div>
</td>
<!--END SIDETOC-->

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>
<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1000850"> </a>The Palm OS<sup>&#174;</sup> Common Language API enables your conduit to load and unload language resource DLLs. For example, if a conduit requires a French version of the resources, it can call these functions to display the French resources from a DLL containing only French resources. If the conduit cannot find the French DLL, it defaults to the base language of the conduit DLL's resources. </p>
<div class="NINoteImportant"><hr>
  <a name="1000851"> </a> <b>IMPORTANT: </b> If your conduit uses this method of selecting language resources, create a unique name for your language resource DLL.
<hr>
</div>

<p><a name="1000852"> </a>The Palm OS Common Language functions are available in <code>PalmCmn.dll</code> and declared in <code>PALM_CMN.H</code> and <code>LANG_DLL.h</code>. </p>

<p><a name="1000932"> </a>The sections in this chapter are: </p>
   <blockquote class = "bq"><a name="1004963"> </a><a href="CRef_CmnLang.html#1000934">Palm OS Common Language Constants</a></blockquote>
   <blockquote class = "bq"><a name="1005055"> </a><a href="CRef_CmnLang.html#996188">Palm OS Common Language Functions</a></blockquote>

<h2 class="haH2">
  <a name="1000934"> </a>Palm OS Common Language Constants <a href="#1000833"><span class="nav">^TOP^</span></a>
</h2>

<h4>
  <a name="1000962"> </a>Purpose 
</h4>

<p><a name="1001159"> </a>Defines the language of the resource DLL. </p>
<h4>
  <a name="1000964"> </a>Declared In 
</h4>
<code>LANG_DLL.h<a name="1000965"> </a></code><h4>
  <a name="1000966"> </a>Constants 
</h4>

<dl>
<dt><a name="1000971"> </a><code>#define LANGUAGE_DUTCH 0x0200</code></dt>
<dd><a name="1000972"> </a>Dutch language resources.</dd>

<dt><a name="1000973"> </a><code>#define LANGUAGE_ENGLISH 0x0010</code></dt>
<dd><a name="1001235"> </a>English language resources.</dd>

<dt><a name="1000975"> </a><code>#define LANGUAGE_FRENCH 0x0020</code></dt>
<dd><a name="1001307"> </a>French language resources.</dd>

<dt><a name="1000977"> </a><code>#define LANGUAGE_GERMAN 0x0040</code></dt>
<dd><a name="1001379"> </a>German language resources.</dd>

<dt><a name="1000979"> </a><code>#define LANGUAGE_ITALIAN 0x0100</code></dt>
<dd><a name="1001451"> </a>Italian language resources.</dd>

<dt><a name="1000981"> </a><code>#define LANGUAGE_JAPANESE 0x1000</code></dt>
<dd><a name="1001523"> </a>Japanese language resources.</dd>

<dt><a name="1000983"> </a><code>#define LANGUAGE_PORTUGUESE 0x0400</code></dt>
<dd><a name="1001595"> </a>Portuguese language resources.</dd>

<dt><a name="1006816"> </a><code>#define LANGUAGE_SCHINESE 0x2000</code></dt>
<dd><a name="1006825"> </a>Simplified Chinese language resources.</dd>

<dt><a name="1000985"> </a><code>#define LANGUAGE_SPANISH 0x0080</code></dt>
<dd><a name="1001667"> </a>Spanish language resources.</dd>

<dt><a name="1006847"> </a><code>#define LANGUAGE_TCHINESE 0x4000</code></dt>
<dd><a name="1001739"> </a>Traditional Chinese language resources.</dd>

</dl>
<h4>
  <a name="1000991"> </a>Comments 
</h4>

<p><a name="1001904"> </a><a href="CRef_CmnLang.html#996442"><code>PalmGetResourceVersion()</code></a> returns one of these to indicate the language resource of the specified DLL.</p>
<h4>
  <a name="1002049"> </a>Compatibility 
</h4>

<p><a name="1002050"> </a>Palm OS Common Language API version: 1<br>Palm OS version: All.</p>

<h2 class="haH2">
  <a name="996188"> </a>Palm OS Common Language Functions <a href="#1000833"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1004554"> </a>This section describes the following Palm OS Common Language functions.</p>

<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <td><p class="tt"><a name="1004630"> </a><a href="CRef_CmnLang.html#996339"><code>PalmFreeLanguage()</code></a> </p>
    </td>
    <td><p class="tt"><a name="1004724"> </a>Unloads the specified language resource DLL.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1004632"> </a><a href="CRef_CmnLang.html#996442"><code>PalmGetResourceVersion()</code></a> </p>
    </td>
    <td><p class="tt"><a name="1004726"> </a>Returns the language resource of the specified DLL. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1004634"> </a><a href="CRef_CmnLang.html#996742"><code>PalmGetVersion()</code></a> </p>
    </td>
    <td><p class="tt"><a name="1004728"> </a>Returns the version of the Palm OS Common Language API. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1004636"> </a><a href="CRef_CmnLang.html#996830"><code>PalmLoadLanguage()</code></a> </p>
    </td>
    <td><p class="tt"><a name="1004730"> </a>Loads the specified language resource DLL.</p>
    </td>
  </tr>
</table>

</div>

</p>

<h3 class="hbH3">
  <a name="996339"> </a>PalmFreeLanguage Function <a href="#1000833"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996350"> </a>Purpose 
</h4>

<p><a name="1004188"> </a>Unloads the specified language resource DLL.</p>
<h4>
  <a name="996361"> </a>Declared In 
</h4>
<code>PALM_CMN.H<a name="996367"> </a></code><h4>
  <a name="996372"> </a>Prototype 
</h4>
<pre class="proto"><a name="996378"></a>BOOL PalmFreeLanguage (
   HINSTANCE <code class="par">hRscInst</code>,
   HINSTANCE <code class="par">hAppInst</code>
)
</pre>
<h4>
  <a name="996383"> </a>Parameters 
</h4>

<dl>
<dt><a name="996389"> </a><code>&rarr;  <i>hRscInst</i></code></dt>
<dd><a name="1004196"> </a>The instance handle of the language resource to unload. Set this value to the return value of <a href="CRef_CmnLang.html#996830"><code>PalmLoadLanguage()</code></a>. </dd>

<dt><a name="996399"> </a><code>&rarr;  <i>hAppInst</i></code></dt>
<dd><a name="1004207"> </a>The instance handle of the application calling this function. </dd>

</dl>
<h4>
  <a name="996409"> </a>Returns 
</h4>

<p><a name="1004215"> </a>If successful, returns <code>true</code>.</p>

<p><a name="1004216"> </a>If unsuccessful, returns <code>false</code>. </p>
<h4>
  <a name="1004217"> </a>Comments 
</h4>

<p><a name="1004218"> </a>To free the language resource DLL that was loaded by <code>PalmLoadLanguage</code>, pass the <code>PalmFreeLanguage</code> function the value that <code>PalmLoadLanguage</code> returned, which is the handle of the language resource DLL it loaded. If the <code>hRscInst</code> and <span style="color: #333;;  font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">hAppInst</span> handles are the same, this function does nothing (because there is nothing to free) and returns <code>true</code>. </p>
<h4>
  <a name="1004219"> </a>Compatibility 
</h4>

<p><a name="1004220"> </a>Palm OS Common Language API version: 1<br>Palm OS version: All.</p>

<h3 class="hbH3">
  <a name="996442"> </a>PalmGetResourceVersion Function <a href="#1000833"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996453"> </a>Purpose 
</h4>

<p><a name="1004243"> </a>Returns the language resource of the specified DLL. </p>
<h4>
  <a name="996475"> </a>Declared In 
</h4>
<code>PALM_CMN.H<a name="996499"> </a></code><h4>
  <a name="996526"> </a>Prototype 
</h4>
<pre class="proto"><a name="996556"></a>DWORD PalmGetResourceVersion (
   HINSTANCE <code class="par">hLangInstance</code>
)
</pre>
<h4>
  <a name="996597"> </a>Parameters 
</h4>

<dl>
<dt><a name="996627"> </a><code>&rarr;  <i>hLangInstance</i></code></dt>
<dd><a name="1004253"> </a>The instance handle of the language resource DLL</dd>

</dl>
<h4>
  <a name="996685"> </a>Returns 
</h4>

<p><a name="1004257"> </a>Returns one of the constants that specifies the language of the specified DLL (see <a href="CRef_CmnLang.html#1000934">"Palm OS Common Language Constants"</a>).</p>
<h4>
  <a name="1004261"> </a>Compatibility 
</h4>

<p><a name="1004262"> </a>Palm OS Common Language API version: 1<br>Palm OS version: All.</p>

<h3 class="hbH3">
  <a name="996742"> </a>PalmGetVersion Function <a href="#1000833"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996753"> </a>Purpose 
</h4>

<p><a name="1004272"> </a>Returns the version of the Palm OS Common Language API.</p>
<h4>
  <a name="996764"> </a>Declared In 
</h4>
<code>PALM_CMN.H<a name="996770"> </a></code><h4>
  <a name="996775"> </a>Prototype 
</h4>
<pre class="proto"><a name="996781"></a>DWORD PalmGetVersion (
   void
)
</pre>
<h4>
  <a name="996786"> </a>Parameters 
</h4>

<p><a name="996792"> </a>None.</p>
<h4>
  <a name="996797"> </a>Returns 
</h4>

<p><a name="1004276"> </a>Returns the version number of the Palm OS Common Language API. </p>
<h4>
  <a name="1004277"> </a>Compatibility 
</h4>

<p><a name="1004278"> </a>Palm OS Common Language API version: 1<br>Palm OS version: All.</p>

<h3 class="hbH3">
  <a name="996830"> </a>PalmLoadLanguage Function <a href="#1000833"><span class="nav">^TOP^</span></a>
</h3>

<h4>
  <a name="996841"> </a>Purpose 
</h4>

<p><a name="1004284"> </a>Loads the specified language resource DLL.</p>
<h4>
  <a name="996852"> </a>Declared In 
</h4>
<code>PALM_CMN.H<a name="996858"> </a></code><h4>
  <a name="996863"> </a>Prototype 
</h4>
<pre class="proto"><a name="996869"></a>HINSTANCE PalmLoadLanguage (
   LPCTSTR <code class="par">pFileName</code>,
   HINSTANCE <code class="par">hAppInst</code>,
   DWORD <code class="par">*pdwVersion</code>
)
</pre>
<h4>
  <a name="996874"> </a>Parameters 
</h4>

<dl>
<dt><a name="996880"> </a><code>&rarr;  <i>pFileName</i></code></dt>
<dd><a name="1004288"> </a>A pointer to the filename of the DLL to load. </dd>

<dt><a name="996890"> </a><code>&rarr;  <i>hAppInst</i></code></dt>
<dd><a name="1004292"> </a>The instance handle of the application calling this function. </dd>

<dt><a name="996907"> </a><code>&larr;  <i>pdwVersion</i></code></dt>
<dd><a name="1004299"> </a>A pointer to one of the constants that specifies the language of the DLL that the function loaded (see <a href="CRef_CmnLang.html#1000934">"Palm OS Common Language Constants"</a>).</dd>

</dl>
<h4>
  <a name="996917"> </a>Returns 
</h4>

<p><a name="1004306"> </a>If this function finds the specified DLL, it returns an instance handle to the language resource DLL it loaded. </p>

<p><a name="1004307"> </a>If it does not find the specified DLL, it returns the instance handle passed to it in <span style="color: #333;;  font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline">hAppInst</span>&#8212that is, the handle of whatever called this function. </p>
<h4>
  <a name="1004308"> </a>Comments 
</h4>

<p><a name="1004309"> </a>The return value is the handle of the language resource DLL that the function loaded. For example, if your conduit includes the call </p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
  hRscInstance = PalmLoadLanguage("MYCLANG.DLL", <a name="1004310"> </a>
                 hDLLInstance, &amp;dwVersion);<a name="1004311"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1004312"> </a>then <code>PalmLoadLanguage</code> looks for (and attempts to load) <code>MYCLANG.DLL</code>, which contains the localized resources for your conduit. If it successfully loads it, this function returns the instance handle. If it cannot find the DLL or loads unsuccessfully for any other reason, <code>PalmLoadLanguage</code> returns the instance handle of your conduit DLL, and therefore your conduit uses the resources compiled into the conduit DLL itself. </p>

<p><a name="1004316"> </a>In the <a href="CRef_CmnLang.html#996339"><code>PalmFreeLanguage()</code></a> function, set <code>hRscInst</code> to this value. </p>
<h4>
  <a name="1004317"> </a>Compatibility 
</h4>

<p><a name="1004318"> </a>Palm OS Common Language API version: 1<br>Palm OS version: All.</p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1998-2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="CRef_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="C++SyncReferenceTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CRef_HSLog.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CRef_ExpMgr.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="C++SyncReferenceIX.html">Index</a>
</p>
</td>
</tr>
<!-- END FOOTER -->

</body>
</html>