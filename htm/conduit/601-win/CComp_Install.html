<html>
<head>
<title>Writing an Installer | C/C++ Sync Suite Companion</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="KEYWORDS" CONTENT="C, C++, C/C++ Sync Suite, install, installer, installing, files, register, Install Aide, HotSync API, User Data, Install Conduit Manager, Notifier Install Manager, notifier, install conduit, test, CDK, conduit, conduits, Windows">
<META NAME="DESCRIPTION" CONTENT="Describes the tasks necessary to write an installer that installs a conduit, a handheld application, or files on a handheld from a Windows desktop computer.">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource HTML 20040609">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks Publisher Professional Edition 6.0.7">
<META NAME="LASTUPDATED" CONTENT="06/28/04 08:29:33">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="995937"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="C++SyncCompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CComp_Notifiers.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CComp_QStart_VC.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="C++SyncCompanionIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">9 &nbsp;&nbsp;
Writing an Installer</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">C/C++ Sync Suite Companion</p>
<p class="SubTitle">Palm OS&#174; Conduit Development Kit for  Windows, Version 6.0.1 </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1"><a href="CComp_Install.html">9  Writing an Installer</a></h1>

   <h2 class="SideTOC2"><a href="#996001">
   Installer Tasks</a></h2>

   <h2 class="SideTOC2"><a href="#1000914">
   Finding the HotSync Manager Binaries</a></h2>

   <h2 class="SideTOC2"><a href="#1059551">
   Files to Install</a></h2>

   <h2 class="SideTOC2"><a href="#996045">
   Using the Conduit Manager API</a></h2>

      <h3 class="SideTOC3"><a href="#1073035">
      Registering a Conduit Conventionally</a></h3>

      <h3 class="SideTOC3"><a href="#1004408">
      Registering a Conduit by Folder</a></h3>

      <h3 class="SideTOC3"><a href="#1003646">
      Unregistering a Conduit</a></h3>

      <h3 class="SideTOC3"><a href="#1040354">
      Resolving Conduit Conflicts</a></h3>

      <h3 class="SideTOC3"><a href="#1004382">
      Accessing Registered Conduit Information</a></h3>

      <h3 class="SideTOC3"><a href="#1003635">
      Accessing Developer-defined Conduit Configuration Entries</a></h3>

      <h3 class="SideTOC3"><a href="#1047236">
      Retrieving Folder-registered Conduit Information</a></h3>

      <h3 class="SideTOC3"><a href="#1008074">
      Registering and Unregistering a Backup Conduit</a></h3>

      <h3 class="SideTOC3"><a href="#1010559">
      Configuring the COM Ports</a></h3>

      <h3 class="SideTOC3"><a href="#1007565">
      Using Conduit Manager's Utility Functions</a></h3>

      <h3 class="SideTOC3"><a href="#1040158">
      Summary of Conduit Manager Functions</a></h3>

   <h2 class="SideTOC2"><a href="#996189">
   Using the Install Aide API</a></h2>

      <h3 class="SideTOC3"><a href="#1020488">
      How Install Aide Works</a></h3>

      <h3 class="SideTOC3"><a href="#1020274">
      Queuing a Database to Install in Primary Storage</a></h3>

      <h3 class="SideTOC3"><a href="#1050628">
      Queuing a File to Install in Primary Storage via HotSync Exchange </a></h3>

      <h3 class="SideTOC3"><a href="#1022847">
      Queuing a File to Install on an Expansion Card</a></h3>

      <h3 class="SideTOC3"><a href="#1032483">
      Retrieving HotSync User Information</a></h3>

      <h3 class="SideTOC3"><a href="#1030244">
      Accessing Registered Install Conduit Information</a></h3>

      <h3 class="SideTOC3"><a href="#1022958">
      Using Install Aide's Utility Functions</a></h3>

      <h3 class="SideTOC3"><a href="#1022988">
      Summary of Install Aide Functions</a></h3>

   <h2 class="SideTOC2"><a href="#996394">
   Using the User Data API</a></h2>

      <h3 class="SideTOC3"><a href="#1037405">
      Adding and Deleting HotSync Users</a></h3>

      <h3 class="SideTOC3"><a href="#1038161">
      Finding and Setting the Directory of a HotSync User</a></h3>

      <h3 class="SideTOC3"><a href="#1038757">
      Accessing Information about a HotSync User</a></h3>

      <h3 class="SideTOC3"><a href="#1038758">
      Accessing the Synchronization Preferences of a HotSync User</a></h3>

      <h3 class="SideTOC3"><a href="#1037606">
      Retrieving the Expansion Slot Information of a HotSync User</a></h3>

      <h3 class="SideTOC3"><a href="#1037696">
      Modifying the Install Conduit Flags of a HotSync User</a></h3>

      <h3 class="SideTOC3"><a href="#1037738">
      Accessing Developer-defined Entries in the User Data Store</a></h3>

      <h3 class="SideTOC3"><a href="#1037861">
      Using User Data API Utility Functions</a></h3>

      <h3 class="SideTOC3"><a href="#1034355">
      Summary of User Data API Functions</a></h3>

   <h2 class="SideTOC2"><a href="#1060140">
   Using the HotSync Manager API</a></h2>

      <h3 class="SideTOC3"><a href="#1060246">
      Summary of HotSync Manager API Functions</a></h3>

   <h2 class="SideTOC2"><a href="#1060410">
   Using the Notifier Install Manager API</a></h2>

      <h3 class="SideTOC3"><a href="#1060438">
      Registering and Unregistering a Notifier</a></h3>

      <h3 class="SideTOC3"><a href="#1060480">
      Accessing Registered Notifier Information</a></h3>

      <h3 class="SideTOC3"><a href="#1060544">
      Summary of Notifier Install Manager Functions</a></h3>

   <h2 class="SideTOC2"><a href="#996405">
   Using the Install Conduit Manager API</a></h2>

      <h3 class="SideTOC3"><a href="#1016222">
      Registering an Install Conduit</a></h3>

      <h3 class="SideTOC3"><a href="#1015805">
      Unregistering an Install Conduit</a></h3>

      <h3 class="SideTOC3"><a href="#1015810">
      Accessing Information about All Registered Install Conduits</a></h3>

      <h3 class="SideTOC3"><a href="#1015798">
      Accessing Developer-defined Install Conduit Configuration Entries</a></h3>

      <h3 class="SideTOC3"><a href="#1015837">
      Summary of Install Conduit Manager Functions</a></h3>

   <h2 class="SideTOC2"><a href="#996514">
   Uninstalling Your Conduit</a></h2>

   <h2 class="SideTOC2"><a href="#996523">
   Testing Your Installer</a></h2>

   <h2 class="SideTOC2"><a href="#996535">
   Installation Troubleshooting Tips </a></h2>

   <h2 class="SideTOC2"><a href="#996548">
   Sample Installer </a></h2>

</div>
</td>
<!--END SIDETOC-->

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>
<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="1059278"> </a>Creating an easy-to-use installer is an important part of product development. You need to make it easy for end users to install your conduit and your desktop and handheld applications. This chapter describes what your installer needs to do and the APIs that the C/C++ Sync Suite provides to help you create an installer. </p>

<p><a name="1059279"> </a>The sections in this chapter are: </p>
   <blockquote class = "bq"><a name="995954"> </a><a href="CComp_Install.html#996001">Installer Tasks</a> </blockquote>
   <blockquote class = "bq"><a name="1014551"> </a><a href="CComp_Install.html#1000914">Finding the HotSync Manager Binaries</a> </blockquote>
   <blockquote class = "bq"><a name="995958"> </a><a href="CComp_Install.html#1059551">Files to Install</a> </blockquote>
   <blockquote class = "bq"><a name="995962"> </a><a href="CComp_Install.html#996045">Using the Conduit Manager API</a> </blockquote>
   <blockquote class = "bq"><a name="995966"> </a><a href="CComp_Install.html#996189">Using the Install Aide API</a> </blockquote>
   <blockquote class = "bq"><a name="995974"> </a><a href="CComp_Install.html#996394">Using the User Data API</a> </blockquote>
   <blockquote class = "bq"><a name="1061404"> </a><a href="CComp_Install.html#1060140">Using the HotSync Manager API</a> </blockquote>
   <blockquote class = "bq"><a name="1061421"> </a><a href="CComp_Install.html#1060410">Using the Notifier Install Manager API</a> </blockquote>
   <blockquote class = "bq"><a name="995978"> </a><a href="CComp_Install.html#996405">Using the Install Conduit Manager API</a> </blockquote>
   <blockquote class = "bq"><a name="995986"> </a><a href="CComp_Install.html#996514">Uninstalling Your Conduit</a> </blockquote>
   <blockquote class = "bq"><a name="995990"> </a><a href="CComp_Install.html#996523">Testing Your Installer</a> </blockquote>
   <blockquote class = "bq"><a name="995994"> </a><a href="CComp_Install.html#996535">Installation Troubleshooting Tips</a> </blockquote>
   <blockquote class = "bq"><a name="995998"> </a><a href="CComp_Install.html#996548">Sample Installer</a> </blockquote>

<h2 class="haH2">
  <a name="996001"> </a>Installer Tasks <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996002"> </a>Your installer may need to install a handheld application and databases, a desktop application, as well as a conduit. So the best user experience is to write a single installer to install all of these at once. For handheld databases, your installer should display a user list if there is more than one HotSync<sup>&#174;</sup> user and prepare the databases to be installed on the next HotSync operation. Your installer must register your conduit, otherwise HotSync Manager cannot run it. And finally, it must request that the user perform a HotSync operation to actually install your application and databases on the handheld. </p>

<p><a name="996003"> </a>To summarize, your installer must perform at least some of the following tasks to successfully deploy your product on an end user's desktop computer and handheld: </p>
<ul type="disc">
  <li><a name="996004"> </a>Copy all of your install files to the end user's desktop computer.
  <li><a name="996005"> </a>Install your desktop application, if your product includes one.
  <li><a name="1013848"> </a>Check that HotSync Manager is installed. Use the Conduit Manager API, <code>CondMgr.dll</code>. Required for any installer.
  <li><a name="996007"> </a>Copy your conduit files and notifier DLL, if you provide one, to a final destination directory.
  <li><a name="996008"> </a>Register your conduit with HotSync Manager. Use the Conduit Manager API, <code>CondMgr.dll</code>, either to register conventionally or to find the <code>Conduits</code> folder, if you are registering by folder. Registration is required for any conduit.
  <li><a name="996009"> </a>Register your notifier with HotSync Manager. Use the Notifier Install Manager API, <code>CondMgr.dll</code>. Required only if you are providing a notifier.
  <li><a name="996010"> </a>Restart HotSync Manager after you register your conduit. Use the HotSync Manager API, <code>HSAPI.dll</code>. Required only for a conduit registered with HotSync Manager versions earlier than 6.0. Versions 6.0 and later do not require this.
  <li><a name="998174"> </a>Queue databases or applications to be installed on the handheld&#8212or files to be installed on expansion cards&#8212during the next HotSync operation. Use the Install Aide API, <code>InstAide.dll</code>. Required for any databases or files to be put on the handheld.
  <li><a name="996012"> </a>Uninstall your desktop application, conduit, and notifier, if you provide one&#8212which includes unregistering your conduit and notifier with HotSync Manager.
</ul>

<h2 class="haH2">
  <a name="1000914"> </a>Finding the HotSync Manager Binaries <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1014045"> </a>One of the first tasks an installer must perform is to determine whether the HotSync Manager executable and its support DLLs are installed on an end user's computer. To do this, your installer must call Conduit Manager to get the path of the HotSync Manager executable. But the Conduit Manager library (<code>CondMgr.dll</code>) that your installer must use is in the same directory as HotSync Manager. </p>

<p><a name="1014412"> </a>To break this circular dependency, PalmSource permits you to redistribute a temporary copy of <code>CondMgr.dll</code> in your installer for the sole purpose of finding the already-installed <code>CondMgr.dll</code> file on an end user's computer. After you find the installed copy, you must delete your temporary copy from the user's computer.</p>

<p><a name="1014713"> </a>Unless otherwise specified, PalmSource does not permit you to redistribute any other binary files from the CDK.</p>
<div class="NWNoteWarning"><hr>
  <a name="1014046"> </a> <span style="color: #FF0000;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">WARNING!  </span> Always use the <code>CondMgr.dll</code> and other HotSync Manager support DLL files that are already installed on a user's computer. Do not replace the installed DLLs with other copies, which might be incompatible with the versions of other installed binaries. Mixing versions of HotSync Manager binaries on a user's computer can cause data loss.
<hr>
</div>

<p><a name="1014047"> </a>The following steps outline how to determine whether HotSync Manager is already installed on a user's computer:</p>
<ol type="1">
  <li value="1"><a name="1014049"> </a>Include in your installer a copy of the <code>CondMgr.dll</code> file provided in the <code>&lt;CDK&gt;\Common\Bin</code> folder.
  <li value="2"><a name="1014464"> </a>Copy <code>CondMgr.dll</code> to a temporary location on the end user's computer.
  <li value="3"><a name="1014050"> </a>Using your temporary copy of <code>CondMgr.dll</code>, call <a href="CRef_CnMgr.html#999080"><code>CmGetSystemHotSyncExecPath()</code></a>, if you're using Conduit Manager version 3 or later, or call <a href="CRef_CnMgr.html#998044"><code>CmGetHotSyncExecPath()</code></a>, if you're using version 2 or earlier.
   <p><a name="1014054"> </a>If either of these functions passes back an empty string via the <code class="par">pPath</code> parameter, then HotSync Manager is not installed. PalmSource recommends that you prompt the user to install the Palm OS<sup>&#174;</sup> Desktop software that came with the handheld and then try to install your product again. Skip to step <a href="CComp_Install.html#1014076">6</a>.</p>
   <p><a name="1014058"> </a>However, if either of these functions passes back a nonempty string via the <code class="par">pPath</code> parameter, then HotSync Manager is already installed. This parameter points to the full path and filename of the HotSync Manager executable. Proceed to the next step. </p>
  <li value="4"><a name="1014060"> </a>Strip the <code>HotSync.exe</code> filename from the path returned by <code>CmGetSystemHotSyncExecPath()</code>. This is the path of <code>CondMgr.dll</code> and other support DLL files that are already installed on the user's computer.
  <li value="5"><a name="1014061"> </a>Using the installed <code>CondMgr.dll</code> file located in the path returned in step <a href="CComp_Install.html#1014060">4</a>, call <a href="CRef_CnMgr.html#998084"><code>CmGetLibVersion()</code></a> to get the version of the Conduit Manager API.
   <p><a name="1014068"> </a>This step confirms that you can successfully call the installed <code>CondMgr.dll</code> file and gives you the version number of its API. If your installer requires Conduit Manager functions that are available only in later versions, use this version number to determine whether and how to proceed. In <a href="CRef_CnMgr.html#996740">"Conduit Manager Functions"</a> in the <i>C/C++ Sync Suite Reference</i>, the description of each function specifies which versions of Conduit Manager provide the function.</p>
  <li value="6"><a name="1014076"> </a>You <i>must</i> delete your temporary copy of <code>CondMgr.dll</code> (step <a href="CComp_Install.html#1014464">2</a>) from the user's computer, whether HotSync Manager is already installed or not. PalmSource does not permit you to leave your temporary copy of <code>CondMgr.dll</code> on users' computers.
  <li value="7"><a name="1014913"> </a>Call, as necessary, other installed HotSync Manager support DLLs that are in the same directory you discovered in step <a href="CComp_Install.html#1014060">4</a>.
</ol>
<div class="NINoteImportant"><hr>
  <a name="1065531"> </a> <b>NOTE: </b> To get the path of the HotSync Manager support DLLs, be sure to use <a href="CRef_CnMgr.html#999080"><code>CmGetSystemHotSyncExecPath()</code></a>, not <a href="CRef_CnMgr.html#997119"><code>CmGetCorePath()</code></a>. <code>CmGetCorePath()</code> retrieves the path of the HotSync users' folder, which for HotSync Manager versions earlier than 6.0, is the same as the HotSync executable path. However, in versions 6.0 and later these are two different paths.
<hr>
</div>

<p><a name="1014098"> </a><a href="CComp_Install.html#1014105">Table 9.1</a> summarizes the Conduit Manager API functions described in this section.</p>

<p class="fineprint">
<p class="caption"><a name="1014105"> </a><b>Table 9.1&nbsp;&nbsp;Finding HotSync Manager and Conduit Manager </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1014109"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1014111"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1014113"> </a>Get the path and filename of the HotSync Manager executable. Strip off the <code>HotSync.exe</code> filename to get the path of the folder that holds all HotSync Manager binaries.</p>
    </td>
    <td><p class="tt"><a name="1014119"> </a><a href="CRef_CnMgr.html#999080"><code>CmGetSystemHotSyncExecPath()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1014124"> </a>Get the path of the HotSync users' directory for the current Windows user. Each Windows user must have a unique path, so there is no system-level path.</p>
    </td>
    <td><p class="tt"><a name="1014126"> </a><a href="CRef_CnMgr.html#997119"><code>CmGetCorePath()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h2 class="haH2">
  <a name="1059551"> </a>Files to Install <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996016"> </a>After it finds the installed HotSync Manager, your installer typically needs to install the following files on a user's computer:</p>
<ul type="disc">
  <li><a name="996028"> </a><code>MyApp.prc</code>, <code>MyAppData.pdb</code>. Your handheld application and possibly separate databases.
  <li><a name="996029"> </a><code>MyConduit.dll</code>. Your C API-based conduit.
  <li><a name="996030"> </a><code>MyApp.exe</code> and supporting files. Your desktop application, if your product includes one.
  <li><a name="1014644"> </a><code>CondMgr.dll</code>, PalmSource's Conduit Manager library. You may copy this HotSync Manager support DLL to the user's computer only temporarily, as described in <a href="CComp_Install.html#1000914">"Finding the HotSync Manager Binaries."</a>
</ul>

<h2 class="haH2">
  <a name="996045"> </a>Using the Conduit Manager API <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1000946"> </a>This section describes the most common tasks an installer performs using the Conduit Manager:</p>
   <blockquote class = "bq"><a name="1013740"> </a><a href="CComp_Install.html#1073035">Registering a Conduit Conventionally</a></blockquote>
   <blockquote class = "bq"><a name="1013747"> </a><a href="CComp_Install.html#1004408">Registering a Conduit by Folder</a></blockquote>
   <blockquote class = "bq"><a name="1013762"> </a><a href="CComp_Install.html#1003646">Unregistering a Conduit</a></blockquote>
   <blockquote class = "bq"><a name="1040469"> </a><a href="CComp_Install.html#1040354">Resolving Conduit Conflicts</a></blockquote>
   <blockquote class = "bq"><a name="1013774"> </a><a href="CComp_Install.html#1004382">Accessing Registered Conduit Information</a></blockquote>
   <blockquote class = "bq"><a name="1013782"> </a><a href="CComp_Install.html#1003635">Accessing Developer-defined Conduit Configuration Entries</a></blockquote>
   <blockquote class = "bq"><a name="1048406"> </a><a href="CComp_Install.html#1047236">Retrieving Folder-registered Conduit Information</a></blockquote>
   <blockquote class = "bq"><a name="1013789"> </a><a href="CComp_Install.html#1008074">Registering and Unregistering a Backup Conduit</a></blockquote>
   <blockquote class = "bq"><a name="1013817"> </a><a href="CComp_Install.html#1010559">Configuring the COM Ports</a></blockquote>
   <blockquote class = "bq"><a name="1013825"> </a><a href="CComp_Install.html#1007565">Using Conduit Manager's Utility Functions</a></blockquote>
   <blockquote class = "bq"><a name="1013833"> </a><a href="CComp_Install.html#1040158">Summary of Conduit Manager Functions</a></blockquote>

<p><a name="1045637"> </a>HotSync Manager, versions 6.0 and later, and Conduit Manager, versions 3 and later, support multi-user versions of Windows. For background information, see <a href="Intro_HSMBasics.html#996056">"Support for Multiple Users"</a> in the <i>Introduction to Conduit Development</i>. The following subsections refer to differences between conduits registered for the user and the system.</p>
<div class="NINoteImportant"><hr>
  <a name="1073029"> </a> <b>NOTE: </b> Before calling Conduit Manager functions to change system-level settings, call <a href="CRef_CnMgr.html#999493"><code>CmIsCurrentUserAdmin()</code></a> first to determine whether the current Windows user has administrator privileges. The system-level calls that make changes can succeed only if the user has these privileges; otherwise these calls return an <code>ERR_INSUFFICIENT_PRIVILEGES</code> and fail. System-level calls that only read information do not require administrator privileges.
<hr>
</div>
<h3 class="hbH3">
  <a name="1073035"> </a>Registering a Conduit Conventionally <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1073036"> </a>This section describes how to use the Conduit Manager API to conventionally register a synchronization conduit. For background information and an explanation of terminology used in this section, see <a href="Intro_Registering.html#995934">Chapter 6, "Registering Conduits and Notifiers with HotSync Manager,"</a> in <i>Introduction to Conduit Development</i>.</p>

<p><a name="1001185"> </a>The Conduit Manager API separates the underlying storage of conduit registration information from the processes of registering and unregistering conduits. This abstraction makes it possible for the underlying storage details to change without affecting how you register and unregister a conduit.</p>
<div class="NINoteImportant"><hr>
  <a name="1001433"> </a> <b>NOTE: </b> Do not directly manipulate the Windows registry to register a conduit. If you circumvent the Conduit Manager to register a conduit, your installer may fail to work with future versions of HotSync Manager.
<hr>
</div>

<p><a name="1001186"> </a>The Conduit Manager uses the unique creator ID assigned to each registered conduit to read and write values in the conduit's configuration entries. See <a href="Intro_CfgEntries.html#990567">Appendix A, "Configuration Entries,"</a> in the <i>Introduction to Conduit Development</i> for descriptions of the conduit configuration entries that HotSync Manager reads.</p>

<p><a name="1001187"> </a>You can use the Conduit Manager in two different ways to conventionally register your conduit, as described in the following subsections:</p>
   <blockquote class = "bq"><a name="1001604"> </a><a href="CComp_Install.html#1001743">Writing a Single Structure</a></blockquote>
   <blockquote class = "bq"><a name="1001763"> </a><a href="CComp_Install.html#1012055">Writing Individual Configuration Entries</a></blockquote>

<h4 class="hcH4">
  <a name="1001743"> </a>Writing a Single Structure
</h4>

<p><a name="1002197"> </a>To register a C API-based conduit from a single structure, allocate a <a href="CRef_CnMgr.html#996398"><code>CmConduitType2</code></a> structure, set the structure field values appropriately, and pass this structure to <a href="CRef_CnMgr.html#999231"><code>CmInstallConduitByStruct()</code></a>. This function attempts to store your conduit's configuration entries for the creator ID you specified in the structure. If another conduit is already registered using the same creator ID, this function returns an <code>ERR_CREATORID_ALREADY_IN_USE</code> error and does not register your conduit. </p>

<p><a name="1003441"> </a>The only fields in <a href="CRef_CnMgr.html#996398"><code>CmConduitType2</code></a> that you <i>must</i> set to register a C API-based conduit are:</p>
<ul type="disc">
  <li><a name="1003455"> </a><code>dwCreatorID</code>&#8212the conduit's creator ID
  <li><a name="1003463"> </a><code>szConduitPath</code>&#8212the conduit DLL's path and filename (or only the filename)
</ul>

<p><a name="1001749"> </a>The other fields are optional. See <a href="CRef_CnMgr.html#996398">"CmConduitType2"</a> in the <i>C/C++ Sync Suite Reference</i> for details.</p>

<p><a name="1003490"> </a><a href="CComp_Install.html#1002919">Listing 9.1</a> is an example of using <code>CmInstallConduitByStruct()</code> to register a conduit for the current Windows user. Simply replace this function call with <a href="CRef_CnMgr.html#999363"><code>CmInstallSystemConduitByStruct()</code></a> to register the conduit for the system.</p>
<p class="CCodeCaption">
  <a name="1002919"> </a><b>Listing 9.1&nbsp;&nbsp;Example of registering a conduit with a single structure</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
int RegisterConduitByStruct () {<a name="1002920"> </a>
   CmConduitType2 pConduit;<a name="1002922"> </a>
   DWORD id;<a name="1003035"> </a>
   int retval = 0;<a name="1003028"> </a>
<a name="1002988"> </a>
   memset(&amp;pConduit, '\0', sizeof(pConduit));<a name="1003310"> </a>
<a name="1003311"> </a>
   strcpy(pConduit.szConduitPath,"MyConduit.dll");<a name="1003312"> </a>
   strcpy(pConduit.szLocalDirectory, "MyConduitDir");<a name="1002926"> </a>
   strcpy(pConduit.szLocalFile,"MyDesktopFile.dat");<a name="1002927"> </a>
   strcpy(pConduit.szRemoteDB,"MyHandheldDatabase");<a name="1002928"> </a>
   strcpy(pConduit.szTitle,"My Conduit Display Name");<a name="1045829"> </a>
<a name="1045831"> </a>
   CmConvertStringToCreatorID("MyID", &amp;id);<a name="1002932"> </a>
   pConduit.dwCreatorID = id;<a name="1002933"> </a>
   pConduit.dwPriority = 2;<a name="1002934"> </a>
<a name="1002935"> </a>
   retval = <i>CmInstallConduitByStruct</i>(pConduit);<a name="1002936"> </a>
// If retval is ERR_CREATORID_ALREADY_IN_USE, then another <a name="1003499"> </a>
// conduit is already registered with this creator ID, so <a name="1003546"> </a>
// this call fails.<a name="1003547"> </a>
   return retval;<a name="1030080"> </a>
}<a name="1002937"> </a>
</pre><div class="CodeRule"><hr></div>


<h5 class="hdH5">
  <a name="1011775"> </a>Compatibility Note
</h5>

<p><a name="1002262"> </a>The <a href="CRef_CnMgr.html#996398"><code>CmConduitType2</code></a> structure and <a href="CRef_CnMgr.html#999231"><code>CmInstallConduitByStruct()</code></a> function are available in Conduit Manager API versions 3 and later. This structure contains only those configuration entries that all versions of HotSync Manager use and stores strings as simple character arrays.</p>

<p><a name="1065738"> </a>All versions of the Conduit Manager provide the <a href="CRef_CnMgr.html#996312"><code>CmConduitType</code></a> structure and <a href="CRef_CnMgr.html#999166"><code>CmInstallConduit()</code></a> function to do the same thing. The <code>CmConduitType</code> structure differs from <code>CmConduitType2</code> in the following two ways:</p>
<ul type="disc">
  <li><a name="1065593"> </a>Several fields each specify the offset from the beginning of the structure to the beginning of a null-terminated string. This technique allows the structures to be built efficiently, without wasting string space. However, when you create a <code>CmConduitType</code> structure, you need to allocate the space for the structure itself and for the strings that you are specifying. If you wish to avoid this memory management work, PalmSource recommends that you use the <code>CmConduitType2</code> structure instead and pass it into the <code>CmInstallConduitByStruct()</code>.
  <li><a name="1065613"> </a>Several fields specify values that are deprecated in Conduit Manager versions 3 and later.
</ul>

<p><a name="1012088"> </a><a href="CComp_Install.html#1012062">Table 9.2</a> summarizes the functions for registering a conduit with a structure for both the current Windows user and the system.</p>

<p class="fineprint">
<p class="caption"><a name="1012062"> </a><b>Table 9.2&nbsp;&nbsp;Writing a single structure to conventionally register a conduit </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1012069"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1012071"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1012073"> </a>Register a conduit conventionally. Pass in a single <a href="CRef_CnMgr.html#996398"><code>CmConduitType2</code></a> structure. Available in Conduit Manager versions 3 and later.</p>
    </td>
    <td><p class="tt"><a name="1012075"> </a>User:<br><a href="CRef_CnMgr.html#999231"><code>CmInstallConduitByStruct()</code></a></p>
<p class="tt"><a name="1012079"> </a>System:<br><a href="CRef_CnMgr.html#999363"><code>CmInstallSystemConduitByStruct()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1012187"> </a>Register a conduit conventionally. Pass in a handle to a single <a href="CRef_CnMgr.html#996312"><code>CmConduitType</code></a> structure. Available in all versions of Conduit Manager. Note that there is no corresponding system-level function that uses this structure.</p>
    </td>
    <td><p class="tt"><a name="1012086"> </a>User:<br><a href="CRef_CnMgr.html#999166"><code>CmInstallConduit()</code></a></p>
<p class="tt"><a name="1012087"> </a>System:<br>N/A</p>
    </td>
  </tr>
</table>

</div>

</p>

<h4 class="hcH4">
  <a name="1012055"> </a>Writing Individual Configuration Entries
</h4>

<p><a name="996097"> </a>To register a C API-based synchronization conduit by writing several configuration entries with a series of function calls, call <a href="CRef_CnMgr.html#999301"><code>CmInstallCreator()</code></a> first with the creator ID of your conduit. If this function succeeds, then call the following series of functions, in no particular order, to set other conduit configuration values:</p>
<ul type="disc">
  <li><a name="1003407"> </a><a href="CRef_CnMgr.html#1000264"><code>CmSetCreatorName()</code></a>&#8212Besides <a href="CRef_CnMgr.html#999301"><code>CmInstallCreator()</code></a>, this is the only other value you must set to register a conduit of any type. The rest are optional.
  <li><a name="1003411"> </a><a href="CRef_CnMgr.html#1000319"><code>CmSetCreatorPriority()</code></a> 
  <li><a name="1003428"> </a><a href="CRef_CnMgr.html#1000433"><code>CmSetCreatorTitle()</code></a> 
  <li><a name="1003415"> </a><a href="CRef_CnMgr.html#999996"><code>CmSetCreatorDirectory()</code></a> 
  <li><a name="1003419"> </a><a href="CRef_CnMgr.html#1000055"><code>CmSetCreatorFile()</code></a> 
  <li><a name="996117"> </a><a href="CRef_CnMgr.html#1000374"><code>CmSetCreatorRemote()</code></a> 
</ul>

<p><a name="1003590"> </a>You can also create your own configuration entries and set them along with these at install time, as described in <a href="CComp_Install.html#1003635">"Accessing Developer-defined Conduit Configuration Entries."</a></p>

<p><a name="1003304"> </a><a href="CComp_Install.html#996135">Listing 9.2</a> shows a simple conduit registration that calls <code>CmInstallCreator()</code> and several <code>CmSetCreator...()</code> functions.</p>
<p class="CCodeCaption">
  <a name="996135"> </a><b>Listing 9.2&nbsp;&nbsp;Registering a conduit with a series of Conduit Manager functions</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
int RegisterConduitWithMultipleCalls () {<a name="1003202"> </a>
   err = <i>CmInstallCreator</i>("Xyzz", CONDUIT_APPLICATION);<a name="1003204"> </a>
   if (err == 0)<a name="996139"> </a>
      err = <i>CmSetCreatorName</i>("Xyzz", <a name="996140"> </a>
         "C:\\MyCond\\Debug\\MyCond.DLL");<a name="996141"> </a>
   if (err == 0)<a name="996142"> </a>
      err = <i>CmSetCreatorDirectory</i>("Xyzz", "MyCond");<a name="996143"> </a>
   if (err == 0)<a name="996144"> </a>
      err = <i>CmSetCreatorFile</i>("Xyzz", "MyCond");<a name="996145"> </a>
   if (err == 0)<a name="996146"> </a>
      err = <i>CmSetCreatorPriority</i>("Xyzz", 2);<a name="996147"> </a>
   if (err == 0)<a name="996148"> </a>
      printf(" Registration succeeded\n");<a name="996149"> </a>
   else<a name="996150"> </a>
      printf(" Registration failed %d\n", err);<a name="996151"> </a>
   return err;<a name="1003293"> </a>
}<a name="1003294"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1012232"> </a><a href="CComp_Install.html#1012236">Table 9.3</a> summarizes the functions for registering a conduit for both the current Windows user and the system by writing individual configuration entries.</p>

<p class="fineprint">
<p class="caption"><a name="1012236"> </a><b>Table 9.3&nbsp;&nbsp;Writing individual configuration entries to conventionally register a conduit </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1012243"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1012245"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1012247"> </a>Register a conduit conventionally. Call <code>CmInstallCreator()</code> or <code>CmInstallSystemCreator()</code> first. Then call the rest, passing in the same creator ID.</p>
    </td>
    <td><p class="tt"><a name="1012412"> </a>User:<br><a href="CRef_CnMgr.html#999301"><code>CmInstallCreator()</code></a><br><a href="CRef_CnMgr.html#1000264"><code>CmSetCreatorName()</code></a><br><a href="CRef_CnMgr.html#1000319"><code>CmSetCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#1000433"><code>CmSetCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#999996"><code>CmSetCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#1000055"><code>CmSetCreatorFile()</code></a><br><a href="CRef_CnMgr.html#1000374"><code>CmSetCreatorRemote()</code></a></p>
<p class="tt"><a name="1012421"> </a>System:<br><a href="CRef_CnMgr.html#999430"><code>CmInstallSystemCreator()</code></a><br><a href="CRef_CnMgr.html#1000997"><code>CmSetSystemCreatorName()</code></a><br><a href="CRef_CnMgr.html#1001053"><code>CmSetSystemCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#1001169"><code>CmSetSystemCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#1000822"><code>CmSetSystemCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#1000882"><code>CmSetSystemCreatorFile()</code></a><br><a href="CRef_CnMgr.html#1001109"><code>CmSetSystemCreatorRemote()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="1012227"> </a>For more information about these functions, see <a href="CRef_CnMgr.html#995933">Chapter 11, "Conduit Manager API,"</a> of the <i>C/C++ Sync Suite Reference</i>. </p>
<h3 class="hbH3">
  <a name="1004408"> </a>Registering a Conduit by Folder <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1004409"> </a>This section describes how to use the Conduit Manager API to register a C API-based synchronization conduit by placing it in the system or current Windows user's <code>Conduits</code> folder. For background information and an explanation of terminology used in this section, see <a href="Intro_Registering.html#995934">Chapter 6, "Registering Conduits and Notifiers with HotSync Manager,"</a> in <i>Introduction to Conduit Development</i>.</p>
<div class="NINoteImportant"><hr>
  <a name="1047083"> </a> <b>NOTE: </b> On an NTFS file system, moving any files, including conduits, in system-level areas can fail if the user does not have administrator privileges. You can call <a href="CRef_CnMgr.html#999493"><code>CmIsCurrentUserAdmin()</code></a> first to determine whether the user has sufficient privileges.
<hr>
</div>

<p><a name="1003868"> </a>A folder-registered conduit must implement logic in its <a href="CRef_CnAPI.html#1013446"><code>GetConduitInfo()</code></a> entry point to respond to an input <code class="par">infoType</code> parameter value of <code>eRegistrationInfo</code>. See <a href="CComp_EntryPoints.html#996131">"GetConduitInfo()"</a> for more on this requirement.</p>

<p><a name="1003782"> </a>To find the current Windows user's <code>Conduits</code> folder at install time, call <a href="CRef_CnMgr.html#1001678"><code>FmGetCurrentUserConduitFolder()</code></a>; for the system <code>Conduits</code> folder, call <a href="CRef_CnMgr.html#1001796"><code>FmGetSystemConduitFolder()</code></a>. These functions always return a path, because if a <code>Conduits</code> folder does not exist, these functions create them.</p>

<p><a name="1004204"> </a>After you get the <code>Conduits</code> folder's path, copy your synchronization conduit DLL to that folder. The Conduit Manager finds your conduit there the next time HotSync Manager queries it for a list of conduits.</p>
<div class="NINoteImportant"><hr>
  <a name="1015398"> </a> <b>TIP: </b> Most installers are designed to remove files during an uninstall from the location to which they were originally installed. Therefore implement this technique in your installer to keep your folder-registered conduit in the same location, at least as far as your installer is concerned: <br><br>1. Install your conduit to the <code>Disabled</code> subfolder. <br><br>2. Call <a href="CRef_CnMgr.html#1001534"><code>FmEnableCurrentUserConduitByPath()</code></a> or <a href="CRef_CnMgr.html#1001587"><code>FmEnableSystemConduitByPath()</code></a> to move it to the <code>Conduits</code> folder. Your installer thinks your conduit is still in the <code>Disabled</code> subfolder.<br><br>3. Upon uninstall, first call <a href="CRef_CnMgr.html#1001409"><code>FmDisableCurrentUserConduitByPath()</code></a> or <a href="CRef_CnMgr.html#1001481"><code>FmDisableSystemConduitByPath()</code></a> to move your conduit back to the <code>Disabled</code> subfolder. Then your installer can delete your conduit from its originally installed location.<br><br>This technique also covers the case of a power user who moves your conduit to the <code>Disabled</code> subfolder after installation. Upon uninstall, the call to disable the conduit fails, but your installer can still delete the conduit, because it is in its originally installed location.
<hr>
</div>

<h5 class="hdH5">
  <a name="1004144"> </a>Compatibility Note
</h5>

<p><a name="1003811"> </a>Folder-based conduit registration is supported by versions 3 and later of the Conduit Manager (versions 6.0 and later of HotSync Manager). If you wish to install conduits on systems with earlier versions, you must register them conventionally as described in <a href="CComp_Install.html#1073035">"Registering a Conduit Conventionally."</a></p>

<p><a name="1012751"> </a><a href="CComp_Install.html#1012755">Table 9.4</a> summarizes the functions for registering a conduit by folder for both the current Windows user and the system.</p>

<p class="fineprint">
<p class="caption"><a name="1012755"> </a><b>Table 9.4&nbsp;&nbsp;Registering and unregistering a conduit <br>by folder </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1012762"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1012764"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1012766"> </a>Find the <code>Conduits</code> folder and <code>Disabled</code> subfolder.</p>
    </td>
    <td><p class="tt"><a name="1012771"> </a>User:<br><a href="CRef_CnMgr.html#1001678"><code>FmGetCurrentUserConduitFolder()</code></a><br><a href="CRef_CnMgr.html#1001718"><code>FmGetCurrentUserDisabledConduitFolder()</code></a></p>
<p class="tt"><a name="1012775"> </a>System:<br><a href="CRef_CnMgr.html#1001796"><code>FmGetSystemConduitFolder()</code></a><br><a href="CRef_CnMgr.html#1001836"><code>FmGetSystemDisabledConduitFolder()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1012780"> </a>Enable/disable a disabled/enabled conduit. Pass in the path and filename (or only filename) of the conduit.</p>
    </td>
    <td><p class="tt"><a name="1012785"> </a>User:<br><a href="CRef_CnMgr.html#1001534"><code>FmEnableCurrentUserConduitByPath()</code></a><br><a href="CRef_CnMgr.html#1001409"><code>FmDisableCurrentUserConduitByPath()</code></a></p>
<p class="tt"><a name="1012789"> </a>System:<br><a href="CRef_CnMgr.html#1001587"><code>FmEnableSystemConduitByPath()</code></a><br><a href="CRef_CnMgr.html#1001481"><code>FmDisableSystemConduitByPath()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1046909"> </a>Disable an enabled conduit. Pass in the index of a folder-registered conduit.</p>
    </td>
    <td><p class="tt"><a name="1046863"> </a>User:<br><a href="CRef_CnMgr.html#1001390"><code>FmDisableCurrentUserConduitByIndex()</code></a></p>
<p class="tt"><a name="1046870"> </a>System:<br><a href="CRef_CnMgr.html#1001462"><code>FmDisableSystemConduitByIndex()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1003646"> </a>Unregistering a Conduit <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1003666"> </a>When you uninstall your conduit, you must unregister it so that HotSync Manager does not attempt to call your conduit DLL, which is no longer present. The following subsections describe how to unregister a conventionally registered and a folder-registered conduit.</p>

<h4 class="hcH4">
  <a name="1003647"> </a>Conventionally Registered
</h4>

<p><a name="1003665"> </a>To unregister a synchronization conduit that is conventionally registered for the current Windows user, call <a href="CRef_CnMgr.html#999513"><code>CmRemoveConduitByCreatorID()</code></a>, passing in the creator ID of the conduit to unregister. To do the same for a system-registered conduit, call <a href="CRef_CnMgr.html#999650"><code>CmRemoveSystemConduitByCreatorID()</code></a>. These functions remove all of the conduit's configuration entries, but they do not delete the conduit DLL.</p>

<p><a name="1012985"> </a><a href="CComp_Install.html#1012991">Table 9.5</a> summarizes the functions for unregistering a conventionally registered conduit for both the current Windows user and the system.</p>

<p class="fineprint">
<p class="caption"><a name="1012991"> </a><b>Table 9.5&nbsp;&nbsp;Unregistering a conventionally registered conduit </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1012995"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1012997"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1012999"> </a>Unregister a conduit by <i>creator ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1013001"> </a>User:<br><a href="CRef_CnMgr.html#999513"><code>CmRemoveConduitByCreatorID()</code></a></p>
<p class="tt"><a name="1013008"> </a>System:<br><a href="CRef_CnMgr.html#999650"><code>CmRemoveSystemConduitByCreatorID()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1013155"> </a>Unregister a conduit by <i>index.</i> Call <a href="CRef_CnMgr.html#997032"><code>CmGetConduitCount()</code></a> or <a href="CRef_CnMgr.html#998336"><code>CmGetSystemConduitCount()</code></a> to get the upper limit of the index.</p>
    </td>
    <td><p class="tt"><a name="1013018"> </a>User:<br><a href="CRef_CnMgr.html#999566"><code>CmRemoveConduitByIndex()</code></a></p>
<p class="tt"><a name="1013025"> </a>System:<br><a href="CRef_CnMgr.html#999704"><code>CmRemoveSystemConduitByIndex()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h4 class="hcH4">
  <a name="1003648"> </a>Folder-registered
</h4>

<p><a name="1003644"> </a>You can unregister a folder-registered conduit in any of three ways:</p>
<ul type="disc">
  <li><a name="1003913"> </a>Delete your conduit DLL from the <code>Conduits</code> folder. To find the <code>Conduits</code> folder, call <a href="CRef_CnMgr.html#1001678"><code>FmGetCurrentUserConduitFolder()</code></a> or <a href="CRef_CnMgr.html#1001796"><code>FmGetSystemConduitFolder()</code></a>.
  <li><a name="1003926"> </a>Call <a href="CRef_CnMgr.html#999513"><code>CmRemoveConduitByCreatorID()</code></a> or <a href="CRef_CnMgr.html#999650"><code>CmRemoveSystemConduitByCreatorID()</code></a> and pass in the creator ID of the conduit to remove. The Conduit Manager moves the conduit from the <code>Conduits</code> folder to the <code>Disabled</code> subfolder.
  <li><a name="1066455"> </a>Call <a href="CRef_CnMgr.html#999566"><code>CmRemoveConduitByIndex()</code></a> or <a href="CRef_CnMgr.html#999704"><code>CmRemoveSystemConduitByIndex()</code></a> and pass in the index of the conduit to remove. The Conduit Manager moves the conduit from the <code>Conduits</code> folder to the <code>Disabled</code> subfolder.
  <li><a name="1046944"> </a>Call <a href="CRef_CnMgr.html#1001409"><code>FmDisableCurrentUserConduitByPath()</code></a> or <a href="CRef_CnMgr.html#1001481"><code>FmDisableSystemConduitByPath()</code></a> and pass in the path or filename of the conduit to remove. Or call <a href="CRef_CnMgr.html#1001390"><code>FmDisableCurrentUserConduitByIndex()</code></a> or <a href="CRef_CnMgr.html#1001462"><code>FmDisableSystemConduitByIndex()</code></a> and pass in the index of the conduit to remove. The Conduit Manager moves the conduit from the <code>Conduits</code> folder to the <code>Disabled</code> subfolder.
</ul>

<p><a name="1004043"> </a>Moving a conduit from the <code>Conduits</code> folder to the <code>Disabled</code> subfolder effectively unregisters a conduit, so HotSync Manager does not attempt to call it. To re-register, or enable, a conduit that is in the <code>Disabled</code> subfolder, move it back to the <code>Conduits</code> folder by calling <a href="CRef_CnMgr.html#1001534"><code>FmEnableCurrentUserConduitByPath()</code></a> or <a href="CRef_CnMgr.html#1001587"><code>FmEnableSystemConduitByPath()</code></a> or by any other means.</p>
<div class="NINoteImportant"><hr>
  <a name="1066441"> </a> <b>NOTE: </b> On an NTFS file system, moving any files, including conduits, in system-level areas can fail if the user does not have administrator privileges. You can call <a href="CRef_CnMgr.html#999493"><code>CmIsCurrentUserAdmin()</code></a> first to determine whether the user has sufficient privileges.
<hr>
</div>

<p><a name="1003657"> </a>See <a href="CComp_Install.html#1004408">"Registering a Conduit by Folder"</a> for a tip on how to accommodate installers that must uninstall files from the same folder it installed them in.</p>

<p><a name="1013300"> </a><a href="CComp_Install.html#1012755">Table 9.4</a> provides a summary of the functions for unregistering a conduit by folder for both the current Windows user and the system.</p>
<h3 class="hbH3">
  <a name="1040354"> </a>Resolving Conduit Conflicts <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1045855"> </a>As described in <a href="Intro_Registering.html#1002920">"Resolving Conduit Conflicts"</a> in the <i>Introduction to Conduit Development</i>, it is possible for two or more folder-registered conduits to have the same creator ID, or for one or more folder-registered conduit to have the same creator ID as a conventionally registered conduit. Before you register your conduit, you should confirm that no conduit is already registered with the same creator ID and thereby prevent potential conflicts. </p>

<p><a name="1040365"> </a>Call <a href="CRef_CnMgr.html#997347"><code>CmGetCreatorIDList()</code></a> to get a list of all user-registered creator IDs, if you are going to register your conduit only for the current Windows user; otherwise, call <a href="CRef_CnMgr.html#998557"><code>CmGetSystemCreatorIDList()</code></a>. If your creator ID is already on the list, then prompt the user to choose whether to install your conduit or leave the existing one installed. If the user chooses to install your conduit, you must unregister the existing conduit before registering yours.</p>

<p><a name="1040473"> </a>If you are conventionally registering your conduit, then Conduit Manager calls that do so return an <code>ERR_CREATORID_ALREADY_IN_USE</code> error and fail, if another conduit is already registered with the same creator ID. This is how Conduit Manager prevents conventionally registered conduits from conflicting. However, if you are registering your conduit by copying it to the <code>Conduits</code> folder, then the only way you can prevent a conflict is to check whether your creator ID is on the list of registered conduits, as described above.</p>

<p><a name="1040544"> </a>Conduit Manager can warn you of an existing conflict in another way. It returns an <code>ERR_AMBIGUOUS_CREATORID</code> error and fails whenever you call a function that attempts to get or set a configuration entry for a registered conduit that already conflicts with another. Functions that can return this error are listed in <a href="CComp_Install.html#1031822">Table 9.18</a>. </p>
<h3 class="hbH3">
  <a name="1004382"> </a>Accessing Registered Conduit Information <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1004491"> </a>The Conduit Manager API provides functions for retrieving information about all registered synchronization conduits, <i>whether conventionally registered or folder-registered</i>. These APIs do not access install or backup conduits. <a href="CComp_Install.html#1004948">Table 9.6</a> describes the kinds of information you can get or set with Conduit Manager APIs, for both user- and system-registered conduits.</p>

<p><a name="1006086"> </a>Several APIs allow you to set the values of single conduit configuration entries in the same way you can if you conventionally register a conduit, as described in <a href="CComp_Install.html#1012055">"Writing Individual Configuration Entries."</a> </p>
<div class="NINoteImportant"><hr>
  <a name="1047194"> </a> <b>NOTE: </b> You can set conduit configuration entries only for conventionally registered conduits. If you call a function to create or set an entry for a folder-registered conduit, the function returns an <code>ERR_CONDUIT_READ_ONLY</code> error and fails.
<hr>
</div>

<p class="fineprint">
<p class="caption"><a name="1004948"> </a><b>Table 9.6&nbsp;&nbsp;Accessing registered conduit <br>information </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1011469"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1011471"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1004956"> </a>Get a count of all conduits. Use as upper limit of index in other by-index calls.</p>
    </td>
    <td><p class="tt"><a name="1004958"> </a>User:<br><a href="CRef_CnMgr.html#997032"><code>CmGetConduitCount()</code></a></p>
<p class="tt"><a name="1004962"> </a>System:<br><a href="CRef_CnMgr.html#998336"><code>CmGetSystemConduitCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1004967"> </a>Get a list of all conduit creator IDs.</p>
    </td>
    <td><p class="tt"><a name="1004969"> </a>User:<br><a href="CRef_CnMgr.html#997347"><code>CmGetCreatorIDList()</code></a></p>
<p class="tt"><a name="1004973"> </a>System:<br><a href="CRef_CnMgr.html#998557"><code>CmGetSystemCreatorIDList()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1005090"> </a>Get a conduit's creator ID by <i>index.</i> </p>
    </td>
    <td><p class="tt"><a name="1005094"> </a>User:<br><a href="CRef_CnMgr.html#997070"><code>CmGetConduitCreatorID()</code></a> </p>
<p class="tt"><a name="1005111"> </a>System:<br><a href="CRef_CnMgr.html#998375"><code>CmGetSystemConduitCreatorID()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1004978"> </a>Get registration information by <i>index.</i> Passes back a <a href="CRef_CnMgr.html#996398"><code>CmConduitType2</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1004980"> </a>User:<br><a href="CRef_CnMgr.html#996982"><code>CmGetConduitByIndex()</code></a></p>
<p class="tt"><a name="1004990"> </a>System:<br><a href="CRef_CnMgr.html#998287"><code>CmGetSystemConduitByIndex()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006174"> </a>Determine by <i>index</i> whether a conduit is registered conventionally or is folder-based and whether HotSync Manager can load it. Passes back a <a href="CRef_CnMgr.html#996487"><code>CmDiscoveryInfoType</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1006182"> </a>User:<br><a href="CRef_CnMgr.html#997999"><code>CmGetDiscoveryInfoByIndex()</code></a></p>
<p class="tt"><a name="1006189"> </a>System:<br><a href="CRef_CnMgr.html#999036"><code>CmGetSystemDiscoveryInfoByIndex()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1005001"> </a>Get conduit registration information by <i>creator ID.</i> Passes back a <a href="CRef_CnMgr.html#996312"><code>CmConduitType</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1005003"> </a>User:<br><a href="CRef_CnMgr.html#996922"><code>CmGetConduitByCreator()</code></a></p>
<p class="tt"><a name="1005007"> </a>System:<br><a href="CRef_CnMgr.html#998236"><code>CmGetSystemConduitByCreator()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1005009"> </a>Get standard conduit configuration entries by <i>creator ID</i>. These are the same entries as defined in the <a href="CRef_CnMgr.html#996398"><code>CmConduitType2</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1005447"> </a>User:<br><a href="CRef_CnMgr.html#997558"><code>CmGetCreatorName()</code></a><br><a href="CRef_CnMgr.html#997619"><code>CmGetCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#997740"><code>CmGetCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#997216"><code>CmGetCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#997282"><code>CmGetCreatorFile()</code></a><br><a href="CRef_CnMgr.html#997674"><code>CmGetCreatorRemote()</code></a></p>
<p class="tt"><a name="1006150"> </a>System:<br><a href="CRef_CnMgr.html#998669"><code>CmGetSystemCreatorName()</code></a><br><a href="CRef_CnMgr.html#998731"><code>CmGetSystemCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#998854"><code>CmGetSystemCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#998424"><code>CmGetSystemCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#998491"><code>CmGetSystemCreatorFile()</code></a><br><a href="CRef_CnMgr.html#998787"><code>CmGetSystemCreatorRemote()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1005731"> </a>Set standard conduit configuration entries by <i>creator ID.</i> These are the same entries as defined in the <a href="CRef_CnMgr.html#996398"><code>CmConduitType2</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1005733"> </a>User:<br><a href="CRef_CnMgr.html#1000264"><code>CmSetCreatorName()</code></a><br><a href="CRef_CnMgr.html#1000319"><code>CmSetCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#1000433"><code>CmSetCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#999996"><code>CmSetCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#1000055"><code>CmSetCreatorFile()</code></a><br><a href="CRef_CnMgr.html#1000374"><code>CmSetCreatorRemote()</code></a></p>
<p class="tt"><a name="1005776"> </a>System:<br><a href="CRef_CnMgr.html#1000997"><code>CmSetSystemCreatorName()</code></a><br><a href="CRef_CnMgr.html#1001053"><code>CmSetSystemCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#1001169"><code>CmSetSystemCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#1000822"><code>CmSetSystemCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#1000882"><code>CmSetSystemCreatorFile()</code></a><br><a href="CRef_CnMgr.html#1001109"><code>CmSetSystemCreatorRemote()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1003635"> </a>Accessing Developer-defined Conduit Configuration Entries <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1006298"> </a>The conduit <a href="Intro_Glossary.html#914811"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">configuration entries</span></a> are extensible. You can define your own entries to store information per user-registered and per system-registered conduit. <a href="CComp_Install.html#1006764">Table 9.7</a> describes the kinds of information you can get or set with Conduit Manager APIs. Your installer, conduit, or desktop application can store information in conduit configuration entries that are specific to your conduit.</p>

<p><a name="1015457"> </a>When you unregister a conduit, the Conduit Manager removes all of a conduit's configuration entries, including those that you define. The Conduit Manager does not access your entries in any other circumstances.</p>
<div class="NINoteImportant"><hr>
  <a name="1046083"> </a> <b>NOTE: </b> You can define your own conduit configuration entries only for conventionally registered conduits. If you call a function to create or set an entry for a folder-registered conduit, the function returns an <code>ERR_CONDUIT_READ_ONLY</code> error and fails.
<hr>
</div>

<p class="fineprint">
<p class="caption"><a name="1006764"> </a><b>Table 9.7&nbsp;&nbsp;Accessing developer-defined conduit configuration entries </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1006771"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1011410"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006775"> </a>Get or set an entry's <code>DWORD</code> value for a conduit by <i>creator ID.</i> The set function creates the entry if it does not already exist.</p>
    </td>
    <td><p class="tt"><a name="1006777"> </a>User:<br><a href="CRef_CnMgr.html#997888"><code>CmGetCreatorValueDword()</code></a><br><a href="CRef_CnMgr.html#1000542"><code>CmSetCreatorValueDword()</code></a></p>
<p class="tt"><a name="1006784"> </a>System:<br><a href="CRef_CnMgr.html#998923"><code>CmGetSystemCreatorValueDword()</code></a><br><a href="CRef_CnMgr.html#1001231"><code>CmSetSystemCreatorValueDword()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1006792"> </a>Get or set an entry's string value for a conduit by <i>creator ID.</i> The set function creates the entry if it does not already exist.</p>
    </td>
    <td><p class="tt"><a name="1006794"> </a>User:<br><a href="CRef_CnMgr.html#997942"><code>CmGetCreatorValueString()</code></a><br><a href="CRef_CnMgr.html#1000593"><code>CmSetCreatorValueString()</code></a></p>
<p class="tt"><a name="1006801"> </a>System:<br><a href="CRef_CnMgr.html#998978"><code>CmGetSystemCreatorValueString()</code></a><br><a href="CRef_CnMgr.html#1001283"><code>CmSetSystemCreatorValueString()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1047236"> </a>Retrieving Folder-registered Conduit Information <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1047237"> </a>This section describes the functions that the Conduit Manager API provides for retrieving information about <i>folder-registered conduits only.</i> For functions that access information about both folder-registered and conventionally registered conduits, see <a href="CComp_Install.html#1004382">"Accessing Registered Conduit Information."</a> </p>

<p><a name="1047564"> </a><a href="CComp_Install.html#1066505">Table 9.8</a> describes the kinds of information you can get with Conduit Manager APIs, for both user- and system-registered conduits that are registered by folder.</p>
<div class="NINoteImportant"><hr>
  <a name="1066501"> </a> <b>NOTE: </b> These functions only retrieve information. You cannot use the Conduit Manager API to set registration information for folder-registered conduits.
<hr>
</div>

<p class="fineprint">
<p class="caption"><a name="1066505"> </a><b>Table 9.8&nbsp;&nbsp;Retrieving folder-registered conduit <br>information </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1066512"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1066514"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1066516"> </a>Get a count of all folder-registered conduits. Use as upper limit of index in other by-index calls.</p>
    </td>
    <td><p class="tt"><a name="1066518"> </a>User:<br><a href="CRef_CnMgr.html#1100109"><code>FmGetCurrentUserConduitCount()</code></a></p>
<p class="tt"><a name="1066522"> </a>System:<br><a href="CRef_CnMgr.html#1001778"><code>FmGetSystemConduitCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1066527"> </a>Get registration information by <i>index.</i> Passes back a <a href="CRef_CnMgr.html#996398"><code>CmConduitType2</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1066532"> </a>User:<br><a href="CRef_CnMgr.html#1001640"><code>FmGetCurrentUserConduitByIndex()</code></a></p>
<p class="tt"><a name="1066536"> </a>System:<br><a href="CRef_CnMgr.html#1001758"><code>FmGetSystemConduitByIndex()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1008074"> </a>Registering and Unregistering a Backup Conduit <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1010105"> </a>HotSync Manager runs only one backup conduit during a HotSync operation. (You can register one for the user and one of the system, but HotSync Manager calls only the user-registered backup conduit, if one is present; else it calls the system-registered backup conduit. See <a href="Intro_Registering.html#997389">"User- and System-registered Conduits and Notifiers"</a> in <i>Introduction to Conduit Development</i>.) Therefore the Conduit Manager provides only functions to register/unregister and to get the filename of the backup conduit for the user and system, as described in <a href="CComp_Install.html#1010141">Table 9.9</a>. </p>
<div class="NWNoteWarning"><hr>
  <a name="1010641"> </a> <span style="color: #FF0000;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">WARNING!  </span> If you unregister the backup conduit, register another backup conduit to replace it; otherwise some of the user's data is not backed up during the next HotSync operation.
<hr>
</div>

<p class="fineprint">
<p class="caption"><a name="1010141"> </a><b>Table 9.9&nbsp;&nbsp;Registering and unregistering the backup conduit </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1010148"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1010150"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1010152"> </a>Register a backup conduit by <i>filename</i>. To unregister, pass in the filename of a different backup conduit.</p>
    </td>
    <td><p class="tt"><a name="1010154"> </a>User:<br><a href="CRef_CnMgr.html#999804"><code>CmSetBackupConduit()</code></a></p>
<p class="tt"><a name="1010161"> </a>System:<br><a href="CRef_CnMgr.html#1000771"><code>CmSetSystemBackupConduit()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1010238"> </a>Get the filename of the registered backup conduit.</p>
    </td>
    <td><p class="tt"><a name="1010171"> </a>User:<br><a href="CRef_CnMgr.html#996814"><code>CmGetBackupConduit()</code></a></p>
<p class="tt"><a name="1010178"> </a>System:<br><a href="CRef_CnMgr.html#998188"><code>CmGetSystemBackupConduit()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1010559"> </a>Configuring the COM Ports <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1010684"> </a>The Conduit Manager provides functions for configuring the COM port that HotSync Manager uses for direct (local) and modem connections, as shown in <a href="CComp_Install.html#1010746">Table 9.10</a>. Note that there are no system-level COM port settings; these settings are for the current Windows user only. When each Windows user performs a HotSync operation for the first time, the Conduit Manager sets default COM port values for each user. You can use these functions to read or change these defaults, if you wish.</p>

<p class="fineprint">
<p class="caption"><a name="1010746"> </a><b>Table 9.10&nbsp;&nbsp;Configuring the COM ports </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1010753"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1010755"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1010757"> </a>Get the name of the COM port that HotSync Manager uses for the specified type of connection.</p>
    </td>
    <td><p class="tt"><a name="1010759"> </a>User:<br><a href="CRef_CnMgr.html#996864"><code>CmGetComPort()</code></a></p>
<p class="tt"><a name="1010763"> </a>System:<br>N/A</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1010875"> </a>Set the name of the COM port that HotSync Manager uses for the specified type of connection.</p>
    </td>
    <td><p class="tt"><a name="1010770"> </a>User:<br><a href="CRef_CnMgr.html#999854"><code>CmSetComPort()</code></a></p>
<p class="tt"><a name="1010774"> </a>System:<br>N/A</p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1007565"> </a>Using Conduit Manager's Utility Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1013396"> </a>The Conduit Manager API includes several utility functions summarized in <a href="CComp_Install.html#1013417">Table 9.11</a>. </p>

<p class="fineprint">
<p class="caption"><a name="1013417"> </a><b>Table 9.11&nbsp;&nbsp;Using utility functions </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1013421"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1013423"> </a><b>Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1013425"> </a>Convert a creator ID from a string/<code>DWORD</code> to a <code>DWORD</code>/string. Many Conduit Manager functions take a creator ID as a <code>DWORD</code> rather than as a string.</p>
    </td>
    <td><p class="tt"><a name="1013427"> </a>User:<br><a href="CRef_CnMgr.html#996744"><code>CmConvertCreatorIDToString()</code></a><br><a href="CRef_CnMgr.html#996780"><code>CmConvertStringToCreatorID()</code></a></p>
<p class="tt"><a name="1013431"> </a>System:<br>N/A</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1013433"> </a>Get the version number of the Conduit Manager API. See the "Compatibility" section of each function to see in which versions of the Conduit Manager API the function is available.</p>
    </td>
    <td><p class="tt"><a name="1013435"> </a>User:<br><a href="CRef_CnMgr.html#998084"><code>CmGetLibVersion()</code></a></p>
<p class="tt"><a name="1013439"> </a>System:<br>N/A</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1013483"> </a>Determine whether the current Windows user has administrator privileges. Call this function to determine whether any system-level Conduit Manager calls can succeed.</p>
    </td>
    <td><p class="tt"><a name="1013491"> </a>User:<br><a href="CRef_CnMgr.html#999493"><code>CmIsCurrentUserAdmin()</code></a></p>
<p class="tt"><a name="1013495"> </a>System:<br>N/A</p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1040158"> </a>Summary of Conduit Manager Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="998460"> </a><b>Conduit Manager Functions </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1015591"> </a><b>Finding and Configuring HotSync Manager</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1015598"> </a><a href="CRef_CnMgr.html#997119"><code>CmGetCorePath()</code></a><br><a href="CRef_CnMgr.html#996864"><code>CmGetComPort()</code></a><br><a href="CRef_CnMgr.html#999854"><code>CmSetComPort()</code></a><br><a href="CRef_CnMgr.html#998152"><code>CmGetPCIdentifier()</code></a></p>
    </td>
    <td><p class="tt"><a name="1015615"> </a><a href="CRef_CnMgr.html#999080"><code>CmGetSystemHotSyncExecPath()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="998464"> </a><b>Registering/Unregistering Synchronization Conduits Conventionally</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="998471"> </a><a href="CRef_CnMgr.html#999301"><code>CmInstallCreator()</code></a><br><a href="CRef_CnMgr.html#999231"><code>CmInstallConduitByStruct()</code></a><br><br><a href="CRef_CnMgr.html#999566"><code>CmRemoveConduitByIndex()</code></a><br><a href="CRef_CnMgr.html#999513"><code>CmRemoveConduitByCreatorID()</code></a><br><br><a href="CRef_CnMgr.html#999166"><code>CmInstallConduit()</code></a></p>
    </td>
    <td><p class="tt"><a name="998500"> </a><a href="CRef_CnMgr.html#999430"><code>CmInstallSystemCreator()</code></a><br><a href="CRef_CnMgr.html#999363"><code>CmInstallSystemConduitByStruct()</code></a><br><br><a href="CRef_CnMgr.html#999704"><code>CmRemoveSystemConduitByIndex()</code></a><br><a href="CRef_CnMgr.html#999650"><code>CmRemoveSystemConduitByCreatorID()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1000165"> </a><b>Registering/Unregistering Folder-registered Conduits</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="998526"> </a><b>Reading Registered Conduit Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="998533"> </a><a href="CRef_CnMgr.html#997032"><code>CmGetConduitCount()</code></a><br><a href="CRef_CnMgr.html#997347"><code>CmGetCreatorIDList()</code></a><br><a href="CRef_CnMgr.html#997070"><code>CmGetConduitCreatorID()</code></a><br><a href="CRef_CnMgr.html#996922"><code>CmGetConduitByCreator()</code></a><br><a href="CRef_CnMgr.html#996982"><code>CmGetConduitByIndex()</code></a><br><a href="CRef_CnMgr.html#997999"><code>CmGetDiscoveryInfoByIndex()</code></a></p>
    </td>
    <td><p class="tt"><a name="998553"> </a><a href="CRef_CnMgr.html#998336"><code>CmGetSystemConduitCount()</code></a><br><a href="CRef_CnMgr.html#998557"><code>CmGetSystemCreatorIDList()</code></a><br><a href="CRef_CnMgr.html#998375"><code>CmGetSystemConduitCreatorID()</code></a><br><a href="CRef_CnMgr.html#998236"><code>CmGetSystemConduitByCreator()</code></a><br><a href="CRef_CnMgr.html#998287"><code>CmGetSystemConduitByIndex()</code></a><br><a href="CRef_CnMgr.html#999036"><code>CmGetSystemDiscoveryInfoByIndex()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="998567"> </a><b>Accessing Standard Conduit Configuration Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="999881"> </a><a href="CRef_CnMgr.html#997558"><code>CmGetCreatorName()</code></a><br><a href="CRef_CnMgr.html#1000264"><code>CmSetCreatorName()</code></a><br><a href="CRef_CnMgr.html#997619"><code>CmGetCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#1000319"><code>CmSetCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#997740"><code>CmGetCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#1000433"><code>CmSetCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#997216"><code>CmGetCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#999996"><code>CmSetCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#997282"><code>CmGetCreatorFile()</code></a><br><a href="CRef_CnMgr.html#1000055"><code>CmSetCreatorFile()</code></a><br><a href="CRef_CnMgr.html#997674"><code>CmGetCreatorRemote()</code></a><br><a href="CRef_CnMgr.html#1000374"><code>CmSetCreatorRemote()</code></a></p>
    </td>
    <td><p class="tt"><a name="999908"> </a><a href="CRef_CnMgr.html#998669"><code>CmGetSystemCreatorName()</code></a><br><a href="CRef_CnMgr.html#1000997"><code>CmSetSystemCreatorName()</code></a><br><a href="CRef_CnMgr.html#998731"><code>CmGetSystemCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#1001053"><code>CmSetSystemCreatorPriority()</code></a><br><a href="CRef_CnMgr.html#998854"><code>CmGetSystemCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#1001169"><code>CmSetSystemCreatorTitle()</code></a><br><a href="CRef_CnMgr.html#998424"><code>CmGetSystemCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#1000822"><code>CmSetSystemCreatorDirectory()</code></a><br><a href="CRef_CnMgr.html#998491"><code>CmGetSystemCreatorFile()</code></a><br><a href="CRef_CnMgr.html#1000882"><code>CmSetSystemCreatorFile()</code></a><br><a href="CRef_CnMgr.html#998787"><code>CmGetSystemCreatorRemote()</code></a><br><a href="CRef_CnMgr.html#1001109"><code>CmSetSystemCreatorRemote()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="998596"> </a><b>Accessing Developer-defined Conduit Configuration Entries</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="998603"> </a><a href="CRef_CnMgr.html#997888"><code>CmGetCreatorValueDword()</code></a><br><a href="CRef_CnMgr.html#1000542"><code>CmSetCreatorValueDword()</code></a><br><a href="CRef_CnMgr.html#997942"><code>CmGetCreatorValueString()</code></a><br><a href="CRef_CnMgr.html#1000593"><code>CmSetCreatorValueString()</code></a></p>
    </td>
    <td><p class="tt"><a name="998614"> </a><a href="CRef_CnMgr.html#998923"><code>CmGetSystemCreatorValueDword()</code></a><br><a href="CRef_CnMgr.html#1001231"><code>CmSetSystemCreatorValueDword()</code></a><br><a href="CRef_CnMgr.html#998978"><code>CmGetSystemCreatorValueString()</code></a><br><a href="CRef_CnMgr.html#1001283"><code>CmSetSystemCreatorValueString()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1047603"> </a><b>Retrieving Folder-registered Conduit Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1047614"> </a><a href="CRef_CnMgr.html#1100109"><code>FmGetCurrentUserConduitCount()</code></a><br><a href="CRef_CnMgr.html#1001640"><code>FmGetCurrentUserConduitByIndex()</code></a></p>
    </td>
    <td><p class="tt"><a name="1047616"> </a><a href="CRef_CnMgr.html#1001778"><code>FmGetSystemConduitCount()</code></a><br><a href="CRef_CnMgr.html#1001758"><code>FmGetSystemConduitByIndex()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1000130"> </a><b>Registering and Unregistering a Backup Conduit</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1000126"> </a><a href="CRef_CnMgr.html#996814"><code>CmGetBackupConduit()</code></a><br><a href="CRef_CnMgr.html#999804"><code>CmSetBackupConduit()</code></a></p>
    </td>
    <td><p class="tt"><a name="1000128"> </a><a href="CRef_CnMgr.html#998188"><code>CmGetSystemBackupConduit()</code></a><br><a href="CRef_CnMgr.html#1000771"><code>CmSetSystemBackupConduit()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1015635"> </a><b>Configuring the COM Ports</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1015642"> </a><a href="CRef_CnMgr.html#996864"><code>CmGetComPort()</code></a><br><a href="CRef_CnMgr.html#999854"><code>CmSetComPort()</code></a></p>
    </td>
    <td><p class="tt"><a name="1015650"> </a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1000142"> </a><b>Utility Functions</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1000138"> </a><a href="CRef_CnMgr.html#996744"><code>CmConvertCreatorIDToString()</code></a><br><a href="CRef_CnMgr.html#996780"><code>CmConvertStringToCreatorID()</code></a></p>
    </td>
    <td><p class="tt"><a name="1000140"> </a><a href="CRef_CnMgr.html#998084"><code>CmGetLibVersion()</code></a><br><a href="CRef_CnMgr.html#999493"><code>CmIsCurrentUserAdmin()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h2 class="haH2">
  <a name="996189"> </a>Using the Install Aide API <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1020289"> </a>The Install Aide enables your desktop application or installer to queue files for installation on a handheld during a HotSync operation. This section describes how the Install Aide works and the most common tasks that an installer performs using the Install Aide:</p>
   <blockquote class = "bq"><a name="1020337"> </a><a href="CComp_Install.html#1020488">How Install Aide Works</a></blockquote>
   <blockquote class = "bq"><a name="1032054"> </a><a href="CComp_Install.html#1020274">Queuing a Database to Install in Primary Storage</a></blockquote>
   <blockquote class = "bq"><a name="1051412"> </a><a href="CComp_Install.html#1050628">Queuing a File to Install in Primary Storage via HotSync Exchange</a></blockquote>
   <blockquote class = "bq"><a name="1032061"> </a><a href="CComp_Install.html#1022847">Queuing a File to Install on an Expansion Card</a></blockquote>
   <blockquote class = "bq"><a name="1032069"> </a><a href="CComp_Install.html#1032483">Retrieving HotSync User Information</a></blockquote>
   <blockquote class = "bq"><a name="1032077"> </a><a href="CComp_Install.html#1030244">Accessing Registered Install Conduit Information</a></blockquote>
   <blockquote class = "bq"><a name="1032117"> </a><a href="CComp_Install.html#1022958">Using Install Aide's Utility Functions</a></blockquote>
   <blockquote class = "bq"><a name="1032125"> </a><a href="CComp_Install.html#1022988">Summary of Install Aide Functions</a></blockquote>

<p><a name="1020326"> </a>For details on the Install Aide functions, see <a href="CRef_InstAide.html#995934">Chapter 15, "Install Aide API,"</a> in the <i>C/C++ Sync Suite Reference</i>. </p>
<h3 class="hbH3">
  <a name="1020488"> </a>How Install Aide Works <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1049293"> </a>The Install Aide does not actually move data between the desktop and handheld; it simply moves files into a queue directory on the desktop and tells HotSync Manager that something needs to be installed. A registered <a href="Intro_Glossary.html#914890"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">install conduit</span></a> called by HotSync Manager during a HotSync operation actually transfers queued files to primary storage or to an expansion card in a handheld. HotSync Manager ships with several install conduits, so you likely do not need to implement your own install conduit. <a href="Intro_HotSyncProc.html#996281">"Running Install Conduits"</a> in the <i>Introduction to Conduit Development</i> lists these install conduits and the file types they can install.</p>

<p><a name="1048809"> </a>The Install Aide API provides two functions that your installer, desktop application, or conduit can call to queue files for installation: <a href="CRef_InstAide.html#997299"><code>PltInstallFile()</code></a> for files destined for primary storage and <a href="CRef_InstAide.html#996589"><code>PlmSlotInstallFile()</code></a> for files destined for an expansion card. When you call one of these functions, you specify the HotSync user and the path of the file you want to install. At the time you call one of these functions, Install Aide performs the following tasks:</p>
<ol type="1">
  <li value="1"><a name="1049749"> </a>Install Aide selects a default install conduit to run based on the <i>extension</i> of the file you specify and the install <i>function</i> you call, as shown in <a href="CComp_Install.html#1049920">Table 9.12</a>. Each install conduit is registered to handle certain filename extensions.
</ol>

<p class="fineprint">
<p class="caption"><a name="1049920"> </a><b>Table 9.12&nbsp;&nbsp;Install Aide's choice of install conduit and destination based on filename extension</b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1049928"> </a><b>Filename Extension</b></p>
    </th>
    <th><p class="tt"><a name="1049930"> </a><b>Function Called</b></p>
    </th>
    <th><p class="tt"><a name="1049932"> </a><b>Install Conduit used by Install Aide</b></p>
    </th>
    <th><p class="tt"><a name="1049934"> </a><b>Destination on Handheld</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1049936"> </a>PRC, PDB, SDB, SSD, PQA</p>
    </td>
    <td><p class="tt"><a name="1049941"> </a><a href="CRef_InstAide.html#997299"><code>PltInstallFile()</code></a></p>
    </td>
    <td><p class="tt"><a name="1049943"> </a>Install</p>
    </td>
    <td><p class="tt"><a name="1049945"> </a>Primary storage</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1049947"> </a>PNC, SCP</p>
    </td>
    <td><p class="tt"><a name="1049952"> </a><a href="CRef_InstAide.html#997299"><code>PltInstallFile()</code></a></p>
    </td>
    <td><p class="tt"><a name="1049954"> </a>Install Service Templates<a href="#1071630"><sup>1</sup></a></p>
    </td>
    <td><p class="tt"><a name="1049956"> </a>Primary storage</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1049958"> </a>*.*</p>
    </td>
    <td><p class="tt"><a name="1049963"> </a><a href="CRef_InstAide.html#997299"><code>PltInstallFile()</code></a></p>
    </td>
    <td><p class="tt"><a name="1049965"> </a>HotSync Exchange</p>
    </td>
    <td><p class="tt"><a name="1049967"> </a>Primary storage</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1049969"> </a>*.*</p>
    </td>
    <td><p class="tt"><a name="1049974"> </a><a href="CRef_InstAide.html#996589"><code>PlmSlotInstallFile()</code></a></p>
    </td>
    <td><p class="tt"><a name="1049976"> </a>Install to Card</p>
    </td>
    <td><p class="tt"><a name="1049978"> </a>Card in specified expansion slot</p>
    </td>
  </tr>
</table>
<div class="tablediv"><table cellspacing="0" class="tTableNR">
   <tr>
     <td><div class="FNTFootnoteTable">
<a name="1071630"> </a><a href="#1049954">1</a>. 
Works only with handhelds running a version of Palm OS earlier than Palm OS Cobalt.</div>
</td>
   </tr>
</table></div>

</div>

</p>
   <p><a name="1049462"> </a>Install Aide chooses the HotSync Exchange conduit if the filename extension does not match one of the preceding Palm OS filename extensions but does match an extension that a handheld application has registered with the Exchange Manager on the handheld. See <a href="Intro_HotSyncExch.html#608590">Chapter 3, "Using HotSync Exchange,"</a> in the <i>Introduction to Conduit Development</i>.</p>
<div class="NINoteImportant"><hr>
  <a name="1079991"> </a> <b>NOTE: </b> The files you install with <a href="CRef_InstAide.html#997299"><code>PltInstallFile()</code></a> must have filename extensions. Otherwise, the install function fails and returns <code>ERR_IA_INVALID_FILE_TYPE</code>, because Install Aide cannot determine what install conduit to use.
<hr>
</div>
<ol type="1">
  <li value="2"><a name="1079992"> </a>Install Aide copies the file to the install directory that is associated with the install conduit that it selected in step <a href="CComp_Install.html#1049749">1</a>. 
  <li value="3"><a name="1026414"> </a>Install Aide creates an install flag for the specified HotSync user in the configuration entries. 
  <li value="4"><a name="1078502"> </a>Install Aide sets the value of the install flag to the value of the bit mask associated with the install conduit that is registered to handle files of the specified type. HotSync Manager reads this install flag the next time it runs install conduits for the specified user. This flag tells HotSync Manager that it must run the install conduit with the matching mask value.
</ol>

<p><a name="1020505"> </a>If you call one of the install functions again before HotSync Manager runs the install conduits again, these steps repeat&#8212except that the Install Aide ORs the existing value of the install flag with that of each subsequent call. For example, if the first call selects an install conduit with a bit mask value of 1 and the second call selects one with a value of 4, the resulting value of this install flag is 5 the next time the install conduits are run. Therefore HotSync Manager will run two install conduits, one registered with a bit mask of 1 and another with a bit mask of 4. </p>

<p><a name="1066610"> </a>Each install conduit decides whether to remove its mask value from the HotSync user's install flag after a successful or unsuccessful installation. The Install install conduit leaves the mask value if unsuccessful; it removes it if successful. The HotSync Exchange install conduit runs independent of the mask, because there could be files that need to be transferred from the handheld to the desktop.</p>

<p><a name="1066586"> </a>HotSync Manager calls install conduits twice: before it runs all synchronization conduits and again after. If one of the install functions is called outside of a HotSync operation, then an install conduit installs the queued file at the <i>beginning</i> of the <i>next</i> HotSync operation. If a conduit calls one of the install functions during a HotSync operation, then an install conduit installs the queued file at the <i>end</i> of the <i>current</i> HotSync operation.</p>

<p><a name="1020507"> </a>The Install Aide provides other functions to help manage files queued to be installed and to obtain expansion slot information. These are discussed in the remainder of this section and detailed in <a href="CRef_InstAide.html#995934">Chapter 15, "Install Aide API,"</a> in the <i>C/C++ Sync Suite Reference</i>. </p>

<h4 class="hcH4">
  <a name="1062284"> </a>Install Directory Terminology
</h4>

<p><a name="1062288"> </a><a href="CComp_Install.html#1062295">Table 9.13</a> defines the various desktop directories to which the Install Aide copies files queued to be installed by the default install conduits during the next HotSync operation. <a href="CComp_Install.html#1062336">Figure 9.1</a> shows the relative locations of these directories for the current Windows user. </p>

<p class="fineprint">
<p class="caption"><a name="1062295"> </a><b>Table 9.13&nbsp;&nbsp;Desktop directories associated with Install Aide</b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1062299"> </a><b>Directory Name</b></p>
    </th>
    <th><p class="tt"><a name="1062301"> </a><b>Description</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1062303"> </a>Windows user's directory</p>
    </td>
    <td><p class="tt"><a name="1062305"> </a>For the current Windows user, this directory contains all HotSync Manager files and user directories (by default) for all HotSync users. To get this path, call <a href="CRef_CnMgr.html#997119"><code>CmGetCorePath()</code></a>.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1062311"> </a>HotSync user's directory </p>
    </td>
    <td><p class="tt"><a name="1062313"> </a>For each HotSync user, this directory contains the handheld-install and slot directories, as well as data directories for each default conduit. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1062316"> </a>Handheld-install directory </p>
    </td>
    <td><p class="tt"><a name="1062318"> </a>For each HotSync user, this directory contains Palm OS applications and databases queued to be installed by an associated install conduit into the handheld's main memory the next time install conduits run. There can be such a directory for each of multiple install conduits. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1062321"> </a>Slot directory </p>
    </td>
    <td><p class="tt"><a name="1062323"> </a>For each HotSync user, this directory contains subdirectories (slot-install directories) for each slot on the user's handheld. This directory and its subdirectories are associated with an install conduit that installs files to expansion cards. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1062326"> </a>Slot-install directory </p>
    </td>
    <td><p class="tt"><a name="1062328"> </a>For each slot on each HotSync user's handheld, this directory contains files queued to be installed to a card in the associated slot the next time install conduits run. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1062331"> </a>HotSync Exchange directory</p>
    </td>
    <td><p class="tt"><a name="1062333"> </a>For each HotSync user, the <code>Exchange</code> directory contains <code>To</code> and <code>From</code> subdirectories. The <code>To</code> directory contains files to be installed to the handheld's main memory via HotSync Exchange. The <code>From</code> directory contains files that have been sent to the desktop from the handheld.</p>
    </td>
  </tr>
</table>

</div>

</p>

<p class="FFigureCaption">
  <a name="1062336"> </a><b>Figure 9.1&nbsp;&nbsp;Directories that default install conduits queue <br>files in </b>
</p>
<div align="left"><img src="images/CComp_Installa.gif" height="413" width="585" border="0" hspace="0" vspace="0">
</div>

<h4 class="hcH4">
  <a name="1062445"> </a>Specifying File Types
</h4>

<p><a name="1032176"> </a>The <a href="CRef_InstAide.html#996735"><code>PltGetFileCount()</code></a>, <a href="CRef_InstAide.html#996771"><code>PltGetFileInfo()</code></a>, and <a href="CRef_InstAide.html#996817"><code>PltGetFileName()</code></a> functions require that the caller pass in the filename in the <code class="par">pExtension</code> parameter. This parameter requires a string of format <i>"*.extension"</i>&#8212for example, the following are the standard Palm OS database image filename extensions:</p>
<ul type="disc">
  <li><a name="1032181"> </a><code>"*.prc"</code>&#8212Application
  <li><a name="1032182"> </a><code>"*.pdb"</code>&#8212Classic or extended database
  <li><a name="1032604"> </a><code>"*.sdb"</code>&#8212Schema database
  <li><a name="1032610"> </a><code>"*.ssd"</code>&#8212Secure schema database
  <li><a name="1032617"> </a><code>"*.pqa"</code>&#8212Query application
  <li><a name="1032535"> </a><code>"*.pnc"</code>&#8212Network configuration file
  <li><a name="1032661"> </a><code>"*.scp"</code>&#8212Network script file
</ul>

<p><a name="1032544"> </a>If you implement an install conduit, you can register your own filename extensions when you register your install conduit. See <a href="CComp_Install.html#996405">"Using the Install Conduit Manager API."</a></p>

<p><a name="1032711"> </a>Those functions that pass back a file extension do so in the same format&#8212for example, <a href="CRef_InstAide.html#996860"><code>PltGetFileTypeExtension()</code></a>. </p>

<p><a name="1032187"> </a>The functions that pass back file filters, <a href="CRef_InstAide.html#997036"><code>PltGetInstallFileFilter()</code></a> and <a href="CRef_InstAide.html#997073"><code>PltGetInstallFileFilterForUser()</code></a>, do so in a buffer containing a string that specifies the file filter types concatenated together in Windows-standard format&#8212for example:</p>
<pre class="sl">"type1 (*.ext1)|*.ext1|type2 (*.ext2)|*.ext2||"</pre>
<h3 class="hbH3">
  <a name="1020274"> </a>Queuing a Database to Install in Primary Storage <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1050526"> </a>The Install Aide provides functions that enable you to queue a Palm OS database image file to be installed in the handheld's primary storage memory the next time HotSync Manager runs install conduits. To perform this operation, pass the HotSync user's name and the path of the file to the <a href="CRef_InstAide.html#997299"><code>PltInstallFile()</code></a> function. The Install Aide does the rest, as described in <a href="CComp_Install.html#1020488">"How Install Aide Works."</a> </p>

<p><a name="1050540"> </a>The default install conduit named Install is registered to handle only files with the extensions of Palm OS database image files. For differences on how to use Install Aide to queue files of other types for installation in primary storage, see <a href="CComp_Install.html#1050628">"Queuing a File to Install in Primary Storage via HotSync Exchange."</a></p>

<p><a name="1027573"> </a><a href="CComp_Install.html#1027578">Listing 9.3</a> is an example of using <code>PltInstallFile()</code> to queue an application (<code>MyApp.prc</code>) for installation in primary storage on the handheld. </p>
<p class="CCodeCaption">
  <a name="1027578"> </a><b>Listing 9.3&nbsp;&nbsp;Example of queuing a file to install in primary storage </b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
int QueueFileToInstallInPrimary () {<a name="1027579"> </a>
<a name="1027808"> </a>
int iRetval = 0;<a name="1027809"> </a>
TCHAR pUser[45];<a name="1027935"> </a>
short psUserBufSize = sizeof (pUser);<a name="1027812"> </a>
unsigned int iIndex = 0;<a name="1027900"> </a>
<a name="1027876"> </a>
   // Get the HotSync user's name. This example just gets the <a name="1027879"> </a>
   // first user in the user data store. <a name="1028317"> </a>
   psUserBufSize = sizeof (pUser);<a name="1027880"> </a>
   memset (pUser, 0, psUserBufSize);<a name="1027881"> </a>
   iRetval = PltGetUser (iIndex, pUser, &amp;psUserBufSize);<a name="1027905"> </a>
<a name="1027906"> </a>
   if (iRetval &gt; 0)<a name="1027907"> </a>
   {<a name="1027877"> </a>
      // Queue file for installation for the first user.<a name="1027949"> </a>
      iRetval = <i>PltInstallFile</i> (pUser, "C:\MyApp.prc");<a name="1027600"> </a>
   }<a name="1028107"> </a>
   return iRetVal;<a name="1027948"> </a>
}<a name="1027601"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1028486"> </a><a href="CComp_Install.html#1028490">Table 9.14</a> summarizes the functions for queuing a file to install in primary storage. </p>

<p class="fineprint">
<p class="caption"><a name="1028490"> </a><b>Table 9.14&nbsp;&nbsp;Queuing a database to install in primary storage </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1028497"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1028499"> </a><b>Install Aide API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028501"> </a>Queue a file to install in primary storage for a HotSync user specified by <i>name.</i> File must be of a type supported by a registered install conduit.</p>
    </td>
    <td><p class="tt"><a name="1028510"> </a><a href="CRef_InstAide.html#997299"><code>PltInstallFile()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028515"> </a>Remove a queued file from the queue folder for a HotSync user specified by <i>name.</i> </p>
    </td>
    <td><p class="tt"><a name="1028524"> </a><a href="CRef_InstAide.html#997409"><code>PltRemoveInstallFile()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028702"> </a>Move a file that is queued for installation on an expansion card to be installed in primary storage instead. Specify the HotSync user by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1028704"> </a><a href="CRef_InstAide.html#996387"><code>PlmMoveInstallFileToHandheld()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028727"> </a>Get the number, names, and sizes of files queued for installation in primary storage. Specify the HotSync user by <i>name.</i> </p>
    </td>
    <td><p class="tt"><a name="1028729"> </a><a href="CRef_InstAide.html#996735"><code>PltGetFileCount()</code></a><br><a href="CRef_InstAide.html#996771"><code>PltGetFileInfo()</code></a><br><a href="CRef_InstAide.html#996817"><code>PltGetFileName()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1028777"> </a>Get the number and extensions of all file types supported by registered install conduits that install files in a handheld's primary storage.</p>
    </td>
    <td><p class="tt"><a name="1028779"> </a><a href="CRef_InstAide.html#996860"><code>PltGetFileTypeExtension()</code></a><br><a href="CRef_InstAide.html#996909"><code>PltGetFileTypesCount()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1050628"> </a>Queuing a File to Install in Primary Storage via HotSync Exchange  <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1051634"> </a>Queuing a <i>file</i> to install in primary storage is similar to queuing an image file of a Palm OS <i>database</i>. See <a href="CComp_Install.html#1020274">"Queuing a Database to Install in Primary Storage"</a> for how that is done. When you queue a <i>file</i> for installation in <i>primary storage</i> and it is not a Palm OS database image file, the Install Aide uses the <i>HotSync Exchange</i> install conduit. The primary differences in how this works are:</p>
<ul type="disc">
  <li><a name="1050815"> </a>Only versions 6.0 and later of HotSync Manager include the HotSync Exchange install conduit. Only Palm OS Cobalt has the required HotSync Exchange Manager library used by the Exchange Manager on the handheld.
  <li><a name="1050820"> </a>The default install conduit that Install Aide uses is called "HotSync Exchange." It is registered to handle only those file types that handheld applications have registered with the Exchange Manager.
  <li><a name="1050821"> </a>HotSync Manager retrieves information from the HotSync Exchange Manager library (or the lack thereof) at the beginning of each HotSync operation and saves it for the corresponding user in the user data store on the desktop. However, between HotSync operations, the user can change or update the handheld&#8212for example, the user can add or delete an application that registers with the Exchange Manager for certain filename extensions. Upon the next HotSync operation, queued files with extensions that a now-deleted application registered for cannot be handled by the HotSync Exchange install conduit, so they are not installed.
</ul>

<p><a name="1050784"> </a>For background on HotSync Exchange, see <a href="Intro_HotSyncExch.html#608590">Chapter 3, "Using HotSync Exchange,"</a> in the <i>Introduction to Conduit Development</i>.</p>
<h3 class="hbH3">
  <a name="1022847"> </a>Queuing a File to Install on an Expansion Card <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1028340"> </a>Queuing a file to install on an expansion card is similar to queuing a file to install in primary storage, so see <a href="CComp_Install.html#1020274">"Queuing a Database to Install in Primary Storage."</a> The primary differences are:</p>
<ul type="disc">
  <li><a name="1028857"> </a>Only versions 4.0 and later of the Install Aide API support expansion cards.
  <li><a name="1028466"> </a>Call <a href="CRef_InstAide.html#996589"><code>PlmSlotInstallFile()</code></a> to queue a file to install on a card.
  <li><a name="1029127"> </a>The default install conduit for expansion cards is called "Install to Card" and is registered to handle all filename extensions.
  <li><a name="1028938"> </a>HotSync Manager retrieves information about a handheld's expansion slots (or lack thereof) at the beginning of each HotSync operation and saves it for the corresponding user in the user information store on the desktop. However, between HotSync operations, the user can change or update the handheld&#8212for example, the user can upgrade to a handheld with more slots or switch to one with no slots at all. Upon the next HotSync operation, HotSync Manager asks the user either to create a new HotSync user name or to choose one from the list of users who have previously performed a HotSync operation as the current Windows user. If the user chooses a HotSync user name from the list, the slot information saved for that user at the beginning of the last HotSync operation is now inaccurate. 
  <li><a name="1028872"> </a>If your application or installer calls the Install Aide outside of a HotSync operation, be aware that your files might not be installed during the next HotSync operation if the slot or card does not exist at that time. 
  <li><a name="1030013"> </a>Call the User Data API to get information about the expansion slots and cards in users' handhelds. You must pass user IDs and expansion slot IDs to expansion-related Install Aide APIs. See <a href="CComp_Install.html#996394">"Using the User Data API."</a>
</ul>

<p><a name="1028357"> </a><a href="CComp_Install.html#1032133">Listing 9.4</a> is an example of using <code>PlmSlotInstallFile()</code> to queue a file (<code>MyPhoto.jpg</code>) for installation on an expansion card.</p>
<p class="CCodeCaption">
  <a name="1032133"> </a><b>Listing 9.4&nbsp;&nbsp;Example of queuing a file to install on an expansion card</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
long QueueFileToInstallOnCard () {<a name="1030084"> </a>
<a name="1030086"> </a>
long kSuccess = 0;<a name="1030215"> </a>
short sIndex = 0;                     // Index of the first HotSync user.<a name="1030087"> </a>
long retval = 0;<a name="1030088"> </a>
DWORD dwUserID = 0;<a name="1030089"> </a>
WORD numSlots = 0;<a name="1030090"> </a>
DWORD *pdwSlotIdList;<a name="1030091"> </a>
char szFile[] = "\\MyPhoto.jpg"; // Name of file to queue for installation.<a name="1030092"> </a>
<a name="1030093"> </a>
   // Get the HotSync user's name. This example just gets the first user in the <a name="1030094"> </a>
   // user data store.<a name="1030212"> </a>
   retval = UmGetUserID (sIndex, &amp;dwUserID);<a name="1030095"> </a>
   if (retval == kSuccess)<a name="1030096"> </a>
   {<a name="1030097"> </a>
      // Get the number of expansion slots.<a name="1030098"> </a>
      retval = UmSlotGetSlotCount (dwUserID, &amp;numSlots);<a name="1030099"> </a>
      if (retval == kSuccess)<a name="1030100"> </a>
      {<a name="1030101"> </a>
         if(numSlots &gt; 0 )<a name="1030102"> </a>
         {<a name="1030103"> </a>
            // Get the slot IDs.<a name="1030104"> </a>
            pdwSlotIdList = new DWORD[numSlots];<a name="1030105"> </a>
            retval = UmSlotGetInfo (dwUserID, pdwSlotIdList, &amp;numSlots);<a name="1030106"> </a>
            if (retval == kSuccess)<a name="1030107"> </a>
            {<a name="1030108"> </a>
               // Queue file to install on card in the first expansion slot.<a name="1030109"> </a>
               retval = <i>PlmSlotInstallFile</i> (dwUserID, *pdwSlotIdList, szFile);<a name="1030111"> </a>
               if (retval == kSuccess)<a name="1030113"> </a>
               {<a name="1030114"> </a>
                  delete[] pdwSlotIdList;<a name="1030115"> </a>
                  return retval;<a name="1030116"> </a>
               }<a name="1030117"> </a>
            }<a name="1030118"> </a>
         }<a name="1030119"> </a>
         else <a name="1030120"> </a>
         {<a name="1030121"> </a>
            return retval; // User's handheld has no slots.<a name="1030122"> </a>
         }<a name="1030123"> </a>
      }<a name="1030124"> </a>
   } <a name="1030125"> </a>
}<a name="1030126"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1029493"> </a><a href="CComp_Install.html#1029499">Table 9.15</a> summarizes the Install Aide functions for queuing a file to install in primary storage. </p>

<p class="fineprint">
<p class="caption"><a name="1029499"> </a><b>Table 9.15&nbsp;&nbsp;Queuing a file to install on an expansion card </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1029503"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1029505"> </a><b>Install Aide API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029507"> </a>Queue a file to install on an expansion card. Specify the HotSync user by <i>user ID</i> and the expansion slot by <i>slot ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1029512"> </a><a href="CRef_InstAide.html#996589"><code>PlmSlotInstallFile()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029514"> </a>Remove a queued file from the slot-install folder. Specify the HotSync user by <i>user ID</i> and the expansion slot by <i>slot ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1029519"> </a><a href="CRef_InstAide.html#996690"><code>PlmSlotRemoveInstallFile()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029521"> </a>Move a file that is queued for installation in primary storage to be installed on an expansion card instead. Specify the HotSync user by <i>user ID</i> and the expansion slot by <i>slot ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1029526"> </a><a href="CRef_InstAide.html#996435"><code>PlmMoveInstallFileToSlot()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029726"> </a>Move a file that is queued for installation on an expansion card to be installed on another expansion card instead. Specify the HotSync user by <i>user ID</i> and the expansion slots by <i>slot ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1029731"> </a><a href="CRef_InstAide.html#996640"><code>PlmSlotMoveInstallFile()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1029528"> </a>Get the number, names, and sizes of files queued for installation on an expansion card. Specify the HotSync user by <i>user ID</i> and the expansion slot by <i>slot ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1029533"> </a><a href="CRef_InstAide.html#996483"><code>PlmSlotGetFileCount()</code></a><br><a href="CRef_InstAide.html#996525"><code>PlmSlotGetFileInfo()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1032483"> </a>Retrieving HotSync User Information <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1030297"> </a>The Install Aide API provides the functions listed in <a href="CComp_Install.html#1030316">Table 9.16</a> for retrieving HotSync user information from the user data store on the desktop. However, PalmSource, Inc. recommends that you use the User Data API instead. See <a href="CComp_Install.html#996394">"Using the User Data API"</a> for details.</p>

<p class="fineprint">
<p class="caption"><a name="1030316"> </a><b>Table 9.16&nbsp;&nbsp;Retrieving HotSync user information </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1030320"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1030322"> </a><b>Install Aide API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1030331"> </a>Get a HotSync user name by <i>index.</i> Call <code>PltGetUserCount()</code> to get the upper limit of the index.</p>
    </td>
    <td><p class="tt"><a name="1030336"> </a><a href="CRef_InstAide.html#997188"><code>PltGetUser()</code></a><br><a href="CRef_InstAide.html#997225"><code>PltGetUserCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1030338"> </a>Get a HotSync user's folder name. Specify the HotSync <i>user name.</i> </p>
    </td>
    <td><p class="tt"><a name="1030343"> </a><a href="CRef_InstAide.html#997262"><code>PltGetUserDirectory()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1030532"> </a>Get a HotSync user name/ID by specifying a <i>user ID/name.</i> </p>
    </td>
    <td><p class="tt"><a name="1030534"> </a><a href="CRef_InstAide.html#996317"><code>PlmGetUserIDFromName()</code></a><br><a href="CRef_InstAide.html#996351"><code>PlmGetUserNameFromID()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1030345"> </a>Determine whether a HotSync user is actually a <a href="Intro_Glossary.html#915011"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">user profile</span></a>.</p>
    </td>
    <td><p class="tt"><a name="1030350"> </a><a href="CRef_InstAide.html#997370"><code>PltIsUserProfile()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1030244"> </a>Accessing Registered Install Conduit Information <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1030754"> </a>The Install Aide API provides functions for retrieving information about the install conduits that HotSync Manager can run for the current Windows user. (The Install Aide accesses only those install conduits that are on the Conduit Manager's list of reconciled install conduits. For more information see <a href="Intro_Registering.html#997389">"User- and System-registered Conduits and Notifiers"</a> in the <i>Introduction to Conduit Development</i>. To get information about all registered install conduits, use the Install Conduit Manager discussed in <a href="CComp_Install.html#996405">"Using the Install Conduit Manager API."</a>) These APIs do not access synchronization or backup conduits. <a href="CComp_Install.html#1030765">Table 9.17</a> describes the kinds of install conduit information you can get or set with Install Aide APIs. </p>

<p class="fineprint">
<p class="caption"><a name="1030765"> </a><b>Table 9.17&nbsp;&nbsp;Accessing registered install conduit <br>information </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1030772"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1030774"> </a><b>Install Aide API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1030776"> </a>Get a count of all registered install conduits. Use as upper limit of index in other by-index calls.</p>
    </td>
    <td><p class="tt"><a name="1030778"> </a><a href="CRef_InstAide.html#996939"><code>PltGetInstallConduitCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1030809"> </a>Get install conduit registration information by <i>index.</i> Passes back a <a href="CRef_InstAide.html#996005"><code>FileInstallType</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1030814"> </a><a href="CRef_InstAide.html#996969"><code>PltGetInstallConduitInfo()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1031424"> </a>Get install conduit registration information by <i>unique ID.</i> Passes back a <a href="CRef_InstAide.html#996005"><code>FileInstallType</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1031429"> </a><a href="CRef_InstAide.html#997005"><code>PltGetInstallCreatorInfo()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1031477"> </a>Get a file filter consisting of all filename extensions registered by all install conduits for all HotSync users, or for the specified HotSync user. When you specify the HotSync user, Install Aide takes into account whether the specified user's handheld has been synchronized with an expansion card in its slot; it includes related file type filters only if a card has been present before.</p>
    </td>
    <td><p class="tt"><a name="1031479"> </a><a href="CRef_InstAide.html#997036"><code>PltGetInstallFileFilter()</code></a><br><a href="CRef_InstAide.html#997073"><code>PltGetInstallFileFilterForUser()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1030823"> </a>Determine by <i>index</i> whether a conduit is registered conventionally or is folder-based and whether HotSync Manager can load it. Passes back a <a href="CRef_CnMgr.html#996487"><code>CmDiscoveryInfoType</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1030828"> </a>User:<br><a href="CRef_CnMgr.html#997999"><code>CmGetDiscoveryInfoByIndex()</code></a></p>
<p class="tt"><a name="1030832"> </a>System:<br><a href="CRef_CnMgr.html#999036"><code>CmGetSystemDiscoveryInfoByIndex()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1031509"> </a>Determine whether an install conduit is set to run or clear its install flag so that it does not run.</p>
    </td>
    <td><p class="tt"><a name="1031511"> </a><a href="CRef_InstAide.html#997336"><code>PltIsInstallMaskSet()</code></a><br><a href="CRef_InstAide.html#997467"><code>PltResetInstallMask()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1022958"> </a>Using Install Aide's Utility Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1031812"> </a>The Install Aide API includes several utility functions summarized in <a href="CComp_Install.html#1013417">Table 9.11</a>. </p>

<p class="fineprint">
<p class="caption"><a name="1031822"> </a><b>Table 9.18&nbsp;&nbsp;Using the Install Aide's utility functions </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1031826"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1031828"> </a><b>Install Aide API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1031841"> </a>Get the version number of the Install Aide API. See the "Compatibility" section of each function to see in which versions of the Install Aide API the function is available.</p>
    </td>
    <td><p class="tt"><a name="1031843"> </a><a href="CRef_InstAide.html#996287"><code>PlmGetLibVersion()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1031972"> </a>Get one of the path of the HotSync users' folder for the current Windows user. Each Windows user must have a unique path, so there is no system-level value.</p>
    </td>
    <td><p class="tt"><a name="1031974"> </a><a href="CRef_InstAide.html#997112"><code>PltGetPath()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1022988"> </a>Summary of Install Aide Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="1025576"> </a><b>Install Aide Functions </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1025580"> </a><b>Queuing a Database or a File to Install in Primary Storage</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1025587"> </a><a href="CRef_InstAide.html#997299"><code>PltInstallFile()</code></a><br><a href="CRef_InstAide.html#997409"><code>PltRemoveInstallFile()</code></a><br><a href="CRef_InstAide.html#996387"><code>PlmMoveInstallFileToHandheld()</code></a></p>
    </td>
    <td><p class="tt"><a name="1025610"> </a><a href="CRef_InstAide.html#996735"><code>PltGetFileCount()</code></a><br><a href="CRef_InstAide.html#996771"><code>PltGetFileInfo()</code></a><br><a href="CRef_InstAide.html#996817"><code>PltGetFileName()</code></a><br><a href="CRef_InstAide.html#996860"><code>PltGetFileTypeExtension()</code></a><br><a href="CRef_InstAide.html#996909"><code>PltGetFileTypesCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1025638"> </a><b>Queuing a File to Install on an Expansion Card</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1025645"> </a><a href="CRef_InstAide.html#996589"><code>PlmSlotInstallFile()</code></a><br><a href="CRef_InstAide.html#996690"><code>PlmSlotRemoveInstallFile()</code></a><br><a href="CRef_InstAide.html#996435"><code>PlmMoveInstallFileToSlot()</code></a><br><a href="CRef_InstAide.html#996640"><code>PlmSlotMoveInstallFile()</code></a></p>
    </td>
    <td><p class="tt"><a name="1025662"> </a><a href="CRef_InstAide.html#996483"><code>PlmSlotGetFileCount()</code></a><br><a href="CRef_InstAide.html#996525"><code>PlmSlotGetFileInfo()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1025794"> </a><b>Retrieving HotSync User Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1025801"> </a><a href="CRef_InstAide.html#997188"><code>PltGetUser()</code></a><br><a href="CRef_InstAide.html#997225"><code>PltGetUserCount()</code></a><br><a href="CRef_InstAide.html#997262"><code>PltGetUserDirectory()</code></a><br><a href="CRef_InstAide.html#997370"><code>PltIsUserProfile()</code></a></p>
    </td>
    <td><p class="tt"><a name="1025818"> </a><a href="CRef_InstAide.html#996317"><code>PlmGetUserIDFromName()</code></a><br><a href="CRef_InstAide.html#996351"><code>PlmGetUserNameFromID()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1025664"> </a><b>Accessing Registered Install Conduit Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1025671"> </a><a href="CRef_InstAide.html#996939"><code>PltGetInstallConduitCount()</code></a><br><a href="CRef_InstAide.html#996969"><code>PltGetInstallConduitInfo()</code></a><br><a href="CRef_InstAide.html#997005"><code>PltGetInstallCreatorInfo()</code></a><br><a href="CRef_InstAide.html#997036"><code>PltGetInstallFileFilter()</code></a><br><a href="CRef_InstAide.html#997073"><code>PltGetInstallFileFilterForUser()</code></a></p>
    </td>
    <td><p class="tt"><a name="1025694"> </a><a href="CRef_InstAide.html#997336"><code>PltIsInstallMaskSet()</code></a><br><a href="CRef_InstAide.html#997467"><code>PltResetInstallMask()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1025704"> </a><b>Utility Functions</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1025711"> </a><a href="CRef_InstAide.html#996287"><code>PlmGetLibVersion()</code></a></p>
    </td>
    <td><p class="tt"><a name="1026185"> </a><a href="CRef_InstAide.html#997112"><code>PltGetPath()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h2 class="haH2">
  <a name="996394"> </a>Using the User Data API <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1038251"> </a>The User Data API is the preferred way to access information in the HotSync <a href="Intro_Glossary.html#915003"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">user data store</span></a> on the desktop. (Other APIs offer some similar functionality, but PalmSource recommends that you use the User Data API instead.) The users data store holds the name, ID, synchronization preferences, desktop directory, and password for each HotSync user created by the current Windows user.</p>

<p><a name="1038260"> </a>This section describes the most common tasks that an installer or desktop application performs using the User Data API:</p>
   <blockquote class = "bq"><a name="1038274"> </a><a href="CComp_Install.html#1037405">Adding and Deleting HotSync Users</a></blockquote>
   <blockquote class = "bq"><a name="1054073"> </a><a href="CComp_Install.html#1038161">Finding and Setting the Directory of a HotSync User</a></blockquote>
   <blockquote class = "bq"><a name="1054097"> </a><a href="CComp_Install.html#1038757">Accessing Information about a HotSync User</a></blockquote>
   <blockquote class = "bq"><a name="1054112"> </a><a href="CComp_Install.html#1038758">Accessing the Synchronization Preferences of a HotSync User</a></blockquote>
   <blockquote class = "bq"><a name="1054120"> </a><a href="CComp_Install.html#1037606">Retrieving the Expansion Slot Information of a HotSync User</a></blockquote>
   <blockquote class = "bq"><a name="1054176"> </a><a href="CComp_Install.html#1037696">Modifying the Install Conduit Flags of a HotSync User</a></blockquote>
   <blockquote class = "bq"><a name="1054264"> </a><a href="CComp_Install.html#1037738">Accessing Developer-defined Entries in the User Data Store</a></blockquote>
   <blockquote class = "bq"><a name="1054278"> </a><a href="CComp_Install.html#1037861">Using User Data API Utility Functions</a></blockquote>
   <blockquote class = "bq"><a name="1054328"> </a><a href="CComp_Install.html#1034355">Summary of User Data API Functions</a></blockquote>

<p><a name="996398"> </a>For details on the User Data API functions, see <a href="CRef_UserData.html#995934">Chapter 16, "User Data API,"</a> in the <i>C/C++ Sync Suite Reference</i>.</p>
<h3 class="hbH3">
  <a name="1037405"> </a>Adding and Deleting HotSync Users <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1038278"> </a>If your desktop application or installer needs to manage HotSync users on the desktop, the User Data API provides the functions described in <a href="CComp_Install.html#1038287">Table 9.19</a>.</p>

<p class="fineprint">
<p class="caption"><a name="1038287"> </a><b>Table 9.19&nbsp;&nbsp;Adding and deleting HotSync users </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1038291"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1038293"> </a><b>User Data API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1038295"> </a>Add a new HotSync user or <a href="Intro_Glossary.html#915011"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">user profile</span></a> to the user data store. Specify the <i>user name.</i> If the user data store does not exist, this function creates it.</p>
    </td>
    <td><p class="tt"><a name="1038300"> </a><a href="CRef_UserData.html#996206"><code>UmAddUser()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1038302"> </a>Delete a HotSync user. Specify the <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1038307"> </a><a href="CRef_UserData.html#996347"><code>UmDeleteUser()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1038161"> </a>Finding and Setting the Directory of a HotSync User <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1038228"> </a>When HotSync Manager is installed, the <a href="Intro_Glossary.html#914842"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">default conduits</span></a> store their desktop data in subdirectories of each HotSync user's directory as shown in <a href="CComp_Install.html#1062336">Figure 9.1</a>. If you want to do the same, <a href="CComp_Install.html#1038729">Table 9.20</a> describes the User Data API functions you can use to find or set this directory for the current Windows user.</p>

<p class="fineprint">
<p class="caption"><a name="1038729"> </a><b>Table 9.20&nbsp;&nbsp;Finding and setting the directory of a HotSync user </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1038733"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1038735"> </a><b>User Data API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1038737"> </a>Get the path of the HotSync users' directory for the current Windows user. This is the value stored in the <a href="Intro_CfgEntries.html#994526"><code>Core\Path</code></a> configuration entry.</p>
    </td>
    <td><p class="tt"><a name="1038745"> </a><a href="CRef_UserData.html#996655"><code>UmGetRootDirectory()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1038747"> </a>Get or set a HotSync user's directory name. Specify the HotSync <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1038752"> </a><a href="CRef_UserData.html#996786"><code>UmGetUserDirectory()</code></a><br><a href="CRef_UserData.html#997428"><code>UmSetUserDirectory()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1038757"> </a>Accessing Information about a HotSync User <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1038774"> </a>The User Data API provides functions for accessing information about each HotSync user created by the current Windows user. <a href="CComp_Install.html#1039300">Table 9.21</a> describes how to access this information.</p>

<p class="fineprint">
<p class="caption"><a name="1039300"> </a><b>Table 9.21&nbsp;&nbsp;Accessing information about a HotSync user </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1039304"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1039306"> </a><b>User Data API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1039308"> </a>Get a HotSync user ID by <i>index.</i> Call <code>UmGetUserCount()</code> to get the upper limit of the index.</p>
    </td>
    <td><p class="tt"><a name="1039313"> </a><a href="CRef_UserData.html#996841"><code>UmGetUserID()</code></a><br><a href="CRef_UserData.html#996760"><code>UmGetUserCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1039318"> </a>Get or set a HotSync user's name by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1039323"> </a><a href="CRef_UserData.html#996880"><code>UmGetUserName()</code></a><br><a href="CRef_UserData.html#997518"><code>UmSetUserName()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1039328"> </a>Get a HotSync user's encrypted password by <i>user ID.</i> Call <a href="CRef_PwdLib.html#995961"><code>PwdVerify()</code></a> to verify that the user's input matches.</p>
    </td>
    <td><p class="tt"><a name="1039336"> </a><a href="CRef_UserData.html#996925"><code>UmGetUserPassword()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1039338"> </a>Determine whether a HotSync user has performed at least one HotSync operation as the current Windows user (is the "installed" flag set). Or set the "installed" flag. Specify a HotSync user's name by <i>user ID.</i></p>
    </td>
    <td><p class="tt"><a name="1039343"> </a><a href="CRef_UserData.html#997133"><code>UmIsUserInstalled()</code></a><br><a href="CRef_UserData.html#997473"><code>UmSetUserInstall()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1039350"> </a>Determine whether a HotSync user is actually a <a href="Intro_Glossary.html#915011"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">user profile</span></a>. Specify a HotSync user's name by <i>user ID.</i></p>
    </td>
    <td><p class="tt"><a name="1039356"> </a><a href="CRef_UserData.html#997176"><code>UmIsUserProfile()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1038758"> </a>Accessing the Synchronization Preferences of a HotSync User <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1039430"> </a>The User Data API provides functions for accessing a HotSync user's permanent and temporary synchronization preferences. These are the preferences pass between HotSync Manager and your conduit via its <a href="CRef_CnAPI.html#996369"><code>CfgConduit()</code></a> entry point so that your conduit can present them to the user to change. For background on synchronization preferences, see <a href="Intro_HSMBasics.html#998123">"User's Conduit Synchronization Preferences"</a> in the <i>Introduction to Conduit Development</i>. </p>

<p><a name="1039639"> </a><a href="CComp_Install.html#1039571">Table 9.22</a> describes how to access this information with User Data API functions.</p>

<p class="fineprint">
<p class="caption"><a name="1039571"> </a><b>Table 9.22&nbsp;&nbsp;Accessing the synchronization preferences of a HotSync user </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1039575"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1039577"> </a><b>User Data API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1039579"> </a>Get or set a permanent or temporary synchronization preference of a conduit for a HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1039584"> </a><a href="CRef_UserData.html#996971"><code>UmGetUserPermSyncPreferences()</code></a><br><a href="CRef_UserData.html#997563"><code>UmSetUserPermSyncPreferences()</code></a><br><a href="CRef_UserData.html#997025"><code>UmGetUserTempSyncPreferences()</code></a><br><a href="CRef_UserData.html#997615"><code>UmSetUserTempSyncPreferences()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1039595"> </a>Delete the permanent or temporary synchronization preferences of <i>all</i> conduits for a HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1039597"> </a><a href="CRef_UserData.html#996388"><code>UmDeleteUserPermSyncPreferences()</code></a><br><a href="CRef_UserData.html#996436"><code>UmDeleteUserTempSyncPreferences()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1040774"> </a>Delete the temporary synchronization preference of a conduit for a HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1039601"> </a><a href="CRef_UserData.html#997225"><code>UmRemoveUserTempSyncPreferences()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1037606"> </a>Retrieving the Expansion Slot Information of a HotSync User <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1041156"> </a>At the beginning of the HotSync process, HotSync Manager retrieves from the handheld whether it has expansion slots, and if so, information about cards in those slots. HotSync Manager stores that information in the user data store, so that it can be accessed between HotSync operations&#8212for example, the Install Tool uses it to determine whether a HotSync user can queue files to be installed during the next HotSync operation. Because the User Data API does not retrieve slot information directly from the handheld but only what is saved in the user data store during the last HotSync operation, this information may not be accurate for the next HotSync operation; the user may have changed or updated the handheld in the interim. </p>

<p><a name="1041224"> </a><a href="CComp_Install.html#1041073">Table 9.23</a> describes how to access this expansion slot information with User Data API functions.</p>

<p class="fineprint">
<p class="caption"><a name="1041073"> </a><b>Table 9.23&nbsp;&nbsp;Retrieving the expansion slot information of a HotSync user </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1041077"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1041079"> </a><b>User Data API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1041269"> </a>Get the version of the Expansion Manager library on the handheld of a HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1041271"> </a><a href="CRef_UserData.html#997721"><code>UmSlotGetExpMgrVersion()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1041508"> </a>Get the number of expansion slots on the handheld of a HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1041510"> </a><a href="CRef_UserData.html#997924"><code>UmSlotGetSlotCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1041544"> </a>Get the slot IDs of all the expansion slots on the handheld for the HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1041549"> </a><a href="CRef_UserData.html#997753"><code>UmSlotGetInfo()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1041185"> </a>Get the display name of the expansion slot specified by <i>slot ID</i> for the HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1041187"> </a><a href="CRef_UserData.html#997670"><code>UmSlotGetDisplayName()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1041431"> </a>Get the type of media in a slot specified by <i>slot ID</i> for the HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1041433"> </a><a href="CRef_UserData.html#997873"><code>UmSlotGetMediaType()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1041563"> </a>Get the name of the slot-install directory on the desktop for a slot specified by <i>slot ID</i> for the HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1041568"> </a><a href="CRef_UserData.html#997813"><code>UmSlotGetInstallDirectory()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1037696"> </a>Modifying the Install Conduit Flags of a HotSync User <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1041683"> </a>Some functions for accessing a user's install conduit flags perform the same action in the User Data API as some do in the Install Aide API. However, the User Data API adds <a href="CRef_UserData.html#997280"><code>UmSetInstallMask()</code></a>. For more information, see <a href="CComp_Install.html#1020488">"How Install Aide Works"</a> and <a href="CComp_Install.html#1030244">"Accessing Registered Install Conduit Information."</a></p>

<p><a name="1041731"> </a><a href="CComp_Install.html#1041735">Table 9.24</a> describes how to modify and get the state of a user's install conduit flags.</p>

<p class="fineprint">
<p class="caption"><a name="1041735"> </a><b>Table 9.24&nbsp;&nbsp;Modifying the install conduit flags of a HotSync user </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1041742"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1041744"> </a><b>User Data API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1041746"> </a>Determine whether an install conduit specified by its <i>mask</i> value is set to run during the next HotSync operation for the HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1041751"> </a><a href="CRef_UserData.html#997082"><code>UmIsInstallMaskSet()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1041953"> </a>Select or deselect an install conduit specified by its <i>mask</i> value so that it set to run or not to run during the next HotSync operation for the HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1041955"> </a><a href="CRef_UserData.html#997280"><code>UmSetInstallMask()</code></a><br><a href="CRef_UserData.html#996253"><code>UmClearInstallMask()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1037738"> </a>Accessing Developer-defined Entries in the User Data Store <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1042074"> </a>In the same way that the Conduit Manager API enables you to define your own conduit configuration entries, the User Data API does the same for the user data store. But whereas the conduit configuration entries are stored per conduit for the current Window user, information in the user data store is stored per HotSync user.</p>

<p><a name="1042279"> </a>The user data store is divided into named sections containing named keys whose values can be set. You can create sections, keys, and set and get the values of keys.</p>

<p><a name="1042075"> </a><a href="CComp_Install.html#1042103">Table 9.25</a> describes the functions you can call to get and set integer and string values in the user data store.</p>

<p class="fineprint">
<p class="caption"><a name="1042103"> </a><b>Table 9.25&nbsp;&nbsp;Accessing developer-defined entries in the user data store </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1042110"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1042112"> </a><b>User Data API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1042114"> </a>Get or set an entry's integer or string value for a HotSync user specified by <i>user ID.</i> The set function creates the section and key if they do not already exist.</p>
    </td>
    <td><p class="tt"><a name="1042123"> </a><a href="CRef_UserData.html#996575"><code>UmGetInteger()</code></a><br><a href="CRef_UserData.html#997330"><code>UmSetInteger()</code></a></p>
<p class="tt"><a name="1042363"> </a><a href="CRef_UserData.html#996707"><code>UmGetString()</code></a><br><a href="CRef_UserData.html#997379"><code>UmSetString()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1042375"> </a>Delete a key or entire section for a HotSync user specified by <i>user ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1042377"> </a><a href="CRef_UserData.html#996303"><code>UmDeleteKey()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1037861"> </a>Using User Data API Utility Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1042581"> </a>The User Data API includes several utility functions summarized in <a href="CComp_Install.html#1042418">Table 9.26</a>.</p>

<p class="fineprint">
<p class="caption"><a name="1042418"> </a><b>Table 9.26&nbsp;&nbsp;Using User Data API utility functions </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1042425"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1042427"> </a><b>User Data API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1042531"> </a>Get the version number of the User Data API. See the "Compatibility" section of each function to see in which versions of the User Data API the function is available.</p>
    </td>
    <td><p class="tt"><a name="1042441"> </a><a href="CRef_UserData.html#996625"><code>UmGetLibVersion()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1042541"> </a>Get a HotSync user ID by specifying a HotSync user's <i>name</i> or <i>directory.</i> </p>
    </td>
    <td><p class="tt"><a name="1042451"> </a><a href="CRef_UserData.html#996491"><code>UmGetIDFromName()</code></a><br><a href="CRef_UserData.html#996533"><code>UmGetIDFromPath()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1034355"> </a>Summary of User Data API Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="1036784"> </a><b>User Data API Functions </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1036788"> </a><b>Adding and Deleting HotSync Users</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1036795"> </a><a href="CRef_UserData.html#996206"><code>UmAddUser()</code></a></p>
    </td>
    <td><p class="tt"><a name="1036800"> </a><a href="CRef_UserData.html#996347"><code>UmDeleteUser()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1038872"> </a><b>Finding and Setting a HotSync User's Directory</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1038862"> </a><a href="CRef_UserData.html#996786"><code>UmGetUserDirectory()</code></a><br><a href="CRef_UserData.html#997428"><code>UmSetUserDirectory()</code></a></p>
    </td>
    <td><p class="tt"><a name="1038870"> </a><a href="CRef_UserData.html#996655"><code>UmGetRootDirectory()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1036802"> </a><b>Accessing HotSync User Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1038150"> </a><a href="CRef_UserData.html#996760"><code>UmGetUserCount()</code></a><br><a href="CRef_UserData.html#996841"><code>UmGetUserID()</code></a><br><a href="CRef_UserData.html#996880"><code>UmGetUserName()</code></a><br><a href="CRef_UserData.html#997518"><code>UmSetUserName()</code></a><br><a href="CRef_UserData.html#996925"><code>UmGetUserPassword()</code></a></p>
    </td>
    <td><p class="tt"><a name="1038084"> </a><a href="CRef_UserData.html#997133"><code>UmIsUserInstalled()</code></a><br><a href="CRef_UserData.html#997473"><code>UmSetUserInstall()</code></a><br><a href="CRef_UserData.html#997176"><code>UmIsUserProfile()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1036991"> </a><b>Accessing HotSync User Synchronization Preferences</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1036839"> </a><a href="CRef_UserData.html#996971"><code>UmGetUserPermSyncPreferences()</code></a><br><a href="CRef_UserData.html#997563"><code>UmSetUserPermSyncPreferences()</code></a><br><a href="CRef_UserData.html#997025"><code>UmGetUserTempSyncPreferences()</code></a><br><a href="CRef_UserData.html#997615"><code>UmSetUserTempSyncPreferences()</code></a></p>
    </td>
    <td><p class="tt"><a name="1036856"> </a><a href="CRef_UserData.html#996388"><code>UmDeleteUserPermSyncPreferences()</code></a><br><br><a href="CRef_UserData.html#996436"><code>UmDeleteUserTempSyncPreferences()</code></a><br><a href="CRef_UserData.html#997225"><code>UmRemoveUserTempSyncPreferences()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1037056"> </a><b>Retrieving HotSync User's Expansion Slot Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1037037"> </a><a href="CRef_UserData.html#997670"><code>UmSlotGetDisplayName()</code></a><br><a href="CRef_UserData.html#997721"><code>UmSlotGetExpMgrVersion()</code></a><br><a href="CRef_UserData.html#997753"><code>UmSlotGetInfo()</code></a></p>
    </td>
    <td><p class="tt"><a name="1037048"> </a><a href="CRef_UserData.html#997813"><code>UmSlotGetInstallDirectory()</code></a><br><a href="CRef_UserData.html#997873"><code>UmSlotGetMediaType()</code></a><br><a href="CRef_UserData.html#997924"><code>UmSlotGetSlotCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1037136"> </a><b>Modifying Install Conduit Flags</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1037123"> </a><a href="CRef_UserData.html#996253"><code>UmClearInstallMask()</code></a><br><a href="CRef_UserData.html#997280"><code>UmSetInstallMask()</code></a></p>
    </td>
    <td><p class="tt"><a name="1037134"> </a><a href="CRef_UserData.html#997082"><code>UmIsInstallMaskSet()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1036866"> </a><b>Accessing Developer-defined Entries in the User Data Store</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1036873"> </a><a href="CRef_UserData.html#996575"><code>UmGetInteger()</code></a><br><a href="CRef_UserData.html#997330"><code>UmSetInteger()</code></a></p>
    </td>
    <td><p class="tt"><a name="1037358"> </a><a href="CRef_UserData.html#996707"><code>UmGetString()</code></a><br><a href="CRef_UserData.html#997379"><code>UmSetString()</code></a><br><a href="CRef_UserData.html#996303"><code>UmDeleteKey()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1036939"> </a><b>Utility Functions</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1036946"> </a><a href="CRef_UserData.html#996491"><code>UmGetIDFromName()</code></a><br><a href="CRef_UserData.html#996533"><code>UmGetIDFromPath()</code></a></p>
    </td>
    <td><p class="tt"><a name="1036954"> </a><a href="CRef_UserData.html#996625"><code>UmGetLibVersion()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h2 class="haH2">
  <a name="1060140"> </a>Using the HotSync Manager API <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1060141"> </a>The HotSync Manager API enables your desktop application or installer to control the HotSync Manager application as summarized in <a href="CComp_Install.html#1060155">Table 9.27</a>.</p>

<p><a name="1060145"> </a>Before calling any other HotSync Manager API functions, call the <a href="CRef_HSAPI.html#996189"><code>HsCheckApiStatus()</code></a> function to determine whether you can communicate with HotSync Manager.</p>

<p class="fineprint">
<p class="caption"><a name="1060155"> </a><b>Table 9.27&nbsp;&nbsp;Using the HotSync Manager API </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1060159"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1060161"> </a><b>HotSync Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060163"> </a>Determine whether the HotSync Manager API can communicate with the HotSync Manager application.</p>
    </td>
    <td><p class="tt"><a name="1060168"> </a><a href="CRef_HSAPI.html#996189"><code>HsCheckApiStatus()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060170"> </a>Determine whether a HotSync operation is in progress.</p>
    </td>
    <td><p class="tt"><a name="1060175"> </a><a href="CRef_HSAPI.html#996426"><code>HsGetSyncStatus()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060177"> </a>Start, restart, or exit the HotSync Manager executable.<a href="#1060181"><sup>1</sup></a></p>
    </td>
    <td><p class="tt"><a name="1060186"> </a><a href="CRef_HSAPI.html#996519"><code>HsSetAppStatus()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060188"> </a>Refresh HotSync Manager. This function requests HotSync Manager to reload its list of registered conduits.<a href="CComp_Install.html#1060181"><sup>1</sup></a></p>
    </td>
    <td><p class="tt"><a name="1060196"> </a><a href="CRef_HSAPI.html#996457"><code>HsRefreshConduitInfo()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060198"> </a>Display a HotSync Manager dialog box to customize conduits or change connection settings; or to display the HotSync Log.</p>
    </td>
    <td><p class="tt"><a name="1060203"> </a><a href="CRef_HSAPI.html#996213"><code>HsDisplayCustomDlg()</code></a><br><a href="CRef_HSAPI.html#996285"><code>HsDisplayLog()</code></a><br><a href="CRef_HSAPI.html#996320"><code>HsDisplaySetupDlg()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060214"> </a>Get or set the state (enabled or disabled) of a HotSync Manager connection type (serial, USB, network, and so on).</p>
    </td>
    <td><p class="tt"><a name="1060219"> </a><a href="CRef_HSAPI.html#996386"><code>HsGetCommStatus()</code></a><br><a href="CRef_HSAPI.html#996570"><code>HsSetCommStatus()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060224"> </a>Re-initialize all enabled HotSync Manager communications transports.</p>
    </td>
    <td><p class="tt"><a name="1060229"> </a><a href="CRef_HSAPI.html#996485"><code>HsResetComm()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060231"> </a>Get the version number of the HotSync Manager API. See the "Compatibility" section of each function to see in which versions of the HotSync Manager API the function is available. Note that this is <i>not</i> the version number of the HotSync Manager application.</p>
    </td>
    <td><p class="tt"><a name="1060236"> </a><a href="CRef_HSAPI.html#996354"><code>HsGetApiVersion()</code></a></p>
    </td>
  </tr>
</table>
<div class="tablediv"><table cellspacing="0" class="tTableNR">
   <tr>
     <td><div class="FNTFootnoteTable">
<a name="1060181"> </a><a href="#1060177">1</a>. 
HotSync Manager versions <i>earlier than 6.0</i> must be refreshed or restarted after registering a conduit. HotSync Manager, versions <i>6.0 and later,</i> automatically refreshes its list so that this call is unnecessary.</div>
</td>
   </tr>
</table></div>

</div>

</p>

<p><a name="1060240"> </a>For details on the HotSync Manager API functions, see <a href="CRef_HSAPI.html#995932">Chapter 14, "HotSync Manager API,"</a> in the <i>C/C++ Sync Suite Reference</i>. </p>
<h3 class="hbH3">
  <a name="1060246"> </a>Summary of HotSync Manager API Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="1060252"> </a><b>HotSync Manager API Functions </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1060256"> </a><b>Checking, Starting, Stopping and Refreshing HotSync Manager</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060263"> </a><a href="CRef_HSAPI.html#996519"><code>HsSetAppStatus()</code></a><br><a href="CRef_HSAPI.html#996426"><code>HsGetSyncStatus()</code></a></p>
    </td>
    <td><p class="tt"><a name="1060271"> </a><a href="CRef_HSAPI.html#996189"><code>HsCheckApiStatus()</code></a><br><a href="CRef_HSAPI.html#996457"><code>HsRefreshConduitInfo()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1060276"> </a><b>Displaying HotSync Manager Dialog Boxes</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060283"> </a><a href="CRef_HSAPI.html#996213"><code>HsDisplayCustomDlg()</code></a><br><a href="CRef_HSAPI.html#996285"><code>HsDisplayLog()</code></a></p>
    </td>
    <td><p class="tt"><a name="1060291"> </a><a href="CRef_HSAPI.html#996320"><code>HsDisplaySetupDlg()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1060296"> </a><b>Getting and Setting Communications State</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060303"> </a><a href="CRef_HSAPI.html#996386"><code>HsGetCommStatus()</code></a><br><a href="CRef_HSAPI.html#996485"><code>HsResetComm()</code></a></p>
    </td>
    <td><p class="tt"><a name="1060311"> </a><a href="CRef_HSAPI.html#996570"><code>HsSetCommStatus()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1060313"> </a><b>Utility Functions</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1060320"> </a><a href="CRef_HSAPI.html#996354"><code>HsGetApiVersion()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h2 class="haH2">
  <a name="1060410"> </a>Using the Notifier Install Manager API <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1060414"> </a>The Notifier Install Manager registers or unregisters <a href="Intro_Glossary.html#914927"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">notifier</span></a>s with HotSync Manager. Its API separates the underlying storage of notifier registration information from the processes of registering and unregistering notifiers. This abstraction makes it possible for the underlying storage details to change without impact on how you install or uninstall your notifier.</p>

<p><a name="1060415"> </a>The Notifier Install Manager uses only the filename of your notifier to register it with HotSync Manager. Alternatively, you can specify a fully qualified path, but note that these functions access a notifier only by the exact string you supply when you register it. Therefore if you specify a full path when you register a notifier, you must specify the same full path when you unregister it.</p>

<p><a name="1060416"> </a>This section describes the most common tasks an installer performs using the Notifier Install Manager:</p>
   <blockquote class = "bq"><a name="1060420"> </a><a href="CComp_Install.html#1060438">Registering and Unregistering a Notifier</a></blockquote>
   <blockquote class = "bq"><a name="1060424"> </a><a href="CComp_Install.html#1060480">Accessing Registered Notifier Information</a></blockquote>
   <blockquote class = "bq"><a name="1060428"> </a><a href="CComp_Install.html#1060544">Summary of Notifier Install Manager Functions</a></blockquote>

<p><a name="1060432"> </a>See <a href="CRef_NtfyInstMgr.html#995934">Chapter 13, "Notifier Install Manager API,"</a> in the <i>C/C++ Sync Suite Reference</i> for details on these functions. </p>
<h3 class="hbH3">
  <a name="1060438"> </a>Registering and Unregistering a Notifier <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1060439"> </a>HotSync Manager runs all registered notifiers with unique paths and filenames only at the beginning and end of the HotSync process. <a href="CComp_Install.html#1060449">Table 9.28</a> summarizes the functions for registering and unregistering notifiers for the current Windows user and for the system.</p>

<p class="fineprint">
<p class="caption"><a name="1060449"> </a><b>Table 9.28&nbsp;&nbsp;Registering and unregistering a notifier </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1060453"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1060455"> </a><b>Notifier Install Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060457"> </a>Register a notifier by <i>filename</i>.</p>
    </td>
    <td><p class="tt"><a name="1060459"> </a>User:<br><a href="CRef_NtfyInstMgr.html#996210"><code>NmRegister()</code></a></p>
<p class="tt"><a name="1060463"> </a>System:<br><a href="CRef_NtfyInstMgr.html#996247"><code>NmRegisterSystem()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060468"> </a>Unregister a notifier by <i>filename</i>.</p>
    </td>
    <td><p class="tt"><a name="1060470"> </a>User:<br><a href="CRef_NtfyInstMgr.html#996374"><code>NmUnregister()</code></a></p>
<p class="tt"><a name="1060474"> </a>System:<br><a href="CRef_NtfyInstMgr.html#996411"><code>NmUnregisterSystem()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1060480"> </a>Accessing Registered Notifier Information <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1060481"> </a>The Notifier Install Manager API provides separate functions for retrieving information about notifiers registered for the current Windows user and for the system. <a href="CComp_Install.html#1060491">Table 9.29</a> summarizes these functions.</p>

<p class="fineprint">
<p class="caption"><a name="1060491"> </a><b>Table 9.29&nbsp;&nbsp;Accessing registered notifier <br>information </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1060495"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1060497"> </a><b>Notifier Install Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060499"> </a>Get a count of all registered notifiers. Use as upper limit of index in other by-index calls.</p>
    </td>
    <td><p class="tt"><a name="1060501"> </a>User:<br><a href="CRef_NtfyInstMgr.html#996094"><code>NmGetCount()</code></a></p>
<p class="tt"><a name="1060505"> </a>System:<br><a href="CRef_NtfyInstMgr.html#996177"><code>NmGetSystemCount()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060510"> </a>Get a notifier's filename by <i>index.</i> </p>
    </td>
    <td><p class="tt"><a name="1060512"> </a>User:<br><a href="CRef_NtfyInstMgr.html#996044"><code>NmGetByIndex()</code></a> </p>
<p class="tt"><a name="1060516"> </a>System:<br><a href="CRef_NtfyInstMgr.html#996127"><code>NmGetSystemByIndex()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060521"> </a>Change the filename of a registered notifier by <i>index.</i> </p>
    </td>
    <td><p class="tt"><a name="1060523"> </a>User:<br><a href="CRef_NtfyInstMgr.html#996284"><code>NmRenameByIndex()</code></a></p>
<p class="tt"><a name="1060527"> </a>System:<br><a href="CRef_NtfyInstMgr.html#996329"><code>NmRenameSystemByIndex()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060532"> </a>Get the index of a registered notifier by <i>filename.</i> </p>
    </td>
    <td><p class="tt"><a name="1060534"> </a>User:<br><a href="CRef_NtfyInstMgr.html#995970"><code>NmFind()</code></a></p>
<p class="tt"><a name="1060538"> </a>System:<br><a href="CRef_NtfyInstMgr.html#996007"><code>NmFindSystem()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
<h3 class="hbH3">
  <a name="1060544"> </a>Summary of Notifier Install Manager Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="1060550"> </a><b>Notifier Install Manager Functions </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1060554"> </a><b>Registering/Unregistering Notifiers</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060561"> </a><a href="CRef_NtfyInstMgr.html#996210"><code>NmRegister()</code></a><br><a href="CRef_NtfyInstMgr.html#996374"><code>NmUnregister()</code></a></p>
    </td>
    <td><p class="tt"><a name="1060569"> </a><a href="CRef_NtfyInstMgr.html#996247"><code>NmRegisterSystem()</code></a><br><a href="CRef_NtfyInstMgr.html#996411"><code>NmUnregisterSystem()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1060574"> </a><b>Accessing Registered Notifier Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1060581"> </a><a href="CRef_NtfyInstMgr.html#995970"><code>NmFind()</code></a><br><a href="CRef_NtfyInstMgr.html#996094"><code>NmGetCount()</code></a><br><a href="CRef_NtfyInstMgr.html#996044"><code>NmGetByIndex()</code></a><br><a href="CRef_NtfyInstMgr.html#996284"><code>NmRenameByIndex()</code></a></p>
    </td>
    <td><p class="tt"><a name="1060595"> </a><a href="CRef_NtfyInstMgr.html#996007"><code>NmFindSystem()</code></a><br><a href="CRef_NtfyInstMgr.html#996177"><code>NmGetSystemCount()</code></a><br><a href="CRef_NtfyInstMgr.html#996127"><code>NmGetSystemByIndex()</code></a><br><a href="CRef_NtfyInstMgr.html#996329"><code>NmRenameSystemByIndex()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h2 class="haH2">
  <a name="996405"> </a>Using the Install Conduit Manager API <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1015736"> </a>The Install Conduit Manager provides most of the same functionality for registering and unregistering install conduits as the Conduit Manager provides for registering standard synchronization conduits. An <a href="Intro_Glossary.html#914890"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">install conduit</span></a> is a special type of C API-based conduit that installs Palm OS databases and applications on a handheld (or copies files from the desktop to handheld expansion cards). For more information on how the Install Aide uses install conduits, see <a href="CComp_Install.html#1020488">"How Install Aide Works."</a> </p>
<div class="NINoteImportant"><hr>
  <a name="1015784"> </a> <b>NOTE: </b> Most conduits are synchronization conduits, not install conduits, and must be registered with the Conduit Manager instead (see <a href="CComp_Install.html#996045">"Using the Conduit Manager API"</a>). 
<hr>
</div>

<p><a name="1015791"> </a>This section describes the most common tasks an installer performs using the Install Conduit Manager:</p>
   <blockquote class = "bq"><a name="1015719"> </a><a href="CComp_Install.html#1016222">Registering an Install Conduit</a></blockquote>
   <blockquote class = "bq"><a name="1020060"> </a><a href="CComp_Install.html#1015805">Unregistering an Install Conduit</a></blockquote>
   <blockquote class = "bq"><a name="1020099"> </a><a href="CComp_Install.html#1015810">Accessing Information about All Registered Install Conduits</a></blockquote>
   <blockquote class = "bq"><a name="1020124"> </a><a href="CComp_Install.html#1015798">Accessing Developer-defined Install Conduit Configuration Entries</a></blockquote>
   <blockquote class = "bq"><a name="1020131"> </a><a href="CComp_Install.html#1015837">Summary of Install Conduit Manager Functions</a></blockquote>
<h3 class="hbH3">
  <a name="1016222"> </a>Registering an Install Conduit <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1016296"> </a>This section describes how to use the Install Conduit Manager API to register an install conduit. For background information and an explanation of terminology used in this section, see <a href="Intro_Registering.html#995934">Chapter 6, "Registering Conduits and Notifiers with HotSync Manager,"</a> in <i>Introduction to Conduit Development</i>.</p>

<p><a name="1016396"> </a>The Install Conduit Manager API separates the underlying storage of install conduit registration information from the processes of registering and unregistering install conduits. This abstraction makes it possible for the underlying storage details to change without affecting how you register and unregister an install conduit.</p>
<div class="NINoteImportant"><hr>
  <a name="1016397"> </a> <b>NOTE: </b> Do not directly manipulate the Windows registry to register an install conduit. If you do not use the Install Conduit Manager for install conduit registration, your installer may fail to work with future versions of HotSync Manager.
<hr>
</div>

<p><a name="1016579"> </a>When you register an install conduit with HotSync Manager, you must specify a unique bit mask value (<a href="Intro_CfgEntries.html#994391"><code>Mask</code></a>), a unique ID (<a href="Intro_CfgEntries.html#994312"><code>CreatorID</code></a>), and one or more filename extensions (<a href="Intro_CfgEntries.html#994367"><code>Extensions</code></a>) associated with your install conduit. HotSync Manager uses only the mask value to identify your install conduit, but the Install Conduit Manager requires the unique ID to access and store values its configuration entries. This ID is not necessarily related to the creator ID you register with PalmSource, Inc. However, one way to ensure your value is unique is to use a creator ID that you registered with PalmSource, Inc. You use the Install Conduit Manager API to add these and other values associated with your install conduit in the install conduit configuration entries. </p>
<div class="NINoteImportant"><hr>
  <a name="1066829"> </a> <b>NOTE: </b> The Install Conduit Manager checks only your install conduit's <a href="Intro_CfgEntries.html#994312"><code>CreatorID</code></a> against those of install conduits that are already registered. Because your <a href="Intro_CfgEntries.html#994391"><code>Mask</code></a> value must also be unique, you must first check it against those of install conduits that are already registered. The Install Conduit Manager returns an error when your <code>CreatorID</code> value is the same, but not when your <code>Mask</code> value is the same. Therefore your installer must ensure the uniqueness of the <code>Mask</code> value.
<hr>
</div>

<p><a name="1016858"> </a>See <a href="Intro_CfgEntries.html#994278">"Install Conduit Configuration Entries"</a> in the <i>C/C++ Sync Suite Reference</i> for descriptions of the predefined install conduit configuration entries.</p>

<p><a name="1016686"> </a>You can use the Install Conduit Manager in two different ways to register your install conduit, as described in the following subsections:</p>
   <blockquote class = "bq"><a name="1016691"> </a><a href="CComp_Install.html#1016223">Writing a Single Structure</a></blockquote>
   <blockquote class = "bq"><a name="1016704"> </a><a href="CComp_Install.html#1016505">Writing Individual Configuration Entries</a></blockquote>

<h4 class="hcH4">
  <a name="1016223"> </a>Writing a Single Structure
</h4>

<p><a name="1016835"> </a>To register an install conduit from a single structure, allocate a <a href="CRef_InstCnMgr.html#996167"><code>FileInstallType</code></a> structure and the strings associated with that structure, set the structure field values appropriately, and pass this structure to <a href="CRef_InstCnMgr.html#996961"><code>ImRegister()</code></a>. This function attempts to store your install conduit's configuration entries for the unique ID you specified in the structure. If another install conduit is already registered with the same unique ID or filename extensions, this function returns an error and does not register your install conduit. </p>

<p><a name="1016908"> </a>The only fields in <a href="CRef_InstCnMgr.html#996167"><code>FileInstallType</code></a> that you <i>must</i> set to register an install conduit are:</p>
<ul type="disc">
  <li><a name="1016947"> </a><code>dwCreatorID</code>&#8212the install conduit's unique ID
  <li><a name="1016948"> </a><code>szExt</code>&#8212the filename extensions of files that an install conduit can install
  <li><a name="1016949"> </a><code>szModule</code>&#8212the install conduit DLL's path and filename (or only the filename)
  <li><a name="1017456"> </a><code>dwMask</code>&#8212the install conduit's unique bit mask
</ul>

<p><a name="1016970"> </a>The other fields are optional. See <a href="CRef_InstCnMgr.html#996167">"FileInstallType"</a> in the <i>C/C++ Sync Suite Reference</i> for details.</p>

<p><a name="1016980"> </a><a href="CComp_Install.html#1017057">Listing 9.5</a> is an example of using <code>ImRegister()</code> to register a conduit for the current Windows user. Simply replace this function call with <a href="CRef_InstCnMgr.html#997064"><code>ImRegisterSystem()</code></a> to register an install conduit for the system.</p>
<p class="CCodeCaption">
  <a name="1017057"> </a><b>Listing 9.5&nbsp;&nbsp;Example of registering an install conduit with a single structure</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
void RegisterInstallConduitByStruct () {<a name="1017098"> </a>
   FileInstallType pInstConduit;<a name="1017099"> </a>
   DWORD id;<a name="1017100"> </a>
   int retval = 0;<a name="1017061"> </a>
<a name="1017062"> </a>
   memset(&amp;pInstConduit, '\0', sizeof(pInstConduit));<a name="1017063"> </a>
<a name="1017064"> </a>
   strcpy(pInstConduit.szModule,"MyInstConduit.dll");<a name="1017065"> </a>
   strcpy(pInstConduit.szDir, "MyInstallDir");<a name="1017066"> </a>
   strcpy(pInstConduit.szName,"My Install Conduit Display <a name="1017069"> </a>
      Name");<a name="1017132"> </a>
   strcpy(pInstConduit.szExt,"*.ext");<a name="1017070"> </a>
<a name="1017071"> </a>
   CmConvertStringToCreatorID("MyID", &amp;id);<a name="1017072"> </a>
   pInstConduit.dwCreatorID = id;<a name="1017073"> </a>
// Check the mask value of all registered install conduits <a name="1017166"> </a>
// and use a value that is not already in use.<a name="1017167"> </a>
   pInstConduit.dwMask = 0x00000001;<a name="1017074"> </a>
<a name="1017075"> </a>
   retval = <i>ImRegister</i>(pInstConduit);<a name="1017076"> </a>
// If retval is not 0, then registration fails. Check for <a name="1017077"> </a>
// negative error codes.<a name="1017164"> </a>
}<a name="1017080"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1017174"> </a><a href="CComp_Install.html#1017178">Table 9.30</a> summarizes the functions for registering a conduit with a structure for both the current Windows user and the system.</p>

<p class="fineprint">
<p class="caption"><a name="1017178"> </a><b>Table 9.30&nbsp;&nbsp;Writing a single structure to register an install conduit </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1017185"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1017187"> </a><b>Install Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1017189"> </a>Register an install conduit. Pass in a single <a href="CRef_InstCnMgr.html#996167"><code>FileInstallType</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1017194"> </a>User:<br><a href="CRef_InstCnMgr.html#996961"><code>ImRegister()</code></a></p>
<p class="tt"><a name="1017198"> </a>System:<br><a href="CRef_InstCnMgr.html#997064"><code>ImRegisterSystem()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h4 class="hcH4">
  <a name="1016505"> </a>Writing Individual Configuration Entries
</h4>

<p><a name="1017391"> </a>To register an install conduit by writing several configuration entries with a series of function calls, call <a href="CRef_InstCnMgr.html#997017"><code>ImRegisterID()</code></a> first with the unique ID of your install conduit. If the <code>ImRegisterID()</code> function succeeds, then call the following series of functions, in no particular order, to set other install conduit configuration values:</p>
<ul type="disc">
  <li><a name="1017423"> </a><a href="CRef_InstCnMgr.html#997265"><code>ImSetExtension()</code></a>&#8212required
  <li><a name="1017427"> </a><a href="CRef_InstCnMgr.html#997366"><code>ImSetModule()</code></a>&#8212required
  <li><a name="1017493"> </a><a href="CRef_InstCnMgr.html#997312"><code>ImSetMask()</code></a>&#8212required
  <li><a name="1017523"> </a><a href="CRef_InstCnMgr.html#997169"><code>ImSetDirectory()</code></a>&#8212optional
  <li><a name="1017530"> </a><a href="CRef_InstCnMgr.html#997414"><code>ImSetName()</code></a>&#8212optional
</ul>

<p><a name="1017538"> </a>You can also create your own configuration entries and set them along with these at install time, as described in <a href="CComp_Install.html#1015798">"Accessing Developer-defined Install Conduit Configuration Entries."</a></p>

<p><a name="1017549"> </a><a href="CComp_Install.html#1017560">Listing 9.6</a> shows a simple install conduit registration that calls <code>ImRegisterID()</code> and several <code>ImSet...()</code> functions.</p>
<p class="CCodeCaption">
  <a name="1017560"> </a><b>Listing 9.6&nbsp;&nbsp;Registering an install conduit with a series of Install Conduit Manager functions</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
int RegisterInstallConduitWithMultipleCalls () {<a name="1017561"> </a>
   DWORD id;<a name="1017618"> </a>
   CmConvertStringToCreatorID("MyID", &amp;id);<a name="1017622"> </a>
<a name="1017616"> </a>
   err = <i>ImRegisterID</i>(id);<a name="1017562"> </a>
   if (err == 0)<a name="1017563"> </a>
      err = <i>ImSetExtension</i>()(id, "*.ext");<a name="1017564"> </a>
   if (err == 0)<a name="1017566"> </a>
      err = <i>ImSetModule</i>()(id, <a name="1017567"> </a>
         "C:\\MyCond\\Debug\\MyInstCond.DLL");<a name="1017657"> </a>
   if (err == 0)<a name="1017568"> </a>
      // Check the mask value of all registered install <a name="1017671"> </a>
      // conduits and use a value that is not already in use.<a name="1017688"> </a>
      err = <i>ImSetMask</i>()(id, 0x00000001);<a name="1017569"> </a>
   if (err == 0)<a name="1017570"> </a>
      err = <i>ImSetDirectory</i>()(id, "MyInstallDir");<a name="1017571"> </a>
   if (err == 0)<a name="1017699"> </a>
      err = <i>ImSetName</i>()(id, "My Install Conduit Display <a name="1017703"> </a>
         Name");<a name="1017715"> </a>
   if (err == 0)<a name="1017572"> </a>
      printf(" Registration succeeded\n");<a name="1017573"> </a>
   else<a name="1017574"> </a>
      printf(" Registration failed %d\n", err);<a name="1017575"> </a>
   return err;<a name="1017576"> </a>
}<a name="1017577"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="1017742"> </a><a href="CComp_Install.html#1017746">Table 9.31</a> summarizes the functions for registering an install conduit for both the current Windows user and the system by writing individual configuration entries.</p>

<p class="fineprint">
<p class="caption"><a name="1017746"> </a><b>Table 9.31&nbsp;&nbsp;Writing individual configuration entries to register an install conduit </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1017753"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1017755"> </a><b>Install Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1017757"> </a>Register an install conduit. Call <code>ImRegisterID()</code> or <code>ImRegisterSystemID()</code> first. Then call the rest, passing in the same unique ID.</p>
    </td>
    <td><p class="tt"><a name="1017759"> </a>User:<br><a href="CRef_InstCnMgr.html#997017"><code>ImRegisterID()</code></a><br><a href="CRef_InstCnMgr.html#997265"><code>ImSetExtension()</code></a><br><a href="CRef_InstCnMgr.html#997366"><code>ImSetModule()</code></a><br><a href="CRef_InstCnMgr.html#997312"><code>ImSetMask()</code></a><br><a href="CRef_InstCnMgr.html#997169"><code>ImSetDirectory()</code></a><br><a href="CRef_InstCnMgr.html#997414"><code>ImSetName()</code></a></p>
<p class="tt"><a name="1017784"> </a>System:<br><a href="CRef_InstCnMgr.html#997120"><code>ImRegisterSystemID()</code></a><br><a href="CRef_InstCnMgr.html#997602"><code>ImSetSystemExtension()</code></a><br><a href="CRef_InstCnMgr.html#997706"><code>ImSetSystemModule()</code></a><br><a href="CRef_InstCnMgr.html#997652"><code>ImSetSystemMask()</code></a><br><a href="CRef_InstCnMgr.html#997506"><code>ImSetSystemDirectory()</code></a><br><a href="CRef_InstCnMgr.html#997754"><code>ImSetSystemName()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="1017367"> </a>For details on these functions, see <a href="CRef_InstCnMgr.html#995934">Chapter 12, "Install Conduit Manager API,"</a> in the <i>C/C++ Sync Suite Reference</i>. </p>
<h3 class="hbH3">
  <a name="1015805"> </a>Unregistering an Install Conduit <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1018198"> </a>When you uninstall your install conduit, you must unregister it so that HotSync Manager does not attempt to call your install conduit DLL, which is no longer present. To unregister an install conduit, call <a href="CRef_InstCnMgr.html#997846"><code>ImUnregisterID()</code></a>, passing in the unique ID of the install conduit to unregister. To do the same for a system-registered conduit, call <a href="CRef_InstCnMgr.html#997885"><code>ImUnregisterSystemID()</code></a>. These functions remove all of the install conduit's configuration entries, but they do not delete the install conduit DLL.</p>

<p><a name="1018256"> </a><a href="CComp_Install.html#1018263">Table 9.32</a> summarizes the functions for unregistering a registered install conduit for both the current Windows user and the system.</p>

<p class="fineprint">
<p class="caption"><a name="1018263"> </a><b>Table 9.32&nbsp;&nbsp;Unregistering a registered install conduit </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1018267"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1018269"> </a><b>Install Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1018271"> </a>Unregister an install conduit by <i>creator ID.</i> </p>
    </td>
    <td><p class="tt"><a name="1018273"> </a>User:<br><a href="CRef_InstCnMgr.html#997846"><code>ImUnregisterID()</code></a></p>
<p class="tt"><a name="1018277"> </a>System:<br><a href="CRef_InstCnMgr.html#997885"><code>ImUnregisterSystemID()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="1018333"> </a>For details on these functions, see <a href="CRef_InstCnMgr.html#995934">Chapter 12, "Install Conduit Manager API,"</a> in the <i>C/C++ Sync Suite Reference</i>. </p>
<h3 class="hbH3">
  <a name="1015810"> </a>Accessing Information about All Registered Install Conduits <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1055329"> </a>The Install Conduit Manager API provides functions for retrieving information about all registered install conduits. These APIs do not access synchronization conduits or backup conduits. <a href="CComp_Install.html#1018427">Table 9.33</a> describes the kinds of information you can get or set with Install Conduit Manager APIs, for both user- and system-registered conduits.</p>

<p><a name="1018369"> </a>Several APIs allow you to set the values of single install conduit configuration entries in the same way you can if you register an install conduit as described in <a href="CComp_Install.html#1016505">"Writing Individual Configuration Entries."</a></p>

<p><a name="1055443"> </a>To iterate through a list of only the install conduits that HotSync Manager can run for current Windows user, use the Install Aide functions described in <a href="CComp_Install.html#1030244">"Accessing Registered Install Conduit Information."</a> </p>

<p class="fineprint">
<p class="caption"><a name="1018427"> </a><b>Table 9.33&nbsp;&nbsp;Accessing registered install conduit <br>information </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1018434"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1018436"> </a><b>Install Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1018513"> </a>Get standard install conduit configuration entries by <i>unique ID</i>. These are the same entries as defined in the <a href="CRef_InstCnMgr.html#996167"><code>FileInstallType</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1018518"> </a>User:<br><a href="CRef_InstCnMgr.html#996337"><code>ImGetExtension()</code></a><br><a href="CRef_InstCnMgr.html#996443"><code>ImGetModule()</code></a><br><a href="CRef_InstCnMgr.html#996389"><code>ImGetMask()</code></a><br><a href="CRef_InstCnMgr.html#996231"><code>ImGetDirectory()</code></a><br><a href="CRef_InstCnMgr.html#996494"><code>ImGetName()</code></a></p>
<p class="tt"><a name="1018540"> </a>System:<br><a href="CRef_InstCnMgr.html#996702"><code>ImGetSystemExtension()</code></a><br><a href="CRef_InstCnMgr.html#996808"><code>ImGetSystemModule()</code></a><br><a href="CRef_InstCnMgr.html#996754"><code>ImGetSystemMask()</code></a><br><a href="CRef_InstCnMgr.html#996596"><code>ImGetSystemDirectory()</code></a><br><a href="CRef_InstCnMgr.html#996859"><code>ImGetSystemName()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1018563"> </a>Set standard install conduit configuration entries by <i>unique ID</i>. These are the same entries as defined in the <a href="CRef_InstCnMgr.html#996167"><code>FileInstallType</code></a> structure.</p>
    </td>
    <td><p class="tt"><a name="1018568"> </a>User:<br><a href="CRef_InstCnMgr.html#997265"><code>ImSetExtension()</code></a><br><a href="CRef_InstCnMgr.html#997366"><code>ImSetModule()</code></a><br><a href="CRef_InstCnMgr.html#997312"><code>ImSetMask()</code></a><br><a href="CRef_InstCnMgr.html#997169"><code>ImSetDirectory()</code></a><br><a href="CRef_InstCnMgr.html#997414"><code>ImSetName()</code></a></p>
<p class="tt"><a name="1018590"> </a>System:<br><a href="CRef_InstCnMgr.html#997602"><code>ImSetSystemExtension()</code></a><br><a href="CRef_InstCnMgr.html#997706"><code>ImSetSystemModule()</code></a><br><a href="CRef_InstCnMgr.html#997652"><code>ImSetSystemMask()</code></a><br><a href="CRef_InstCnMgr.html#997506"><code>ImSetSystemDirectory()</code></a><br><a href="CRef_InstCnMgr.html#997754"><code>ImSetSystemName()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="1019282"> </a>For details on these functions, see <a href="CRef_InstCnMgr.html#996228">"Install Conduit Manager Functions"</a> in the <i>C/C++ Sync Suite Reference</i>. </p>
<h3 class="hbH3">
  <a name="1015798"> </a>Accessing Developer-defined Install Conduit Configuration Entries <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="1019385"> </a>The install conduit <a href="Intro_Glossary.html#914811"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">configuration entries</span></a> are extensible. You can define your own entries by unique ID to store information per user-registered and per system-registered install conduit. <a href="CComp_Install.html#1019398">Table 9.34</a> describes the kinds of information you can get or set with the Install Conduit Manager APIs. Your installer, install conduit, or desktop application can store information in install conduit configuration entries that are specific to your install conduit.</p>

<p><a name="1019389"> </a>When you unregister an install conduit, the Install Conduit Manager removes all of an install conduit's configuration entries, including those that you define. Otherwise, the Install Conduit Manager does not access your entries in any way. For this reason, you can call these functions at any time without having to refresh or restart HotSync Manager.</p>

<p class="fineprint">
<p class="caption"><a name="1019398"> </a><b>Table 9.34&nbsp;&nbsp;Accessing developer-defined install conduit configuration entries </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="1019405"> </a><b>Task</b></p>
    </th>
    <th><p class="tt"><a name="1019407"> </a><b>Install Conduit Manager API Functions</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1019409"> </a>Get or set an entry's <code>DWORD</code> value for an install conduit by <i>unique ID.</i> The set function creates the entry if it does not already exist.</p>
    </td>
    <td><p class="tt"><a name="1019411"> </a>User:<br><a href="CRef_InstCnMgr.html#996287"><code>ImGetDWord()</code></a><br><a href="CRef_InstCnMgr.html#997221"><code>ImSetDWord()</code></a></p>
<p class="tt"><a name="1019418"> </a>System:<br><a href="CRef_InstCnMgr.html#996652"><code>ImGetSystemDWord()</code></a><br><a href="CRef_InstCnMgr.html#997558"><code>ImSetSystemDWord()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1019426"> </a>Get or set an entry's string value for an install conduit by <i>unique ID.</i> The set function creates the entry if it does not already exist.</p>
    </td>
    <td><p class="tt"><a name="1019428"> </a>User:<br><a href="CRef_InstCnMgr.html#996545"><code>ImGetString()</code></a><br><a href="CRef_InstCnMgr.html#997462"><code>ImSetString()</code></a></p>
<p class="tt"><a name="1019435"> </a>System:<br><a href="CRef_InstCnMgr.html#996910"><code>ImGetSystemString()</code></a><br><a href="CRef_InstCnMgr.html#997802"><code>ImSetSystemString()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="1019512"> </a>For details on these functions, see <a href="CRef_InstCnMgr.html#996228">"Install Conduit Manager Functions"</a> in the <i>C/C++ Sync Suite Reference</i>.</p>
<h3 class="hbH3">
  <a name="1015837"> </a>Summary of Install Conduit Manager Functions <a href="#995937"><span class="nav">^TOP^</span></a>
</h3>


<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="1015843"> </a><b>Install Conduit Manager Functions </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1015879"> </a><b>Registering/Unregistering Install Conduits</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1015886"> </a><a href="CRef_InstCnMgr.html#996961"><code>ImRegister()</code></a><br><a href="CRef_InstCnMgr.html#997846"><code>ImUnregisterID()</code></a></p>
    </td>
    <td><p class="tt"><a name="1015903"> </a><a href="CRef_InstCnMgr.html#997064"><code>ImRegisterSystem()</code></a><br><a href="CRef_InstCnMgr.html#997885"><code>ImUnregisterSystemID()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1015990"> </a><b>Accessing Standard Install Conduit Configuration Information</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1015997"> </a><a href="CRef_InstCnMgr.html#996337"><code>ImGetExtension()</code></a><br><a href="CRef_InstCnMgr.html#997265"><code>ImSetExtension()</code></a><br><a href="CRef_InstCnMgr.html#996443"><code>ImGetModule()</code></a><br><a href="CRef_InstCnMgr.html#997366"><code>ImSetModule()</code></a><br><a href="CRef_InstCnMgr.html#996389"><code>ImGetMask()</code></a><br><a href="CRef_InstCnMgr.html#997312"><code>ImSetMask()</code></a><br><a href="CRef_InstCnMgr.html#996231"><code>ImGetDirectory()</code></a><br><a href="CRef_InstCnMgr.html#997169"><code>ImSetDirectory()</code></a><br><a href="CRef_InstCnMgr.html#996494"><code>ImGetName()</code></a><br><a href="CRef_InstCnMgr.html#997414"><code>ImSetName()</code></a></p>
    </td>
    <td><p class="tt"><a name="1016041"> </a><a href="CRef_InstCnMgr.html#996702"><code>ImGetSystemExtension()</code></a><br><a href="CRef_InstCnMgr.html#997602"><code>ImSetSystemExtension()</code></a><br><a href="CRef_InstCnMgr.html#996808"><code>ImGetSystemModule()</code></a><br><a href="CRef_InstCnMgr.html#997706"><code>ImSetSystemModule()</code></a><br><a href="CRef_InstCnMgr.html#996754"><code>ImGetSystemMask()</code></a><br><a href="CRef_InstCnMgr.html#997652"><code>ImSetSystemMask()</code></a><br><a href="CRef_InstCnMgr.html#996596"><code>ImGetSystemDirectory()</code></a><br><a href="CRef_InstCnMgr.html#997506"><code>ImSetSystemDirectory()</code></a><br><a href="CRef_InstCnMgr.html#996859"><code>ImGetSystemName()</code></a><br><a href="CRef_InstCnMgr.html#997754"><code>ImSetSystemName()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="1016082"> </a><b>Accessing Developer-defined Install Conduit Configuration Entries</b></p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="1016089"> </a><a href="CRef_InstCnMgr.html#996287"><code>ImGetDWord()</code></a><br><a href="CRef_InstCnMgr.html#997221"><code>ImSetDWord()</code></a><br><a href="CRef_InstCnMgr.html#996545"><code>ImGetString()</code></a><br><a href="CRef_InstCnMgr.html#997462"><code>ImSetString()</code></a></p>
    </td>
    <td><p class="tt"><a name="1016103"> </a><a href="CRef_InstCnMgr.html#996652"><code>ImGetSystemDWord()</code></a><br><a href="CRef_InstCnMgr.html#997558"><code>ImSetSystemDWord()</code></a><br><a href="CRef_InstCnMgr.html#996910"><code>ImGetSystemString()</code></a><br><a href="CRef_InstCnMgr.html#997802"><code>ImSetSystemString()</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<h2 class="haH2">
  <a name="996514"> </a>Uninstalling Your Conduit <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996515"> </a>Users expect that applications provide them with a facility to easily remove all the relevant files and other information that were put on the their computer during installation. Your uninstall application must:</p>
<ul type="disc">
  <li><a name="996516"> </a>Unregister your conduit. See <a href="CComp_Install.html#1003646">"Unregistering a Conduit."</a>
  <li><a name="996517"> </a>Unregister your notifier DLLs, if you installed them. See <a href="CComp_Install.html#1060438">"Registering and Unregistering a Notifier."</a>
  <li><a name="1044792"> </a>Delete any entries in the user data store, if you created any. See <a href="CComp_Install.html#1037738">"Accessing Developer-defined Entries in the User Data Store."</a>
  <li><a name="996518"> </a>Remove all installed files. 
  <li><a name="996519"> </a>Perform any other cleanup.
</ul>

<p><a name="1044784"> </a>And, if your conduit replaced a conduit that was already installed on the user's machine (like any of the default conduits), you should offer the user the option to reregister it with HotSync Manager, leaving the user's machine exactly as you found it. </p>

<h2 class="haH2">
  <a name="996523"> </a>Testing Your Installer <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996524"> </a>Because one of the most important goals of the HotSync process is simplicity for users, ensure that your conduit installs and uninstalls correctly and easily. PalmSource, Inc. strongly recommends that, at a minimum, you test the following conduit installation and removal conditions:</p>
<ul type="disc">
  <li><a name="996525"> </a>Check for the existence of HotSync Manager on the user's desktop computer. See <a href="CComp_Install.html#1000914">"Finding the HotSync Manager Binaries."</a>
  <li><a name="996526"> </a>After installing your conduit, the user can press the HotSync button and have synchronization operations proceed correctly and without required intervention.
  <li><a name="1077563"> </a>After removing (uninstalling) your conduit, the user can press the HotSync button and have synchronization operations proceed correctly and without required intervention.
  <li><a name="1077564"> </a>After removal of your conduit, the conduit configuration entries are restored to what they were prior to its installation. 
</ul>
<div class="NINoteImportant"><hr>
  <a name="1077568"> </a> <b>NOTE: </b> Whenever you change any of the configuration entries, HotSync Manager versions earlier than 6.0 require that you call either <a href="CRef_HSAPI.html#996519"><code>HsSetAppStatus()</code></a> to restart HotSync Manager to recognize all but conduit configuration changes or <a href="CRef_HSAPI.html#996457"><code>HsRefreshConduitInfo()</code></a> to recognize a conduit configuration change. <br><br>However, HotSync Manager versions 6.0 and later automatically discover changes to conduit configuration information without you calling these functions. To recognize other changes (HotSync Manager communication settings, backup conduit, and so on), you must still call <code>HsSetAppStatus()</code> to restart HotSync Manager.
<hr>
</div>

<p><a name="996530"> </a>In addition to verifying that your conduit installation and removal operations leave the user's desktop computer in fully operational condition, you need to be aware of the following situations on the handheld that can cause your conduit to generate unpleasant side effects for users:</p>
<ul type="disc">
  <li><a name="996531"> </a>If your conduit stores state information on the handheld, you must remember to clean up the state information upon removal of your conduit.
  <li><a name="996532"> </a>If you create data for a creator ID that you do not own, your conduit can generate very unpleasant results. Do not use a creator ID that does not belong to you.
</ul>

<h2 class="haH2">
  <a name="996535"> </a>Installation Troubleshooting Tips  <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996536"> </a>This section suggests a few things to look for when you have installation problems:</p>
<ul type="disc">
  <li><a name="996537"> </a>Check the HotSync log after you run your conduit. The log contains any error messages that may result. Ensure that you are looking at the log entry for the correct user. 
  <li><a name="996538"> </a>For additional (verbose) logging information, exit HotSync Manager, click the <b>Start</b> button, then <b>Run</b>, and type <code>c:\&lt;HotSync Manager dir&gt;\hotsync.exe -v</code>. 
  <li><a name="996539"> </a>Conduits are run by HotSync Manager only when there is a application with a matching creator ID on the handheld, unless your conduit tells HotSync Manager to run it regardless. See <a href="CComp_EntryPoints.html#996131">"GetConduitInfo()."</a>
  <li><a name="996540"> </a>Use <code>CondCfg.exe</code> to view the conduit configuration settings. Double check them and watch for things like whether your conduit DLL is actually where you indicated. 
  <li><a name="996541"> </a>Ensure that the creator ID specified for the conduit (use <code>CondCfg.exe</code> to view the entry) matches the creator ID of an application on the handheld. 
  <li><a name="996542"> </a>Use the verbose log to get a list of the creator IDs on the handheld.
</ul>

<p><a name="996546"> </a>See the <a href="Util_Front.html#1008477">Conduit Development Utilities Guide</a> for details on using the Conduit Configuration utility (<code>CondCfg.exe</code>) and other helpful tools.</p>

<h2 class="haH2">
  <a name="996548"> </a>Sample Installer  <a href="#995937"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996550"> </a>For a sample conduit installer, see the article "<a href=" http://kb.palmsource.com/cgi-bin/palmsource.cfg/php/enduser/std_adp.php?p_sid=2hjQ-T1h&p_lva=&p_faqid=173">Sample Code for a Conduit Installer in C++</a>" in the Palm OS Knowledge Base. This article provides a Microsoft Visual C++ 6.0 project that generates a conduit installer.</p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1999-2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="CComp_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="C++SyncCompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CComp_Notifiers.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CComp_QStart_VC.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="C++SyncCompanionIX.html">Index</a>
</p>
</td>
</tr>
<!-- END FOOTER -->

</body>
</html>