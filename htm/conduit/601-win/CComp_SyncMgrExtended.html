<html>
<head>
<title>Using the Extended Sync Manager API | C/C++ Sync Suite Companion</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="KEYWORDS" CONTENT="C, C++, C/C++ Sync Suite, Sync Manager, extended open, close, read, write, database, CDK, conduit, conduits, Windows">
<META NAME="DESCRIPTION" CONTENT="Provides an overview of the extended Sync Manager and how to use it in C API-based conduits for Windows.">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource HTML 20040609">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks Publisher Professional Edition 6.0.7">
<META NAME="LASTUPDATED" CONTENT="06/28/04 08:29:32">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="995934"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="C++SyncCompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CComp_SyncMgr.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CComp_Expansion.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="C++SyncCompanionIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">5 &nbsp;&nbsp;
Using the Extended Sync Manager API</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">C/C++ Sync Suite Companion</p>
<p class="SubTitle">Palm OS&#174; Conduit Development Kit for  Windows, Version 6.0.1 </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1"><a href="CComp_SyncMgrExtended.html">5  Using the Extended Sync Manager API</a></h1>

   <h2 class="SideTOC2"><a href="#999754">
   Comparing Extended and Classic Sync Manager APIs</a></h2>

</div>
</td>
<!--END SIDETOC-->

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>
<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="999134"> </a>The extended Sync Manager API is a low-level programming interface to HotSync<sup>&#174;</sup> operations with <a href="Intro_Glossary.html#918750"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">extended database</span></a>s. This chapter compares this API with that for classic databases described in <a href="CComp_SyncMgr.html#995934">Chapter 4, "Using the Classic Sync Manager API,"</a>:</p>
   <blockquote class = "bq"><a name="1001066"> </a><a href="CComp_SyncMgrExtended.html#999754">Comparing Extended and Classic Sync Manager APIs</a></blockquote>

<p><a name="999159"> </a>The Sync Manager API libraries are located in the <code>&lt;CDK&gt;\C++\Win\lib</code> directory of the C/C++ Sync Suite. </p>

<p class="fineprint">

</p>

<h2 class="haH2">
  <a name="999754"> </a>Comparing Extended and Classic Sync Manager APIs <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1000631"> </a>The Data Manager in Palm OS Cobalt supports extended record and resource databases. Extended databases differ from or classic databases in several ways. Two of the most important differences are:</p>
<ul type="disc">
  <li><a name="1000632"> </a>Classic database records, resources, and other data are limited to 64 KB. Extended database data can be much larger, with record sizes up to almost 64 MB.
  <li><a name="1001339"> </a>Classic, extended, and schema databases exist in disjoint namespaces. 
  <ul type="disc">
    <li><a name="1001341"> </a>Within the <i>classic</i> database namespace, database names must be unique. 
    <li><a name="1001345"> </a>Within the <i>extended</i> and <i>schema</i> namespaces, database names must be unique <i>only for a given creator ID.</i> 
   <p><a name="1001370"> </a>Because the namespaces are disjoint, it is possible for up to three databases, one per namespace, to have the same name and creator ID.</p>
  </ul>
</ul>

<p><a name="1000772"> </a>For a comparison of all database types, see <a href="Intro_Databases.html#998639">"Schema vs. Non-schema Databases"</a> in <i>Introduction to Conduit Development</i>.</p>

<p><a name="1000773"> </a>Sync Manager version 2.4 (first shipped with HotSync Manager 6.0) provides an API for accessing extended databases. The <i>extended Sync Manager API </i>differs from the classic Sync Manager API in the following ways:</p>
<ul type="disc">
  <li><a name="1000636"> </a>Extended database API names begin with "SyncDm" instead of "Sync".
  <li><a name="1000637"> </a>Extended database APIs do not take a <a href="Intro_Glossary.html#925551"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">memory card</span></a> number parameter. Palm OS Cobalt does not support memory cards. 
  <li><a name="1000638"> </a>Extended database size and offset parameters are 32 bits instead of 16.
  <li><a name="1000639"> </a>Extended database APIs that need to uniquely identify a database take both a <a href="Intro_Glossary.html#914833"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">creator ID</span></a> and a <a href="Intro_Glossary.html#918044"><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: underline; text-transform: none; vertical-align: baseline">database name</span></a>.
  <li><a name="1000640"> </a>Multiple extended (or schema) databases may be open at the same time; it is also possible to iterate through multiple extended or schema databases at the same time.
  <li><a name="1000641"> </a>Record modification, deletion, and creation is supported while iterating through an extended database.
  <li><a name="1000642"> </a>To simplify usage, extended database APIs favor individual parameters over parameter structures like <a href="CRef_SyncClassic.html#1070265"><code>CRawRecordInfo</code></a>. This is a stylistic difference and does not reflect any underlying difference in functionality.
  <li><a name="1000643"> </a>To provide flexibility for larger data sizes, extended database APIs support partial reads and writes via the addition of an offset parameter; this is consistent with the schema database single column read and write APIs.
  <li><a name="1000644"> </a>To minimize round trips to the handheld, extended database read APIs automatically cache handheld data on the desktop.  This is particularly useful when reading potentially large data of unknown size, because reading such data typically requires dynamic buffer allocation. Dynamic allocation requires two calls: one to retrieve the data size and one to retrieve the actual data. By caching data during the first call, the overhead of a second round trip to the handheld is avoided.
</ul>

<p><a name="1000645"> </a>As an example of the difference between the classic and extended Sync Manager APIs, consider the classic <a href="CRef_SyncClassic.html#1071040"><code>SyncWriteRec()</code></a> API:</p>
<pre class="proto"><a name="1000875"></a>class CRawRecordInfo {
   public:
   HSByte m_FileHandle;
   UInt32 m_RecId;
   UInt16 m_RecIndex;
   HSByte m_Attribs;
   SInt16 m_CatId;
   SInt32 m_ConduitId;
   UInt32 m_RecSize;
   UInt16 m_TotalBytes;
   HSByte *m_pBytes;
   UInt32 m_dwReserved;
} 

SInt32 SyncWriteRec (CRawRecordInfo <code class="par">&amp;rInfo</code>);
</pre>

<p><a name="1000661"> </a>The corresponding extended database record write API is <a href="CRef_SyncExtended.html#1001772"><code>SyncDmWriteRecord()</code></a>:</p>
<pre class="proto"><a name="1000668"></a>HSError SyncDmWriteRecord (
   HSByte <code class="par">handle</code>, 
   UInt32 <code class="par">*pRecordID</code>, 
   UInt16 <code class="par">categoryIndex</code>, 
   HSByte <code class="par">attributes</code>, 
   UInt32 <code class="par">dataOffset</code>, 
   UInt32 <code class="par">dataSize</code>, 
   HSBytePtr <code class="par">pRecordData</code>);
</pre>

<p><a name="1000669"> </a>Note that the supported classic <code>CRawRecordInfo</code> members are parameters in the extended API.</p>

<p><a name="1000670"> </a>Similarly the classic <a href="CRef_SyncClassic.html#1070890"><code>SyncReadRecordById()</code></a> API:</p>
<pre class="proto"><a name="1000671"></a>SInt32 SyncReadRecordById (CRawRecordInfo <code class="par">&amp;rInfo</code>);
</pre>

<p><a name="1000672"> </a>becomes the extended <a href="CRef_SyncExtended.html#1000113"><code>SyncDmReadRecordByID()</code></a>:</p>
<pre class="proto"><a name="1000681"></a>HSError SyncDmReadRecordByID (
   HSByte <code class="par">handle</code>, 
   UInt16 <code class="par">*pRecordIndex</code>, 
   UInt32 <code class="par">recordID</code>, 
   UInt16 <code class="par">*pCategoryIndex</code>, 
   HSByte <code class="par">*pAttributes</code>, 
   UInt32 <code class="par">dataOffset</code>, 
   UInt32 <code class="par">*pDataSize</code>, 
   HSBytePtr <code class="par">pRecordData</code>, 
   UInt32 <code class="par">*pDataRemaining</code>);
</pre>

<p><a name="1001016"> </a>A similar transformation yields the extended Sync Manager API for each write and read function.</p>

<h4 class="hcH4">
  <a name="1001017"> </a>Data Size
</h4>

<p><a name="1000684"> </a>After an extended Sync Manager write operation, the final data size&#8212record size, resource size, etc.&#8212is equal to <code class="par">dataOffset</code> + <code class="par">dataSize</code>. This implies that all existing data following the specified offset is lost. After a read, the total data size is <code class="par">dataOffset</code> + <code class="par">*pDataSize</code> + <code class="par">*pDataRemaining</code>. To discover the data size without reading the data, the caller can pass a zero offset and <code>NULL</code> for all output fields except <code class="par">pDataRemaining</code>. As noted above, this causes the actual data to be retrieved and cached on the desktop.</p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 1999-2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="CComp_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="C++SyncCompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CComp_SyncMgr.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="CComp_Expansion.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="C++SyncCompanionIX.html">Index</a>
</p>
</td>
</tr>
<!-- END FOOTER -->

</body>
</html>