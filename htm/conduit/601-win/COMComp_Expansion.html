<html>
<head>
<title>Using Expansion Technology | COM Sync Suite Companion</title> 
<link href="psi_devpubs.css" rel="stylesheet" type="text/css">

<!-- BEGIN META DATA -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="KEYWORDS" CONTENT="COM, COM Sync, COM Sync Suite, expansion, card, slot, architecture, file, volume, directory, CDK, conduit, conduits, Windows">
<META NAME="DESCRIPTION" CONTENT="Describes how to work with handheld expansion cards from the desktop using the Expansion and Virtual File System (VFS) Managers in the COM Sync Suite for Windows.">
<META NAME="PSITEMPLATE" CONTENT="1006-007 PalmSource HTML 20040609">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks Publisher Professional Edition 6.0.7">
<META NAME="LASTUPDATED" CONTENT="06/28/04 08:33:42">
<!-- END META DATA -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="995934"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="images/shim.gif" width="7" height="75" border="0" alt=""></td>
<td align="left"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="25" height="75" border="0" alt=""></td>
<td valign="top"><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="15" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>

</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--BEGIN MASTHEAD-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<tr>
<td>
<!--BEGIN BOOK NAVIGATION-->
<span class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="COMSyncCompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="COMComp_Install.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="COMSyncCompanionIX.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="COMSyncCompanionIX.html">Index</a>
</span>
<!--END BOOK NAVIGATION-->
</tr>
<tr>
<td>
<!--BEGIN PAGE TITLE-->
<h2 class="PageTitle">5 &nbsp;&nbsp;
Using Expansion Technology</h2></td>
<!--END PAGE TITLE-->
</tr>
<tr>
<td>
<!--BEGIN BOOK TITLE-->
<p class="BookTitle">COM Sync Suite Companion</p>
<p class="SubTitle">Palm OS&#174; Conduit Development Kit for  Windows, Version 6.0.1 </p>
<!--END BOOK TITLE-->
</td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--END MASTHEAD-->
</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="5"><img name="index_x" src="images/shim.gif" width="5" height="33" border="0" alt=""></td>

<!--BEGIN SIDETOC-->
<td valign="top" width="175">
<div id="sidetoc" valign="bottom">
<h1 class="SideTOC1"><a href="COMComp_Expansion.html">5  Using Expansion Technology</a></h1>

   <h2 class="SideTOC2"><a href="#1002954">
   Expansion Support</a></h2>

      <h3 class="SideTOC3"><a href="#996003">
      Primary vs. Secondary Storage</a></h3>

      <h3 class="SideTOC3"><a href="#996043">
      Expansion Slot</a></h3>

      <h3 class="SideTOC3"><a href="#996054">
      Universal Connector</a></h3>

   <h2 class="SideTOC2"><a href="#996064">
   Architectural Overview</a></h2>

      <h3 class="SideTOC3"><a href="#996094">
      Slot Drivers</a></h3>

      <h3 class="SideTOC3"><a href="#996116">
      File Systems</a></h3>

      <h3 class="SideTOC3"><a href="#996126">
      VFS Manager</a></h3>

      <h3 class="SideTOC3"><a href="#996182">
      Expansion Manager</a></h3>

   <h2 class="SideTOC2"><a href="#996223">
   Standard Directories</a></h2>

   <h2 class="SideTOC2"><a href="#996272">
   Card Insertion and Removal</a></h2>

   <h2 class="SideTOC2"><a href="#996277">
   Checking for Expansion Cards</a></h2>

      <h3 class="SideTOC3"><a href="#996310">
      Is an Expansion Slot Present?</a></h3>

      <h3 class="SideTOC3"><a href="#996414">
      How Many Slots are Present?</a></h3>

      <h3 class="SideTOC3"><a href="#996433">
      Is a Card in the Slot?</a></h3>

      <h3 class="SideTOC3"><a href="#996444">
      Is a Mounted Volume on the Card?</a></h3>

      <h3 class="SideTOC3"><a href="#996492">
      Example of Checking for an Expansion Slot, Card, and Volume</a></h3>

      <h3 class="SideTOC3"><a href="#996553">
      Determining a Card's Capabilities</a></h3>

   <h2 class="SideTOC2"><a href="#996595">
   Volume Operations</a></h2>

      <h3 class="SideTOC3"><a href="#996713">
      Hidden Volumes</a></h3>

      <h3 class="SideTOC3"><a href="#996739">
      Matching Volumes to Slots</a></h3>

      <h3 class="SideTOC3"><a href="#996765">
      Naming Volumes</a></h3>

   <h2 class="SideTOC2"><a href="#996774">
   File Operations</a></h2>

      <h3 class="SideTOC3"><a href="#996797">
      Common File Operations</a></h3>

      <h3 class="SideTOC3"><a href="#996981">
      Naming Files</a></h3>

      <h3 class="SideTOC3"><a href="#996992">
      Working with Palm OS Databases</a></h3>

   <h2 class="SideTOC2"><a href="#997009">
   Directory Operations</a></h2>

      <h3 class="SideTOC3"><a href="#997043">
      Directory Paths</a></h3>

      <h3 class="SideTOC3"><a href="#997050">
      Common Directory Operations</a></h3>

      <h3 class="SideTOC3"><a href="#997177">
      Enumerating the Files and Subdirectories in a Directory</a></h3>

      <h3 class="SideTOC3"><a href="#997189">
      Determining the Default Directory for a Particular File Type</a></h3>

      <h3 class="SideTOC3"><a href="#997212">
      Default Directories Registered at Initialization</a></h3>

   <h2 class="SideTOC2"><a href="#997381">
   Example of Getting a File</a></h2>

   <h2 class="SideTOC2"><a href="#997470">
   Custom Calls</a></h2>

   <h2 class="SideTOC2"><a href="#1004964">
   Debugging</a></h2>

   <h2 class="SideTOC2"><a href="#997494">
   Summary of Expansion and VFS Managers</a></h2>

</div>
</td>
<!--END SIDETOC-->

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif"><img src="images/shim.gif" width="2" height="75" border="0" alt=""></td>
<td width="5">&nbsp;&nbsp;</td>
<td valign="top">

<!--BEGIN CONTENT-->
<div id="content" valign="bottom">
<p><a name="995940"> </a>This chapter describes how to work with handheld expansion cards and add-on devices from the desktop using the Expansion and Virtual File System (VFS) Managers. The sections in this chapter are: </p>
   <blockquote class = "bq"><a name="995944"> </a><a href="COMComp_Expansion.html#1002954">Expansion Support</a> </blockquote>
   <blockquote class = "bq"><a name="995948"> </a><a href="COMComp_Expansion.html#996064">Architectural Overview</a> </blockquote>
   <blockquote class = "bq"><a name="995952"> </a><a href="COMComp_Expansion.html#996223">Standard Directories</a> </blockquote>
   <blockquote class = "bq"><a name="995956"> </a><a href="COMComp_Expansion.html#996272">Card Insertion and Removal</a> </blockquote>
   <blockquote class = "bq"><a name="995960"> </a><a href="COMComp_Expansion.html#996277">Checking for Expansion Cards</a> </blockquote>
   <blockquote class = "bq"><a name="995964"> </a><a href="COMComp_Expansion.html#996595">Volume Operations</a> </blockquote>
   <blockquote class = "bq"><a name="995968"> </a><a href="COMComp_Expansion.html#996774">File Operations</a> </blockquote>
   <blockquote class = "bq"><a name="995972"> </a><a href="COMComp_Expansion.html#997009">Directory Operations</a> </blockquote>
   <blockquote class = "bq"><a name="995976"> </a><a href="COMComp_Expansion.html#997381">Example of Getting a File</a> </blockquote>
   <blockquote class = "bq"><a name="995980"> </a><a href="COMComp_Expansion.html#997470">Custom Calls</a> </blockquote>
   <blockquote class = "bq"><a name="1004947"> </a><a href="COMComp_Expansion.html#1004964">Debugging</a> </blockquote>
   <blockquote class = "bq"><a name="1005135"> </a><a href="COMComp_Expansion.html#997494">Summary of Expansion and VFS Managers</a> </blockquote>
<div class="NINoteImportant"><hr>
  <a name="1002960"> </a> <b>NOTE: </b> The Card Explorer sample in <code>&lt;CDK&gt;\COM\Samples\ExpansionCard\CardExplorer</code> illustrates many of the concepts explained in this chapter.
<hr>
</div>

<h2 class="haH2">
  <a name="1002954"> </a>Expansion Support <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="995988"> </a>Beginning with Palm OS<sup>&#174;</sup> 4.0, a set of optional system extensions provide a standard mechanism by which Palm OS applications, desktop applications, and conduits can take advantage of the expansion capabilities of various Palm Powered<sup>&#8482;</sup> handhelds. This capability not only augments the memory and I/O of the handheld, but facilitates data interchange with other Palm Powered handhelds and with devices that are not running Palm OS. These other devices include digital cameras, digital audio players, desktop or laptop computers, and the like.</p>

<p><a name="995989"> </a>This section covers the following topics: </p>
<ul type="disc">
  <li><a name="995993"> </a><a href="COMComp_Expansion.html#996003">Primary vs. Secondary Storage</a> 
  <li><a name="995997"> </a><a href="COMComp_Expansion.html#996043">Expansion Slot</a> 
  <li><a name="996001"> </a><a href="COMComp_Expansion.html#996054">Universal Connector</a> 
</ul>
<h3 class="hbH3">
  <a name="996003"> </a>Primary vs. Secondary Storage <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996005"> </a>All Palm Powered handhelds contain <b>primary storage</b>&#8212directly addressable memory that is used for both long-term and temporary storage. This includes storage RAM, used to hold nonvolatile user data and applications; and dynamic RAM, which is used as working space for temporary allocations. </p>

<p><a name="996007"> </a>On most handhelds, primary storage is contained entirely within the handheld itself. The Palm OS memory architecture does not limit handhelds to this, however; handhelds can be designed to accept additional storage RAM. Some products developed by Handspring work this way; memory modules plugged into the Springboard slot are fully-addressable and appear to a Palm OS application as additional storage RAM.</p>

<p><a name="996008"> </a>To access primary storage RAM from the desktop, conduits make Sync Manager API calls during a HotSync<sup>&#174;</sup> operation using COM Sync database adapters (see <a href="COMComp_Basics.html#1004101">"Database Support and Extensibility"</a>). </p>

<p><a name="996014"> </a><b>Secondary storage</b>, by contrast, is designed primarily to be add-on nonvolatile storage. Although not limited to any particular implementation, most secondary storage media:</p>
<ul type="disc">
  <li><a name="996015"> </a>can be inserted and removed from the expansion slot at will
  <li><a name="996017"> </a>are based upon a third-party standard, such as Secure Digital (SD), MultiMediaCard (MMC), CompactFlash, Sony's Memory Stick, and others
  <li><a name="996021"> </a>present a serial interface, accessing data one bit, byte, or block at a time
</ul>

<p><a name="996022"> </a>COM-based conduits access primary storage during a HotSync operation with the Sync Manager via COM Sync objects called <b>database adapters</b>. To access secondary storage, however, they use the Expansion and VFS Managers, represented as several COM Sync objects shown in <a href="COMComp_Expansion.html#996086">Figure 5.1</a>. These have been designed to support as broad a range of serial expansion architectures as possible.</p>

<p><a name="996027"> </a>Desktop applications or installers have always used the Install Aide to queue applications and databases for an install conduit to install in primary storage on the handheld during the next HotSync operation. With version 4.0 of the Palm OS platform, they can also use the Install Aide to queue files for an install conduit to copy from the desktop to secondary storage on expansion cards. Similarly, the User Data API enables desktop applications and installers to access information about handheld users on the desktop; now they can also access information about expansion slots on users' handhelds. The User Data and Install Aide APIs are exposed in the COM Sync module through the <a href="COMRef_Obj.html#1190026"><code>PDUserData</code></a> and <a href="COMRef_Obj.html#1172233"><code>PDInstall</code></a> objects. </p>

<p><a name="996034"> </a>For more information about the <code>PDUserData</code> and <code>PDInstall</code> objects, see <a href="COMComp_Install.html#996584">"Accessing User Data with PDUserData"</a> and <a href="COMComp_Install.html#996352">"Installing Files on the Handheld with PDInstall."</a> </p>
<h3 class="hbH3">
  <a name="996043"> </a>Expansion Slot <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996044"> </a>The expansion slots found on many Palm Powered handhelds vary depending on the manufacturer. While some may accept SD and MMC cards, others may accept Memory Stick or CompactFlash. Note that there is no restriction on the number of expansion slots that handhelds can have.</p>

<p><a name="996045"> </a>Depending on the expansion technology used, there can be a wide variety of expansion cards usable with a given handheld:</p>
<ul type="disc">
  <li><a name="996047"> </a>Storage cards provide secondary storage and can either be used to hold additional applications and data, or can be used for a specific purpose, for instance as a backup mechanism.
  <li><a name="996049"> </a>ROM cards hold dedicated applications and data.
  <li><a name="996050"> </a>I/O cards extend the handheld's I/O capabilities. A modem, for instance, could provide wired access, while a Bluetooth transceiver could add wireless capability.
  <li><a name="996051"> </a>"Combo" cards provide both additional storage or ROM along with some I/O capability.
</ul>
<h3 class="hbH3">
  <a name="996054"> </a>Universal Connector <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996055"> </a>Certain newer Palm Powered handhelds may be equipped with a universal connector that connects the handheld to a HotSync cradle. This connector can be used to connect the handheld to snap-on I/O devices as well. A special slot driver dedicated to this connector allows handheld-to-accessory communication using the serial portion of the connector. This "plug and play" slot driver presents the peripheral as a card in a slot, even to the extent of providing the card insertion notification when the peripheral is attached.</p>

<p><a name="996057"> </a>Because the universal connector's slot driver makes a snap-on peripheral appear to be a card in a slot, such peripherals can be treated as expansion cards by the handheld application. From a conduit's perspective, such a peripheral is not accessible during a <i>cradle-based</i><span style="color: #333;;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline"> </span>HotSync operation, because the universal connector is physically unavailable to a peripheral if it is used by the HotSync cradle. However, if the HotSync operation is via a <i>wireless</i> connection&#8212for example, infrared&#8212then a conduit can access such a peripheral. See <a href="COMComp_Expansion.html#997470">"Custom Calls"</a> for where to learn more about custom C API calls to access custom file systems or I/O devices.</p>

<p><a name="996061"> </a>For the remainder of this chapter, wherever an I/O card could be used, the phrase "expansion card" can be taken to mean both "expansion card" and "plug and play peripheral," but only if the the HotSync operation is not via the universal connector. </p>

<h2 class="haH2">
  <a name="996064"> </a>Architectural Overview <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996068"> </a><a href="COMComp_Expansion.html#996086">Figure 5.1</a> illustrates the Palm OS expansion architecture. It is designed to be flexible enough to support multiple file systems and diverse physical expansion mechanisms while still presenting a consistent set of APIs to applications and to other parts of Palm OS. The following sections describe the major components of the Palm OS expansion architecture. Working from the bottom up, those components are: </p>
<ul type="disc">
  <li><a name="996072"> </a><a href="COMComp_Expansion.html#996094">Slot Drivers</a> 
  <li><a name="996076"> </a><a href="COMComp_Expansion.html#996116">File Systems</a> 
  <li><a name="996080"> </a><a href="COMComp_Expansion.html#996126">VFS Manager</a> 
  <li><a name="996084"> </a><a href="COMComp_Expansion.html#996182">Expansion Manager</a> 
</ul>

<p class="FFigureCaption">
  <a name="996086"> </a><b>Figure 5.1&nbsp;&nbsp;Palm OS expansion architecture </b>
</p>
<div align="left"><img src="images/COMSyncExpArch.gif" height="619" width="624" border="0" hspace="0" vspace="0">
</div>
<h3 class="hbH3">
  <a name="996094"> </a>Slot Drivers <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996095"> </a>A <b>slot driver</b> is a standard Palm OS shared library on the handheld. It is a special library that encapsulates direct access to the hardware and provides a standard set of services to the Expansion Manager and, optionally, to file system libraries. As illustrated in <a href="COMComp_Expansion.html#996086">Figure 5.1</a>, neither handheld applications nor conduits normally interact directly with slot drivers. </p>

<p><a name="996099"> </a>Each expansion slot has a slot driver associated with it. Slots are identified by a unique <b>slot reference number</b>, which is assigned by the Expansion Manager on the handheld. Expansion cards themselves are not numbered individually; applications typically reference the slot into which a card is inserted. Note, however, that a slot may or may not have a card in it at any given time, and that a card can be inserted and removed while an application is running.</p>

<p><a name="996102"> </a>The Expansion Manager on the handheld identifies slots by slot reference numbers. These slot reference numbers may change depending on the order in which slot drivers are loaded by the Expansion Manager. Moreover, slot reference numbers are available only to conduits during a HotSync operation via the Expansion Manager API, which is represented by the COM Sync module as a <a href="COMRef_Obj.html#1165746"><code>PDExpansionManager</code></a> object. Therefore HotSync Manager assigns <b>slot IDs</b> to slots on the handheld at the beginning of each HotSync operation and saves them for the corresponding user in the user data store on the desktop. </p>

<p><a name="996107"> </a>The User Data and Install Aide APIs, which are not used during a HotSync operation, use slot IDs to identify slots instead of slot reference numbers. These APIs&#8212represented by the COM Sync module as <a href="COMRef_Obj.html#1190026"><code>PDUserData</code></a> and <a href="COMRef_Obj.html#1172233"><code>PDInstall</code></a> objects, respectively&#8212simply return the information saved on the desktop during the last HotSync operation, so this information might not be accurate for the next HotSync operation because the user might have changed or updated the handheld between HotSync operations. </p>
<h3 class="hbH3">
  <a name="996116"> </a>File Systems <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996117"> </a>The Palm OS expansion architecture defines a common interface for all file system implementations on Palm OS. This interface consists of a complete set of APIs for interacting with <b>file systems</b>, including the ability to open, close, read, write, and delete both files and directories on named volumes. Almost all of these handheld APIs are available on the desktop so that conduits can interact with file systems almost as completely as handheld applications can. </p>

<p><a name="996119"> </a>File system implementations are packaged as shared libraries on the handheld. They are modular plug-ins that add support for a particular type of file system, such as VFAT, HFS, or NFS. The Palm OS expansion architecture allows multiple file system libraries to be installed at any given time. Typically, an implementation of the VFAT file system is present. </p>

<p><a name="996121"> </a>VFAT is the industry standard for flash memory cards of all types. It enables easy transfer of data and or applications to desktops and other devices. The VFAT file system library included with Palm OS software versions 4.0 and later natively supports VFAT file systems on secondary storage media. It is able to recognize and mount FAT and VFAT file systems, and offers to reformat unrecognizable or corrupted media.</p>

<p><a name="996124"> </a>Because the VFAT file system requires long filenames to be stored in Unicode/UCS2 format, the standard VFAT file system library supports conversion between UCS2 and Shift-JIS (the standard Palm OS multi-byte character encoding), and between UCS2 and the Palm OS/Latin encoding. </p>
<h3 class="hbH3">
  <a name="996126"> </a>VFS Manager <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996127"> </a>The <b>Virtual File System (VFS) Manager</b> provides a unified API that gives handheld applications and desktop conduits access to many different file systems on many different media types. It abstracts the underlying file systems so that applications and conduits can be written without regard to the actual file system in use. The VFS Manager provides conduits many API functions for manipulating files, directories, and volumes <i>during</i> a HotSync operation.</p>

<h4 class="hcH4">
  <a name="996129"> </a>VFS Manager and the Sync Manager APIs 
</h4>

<p><a name="996130"> </a>With the addition of the VFS Manager to the COM Sync Suite, there are now two distinct ways that conduits can store and retrieve Palm OS users' data:</p>
<ul type="disc">
  <li><a name="996131"> </a>COM Sync database adapter objects access resource and record databases in the handheld's primary storage RAM via the Sync Manager API on the desktop. The Sync Manager effectively calls the handheld's Data Manager, which was specifically designed to make the most of the limited dynamic RAM and the nonvolatile RAM used instead of disk storage on most handhelds. Use the database adapter objects to store and retrieve a Palm OS user's data when storage on the handheld is all that is needed, or when efficient access to data is paramount. 
  <li><a name="996133"> </a>The VFS and Expansion Managers were designed specifically to support many types of expansion memory as secondary storage. The VFS Manager API presents a consistent interface to many different types of file systems on many types of external media. Conduits that use the COM Sync module's VFS Manager objects can support the widest variety of file systems. Use these objects when your conduit needs to read and write data stored on external media.
</ul>

<p><a name="996134"> </a>Conduits should use the appropriate objects for each given situation. Database adapters&#8212via the Sync Manager, being an efficient manager of storage in the storage heap&#8212should be used whenever access to external media is not absolutely needed. Use the VFS Manager objects when interoperability and file system access is needed. Note, however, that the VFS Manager adds the extra overhead of buffering all reads and writes in the handheld's memory when accessing data, so only conduits that specifically need this functionality should use the VFS Manager. </p>

<p><a name="996137"> </a>For more information on database adapters, see <a href="COMComp_Basics.html#1004101">"Database Support and Extensibility."</a> </p>

<h4 class="hcH4">
  <a name="996141"> </a>COM Sync VFS Manager Objects
</h4>

<p><a name="996145"> </a>As shown in <a href="COMComp_Expansion.html#996086">Figure 5.1</a>, COM-based conduits access the VFS Manager via these COM Sync objects: </p>

<dl>
<dt><a name="996150"> </a><a href="COMRef_Obj.html#1194445"><code>PDVFSManager</code></a></dt>
<dd><a name="996151"> </a>Represents the VFS Manager on the desktop. Its methods can determine whether and how many volumes are available on an expansion card, get a volume reference number for each mounted volume on the card, and create a <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object. </dd>

<dt><a name="996159"> </a><a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a></dt>
<dd><a name="996160"> </a>Represents a volume on an expansion card, created by a <a href="COMRef_Obj.html#1194445"><code>PDVFSManager</code></a> object. Its methods can create and open files and directories, copy files to and from the desktop, and import/export files and Palm OS databases between primary storage memory and an expansion card. </dd>

<dt><a name="996168"> </a><a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a></dt>
<dd><a name="996169"> </a>Represents a file or directory created or opened by a <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object. Its methods can read and write open files or directories. </dd>

</dl>

<p><a name="996173"> </a>The following sections in this chapter provide examples using the VFS Manager objects. For details on these objects, see <a href="COMRef_Obj.html#995936">Chapter 3, "Objects,"</a> in the <i>COM Sync Suite Reference</i>. </p>
<h3 class="hbH3">
  <a name="996182"> </a>Expansion Manager <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996183"> </a>The <b>Expansion Manager</b> is a software layer that manages slot drivers on Palm Powered handhelds. Supported expansion card types include, but are not limited to, Memory Stick and SD cards. The Expansion Manager does not support these expansion cards directly; rather, it provides an architecture and higher level set of API functions that, with the help of low-level slot drivers and file system libraries, support these types of media.</p>

<p><a name="996185"> </a>The Expansion Manager on the handheld:</p>
<ul type="disc">
  <li><a name="996186"> </a>broadcasts notification of card insertion and removal
  <li><a name="996187"> </a>plays sounds to signify card insertion and removal
  <li><a name="996188"> </a>mounts and unmounts card-resident volumes
</ul>

<p><a name="996189"> </a>The Expansion Manager API on the desktop provides an interface to the Expansion Manager on the handheld <i>during</i> a HotSync operation. Conduits that use the COM Sync module's Expansion Manager objects can determine whether an expansion card is present in a slot and get information about those cards. </p>

<h4 class="hcH4">
  <a name="996191"> </a>COM Sync Expansion Manager Objects
</h4>

<p><a name="996195"> </a>As shown in <a href="COMComp_Expansion.html#996086">Figure 5.1</a>, COM-based conduits access the Expansion Manager via these COM Sync objects: </p>

<dl>
<dt><a name="996200"> </a><a href="COMRef_Obj.html#1165746"><code>PDExpansionManager</code></a></dt>
<dd><a name="996201"> </a>Represents the Expansion Manager on the desktop. Its methods can detect the presence of and get information about expansion slots on a handheld and the cards in them. It can get slot reference numbers, which you subsequently use to get a <a href="COMRef_Obj.html#1163598"><code>PDExpansionCardInfo</code></a> object. </dd>

<dt><a name="996209"> </a><a href="COMRef_Obj.html#1163598"><code>PDExpansionCardInfo</code></a></dt>
<dd><a name="996210"> </a>Represents expansion card information given a slot reference number, which is provided by a <a href="COMRef_Obj.html#1165746"><code>PDExpansionManager</code></a> object. This object's properties include the card manufacturer's name, the type of media, and whether the card has storage and is read-only. </dd>

</dl>

<p><a name="996214"> </a>The following sections in this chapter provide examples using the Expansion Manager objects. For details on these objects, see <a href="COMRef_Obj.html#995936">Chapter 3, "Objects,"</a> in the <i>COM Sync Suite Reference</i>. </p>

<h2 class="haH2">
  <a name="996223"> </a>Standard Directories <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996224"> </a>The user experience presented by Palm OS is simpler and more intuitive than that of a typical desktop computer. Part of this simplicity arises from the fact that Palm OS does not present a file system to the user. Users do not have to understand the complexities of a typical file system; applications are readily available with one or two taps of a button or icon, and data associated with those applications is accessible only through each application. Maintaining this simplicity of user operation while supporting a file system on an expansion card is made possible through a standard set of directories on the expansion card.</p>

<p><a name="996229"> </a><a href="COMComp_Expansion.html#996236">Table 5.1</a> lists the standard directory layout for all "standards compliant" Palm OS secondary storage. All Palm OS relevant data should be in the <code>/PALM </code>directory (or in a subdirectory of the <code>/PALM </code>directory), effectively partitioning off a private name space.</p>

<p class="fineprint">
<p class="caption"><a name="996236"> </a><b>Table 5.1&nbsp;&nbsp;Standard directories </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="996240"> </a><b>Directory</b></p>
    </th>
    <th><p class="tt"><a name="996242"> </a><b>Description</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996244"> </a><code>/</code></p>
    </td>
    <td><p class="tt"><a name="996246"> </a>Root of the secondary storage.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996248"> </a><code>/PALM</code></p>
    </td>
    <td><p class="tt"><a name="996250"> </a>Most data written by Palm OS applications lives in a subdirectory of this directory. <code>start.prc</code> lives directly in <code>/PALM</code>. This optional file is automatically run when the secondary storage volume is mounted. Other applications may also reside in this directory.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996253"> </a><code>/PALM/Backup</code></p>
    </td>
    <td><p class="tt"><a name="996255"> </a>Reserved by Palm OS for backup purposes.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996257"> </a><code>/PALM/Programs</code></p>
    </td>
    <td><p class="tt"><a name="996259"> </a>Catch-all for other applications and data.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996261"> </a><code>/PALM/Launcher</code></p>
    </td>
    <td><p class="tt"><a name="996263"> </a>Home of Launcher-visible applications.</p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="996265"> </a>In addition to these standard directories, the VFS Manager supports the concept of a <b>default directory</b>; a directory in which data of a particular type is typically stored. See <a href="COMComp_Expansion.html#997189">"Determining the Default Directory for a Particular File Type"</a> for more information.</p>

<h2 class="haH2">
  <a name="996272"> </a>Card Insertion and Removal <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996273"> </a>The Expansion Manager supports the insertion and removal of expansion media at any time. The handheld continues to run as before, though an application switch may occur upon card insertion. The handheld need not be reset or otherwise explicitly informed that a card has been inserted or removed. </p>
<div class="NWNoteWarning"><hr>
  <a name="996274"> </a> <span style="color: #FF0000;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">WARNING!  </span> Because of the way certain expansion cards are constructed, if the user removes an expansion card while an application or conduit is <i>writing</i> to it, in certain rare circumstances it is possible for the card to become damaged to the point where either it can no longer be used or it must be reformatted. To the greatest extent possible, applications and conduits should write to the card only at well-defined points. The card can be removed without fear of damage while an application or conduit is <i>reading</i> from it, however.
<hr>
</div>

<p><a name="996275"> </a>If the user removes a card while your conduit is accessing it during a HotSync operation, the Expansion Manager or VFS Manager method fails. PalmSource, Inc. recommends that your conduit always check errors returned by all methods and add helpful messages to the user in the HotSync log. </p>

<h2 class="haH2">
  <a name="996277"> </a>Checking for Expansion Cards <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996278"> </a>Before accessing an expansion card, your conduit should check the following conditions in this order:</p>
<ol type="1">
  <li value="1"><a name="996282"> </a><a href="COMComp_Expansion.html#996310">Is an Expansion Slot Present?</a>
   <p><a name="996283"> </a>Your conduit should first make sure that the handheld supports expansion by verifying the presence of the Expansion and VFS Managers, which are present only if the handheld has an expansion slot. </p>
  <li value="2"><a name="996287"> </a><a href="COMComp_Expansion.html#996414">How Many Slots are Present?</a>
   <p><a name="996288"> </a>Once you know that at least one slot is present, you should enumerate them and determine which your conduit should use. </p>
  <li value="3"><a name="996292"> </a><a href="COMComp_Expansion.html#996433">Is a Card in the Slot?</a>
   <p><a name="996293"> </a>If there is, you can now ascertain the capabilities of the card: whether it has memory, whether it does I/O, and so on. </p>
  <li value="4"><a name="996297"> </a><a href="COMComp_Expansion.html#996444">Is a Mounted Volume on the Card?</a> 
   <p><a name="996298"> </a>If there is, you can access files and directories on it. </p>
</ol>

<p><a name="996299"> </a>This section discusses each of the above steps. The last two subsections are: </p>
<ul type="disc">
  <li><a name="996302"> </a><a href="COMComp_Expansion.html#996492">Example of Checking for an Expansion Slot, Card, and Volume</a> 
  <li><a name="996307"> </a><a href="COMComp_Expansion.html#996553">Determining a Card's Capabilities</a> 
</ul>
<h3 class="hbH3">
  <a name="996310"> </a>Is an Expansion Slot Present? <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996311"> </a>There are many different types of Palm Powered handhelds, and in the future there will be many more. Some will have expansion slots to support secondary storage, and some will not. Hardware to support secondary storage is optional, and may or may not be present on a given type of handheld. Because the Expansion and VFS Managers are of no use on a handheld that has no physical expansion capability, they are optional system extensions that are not present on every type of Palm Powered handheld. </p>

<p><a name="996312"> </a>Because of the great variability both in handheld configuration and in the modules that can be plugged into or snapped onto the handheld, conduits should not attempt to detect the manufacturer or model of a specific handheld when determining whether it supports secondary storage. Instead, check for the presence and capabilities of the underlying operating system.</p>

<p><a name="996313"> </a>The VFS Manager and the Expansion Manager on the handheld are individual system extensions that are both optional. They both make use of other parts of the operating system that were introduced in Palm OS software version 4.0. </p>
<div class="NINoteImportant"><hr>
  <a name="996314"> </a> <b>NOTE: </b> Although your conduit could check for the presence of both the VFS and Expansion Managers, it can take advantage of the fact that the VFS Manager relies on the Expansion Manager and is not present without it. Therefore, if the VFS Manager is present, you can safely assume that the Expansion Manager is present as well. 
<hr>
</div>

<p><a name="996316"> </a>Therefore your conduit must check for the presence of the VFS Manager on the handheld before calling any VFS or Expansion Manager methods. This section presents two ways of verifying the presence of the VFS Manager on the handheld:</p>
<ul type="disc">
  <li><a name="996320"> </a><a href="COMComp_Expansion.html#996327">Using the IsExpansionSlotPresent Method</a> 
  <li><a name="996324"> </a><a href="COMComp_Expansion.html#996350">Using the ReadFeature Method</a> 
</ul>

<h4 class="hcH4">
  <a name="996327"> </a>Using the IsExpansionSlotPresent Method
</h4>

<p><a name="996328"> </a>The desktop Expansion Manager object provides the <a href="COMRef_Meth.html#1000140"><code>IsExpansionSlotPresent()</code></a> method to verify whether the handheld has an expansion slot. Actually, at the beginning of each HotSync operation, the desktop VFS Manager checks for the presence of the Expansion Manager and VFS Manager system extensions on the handheld before HotSync Manager calls your conduit to run. </p>

<p><a name="996335"> </a>When you call <a href="COMRef_Meth.html#1000140"><code>IsExpansionSlotPresent()</code></a>, it returns <code>True</code> if these extensions are present and <code>False</code> otherwise. If they are present, you can infer that a slot is present, because no handheld ships with these extensions unless it has a slot. </p>
<div class="NINoteImportant"><hr>
  <a name="996339"> </a> <b>NOTE: </b> The <a href="COMRef_Meth.html#1000140"><code>IsExpansionSlotPresent()</code></a> method is the primary method for conduits to determine whether a handheld has expansion slots. This information has already been obtained by the desktop VFS Manager, so no additional calls are made to the handheld at the time your conduit calls this method&#8212which makes it more efficient than using <a href="COMRef_Meth.html#1363264"><code>ReadFeature()</code></a>. 
<hr>
</div>

<p><a name="996345"> </a><a href="COMComp_Expansion.html#996492">"Example of Checking for an Expansion Slot, Card, and Volume"</a> shows the use of <code>IsExpansionSlotPresent</code>. </p>

<h4 class="hcH4">
  <a name="996350"> </a>Using the ReadFeature Method
</h4>

<p><a name="996357"> </a>The <a href="COMRef_Obj.html#1185985"><code>PDSystemAdapter</code></a> object provides the <a href="COMRef_Meth.html#1363264"><code>ReadFeature()</code></a> method to verify the presence of defined feature sets on the handheld. To check for the VFS Manager's system feature, do the following: </p>
<ul type="disc">
  <li><a name="996361"> </a>call <a href="COMRef_Meth.html#1363264"><code>ReadFeature()</code></a> 
  <li><a name="996362"> </a>supply <code>sysFileCVFSMgr</code> for the feature creator 
  <li><a name="996363"> </a>supply <code>vfsFtrIDVersion</code> for the feature number
</ul>

<p><a name="996364"> </a>These constants are defined in the C header file <code>VFSMgr.h</code>. </p>

<p><a name="996371"> </a><a href="COMComp_Expansion.html#996373">Listing 5.1</a> shows how to use <a href="COMRef_Meth.html#1363264"><code>ReadFeature()</code></a> to check for the presence and proper version of the VFS Manger. </p>
<p class="CCodeCaption">
  <a name="996373"> </a><b>Listing 5.1&nbsp;&nbsp;ReadFeature to verify the presence of the VFS Manager</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Dim pSystem as New PDSystemAdapter<a name="996374"> </a>
Dim Feature as Long<a name="996375"> </a>
<a name="996376"> </a>
Feature = pSystem.<i>ReadFeature</i>("vfsm", 0)<a name="996377"> </a>
<a name="996378"> </a>
' On error, VFS Manager is not present, so fail gracefully.<a name="996379"> </a>
<a name="996380"> </a>
' On success, call VFS Manager methods as required. <a name="996381"> </a>
' If you check the return value of Feature and it is the <a name="996382"> </a>
' expected version number, everything is OK. <a name="996383"> </a>
</pre><div class="CodeRule"><hr></div>


<p><a name="996384"> </a>Even though presence of the VFS Manager implies presence of the Expansion Manager, you can also check for the Expansion Manager's system feature as follows:</p>
<ul type="disc">
  <li><a name="996388"> </a>call <a href="COMRef_Meth.html#1363264"><code>ReadFeature()</code></a> 
  <li><a name="996389"> </a>supply <code>sysFileCExpansionMgr</code> for the feature creator 
  <li><a name="996390"> </a>supply <code>expFtrIDVersion</code> for the feature number 
</ul>

<p><a name="996391"> </a>These constants are defined in the C header file <code>ExpansionMgr.h</code>. </p>

<p><a name="996398"> </a><a href="COMComp_Expansion.html#996400">Listing 5.2</a> shows how to use <a href="COMRef_Meth.html#1363264"><code>ReadFeature()</code></a> to check for the presence and proper version of the Expansion Manger. </p>
<p class="CCodeCaption">
  <a name="996400"> </a><b>Listing 5.2&nbsp;&nbsp;ReadFeature to verify the presence of the Expansion Manager</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Dim pSystem as New PDSystemAdapter<a name="996401"> </a>
Dim Feature as Long<a name="996402"> </a>
<a name="996403"> </a>
Feature = pSystem.<i>ReadFeature</i>("expn", 0)<a name="996404"> </a>
<a name="996405"> </a>
' On error, Expansion Manager is not present, so fail <a name="996406"> </a>
' gracefully.<a name="996407"> </a>
<a name="996408"> </a>
' On success, call Expansion Manager methods as required. <a name="996409"> </a>
' If you check the return value of Feature and it is the <a name="996410"> </a>
' expected version number, everything is OK. <a name="996411"> </a>
</pre><div class="CodeRule"><hr></div>

<h3 class="hbH3">
  <a name="996414"> </a>How Many Slots are Present? <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996415"> </a>Before you can determine which expansion modules are attached to a handheld, you must first determine how those modules could be attached. Expansion cards and some I/O devices could be plugged into physical slots, and snap-on modules could be connected through the handheld's universal connector. Irrespective of how they are physically connected, the Expansion Manager presents these to the developer as slots. The <a href="COMRef_Meth.html#999239"><code>GetSlotReferenceNumbers()</code></a> method makes it simple to enumerate these slots, getting a slot reference number for each. </p>

<p><a name="996421"> </a>The array of slot reference numbers passed back by <a href="COMRef_Meth.html#999239"><code>GetSlotReferenceNumbers()</code></a> uniquely identify all slots. A slot reference number can be supplied to various <a href="COMRef_Obj.html#1165746"><code>PDExpansionManager</code></a> methods to obtain information about the slot, such as whether there is a card or other expansion module present in the slot. <a href="COMComp_Expansion.html#996492">"Example of Checking for an Expansion Slot, Card, and Volume"</a> illustrates this. </p>
<h3 class="hbH3">
  <a name="996433"> </a>Is a Card in the Slot? <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996437"> </a>With the <a href="COMRef_Obj.html#1165746"><code>PDExpansionManager</code></a> object for a specific expansion slot, you can easily determine whether a card is in that slot. Call its <a href="COMRef_Meth.html#999026"><code>GetSlotInfo()</code></a> method and check the <code>IsCardPresent</code> parameter that it passes back. </p>
<h3 class="hbH3">
  <a name="996444"> </a>Is a Mounted Volume on the Card? <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996445"> </a>Conduits rely on the fact that Palm OS automatically mounts any recognized volumes inserted into or snapped onto the handheld. </p>
<div class="NINoteImportant"><hr>
  <a name="996446"> </a> <b>NOTE: </b> The slot driver provided by PalmSource currently mounts only one volume per expansion slot. 
<hr>
</div>

<p><a name="996447"> </a>Depending on your needs, you can use either of the following methods to determine whether any volumes are mounted: </p>
<ul type="disc">
  <li><a name="996454"> </a><a href="COMRef_Obj.html#1194445"><code>PDVFSManager</code></a>.<a href="COMRef_Meth.html#1000262"><code>IsVolumeAvailable()</code></a> determines whether any volumes are currently mounted on any card in any slot. Notice that this does not tell you anything about which slot or which card the volume is on. 
  <li><a name="996462"> </a><a href="COMRef_Obj.html#1165746"><code>PDExpansionManager</code></a>.<a href="COMRef_Meth.html#999026"><code>GetSlotInfo()</code></a> passes back a value in its <code>IsVolumeMounted</code> parameter, which indicates whether a volume is mounted on this card in this slot. 
</ul>

<p><a name="996463"> </a>After you have confirmed that a volume is present, you need a volume reference number to specify it. Again, depending on your needs, you can use either of the following methods to get a volume reference number:</p>
<ul type="disc">
  <li><a name="996471"> </a><a href="COMRef_Obj.html#1165746"><code>PDExpansionManager</code></a>.<a href="COMRef_Meth.html#999026"><code>GetSlotInfo()</code></a> passes back a volume reference number in its <code>VolRefNum</code> parameter for the first volume on the card in this slot. 
  <li><a name="996479"> </a><a href="COMRef_Obj.html#1194445"><code>PDVFSManager</code></a>.<a href="COMRef_Meth.html#999880"><code>GetVolumeReferenceList()</code></a> returns a list of the volume reference numbers of all mounted volumes on cards in all slots. 
</ul>

<p><a name="996480"> </a>You can then pass that volume reference number to the <a href="COMRef_Meth.html#999832"><code>GetVolumeManager()</code></a> method to create a <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object, with which you can manipulate files and directories on that volume. </p>

<p><a name="996489"> </a>See <a href="COMComp_Expansion.html#996492">"Example of Checking for an Expansion Slot, Card, and Volume"</a> for an example that illustrates the use of the <code>GetSlotInfo</code> and <code>GetVolumeReferenceList</code> methods to perform these tasks as well as the checks described previously in this section. </p>
<h3 class="hbH3">
  <a name="996492"> </a>Example of Checking for an Expansion Slot, Card, and Volume <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996496"> </a><a href="COMComp_Expansion.html#996498">Listing 5.3</a> illustrates how to perform the tasks described in the preceding subsections. The example VB subroutine <code>GetVolume</code> performs all the checks previously described and then displays information about the first volume it finds. </p>
<p class="CCodeCaption">
  <a name="996498"> </a><b>Listing 5.3&nbsp;&nbsp;GetVolume example </b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Public Sub GetVolume()<a name="996499"> </a>
<a name="996500"> </a>
   Dim ExpansionSlot As New PDExpansionManager<a name="996501"> </a>
   Dim SlotNumbers As Variant<a name="996502"> </a>
   Dim IsCardPresent As Boolean<a name="996503"> </a>
   Dim IsVolumeMounted As Boolean<a name="996504"> </a>
   Dim VolumeRef As Long<a name="996505"> </a>
   Dim VolumeCount As Long<a name="996506"> </a>
<a name="996507"> </a>
   Dim VFSManager As New PDVFSManager<a name="996508"> </a>
   Dim VFSVolume As PDVFSVolumeManager<a name="996509"> </a>
   Dim VolumeList() As Integer<a name="996510"> </a>
   Dim i As Integer<a name="996511"> </a>
<a name="996512"> </a>
   On Error GoTo ErrorHandler<a name="996513"> </a>
<a name="996514"> </a>
   If ExpansionSlot.<b>IsExpansionSlotPresent</b> Then<a name="996515"> </a>
      ' Get a list of all available slots.<a name="996516"> </a>
      SlotNumbers = ExpansionSlot.<b>GetSlotReferenceNumbers</b> <a name="996517"> </a>
      ' Retrieve slot information from the first available slot.<a name="996518"> </a>
      For i = 0 To UBound(SlotNumbers)<a name="996519"> </a>
         Call ExpansionSlot.<b>GetSlotInfo</b>(SlotNumbers(i), IsCardPresent, _<a name="996520"> </a>
            IsVolumeMounted, VolumeRef)<a name="996521"> </a>
         If IsCardPresent Then Exit For<a name="996522"> </a>
      Next i<a name="996523"> </a>
<a name="996524"> </a>
      If IsCardPresent Then<a name="996525"> </a>
         If IsVolumeMounted Then<a name="996526"> </a>
            VolumeList = VFSManager.<b>GetVolumeReferenceList</b>(VolumeCount)<a name="996527"> </a>
            ' Use the first available volume<a name="996528"> </a>
            Set VFSVolume = VFSManager.<b>GetVolumeManager</b>(VolumeList(0))<a name="996529"> </a>
         End If<a name="996530"> </a>
      Else<a name="996531"> </a>
         MsgBox("No card present in Slot ", vbInformation, "Information")<a name="996532"> </a>
         Exit Sub<a name="996533"> </a>
      End If<a name="996534"> </a>
   Else<a name="996535"> </a>
      MsgBox("No Expansion slot was found.", vbInformation, "Information")<a name="996536"> </a>
      Exit Sub<a name="996537"> </a>
   End If<a name="996538"> </a>
<a name="996539"> </a>
   ' Display the amount of used space on the current volume.<a name="996540"> </a>
   MsgBox(VFSVolume.<b>UsedSpace</b> &amp; " Bytes found on Volume '" &amp; VFSVolume.<b>Label</b> _ <a name="996541"> </a>
      &amp; "'", vbInformation, "Information")<a name="996542"> </a>
<a name="996543"> </a>
   Exit Sub<a name="996544"> </a>
<a name="996545"> </a>
ErrorHandler:<a name="996546"> </a>
   MsgBox("Error " &amp; Err.Number &amp; " " &amp; Err.Description, vbExclamation, _ <a name="996547"> </a>
      "GetVolume")<a name="996548"> </a>
   Exit Sub<a name="996549"> </a>
End Sub<a name="996550"> </a>
</pre><div class="CodeRule"><hr></div>

<h3 class="hbH3">
  <a name="996553"> </a>Determining a Card's Capabilities <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996554"> </a>Just knowing that an expansion card is inserted into a slot or connected to the handheld is not enough; your conduit needs to know something about the card to ensure that the operations it needs to perform are compatible with the card. For instance, if your conduit needs to write data to the card, its important to know whether writing is permitted.</p>

<p><a name="996555"> </a>The capabilities available to your conduit depend not only on the card but on the slot driver as well. Handheld manufacturers will provide one or more slot drivers that define standard interfaces to certain classes of expansion hardware. Card and device manufacturers may also choose to provide card-specific slot drivers, or they may require that applications use the slot custom control function and a registered creator code to access and control certain cards. The COM Sync module does not support access to custom control, but <a href="COMComp_Expansion.html#997470">"Custom Calls"</a> tells you where to learn more about custom C API calls to access custom file systems or I/O devices.</p>

<p><a name="996560"> </a>The slot driver is responsible for querying expansion cards for a standard set of capabilities. When a slot driver is present for a given expansion card, you can use the <a href="COMRef_Meth.html#998030"><code>GetCardInfo()</code></a> method to get a <a href="COMRef_Obj.html#1163598"><code>PDExpansionCardInfo</code></a> object whose properties specify the following:</p>
<ul type="disc">
  <li><a name="996568"> </a>the name of the expansion card's manufacturer (<a href="COMRef_Prop.html#997825"><code>ManufacturerName</code></a>)
  <li><a name="996575"> </a>the name of the expansion card (<a href="COMRef_Prop.html#998734"><code>ProductName</code></a>) 
  <li><a name="996576"> </a>the "device class," or type of expansion card (<a href="COMRef_Prop.html#996867"><code>DeviceClass</code></a>). Values returned here might include "Ethernet" or "Backup"
  <li><a name="996580"> </a>a unique identifier for the device, such as a serial number (<a href="COMRef_Prop.html#996884"><code>DeviceUniqueId</code></a>) 
  <li><a name="996584"> </a>whether the card supports both reading and writing, or whether it is read-only (<a href="COMRef_Prop.html#996126"><code>CapabilityFlags</code></a>) 
</ul>

<p><a name="996592"> </a>Note that the existence of the <a href="COMRef_Meth.html#998030"><code>GetCardInfo()</code></a> method does not imply that all expansion cards support these capabilities. It means only that the slot driver is able to assess a card and report its findings up to the Expansion Manager.</p>

<h2 class="haH2">
  <a name="996595"> </a>Volume Operations <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996596"> </a>If an expansion card supports a file system, the VFS Manager allows you to perform a number of standard volume operations. To determine which volumes are currently mounted and available, use <a href="COMRef_Meth.html#999880"><code>GetVolumeReferenceList()</code></a>. This method, the use of which is illustrated in <a href="COMComp_Expansion.html#996444">"Is a Mounted Volume on the Card?,"</a> returns a list of volume reference numbers, which you select from and then supply to the <a href="COMRef_Meth.html#999832"><code>GetVolumeManager()</code></a> method, which creates a <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object. This object provides the methods you need to manipulate files and directories on a volume. </p>
<div class="NINoteImportant"><hr>
  <a name="996609"> </a> <b>NOTE: </b> Volume reference numbers can change each time the handheld mounts a given volume. To keep track of a particular volume, save the <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a><span style="color: #333;;  font-style: normal; font-weight: normal; text-decoration: none; text-transform: none; vertical-align: baseline"> object's </span><a href="COMRef_Prop.html#1407655"><code>Label</code></a> property rather than its reference number. 
<hr>
</div>

<p><a name="996617"> </a>When the user inserts a card containing a mountable volume into a slot, the VFS Manager attempts to mount the volume automatically. Conduits cannot otherwise mount a volume.</p>

<p><a name="996622"> </a>You can use the <a href="COMRef_Meth.html#997754"><code>Format()</code></a> method to reformat an already formatted volume; it cannot format an unformatted card. Once the card has been formatted, the VFS Manager automatically mounts it and can assign it a new volume reference number. Despite the change in its volume reference number, you can continue to use the same <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object from which you formatted the volume. But the list of volume reference numbers you obtained with <a href="COMRef_Meth.html#999880"><code>GetVolumeReferenceList()</code></a> is no longer valid. This is another reason not to use volume reference numbers to track a particular volume. </p>

<p><a name="996636"> </a>The <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a>.<a href="COMRef_Prop.html#1407655"><code>Label</code></a> property allows you to get and set the volume label. Because the file system is responsible for verifying the validity of strings, you can try to set the volume label to any desired value. If the file system does not natively support the name given, the VFS Manager creates the <code>/VOLUME.NAM</code> file used to support long volume names (see <a href="COMComp_Expansion.html#996765">"Naming Volumes"</a> for more information) or you get an error back if the file system does not support the supplied string.</p>
<div class="NINoteImportant"><hr>
  <a name="996643"> </a> <b>NOTE: </b> Most conduits should not need to set the <a href="COMRef_Prop.html#1407655"><code>Label</code></a> property. Setting this property may create or delete a file in the root directory, which would invalidate any current calls to <a href="COMRef_Meth.html#998444"><code>GetFileList()</code></a>. 
<hr>
</div>

<p><a name="996647"> </a>Additional information about the volume can be obtained through getting the <a href="COMRef_Prop.html#999253"><code>TotalCapacity</code></a>, <a href="COMRef_Prop.html#999319"><code>UsedSpace</code></a>, and other <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> properties. These properties return the total amount of space on the volume, in bytes, and the amount of that volume's space that is currently in use, again in bytes. Other properties provide various pieces of information about the volume, including:</p>
<ul type="disc">
  <li><a name="996663"> </a>whether the volume is hidden (<a href="COMRef_Prop.html#996075"><code>Attributes</code></a>) 
  <li><a name="996668"> </a>whether the volume is read-only (<a href="COMRef_Prop.html#996075"><code>Attributes</code></a>)
  <li><a name="996669"> </a>whether the volume is supported by a slot driver, or is being simulated by Palm OS Emulator (<a href="COMRef_Prop.html#998114"><code>mountClass</code></a>)
  <li><a name="996674"> </a>the slot with which the volume is associated (<a href="COMRef_Prop.html#999114"><code>SlotReferenceNumber</code></a>), and the reference number of the slot driver controlling the slot (<a href="COMRef_Prop.html#999094"><code>SlotLibRefNumber</code></a>)
  <li><a name="996681"> </a>the type of media on which this volume is located, such as SD, CompactFlash, or Memory Stick (<a href="COMRef_Prop.html#997933"><code>MediaType</code></a>)
</ul>

<p><a name="996685"> </a>All of the above information is provided by the properties of a <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object. Whether the volume is hidden or read-only is further encoded in the <a href="COMRef_Prop.html#996075"><code>Attributes</code></a> property; see <a href="COMRef_Const.html#997580">"VFS Volume Attributes"</a> in the <i>COM Sync Suite Reference</i> for the bits that make up this property. </p>

<p><a name="996698"> </a>The rest of this section covers the following topics:</p>
<ul type="disc">
  <li><a name="996702"> </a><a href="COMComp_Expansion.html#996713">Hidden Volumes</a> 
  <li><a name="996706"> </a><a href="COMComp_Expansion.html#996739">Matching Volumes to Slots</a> 
  <li><a name="996710"> </a><a href="COMComp_Expansion.html#996765">Naming Volumes</a> 
</ul>
<h3 class="hbH3">
  <a name="996713"> </a>Hidden Volumes <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996714"> </a>Included among the volume attributes is a "hidden" bit, <code>vfsVolumeAttrHidden</code>, that indicates whether the volume on the card is to be visible or hidden. Hidden volumes are typically not meant to be directly available to the user; the Launcher and the CardInfo application both ignore all hidden volumes. </p>

<p><a name="996716"> </a>To make a volume hidden, simply create an empty file named <code>HIDDEN.VOL</code> in the <code>/PALM </code>directory. A <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object looks for this file and, if found, sets the <code>vfsVolumeAttrHidden</code> bit along with the volume's other attributes in the <a href="COMRef_Prop.html#996075"><code>Attributes</code></a> property. </p>
<div class="NINoteImportant"><hr>
  <a name="996727"> </a> <b>NOTE: </b> The bit values that the volume <a href="COMRef_Prop.html#996075"><code>Attributes</code></a> property can be set to and described in <a href="COMRef_Const.html#997580">"VFS Volume Attributes"</a> in the <i>COM Sync Suite Reference</i> are defined in the C header file (<code>VFSMgr.h</code>) of the <i>desktop</i> VFS Manager API. However, the <code>vfsVolumeAttrHidden</code> bit is not defined in that header file but can be passed back in an <a href="COMRef_Prop.html#996075"><code>Attributes</code></a> property. It is defined in the <i>handheld's</i> VFS Manager header file available in the Palm OS SDK, so you can copy it from that file to the desktop <code>VFSMgr.h</code> file. 
<hr>
</div>
<h3 class="hbH3">
  <a name="996739"> </a>Matching Volumes to Slots <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996740"> </a>In most cases, a conduit does not need to know the specifics of an expansion card as provided by the <a href="COMRef_Meth.html#998030"><code>GetCardInfo()</code></a> method. Often, the information provided by the properties of a <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object is enough. Some applications need to know more about a particular volume, however. The name of the manufacturer or the type of card, for instance, may be important. </p>

<p><a name="996751"> </a>The properties of a <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object include a <a href="COMRef_Prop.html#999114"><code>SlotReferenceNumber</code></a> property that can be passed to <a href="COMRef_Meth.html#998030"><code>GetCardInfo()</code></a>. This allows you to obtain specific information about the card on which a particular volume is located.</p>

<p><a name="996758"> </a>Obtaining volume information that corresponds to a given slot reference number is just as simple: call the <a href="COMRef_Meth.html#999026"><code>GetSlotInfo()</code></a> method, passing it a slot reference number, and it returns the volume reference number of the first mounted volume on a card in that slot. (The current slot driver provided by PalmSource supports only one volume per card.) </p>
<h3 class="hbH3">
  <a name="996765"> </a>Naming Volumes <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996766"> </a>Different handheld file system libraries support volume names of different maximum lengths and have different restrictions on character sets. The file system library is responsible for verifying whether or not a given volume name is valid, and returns an error if it is not. From a conduit developer's standpoint, volume names can be up to 255 characters long, and can include any printable character. </p>

<p><a name="996767"> </a>The file system library is responsible for translating the volume name into a format that is acceptable to the underlying file system. For example, when the 8.3 naming convention is used to translate a long volume name, the first eleven valid, non-space characters are used. Valid characters in this instance are A-Z, 0-9, $, %, ', -, _, @, ~, ', !, (, ), ^, #, and &amp;. </p>

<p><a name="996768"> </a>For more information on naming volumes on handheld expansion cards, see the <i>Palm OS Programmer's Companion</i>. </p>

<h2 class="haH2">
  <a name="996774"> </a>File Operations <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="996775"> </a>All of the familiar operations you use to operate on files in a desktop application are supported by the VFS Manager for handheld expansion cards; these are listed in <a href="COMComp_Expansion.html#996797">"Common File Operations."</a> In addition, the VFS Manager includes a set of functions that simplify the way you work with files that represent Palm OS record databases (PDB) or resource databases (PRC). These are covered in <a href="COMComp_Expansion.html#996992">"Working with Palm OS Databases."</a></p>

<p><a name="996782"> </a>This section covers the following topics:</p>
<ul type="disc">
  <li><a name="996786"> </a><a href="COMComp_Expansion.html#996797">Common File Operations</a> 
  <li><a name="996790"> </a><a href="COMComp_Expansion.html#996981">Naming Files</a> 
  <li><a name="996794"> </a><a href="COMComp_Expansion.html#996992">Working with Palm OS Databases</a> 
</ul>
<h3 class="hbH3">
  <a name="996797"> </a>Common File Operations <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996801"> </a>As shown in <a href="COMComp_Expansion.html#996825">Table 5.2</a>, the VFS Manager provides all of the standard file operations that should be familiar from desktop and larger computer systems. Because these methods work largely as you would expect, their use is not detailed here. See the descriptions of each individual method in <a href="COMRef_Meth.html#995936">Chapter 4, "Methods,"</a> in the <i>COM Sync Suite Reference</i> for the parameters, return values, and side effects of each.</p>

<p><a name="996811"> </a>Most file operations are performed on <a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a> objects, except for a few such as the <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a>'s <a href="COMRef_Meth.html#1000463"><code>Open()</code></a> method, which creates a <code>PDVFSFileManager</code> object to represent a file. Then you call its methods to read, write, and close the file. Note that the <code>PDVFSVolumeManager</code>'s methods operate only on <i>closed</i> files, whereas <code>PDVFSFileManager</code>'s methods operate only on <i>open</i> files. </p>

<p><a name="996818"> </a>Note that some of these methods can be applied to both files and directories, while others work only with files.</p>

<p class="fineprint">
<p class="caption"><a name="996825"> </a><b>Table 5.2&nbsp;&nbsp;Common file operations </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="996829"> </a><b>Function</b></p>
    </th>
    <th><p class="tt"><a name="996831"> </a><b>Description</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="996836"> </a><a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> methods</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996844"> </a><a href="COMRef_Meth.html#1000463"><code>Open()</code></a> method</p>
    </td>
    <td><p class="tt"><a name="996846"> </a>Opens a file, given a file path and open mode. Opening a file creates a <a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a> object to represent it. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996855"> </a><a href="COMRef_Meth.html#997019"><code>CreateFile()</code></a> method </p>
    </td>
    <td><p class="tt"><a name="996857"> </a>Creates a file on this volume given a path.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996863"> </a><a href="COMRef_Meth.html#997279"><code>Delete()</code></a> method </p>
    </td>
    <td><p class="tt"><a name="996865"> </a>Deletes a closed file.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996871"> </a><a href="COMRef_Meth.html#1002344"><code>Rename()</code></a> method </p>
    </td>
    <td><p class="tt"><a name="996873"> </a>Renames a closed file.</p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="996878"> </a><a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a> methods and properties</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996886"> </a><a href="COMRef_Meth.html#996715"><code>Close()</code></a> method </p>
    </td>
    <td><p class="tt"><a name="996888"> </a>Closes an open file.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996894"> </a><a href="COMRef_Meth.html#1000641"><code>Read()</code></a> method</p>
    </td>
    <td><p class="tt"><a name="996896"> </a>Reads data from an open file into the specified buffer.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996902"> </a><a href="COMRef_Meth.html#1003872"><code>Write()</code></a> method</p>
    </td>
    <td><p class="tt"><a name="996904"> </a>Writes data to an open file.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996910"> </a><a href="COMRef_Meth.html#1002572"><code>Seek()</code></a> method</p>
    </td>
    <td><p class="tt"><a name="996912"> </a>Sets the position within an open file from which to read or write.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996918"> </a><a href="COMRef_Meth.html#1003474"><code>Tell()</code></a> method</p>
    </td>
    <td><p class="tt"><a name="996920"> </a>Gets the current position of the file pointer within an open file.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996926"> </a><a href="COMRef_Prop.html#997015"><code>EOF</code></a> property</p>
    </td>
    <td><p class="tt"><a name="996928"> </a>Indicates whether the file pointer has reached the end of the file. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996934"> </a><a href="COMRef_Prop.html#999077"><code>Size</code></a> property </p>
    </td>
    <td><p class="tt"><a name="996936"> </a>Size of a file or what to resize a file to. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996942"> </a><a href="COMRef_Prop.html#996075"><code>Attributes</code></a> property</p>
    </td>
    <td><p class="tt"><a name="996944"> </a>Attributes of a file, including hidden, read-only, system, and archive bits. See <a href="COMRef_Const.html#997493">"VFS File and Directory Attributes"</a> in the <i>COM Sync Suite Reference</i> for the bits that make up this property. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="996959"> </a><a href="COMRef_Prop.html#996426"><code>CreationDate</code></a>, <a href="COMRef_Prop.html#997712"><code>LastModificationDate</code></a>, <a href="COMRef_Prop.html#997661"><code>LastAccessedDate</code></a> properties</p>
    </td>
    <td><p class="tt"><a name="996966"> </a>Dates on which an open file was created, last modified, and last accessed.</p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="996975"> </a>To open a file with the <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a>'s <a href="COMRef_Meth.html#1000463"><code>Open()</code></a> method, you specify only its path and an open mode (read-only, exclusive open, and so on). This method returns a <a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a> object, which uniquely identifies the file. Note that all paths are volume relative, <i>and absolute within that volume:</i> the VFS Manager has no concept of a "current working directory," so relative path names are not supported. The directory separator character is the forward slash: "/". The root directory for the specified volume is specified by a path of "/".</p>
<h3 class="hbH3">
  <a name="996981"> </a>Naming Files <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996982"> </a>Different file systems support filenames and paths of different maximum lengths. The file system library is responsible for verifying whether or not a given path is valid and returns an error if it is not valid. From a conduit developer's standpoint, filenames can be up to 255 characters long and can include any normal character including spaces and lowercase characters in any character set. They can also include the following special characters:</p>

<p><a name="996983"> </a><code>$ % ' - _ @ ~ </code><i>'</i><i> </i><code>! ( ) ^ # &amp; + , ; = [ ]</code></p>

<p><a name="996984"> </a>The file system library is responsible for translating each filename and path into a format that is acceptable to the underlying file system. For example, when the 8.3 naming convention is used to translate a long filename, the following guidelines are used:</p>
<ul type="disc">
  <li><a name="996985"> </a>The name is created from the first six valid, non-space characters which appear before the last period. The only valid characters are A-Z, 0-9, $, %, ', -, _, @, ~, ', !, (, ), ^, #, and &amp;.
  <li><a name="996986"> </a>The extension is the first three valid characters after the last period.
  <li><a name="996987"> </a>The end of the six byte name has "~1" appended to it for the first occurrence of the shortened filename. Each subsequent occurrence uses the next unique number, so the second occurrence would have "~2" appended, and so on.
</ul>

<p><a name="996989"> </a>The standard VFAT file system library provided with all Palm Powered handhelds that support expansion uses the above rules to create FAT-compliant names from long filenames.</p>
<h3 class="hbH3">
  <a name="996992"> </a>Working with Palm OS Databases <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="996993"> </a>Expansion cards are often used to hold Palm OS applications and data in PRC and PDB format. Because of the way that secondary storage media are connected to the Palm Powered handheld, applications cannot be run directly from the expansion card, nor can conduits manipulate databases using the Sync Manager without first transferring them to main memory with the VFS Manager. Conduits written to use the VFS Manager, however, can operate directly on files located on an expansion card.</p>
<div class="NINoteImportant"><hr>
  <a name="996995"> </a> <b>NOTE: </b> Whenever possible give the same name to the PRC/PDB file and to the database. If the PRC/PDB filename differs from the database name, and the user copies your database from the card to the handheld and then to another card, the filename may change. This is because the database name is used when a database is copied from the handheld to the card.
<hr>
</div>

<h4 class="hcH4">
  <a name="996996"> </a>Transferring Palm OS Databases to and from Expansion Cards
</h4>

<p><a name="997001"> </a>The <a href="COMRef_Meth.html#997708"><code>ExportDatabaseToFile()</code></a> method converts a database from its internal format on the handheld to its equivalent PRC or PDB file format and transfers it to an expansion card. The <a href="COMRef_Meth.html#999972"><code>ImportDatabaseFromFile()</code></a> method does the reverse; it transfers the PRC or PDB file to primary storage memory and converts it to the internal format used by Palm OS. Use these methods when moving Palm OS databases between primary storage memory on a handheld and secondary storage on an expansion card. </p>

<p><a name="997006"> </a>The <code>ExportDatabaseToFile</code> and <code>ImportDatabaseFromFile</code> routines are atomic and, depending on the size of the database and the mechanism by which it is being transferred, can take some time. </p>
<div class="NINoteImportant"><hr>
  <a name="1003006"> </a> <b>IMPORTANT: </b> The import and export methods do not work with schema databases.
<hr>
</div>

<h2 class="haH2">
  <a name="997009"> </a>Directory Operations <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="997010"> </a>All of the familiar operations you would use to operate on directories are supported by the VFS Manager; these are listed in <a href="COMComp_Expansion.html#997050">"Common Directory Operations."</a> One common operation&#8212determining the files that are contained within a given directory&#8212is covered in <a href="COMComp_Expansion.html#997177">"Enumerating the Files and Subdirectories in a Directory."</a> To improve data interchange with devices that are not running Palm OS, expansion card manufacturers have specified default directories for certain file types. <a href="COMComp_Expansion.html#997189">"Determining the Default Directory for a Particular File Type"</a> discusses how you can both determine and set the default directory for a given file type. </p>

<p><a name="997021"> </a>This section covers the following topics:</p>
<ul type="disc">
  <li><a name="997025"> </a><a href="COMComp_Expansion.html#997043">Directory Paths</a> 
  <li><a name="997029"> </a><a href="COMComp_Expansion.html#997050">Common Directory Operations</a> 
  <li><a name="997033"> </a><a href="COMComp_Expansion.html#997177">Enumerating the Files and Subdirectories in a Directory</a> 
  <li><a name="997037"> </a><a href="COMComp_Expansion.html#997189">Determining the Default Directory for a Particular File Type</a> 
  <li><a name="997041"> </a><a href="COMComp_Expansion.html#997212">Default Directories Registered at Initialization</a> 
</ul>
<h3 class="hbH3">
  <a name="997043"> </a>Directory Paths <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="997044"> </a>All paths are volume relative, <i>and absolute within that volume</i>: the VFS Manager has no concept of a "current working directory," so relative path names are not supported. The directory separator character is the forward slash: "/". The root directory for the specified volume is specified by a path of "/". </p>

<p><a name="997048"> </a>See <a href="COMComp_Expansion.html#996981">"Naming Files"</a> for details on valid characters to use in file and directory names. </p>
<h3 class="hbH3">
  <a name="997050"> </a>Common Directory Operations <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="997054"> </a>As shown in <a href="COMComp_Expansion.html#997078">Table 5.3</a>, the VFS Manager provides all of the standard directory operations that should be familiar from desktop and larger computer systems. Because these methods work largely as you would expect, their use is not detailed here. See the descriptions of each individual method in <a href="COMRef_Meth.html#995936">Chapter 4, "Methods,"</a> in the <i>COM Sync Suite Reference</i> for the parameters, return values, and side effects of each.</p>

<p><a name="997064"> </a>Most directory operations are performed on <a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a> objects, except for a few such as the <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a>'s <a href="COMRef_Meth.html#1000463"><code>Open()</code></a> method, which creates a <code>PDVFSFileManager</code> object to represent a directory. Then you call its methods to read, write, and close the directory. Note that the <code>PDVFSVolumeManager</code>'s methods operate only on <i>closed</i> directories, whereas <code>PDVFSFileManager</code>'s methods operate only on <i>open</i> directories. </p>

<p><a name="997071"> </a>Note that most of these methods can be applied to files as well as directories. </p>

<p class="fineprint">
<p class="caption"><a name="997078"> </a><b>Table 5.3&nbsp;&nbsp;Common directory operations </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="997082"> </a><b>Function</b></p>
    </th>
    <th><p class="tt"><a name="997084"> </a><b>Description</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="997089"> </a><a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> methods</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997097"> </a><a href="COMRef_Meth.html#1000463"><code>Open()</code></a> method</p>
    </td>
    <td><p class="tt"><a name="997099"> </a>Opens a directory, given a file path and open mode. Opening a directory creates a <a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a> object to represent it. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997108"> </a><a href="COMRef_Meth.html#996955"><code>CreateDirectory()</code></a> method </p>
    </td>
    <td><p class="tt"><a name="997110"> </a>Creates a new directory on this volume given a path.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997116"> </a><a href="COMRef_Meth.html#997279"><code>Delete()</code></a> method </p>
    </td>
    <td><p class="tt"><a name="997118"> </a>Deletes a closed directory.</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997124"> </a><a href="COMRef_Meth.html#1002344"><code>Rename()</code></a> method </p>
    </td>
    <td><p class="tt"><a name="997126"> </a>Renames a closed directory.</p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="997131"> </a><a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a> methods and properties</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997139"> </a><a href="COMRef_Prop.html#996075"><code>Attributes</code></a> property</p>
    </td>
    <td><p class="tt"><a name="997141"> </a>Attributes of a directory, including read-only and slot-based bits. See <a href="COMRef_Const.html#997580">"VFS Volume Attributes"</a> in the <i>COM Sync Suite Reference</i> for the bits that make up this property. </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997156"> </a><a href="COMRef_Prop.html#996426"><code>CreationDate</code></a>, <a href="COMRef_Prop.html#997712"><code>LastModificationDate</code></a>, <a href="COMRef_Prop.html#997661"><code>LastAccessedDate</code></a> properties</p>
    </td>
    <td><p class="tt"><a name="997163"> </a>Dates on which an open directory was created, last modified, and last accessed.</p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="997172"> </a>To open a directory with the <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a>'s <a href="COMRef_Meth.html#1000463"><code>Open()</code></a> method, you specify only its path and an open mode (read-only, exclusive open, and so on). This method returns a <a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a> object, which uniquely identifies the directory. Note that all paths are volume relative, <i>and absolute within that volume:</i> the VFS Manager has no concept of a "current working directory," so relative path names are not supported. The directory separator character is the forward slash: "/". The root directory for the specified volume is specified by a path of "/". </p>
<h3 class="hbH3">
  <a name="997177"> </a>Enumerating the Files and Subdirectories in a Directory <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="997179"> </a>To enumerate the files and subdirectories within a directory, call the <a href="COMRef_Meth.html#998444"><code>GetFileList()</code></a> and <a href="COMRef_Meth.html#999401"><code>GetSubDirectoryList()</code></a> methods, respectively. </p>
<h3 class="hbH3">
  <a name="997189"> </a>Determining the Default Directory for a Particular File Type <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="997194"> </a>As explained in <a href="COMComp_Expansion.html#996223">"Standard Directories,"</a> the expansion capabilities of Palm OS include a mechanism to map MIME types or file extensions to specific directory names. This mechanism is specific to the slot driver: where an image might be stored in the "<code>/Images</code>" directory on a Memory Stick, on an MMC card it may be stored in the "<code>/DCIM</code>" directory. The VFS Manager includes a function that enables your conduit to get the default directory on a particular volume for a given file extension or MIME type; unlike handheld applications, conduits cannot register and unregister their own default directories.</p>

<p><a name="997203"> </a>A <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> object's <a href="COMRef_Meth.html#998323"><code>GetDefaultDirectory()</code></a> method takes a string containing the file extension or MIME type and returns a string containing the full path to the corresponding default directory. When specifying the file type, either supply a MIME media type/subtype pair, such as "image/jpeg", "text/plain", or "audio/basic"; or a file extension, such as "<code>.jpeg</code>". </p>

<p><a name="997204"> </a>The default directory registered for a given file type is intended to be the "root" default directory. If a given default directory has one or more subdirectories, conduits should also search those subdirectories for files of the appropriate type.</p>

<p><a name="997208"> </a><a href="COMRef_Meth.html#998323"><code>GetDefaultDirectory()</code></a> allows you to determine the directory associated with a particular file suffix. However, there is no way to get the entire list of file suffixes that are mapped to default directories. </p>
<h3 class="hbH3">
  <a name="997212"> </a>Default Directories Registered at Initialization <a href="#995934"><span class="nav">^TOP^</span></a>
</h3>


<p><a name="997216"> </a>The VFS Manager registers the file types in <a href="COMComp_Expansion.html#997236">Table 5.4</a> under the <code>expMediaType_Any</code> media type, which <a href="COMRef_Meth.html#998323"><code>GetDefaultDirectory()</code></a> reverts to when there is no default registered by the slot driver for a given media type. (The supported media type is specified in the <a href="COMRef_Prop.html#997933"><code>MediaType</code></a> property in <a href="COMRef_Obj.html#1163598"><code>PDExpansionCardInfo</code></a> and <a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a> objects.) </p>

<p class="fineprint">
<p class="caption"><a name="997236"> </a><b>Table 5.4&nbsp;&nbsp;Default directory registrations </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="997240"> </a><b>File Type</b></p>
    </th>
    <th><p class="tt"><a name="997242"> </a><b>Path</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997244"> </a><code>.prc</code> </p>
    </td>
    <td><p class="tt"><a name="997246"> </a><code>/PALM/Launcher/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997248"> </a><code>.pdb</code> </p>
    </td>
    <td><p class="tt"><a name="997250"> </a><code>/PALM/Launcher/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997252"> </a><code>.pqa</code> </p>
    </td>
    <td><p class="tt"><a name="997254"> </a><code>/PALM/Launcher/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997256"> </a><code>application/vnd.palm</code> </p>
    </td>
    <td><p class="tt"><a name="997258"> </a><code>/PALM/Launcher/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997260"> </a><code>.jpg</code> </p>
    </td>
    <td><p class="tt"><a name="997262"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997264"> </a><code>.jpeg</code> </p>
    </td>
    <td><p class="tt"><a name="997266"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997268"> </a><code>image/jpeg</code> </p>
    </td>
    <td><p class="tt"><a name="997270"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997272"> </a><code>.gif</code> </p>
    </td>
    <td><p class="tt"><a name="997274"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997276"> </a><code>image/gif</code> </p>
    </td>
    <td><p class="tt"><a name="997278"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997280"> </a><code>.qt</code> </p>
    </td>
    <td><p class="tt"><a name="997282"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997284"> </a><code>.mov</code> </p>
    </td>
    <td><p class="tt"><a name="997286"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997288"> </a><code>video/quicktime</code> </p>
    </td>
    <td><p class="tt"><a name="997290"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997292"> </a><code>.avi</code> </p>
    </td>
    <td><p class="tt"><a name="997294"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997296"> </a><code>video/x-msvideo</code> </p>
    </td>
    <td><p class="tt"><a name="997298"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997300"> </a><code>.mpg</code> </p>
    </td>
    <td><p class="tt"><a name="997302"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997304"> </a><code>.mpeg</code> </p>
    </td>
    <td><p class="tt"><a name="997306"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997308"> </a><code>video/mpeg</code> </p>
    </td>
    <td><p class="tt"><a name="997310"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997312"> </a><code>.mp3</code> </p>
    </td>
    <td><p class="tt"><a name="997314"> </a><code>/AUDIO/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997316"> </a><code>.wav</code> </p>
    </td>
    <td><p class="tt"><a name="997318"> </a><code>/AUDIO/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997320"> </a><code>audio/x-wav</code> </p>
    </td>
    <td><p class="tt"><a name="997322"> </a><code>/AUDIO/</code> </p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="997325"> </a>The SD slot driver provided by PalmSource, Inc. registers the file types in <a href="COMComp_Expansion.html#997335">Table 5.5</a>, because it has an appropriate specification for these file types. </p>

<p class="fineprint">
<p class="caption"><a name="997335"> </a><b>Table 5.5&nbsp;&nbsp;Directories registered by the SD slot driver </b></p>
<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th><p class="tt"><a name="997339"> </a><b>File Type</b></p>
    </th>
    <th><p class="tt"><a name="997341"> </a><b>Path</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997343"> </a><code>.jpg</code> </p>
    </td>
    <td><p class="tt"><a name="997345"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997347"> </a><code>.jpeg</code> </p>
    </td>
    <td><p class="tt"><a name="997349"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997351"> </a><code>image/jpeg</code> </p>
    </td>
    <td><p class="tt"><a name="997353"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997355"> </a><code>.qt</code> </p>
    </td>
    <td><p class="tt"><a name="997357"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997359"> </a><code>.mov</code> </p>
    </td>
    <td><p class="tt"><a name="997361"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997363"> </a><code>video/quicktime</code> </p>
    </td>
    <td><p class="tt"><a name="997365"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997367"> </a><code>.avi</code> </p>
    </td>
    <td><p class="tt"><a name="997369"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997371"> </a><code>video/x-msvideo</code> </p>
    </td>
    <td><p class="tt"><a name="997373"> </a><code>/DCIM/</code> </p>
    </td>
  </tr>
</table>

</div>

</p>

<p><a name="997375"> </a>Although the directories registered by this SD slot driver all happen to be duplicates of the default registrations made by the VFS Manager, they are also registered under the SD media type because the SD specification explicitly includes them.</p>

<p><a name="997377"> </a>Slot drivers written by other Palm Powered handheld manufacturers that support different media types, such as Memory Stick, register default directories appropriate to their media's specifications. In some cases these registrations may override the <code>expMediaType_Any</code> media type registration, or in some cases augment the <code>expMediaType_Any</code> registrations with file types not previously registered. </p>

<p><a name="997378"> </a>These registrations are intended to aid applications developers, but you are not required to follow them. Although you can choose to ignore these registrations, by following them you improve interoperability between applications and other devices. For example, a digital camera which conforms to the media specifications puts its pictures into the registered directory (or a subdirectory of it) appropriate for the image format and media type. By looking up the registered directory for that format, an image viewer application on the handheld can easily find the images without having to search the entire card. These registrations also help prevent different developers from hard-coding different paths for specific file types. Thus, if a user has two different image viewer applications, both look in the same location and find the same set of images.</p>

<p><a name="997379"> </a>Registering these file types at initialization allows the default card install conduit (<code>CardInst.dll</code>) to transfer files of these types to an expansion card. During the HotSync process, files of the registered types are placed directly in the specified directories on the card.</p>

<h2 class="haH2">
  <a name="997381"> </a>Example of Getting a File <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="997385"> </a><a href="COMComp_Expansion.html#997391">Listing 5.4</a> is an example VB subroutine named <code>GetFile</code>, which performs the checks described in <a href="COMComp_Expansion.html#996277">"Checking for Expansion Cards"</a> and then gets a list of directories from the root. If a directory exists, it gets a list of files from the first directory in the list. It then opens the first file, if it exists, and displays some file information. </p>
<p class="CCodeCaption">
  <a name="997391"> </a><b>Listing 5.4&nbsp;&nbsp;GetFile example</b>
</p>

<div class="CodeRule"><hr></div><pre class="CodeBlock">
Public Sub GetFile()<a name="997392"> </a>
<a name="997393"> </a>
   Dim ExpansionSlot As New PDExpansionManager<a name="997394"> </a>
   Dim SlotNumbers As Variant<a name="997395"> </a>
   Dim IsCardPresent As Boolean<a name="997396"> </a>
   Dim IsVolumeMounted As Boolean<a name="997397"> </a>
   Dim VolumeRef As Long<a name="997398"> </a>
   Dim VolumeCount As Long<a name="997399"> </a>
<a name="997400"> </a>
   Dim VFSManager As New PDVFSManager<a name="997401"> </a>
   Dim VFSVolume As PDVFSVolumeManager<a name="997402"> </a>
   Dim VFSFile As PDVFSFileManager<a name="997403"> </a>
   Dim VolumeList() As Integer<a name="997404"> </a>
   Dim i As Integer<a name="997405"> </a>
   <a name="997406"> </a>
   Dim DirectoryCount As Integer<a name="997407"> </a>
   Dim FileCount As Integer<a name="997408"> </a>
   Dim DirectoryList As Variant<a name="997409"> </a>
   Dim FileList As Variant<a name="997410"> </a>
   <a name="997411"> </a>
   On Error GoTo ErrorHandler<a name="997412"> </a>
   <a name="997413"> </a>
   If ExpansionSlot.<b>IsExpansionSlotPresent</b> Then<a name="997414"> </a>
      ' Get a list of all available slots.<a name="997415"> </a>
      SlotNumbers = ExpansionSlot.<b>GetSlotReferenceNumbers</b> <a name="997416"> </a>
      ' Retrieve slot information from the first available slot.<a name="997417"> </a>
      For i = 0 To UBound(SlotNumbers)<a name="997418"> </a>
         Call ExpansionSlot.<b>GetSlotInfo</b>(SlotNumbers(i), IsCardPresent, _ <a name="997419"> </a>
            IsVolumeMounted, VolumeRef)<a name="997420"> </a>
         If IsCardPresent Then Exit For<a name="997421"> </a>
      Next i<a name="997422"> </a>
<a name="997423"> </a>
      If IsCardPresent Then<a name="997424"> </a>
         If IsVolumeMounted Then<a name="997425"> </a>
            VolumeList = VFSManager.<b>GetVolumeReferenceList</b>(VolumeCount)<a name="997426"> </a>
            ' Use the first available volume. <a name="997427"> </a>
            Set VFSVolume = VFSManager.<b>GetVolumeManager</b>(VolumeList(0))<a name="997428"> </a>
         End If<a name="997429"> </a>
      Else<a name="997430"> </a>
         MsgBox("No card present in Slot ", vbInformation, "Information")<a name="997431"> </a>
         Exit Sub<a name="997432"> </a>
      End If<a name="997433"> </a>
   Else<a name="997434"> </a>
      MsgBox("No Expansion slot was found.", vbInformation, "Information")<a name="997435"> </a>
      Exit Sub<a name="997436"> </a>
   End If<a name="997437"> </a>
<a name="997438"> </a>
   ' Retrieve a list of the topmost directories. <a name="997439"> </a>
   DirectoryCount = VFSVolume.<b>GetSubDirectoryList</b>("/", DirectoryList)<a name="997440"> </a>
<a name="997441"> </a>
   If DirectoryCount &gt; 0 Then<a name="997442"> </a>
      ' Retrieve a list of files from the first directory. <a name="997443"> </a>
      FileCount = VFSVolume.<b>GetFileList</b>(DirectoryList(0), FileList)<a name="997444"> </a>
      If FileCount &gt; 0 Then<a name="997445"> </a>
         ' Open the first file found in the first directory in read-only mode. <a name="997446"> </a>
         Set VFSFile = VFSVolume.<b>Open</b>(DirectoryList(0) &amp; "/" &amp; FileList(0), _<a name="997447"> </a>
            PDDirectLib.EPDVFSFileOpenAttr.eVFSModeRead)<a name="997448"> </a>
<a name="997449"> </a>
         ' Display file information.<a name="997450"> </a>
         MsgBox("Opened '" &amp; DirectoryList(0) &amp; "/" &amp; FileList(0) &amp; "'" &amp; _ <a name="997451"> </a>
            vbCr &amp; vbCr &amp; "File Size  : " &amp; VFSFile.<b>Size</b> &amp; " Bytes " &amp; vbCr &amp; _<a name="997452"> </a>
            "Created on : " &amp; VFSFile.<b>CreationDate</b>, vbInformation, _<a name="997453"> </a>
            "Information")<a name="997454"> </a>
<a name="997455"> </a>
         VFSFile.<b>Close</b> <a name="997456"> </a>
      End If<a name="997457"> </a>
   End If<a name="997458"> </a>
<a name="997459"> </a>
   Exit Sub<a name="997460"> </a>
<a name="997461"> </a>
ErrorHandler:<a name="997462"> </a>
   MsgBox("Error " &amp; Err.Number &amp; " " &amp; Err.Description, vbExclamation, _<a name="997463"> </a>
      "GetFile")<a name="997464"> </a>
   Exit Sub<a name="997465"> </a>
<a name="997466"> </a>
End Sub<a name="997467"> </a>
</pre><div class="CodeRule"><hr></div>


<h2 class="haH2">
  <a name="997470"> </a>Custom Calls <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="997471"> </a>Recognizing that some file systems may implement functionality not covered by the APIs included in the VFS and Expansion Managers, the VFS Manager includes a single function that exists solely to give developers access to the underlying file system. This function, <a href="CRef_VFSMgr.html#996828"><code>VFSCustomControl()</code></a>, is available only in the C API; it is not exposed in the COM Sync module. For more information on accessing custom file systems and custom I/O from the VFS Manager's C API, see <a href="CComp_Expansion.html#997143">"Custom Calls"</a> in the <i>C/C++ Sync Suite Companion</i>. </p>

<h2 class="haH2">
  <a name="1004964"> </a>Debugging <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p><a name="1004965"> </a>Palm OS Simulator supports the expansion capabilities of the VFS Manager. It presents a directory on the host file system as a volume to the virtual file system. You can populate this directory on your host system and then simulate a volume mount. Changes made to the simulated expansion card's contents can be verified simply by examining the directory on the host. </p>

<p><a name="1004966"> </a>For more information on configuring and operating Palm OS Simulator, see <i>Palm OS Cobalt Simulator Guide</i> or <i>Testing with Palm OS Garnet Simulator</i>. For information on performing HotSync operations with Simulator, see <a href="Util_Simulator.html#995933">Chapter 8, "Synchronizing with Palm OS Simulator,"</a> of the <i>Conduit Development Utilities Guide</i>. </p>

<h2 class="haH2">
  <a name="997494"> </a>Summary of Expansion and VFS Managers <a href="#995934"><span class="nav">^TOP^</span></a>
</h2>


<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="997500"> </a><b>Expansion Manager Methods (<a href="COMRef_Obj.html#1165746"><code>PDExpansionManager</code></a>)</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997507"> </a><a href="COMRef_Meth.html#998030"><code>GetCardInfo()</code></a> <br><a href="COMRef_Meth.html#999026"><code>GetSlotInfo()</code></a> </p>
    </td>
    <td><p class="tt"><a name="997515"> </a><a href="COMRef_Meth.html#999239"><code>GetSlotReferenceNumbers()</code></a> <br><a href="COMRef_Meth.html#1000140"><code>IsExpansionSlotPresent()</code></a> </p>
    </td>
  </tr>
</table>

</div>

</p>

<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="997525"> </a><b>Expansion Card Information Properties (<a href="COMRef_Obj.html#1163598"><code>PDExpansionCardInfo</code></a>)</b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997532"> </a><a href="COMRef_Prop.html#996126"><code>CapabilityFlags</code></a> <br><a href="COMRef_Prop.html#996867"><code>DeviceClass</code></a> <br><a href="COMRef_Prop.html#996884"><code>DeviceUniqueId</code></a></p>
    </td>
    <td><p class="tt"><a name="997543"> </a><a href="COMRef_Prop.html#997825"><code>ManufacturerName</code></a> <br><a href="COMRef_Prop.html#997933"><code>MediaType</code></a><br><a href="COMRef_Prop.html#998734"><code>ProductName</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="997559"> </a><b>VFS Manager Methods (<a href="COMRef_Obj.html#1194445"><code>PDVFSManager</code></a>) </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997566"> </a><a href="COMRef_Meth.html#999791"><code>GetVolumeCount()</code></a><br><a href="COMRef_Meth.html#999832"><code>GetVolumeManager()</code></a></p>
    </td>
    <td><p class="tt"><a name="997574"> </a><a href="COMRef_Meth.html#999880"><code>GetVolumeReferenceList()</code></a><br><a href="COMRef_Meth.html#1000262"><code>IsVolumeAvailable()</code></a> </p>
    </td>
  </tr>
</table>

</div>

</p>

<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="997587"> </a><b>VFS Volume Manager (<a href="COMRef_Obj.html#1195273"><code>PDVFSVolumeManager</code></a>) </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="997591"> </a>Methods</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997598"> </a><a href="COMRef_Meth.html#996829"><code>CopyFileFromDeskTop()</code></a><br><a href="COMRef_Meth.html#996895"><code>CopyFileToDeskTop()</code></a><br><a href="COMRef_Meth.html#996955"><code>CreateDirectory()</code></a><br><a href="COMRef_Meth.html#997019"><code>CreateFile()</code></a><br><a href="COMRef_Meth.html#997279"><code>Delete()</code></a><br><a href="COMRef_Meth.html#997708"><code>ExportDatabaseToFile()</code></a><br><a href="COMRef_Meth.html#997754"><code>Format()</code></a></p>
    </td>
    <td><p class="tt"><a name="997621"> </a><a href="COMRef_Meth.html#998323"><code>GetDefaultDirectory()</code></a><br><a href="COMRef_Meth.html#998444"><code>GetFileList()</code></a><br><a href="COMRef_Meth.html#999401"><code>GetSubDirectoryList()</code></a><br><a href="COMRef_Meth.html#999972"><code>ImportDatabaseFromFile()</code></a><br><a href="COMRef_Meth.html#1000463"><code>Open()</code></a><br><a href="COMRef_Meth.html#1002344"><code>Rename()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="997638"> </a>Properties </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997645"> </a><a href="COMRef_Prop.html#996075"><code>Attributes</code></a><br><a href="COMRef_Prop.html#997161"><code>FileSystemType</code></a><br><a href="COMRef_Prop.html#1407655"><code>Label</code></a><br><a href="COMRef_Prop.html#997933"><code>MediaType</code></a><br><a href="COMRef_Prop.html#998114"><code>mountClass</code></a></p>
    </td>
    <td><p class="tt"><a name="997662"> </a><a href="COMRef_Prop.html#999094"><code>SlotLibRefNumber</code></a><br><a href="COMRef_Prop.html#999114"><code>SlotReferenceNumber</code></a><br><a href="COMRef_Prop.html#999253"><code>TotalCapacity</code></a><br><a href="COMRef_Prop.html#999319"><code>UsedSpace</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>

<p class="fineprint">

<div class="tablediv"><table cellspacing="0" class="tTable">

  <tr valign="top">
    <th colspan="2" rowspan="1"><p class="tt"><a name="997681"> </a><b>VFS File Manager (<a href="COMRef_Obj.html#1193439"><code>PDVFSFileManager</code></a>) </b></p>
    </th>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="997685"> </a>Methods</p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997692"> </a><a href="COMRef_Meth.html#996715"><code>Close()</code></a><br><a href="COMRef_Meth.html#1000641"><code>Read()</code></a><br><a href="COMRef_Meth.html#1002572"><code>Seek()</code></a></p>
    </td>
    <td><p class="tt"><a name="997703"> </a><a href="COMRef_Meth.html#1003474"><code>Tell()</code></a><br><a href="COMRef_Meth.html#1003872"><code>Write()</code></a></p>
    </td>
  </tr>
  <tr valign="top">
    <td colspan="2" rowspan="1"><p class="tt"><a name="997708"> </a>Properties </p>
    </td>
  </tr>
  <tr valign="top">
    <td><p class="tt"><a name="997715"> </a><a href="COMRef_Prop.html#996075"><code>Attributes</code></a><br><a href="COMRef_Prop.html#996426"><code>CreationDate</code></a><br><a href="COMRef_Prop.html#997015"><code>EOF</code></a></p>
    </td>
    <td><p class="tt"><a name="997726"> </a><a href="COMRef_Prop.html#997661"><code>LastAccessedDate</code></a><br><a href="COMRef_Prop.html#997712"><code>LastModificationDate</code></a><br><a href="COMRef_Prop.html#999077"><code>Size</code></a></p>
    </td>
  </tr>
</table>

</div>

</p>
&nbsp;<br>
</div>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="7" rowspan="2"><img name="index_x" src="images/shim.gif" width="7" height="33" border="0" alt=""></td>
<td align="left"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p class="footer">
Copyright © 2000-2004, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="COMComp_Front.html" target="_blank">Legal</a></p>
<br>
<!--BEGIN BOOK NAVIGATION-->
<p class="nav">
<A href="http://www.palmos.com/dev/support/docs/">Documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a href="COMSyncCompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="COMComp_Install.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="COMSyncCompanionIX.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="COMSyncCompanionIX.html">Index</a>
</p>
</td>
</tr>
<!-- END FOOTER -->

</body>
</html>