<html>
<head>
<title>PalmSource | Developing Conduits</title> 
<link href="palmsource_styles.css" rel="stylesheet" type="text/css">
<link href="document.css" rel="stylesheet" type="text/css">

<!-- begin meta data -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META NAME="PALMSOURCETEMPLATE" CONTENT="1006-006 PalmSource HTML 20030131">
<META NAME="GENERATOR" CONTENT="Quadralay WebWorks Publisher Professional Edition 6.0.7">
<META NAME="LASTUPDATED" CONTENT="03/03/03 11:18:27">
<!-- end meta data -->
</head>

<body bgcolor="#ffffff" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<a name="971628"></a>

<!-- BEGIN TOPNAV -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td align="middle" bgcolor="#efefe4"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r1_c1" src="images/shim.gif" width="280" height="24" border="0" alt="" id="IMG1"></td>
</tr>
</table>
</td>
</tr>
<tr>
<td align="middle"><table border="0" cellpadding="0" cellspacing="0" width="744">
<tr>
<td><img name="index_r2_c1" src="images/shim.gif" width="33" height="75" border="0" alt=""></td>
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_r2_c4" src="images/shim.gif" width="96" height="11" border="0" alt=""></td>
</tr>
<tr>
<td><a href="http://www.palmsource.com/"><img name="ps_logo" src="images/ps_logo.gif" width="96" height="54" border="0" alt=""></a></td>
</tr>
<tr>
<td><img name="index_r6_c4" src="images/shim.gif" width="96" height="10" border="0" alt=""></td>
</tr>
</table>
</td>

<td><table border="0" cellpadding="0" cellspacing="0" width="30">
<td><img name="index_x" src="images/shim.gif" width="30" height="75" border="0" alt=""></td>
</table></td>

<!--Begin masthead-->
<td><table border="0" cellpadding="0" cellspacing="0" width="96">
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
<!--Begin breadcrumbs-->
<tr>
<td><span class="nav">&lt;&nbsp;<A HREF="http://www.palmos.com/index.html">Home</a> 
&nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/">Developers</a> 
&nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/support/">Development Support</a>
&nbsp;&nbsp;&lt;&nbsp;<A HREF="http://www.palmos.com/dev/support/docs/">Documentation</a></span></td>
</tr>
<!--End breadcrumbs-->
<tr>
<td><h2 class="HeadDocPage">4 &nbsp;&nbsp;Developing Conduits</h2></td>
</tr>
<tr>
<td><span class="nav">
<a href="C++SyncMacCompanionTOC.html">Table of Contents</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="MCComp_HotSync.html">&lt;&nbsp;Previous</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="MCComp_GenCn.html">Next&nbsp;&gt;</a>&nbsp;&nbsp;
             |&nbsp;&nbsp;<a href="C++SyncMacCompanionIX.html">Index</a>
</span></td>
</tr>
<tr>
<td><img name="index_x" src="images/shim.gif" width="615" height="5" border="0" alt=""></td>
</tr>
</table>
</td>
<!--End masthead-->

</tr>
</table>
<img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
</tr>
</table>
<!-- END TOPNAV -->

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top" width="10"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>

<!--BEGIN MINITOC-->
<td valign="top" width="175">
<p class="SideTitle"><a href="MCComp_Front.html">C/C++ Sync Suite Companion for Macintosh</a></p>
<p class="SideTOC1-PartTab">Palm OS® Conduit Development Kit for Macintosh, Version 4.03 </p>
<p class="SideTOC1"><a href="MCComp_Conduits.html">4  Developing Conduits</a></p>


<p class="SideTOC2">
<a href="#971639">About Conduits
</a></p>

<p class="SideTOC3">
<a href="#971646">Programming Conduits
</a></p>

<p class="SideTOC3">
<a href="#971653">Conduit Tasks
</a></p>

<p class="SideTOC3">
<a href="#971776">Conduit Synchronization Types
</a></p>

<p class="SideTOC2">
<a href="#971837">Conduit Design Goals
</a></p>

<p class="SideTOC2">
<a href="#971869">Conduit Development Basics
</a></p>

<p class="SideTOC2">
<a href="#971897">Conduit Design Decisions
</a></p>

<p class="SideTOC3">
<a href="#971904">Conduit Design Questions
</a></p>

</td>
<!--END MINITOC-->

<td width="5">&nbsp;&nbsp;</td>
<td width="2" background="images/index_r8_c10.gif">&nbsp;</td>
<td width="5">&nbsp;&nbsp;</td>
<td valign="top">

<!--BEGIN CONTENT-->
<p class="Body">
  <a name="971634"> </a>This chapter provides an overview of conduit development. For more information about the functions and data structures that you use to develop conduits, see the <a href="MCRef_Front.html#1005674">C/C++ Sync Suite Reference for Macintosh</a>.
</p>

<h2 class="HaHeadA">
  <a name="971639"> </a>About Conduits <a href="#971628"><span class="nav">^TOP^</span></a>
</h2>

<p class="Body">
  <a name="971641"> </a>A conduit is a plug-in module for the HotSync<sup>®</sup> Manager application that transfers data between the handheld and the desktop computer. The HotSync Manager application runs the conduits that have been installed on the user's desktop computer. Each conduit is designed to synchronize or back up data from specific handheld applications' database or databases.
</p>
<p class="Body">
  <a name="971642"> </a>Some handheld applications create or use data that must be shared with data on a desktop computer. For example, the built-in Date Book application exchanges data with the Palm Desktop application that runs on the user's desktop computer. The Date Book conduit synchronizes the Date Book databases on the computer and handheld.
</p>
<p class="Body">
  <a name="971643"> </a>Other handheld applications create data that is backed up onto the desktop computer. The backup conduit copies the data from the handheld to the user's desktop computer.
</p>

<h2 class="HBHeadB">
  <a name="971646"> </a>Programming Conduits <a href="#971628"><span class="nav">^TOP^</span></a>
</h2>

<p class="Body">
  <a name="971647"> </a>Each conduit running on a Macintosh system is a standard Carbon Core Foundation shared library. These shared libraries on the Macintosh are similar to DLLs on Windows systems. Your conduit code can perform any actions that any shared library can perform. However, to maintain the integrity of the HotSync process, conduits need to meet certain design goals, as described in <a href="MCComp_Conduits.html#971837">"Conduit Design Goals."</a> 
</p>

<h2 class="HBHeadB">
  <a name="971653"> </a>Conduit Tasks <a href="#971628"><span class="nav">^TOP^</span></a>
</h2>

<p class="Body">
  <a name="971654"> </a>Your conduit synchronizes data for a specific application on the handheld with the desktop computer. To do so, your conduit must perform the following tasks:
</p>

  <a name="971655"> </a><p class="B1Bullet"> &#8226; open and close databases on the handheld</p>

  <a name="971656"> </a><p class="B1Bullet"> &#8226; add, delete, and modify records on the handheld and desktop computer, converting formats as required</p>

  <a name="971659"> </a><p class="B1Bullet"> &#8226; compare records to support fast sync, as described in <a href="MCComp_HotSync.html#970410">"Fast and Slow Synchronizations."</a> </p>
<p class="Body">
  <a name="971661"> </a>Since each application stores data in its own format, each conduit has to use custom data handling and conversion algorithms. To work with data on the handheld, you need to use the Sync Manager API, as described in <a href="MCComp_SyncMgr.html#972740">Chapter 6, "Using the Sync Manager API."</a> 
</p>

<h2 class="HBHeadB">
  <a name="971776"> </a>Conduit Synchronization Types <a href="#971628"><span class="nav">^TOP^</span></a>
</h2>

<p class="Body">
  <a name="971777"> </a>The form of synchronization that you choose for your conduit depends on the nature of the applications involved and how you want to handle their data. The synchronization types are summarized in <a href="MCComp_Conduits.html#971787">Table 4.1</a>. 
</p>

<h5 class="TgTable">


<table border="1" cellpadding="5" cellspacing="0">
  <caption><a name="971787"> </a><div class="TableTitle">Table 4.1  Conduit synchronization types </div></caption>
  <tr bgcolor="#CCCCCC" valign="top">
    <th><a name="971793"> </a><div class="CellHeading">Synchronization type</div></th>
    <th><a name="971795"> </a><div class="CellHeading">Description</div></th>
    <th><a name="971797"> </a><div class="CellHeading">Notes</div></th>
  </tr>
  <tr valign="top">
    <td><a name="971800"> </a><div class="CellBody">Mirror-image</div></td>
    <td><a name="971802"> </a><div class="CellBody">Ideal for applications that run on both platforms and allow modifications on both; makes data identical on both platforms.</div><a name="971803"> </a><div class="CellBody"><br></div><a name="971804"> </a><div class="CellBody">Example applications for this kind of synchronization include Address Book and Date Book applications.</div></td>
    <td><a name="971806"> </a><div class="CellBody">Your conduit must provide conflict resolution solutions when the same record has been modified on both platforms. This must occur without user intervention.</div></td>
  </tr>
  <tr valign="top">
    <td><a name="971810"> </a><div class="CellBody">One directional</div></td>
    <td><a name="971812"> </a><div class="CellBody">For applications that run on both platforms but only allow data modification on one; copies the data to the other platform</div><a name="971813"> </a><div class="CellBody"><br></div><a name="971814"> </a><div class="CellBody">An example application for this kind of synchronization is a stock quotation program that updates data on the desktop computer and copies the latest data to the handheld.</div></td>
    <td><a name="971816"> </a><div class="CellBody">Requires less time, and should be used when possible.</div></td>
  </tr>
  <tr valign="top">
    <td><a name="971819"> </a><div class="CellBody">Transaction-based</div></td>
    <td><a name="971821"> </a><div class="CellBody">For applications that need to perform additional processing on the desktop computer between record synchronizations.</div><a name="971822"> </a><div class="CellBody"><br></div><a name="971823"> </a><div class="CellBody">An example of using this kind of synchronization is an e-mail program that uses transaction processing to update the In Box on the desktop computer.</div></td>
    <td><a name="971825"> </a><div class="CellBody">Only use this when required, because it slows down the HotSync process.</div></td>
  </tr>
  <tr valign="top">
    <td><a name="972939"> </a><div class="CellBody">Backup</div></td>
    <td><a name="972941"> </a><div class="CellBody">For applications that don't have desktop computer components; simply copies the handheld data to the desktop computer.</div></td>
    <td><a name="972943"> </a><div class="CellBody">Can use the Backup conduit provided by PalmSource, Inc.</div></td>
  </tr>
</table>




</h5>
<div class="NINoteImportant"><hr>
  <a name="971834"> </a> <span style="color: #333;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">NOTE:  </span> A major design goal for conduits is to minimize synchronization time. This means that you should choose the simplest method of synchronization that can be used for your conduit. The synchronization types in order, from simplest to most complex are: backup, one-directional, mirror-image, and transaction-based.
<hr>
</div>

<h2 class="HaHeadA">
  <a name="971837"> </a>Conduit Design Goals <a href="#971628"><span class="nav">^TOP^</span></a>
</h2>

<p class="Body">
  <a name="971838"> </a>HotSync technology has been a very important part of the success of the Palm OS platform. One of the reasons for this is that the conduits called by the HotSync Manager application run quickly and adhere to a strong set of design goals. You need to develop your conduit with these same goals in mind, as described in <a href="MCComp_Conduits.html#971845">Table 4.2</a>. 
</p>

<h5 class="TgTable">


<table border="1" cellpadding="5" cellspacing="0">
  <caption><a name="971845"> </a><div class="TableTitle">Table 4.2  Conduit design goals </div></caption>
  <tr bgcolor="#CCCCCC" valign="top">
    <th><a name="971849"> </a><div class="CellHeading">Design goal</div></th>
    <th><a name="971851"> </a><div class="CellHeading">Description</div></th>
  </tr>
  <tr valign="top">
    <td><a name="971853"> </a><div class="CellBody">Fast execution</div></td>
    <td><a name="971855"> </a><div class="CellBody">The overarching goal for the HotSync process is that a complete synchronization happen very quickly. Conduits need to be designed for optimal processing speed and minimal data transfer.</div></td>
  </tr>
  <tr valign="top">
    <td><a name="971857"> </a><div class="CellBody">Zero data loss</div></td>
    <td><a name="971859"> </a><div class="CellBody">Conduits must take measures required to prevent data loss under any circumstances, including loss of connection during a synchronization process.</div></td>
  </tr>
  <tr valign="top">
    <td><a name="971861"> </a><div class="CellBody">Good conflict handling</div></td>
    <td><a name="971863"> </a><div class="CellBody">Conduits that perform mirror image synchronizations must be able to gracefully handle conflicting modifications. This occurs when the user modifies a record on both the desktop computer and the handheld. In addition to managing the conflict, the conduit should add an entry to the log to notify the user of this situation. </div></td>
  </tr>
  <tr valign="top">
    <td><a name="971865"> </a><div class="CellBody">No user interaction</div></td>
    <td><a name="971867"> </a><div class="CellBody">The user expects to be able to press the HotSync button on the handheld cradle and have synchronization proceed without any required interaction. Conduits must never require user interaction.</div></td>
  </tr>
</table>




</h5>

<h2 class="HaHeadA">
  <a name="971869"> </a>Conduit Development Basics <a href="#971628"><span class="nav">^TOP^</span></a>
</h2>

<p class="Body">
  <a name="971870"> </a>The easiest way to create a new conduit is to create a new project based on the conduit stationery that is installed for CodeWarrior when you install the CDK. 
</p>
<p class="Body">
  <a name="971871"> </a>To customize the stationery conduit into your own version, you must perform the following minimal steps:
</p>

  <a name="971873"> </a><p class="B1Bullet"> &#8226; modify the <span style="font-family: monospace">GetConduitName</span> function (for non-bundled conduits) or <span style="font-family: monospace">CopyConduitNameAsCFStringRef</span> function (for bundled conduits) to return the name of your conduit</p>

  <a name="971875"> </a><p class="B1Bullet"> &#8226; modify <span style="font-family: monospace">GetConduitVersion</span> to return the version number of your conduit</p>

  <a name="971877"> </a><p class="B1Bullet"> &#8226; add code to the <span style="font-family: monospace">OpenConduit</span> function (for non-bundled conduits) or <span style="font-family: monospace">OpenConduitCarbon</span> (for bundled conduits) to perform your actual synchronization operations</p>

  <a name="971879"> </a><p class="B1Bullet"> &#8226; modify the <span style="font-family: monospace">ConfigureConduit</span> function to allow the user to perform configuration of your conduit</p>

  <a name="971881"> </a><p class="B1Bullet"> &#8226; modify the <span style="font-family: monospace">GetActionString</span> function (for non-bundled conduits) or <span style="font-family: monospace">CopyActionStringAsCFStringRef</span> (for bundled conduits) to return the string that the HotSync Manager application displays in the "Next Action" dialog box</p>
<p class="Body">
  <a name="971883"> </a>You must also create a Conduit Information (<span style="font-family: monospace">'CInf'</span>) resource that specifies information about your conduit. For more information about the conduit information resource, see <a href="MCComp_Installation.html#978808">Chapter 9, "Installing Conduits."</a> 
</p>
<div class="NINoteImportant"><hr>
  <a name="973011"> </a> <span style="color: #333;  font-style: normal; font-weight: bold; text-decoration: none; text-transform: none; vertical-align: baseline">NOTE:  </span> Your conduit must have either a <span style="font-family: monospace">'carb'</span> or <span style="font-family: monospace">'plst'</span> resource of ID 0 in order to be recognized as a Carbonized conduit. Read Apple Technical Note 2013 at <a href="http://developer.apple.com/technotes/tn/tn2013.html">http://developer.apple.com/technotes/tn/tn2013.html</a> for details.
<hr>
</div>
<p class="Body">
  <a name="971887"> </a>You can also refer to the source code for the stationery conduit that is provided with the CDK. The stationery conduit source code implements the basic conduit functions.
</p>
<p class="Body">
  <a name="971888"> </a>Many conduit developers find that the best way to develop their conduits is to examine and borrow code from the example conduits that are provided with the Conduit Development Kit.
</p>

<h2 class="HaHeadA">
  <a name="971897"> </a>Conduit Design Decisions <a href="#971628"><span class="nav">^TOP^</span></a>
</h2>

<p class="Body">
  <a name="971898"> </a>This section provides information that you can use to make decisions regarding the top-level design of your conduit.
</p>

<h2 class="HBHeadB">
  <a name="971904"> </a>Conduit Design Questions <a href="#971628"><span class="nav">^TOP^</span></a>
</h2>

<p class="Body">
  <a name="971905"> </a>The most important considerations when designing your conduit are:
</p>

  <a name="971906"> </a><p class="B1Bullet"> &#8226; how the data is stored on both platforms</p>

  <a name="971907"> </a><p class="B1Bullet"> &#8226; whether synchronization will be one directional, mirror image, or transaction based</p>
<p class="Body">
  <a name="971908"> </a>Your answers to the following questions will help determine the type of conduit you need to implement:
</p>

  <a name="971909"> </a><p class="B1Bullet"> &#8226; Do the existing desktop computer databases offer a public application programming interface for record I/O? If so, is this API packaged as a stand-alone library?</p>

  <a name="971910"> </a><p class="B1Bullet"> &#8226; Does each record have a unique Record ID field? If so, can the conduit perform keyed look-ups by Record ID? If so, can the conduit re-assign the Record ID to a record? Is the record ID format on the desktop computer compatible with the record ID format on the handheld? PalmSource strongly recommends that record IDs only get assigned on the handheld.</p>

  <a name="971911"> </a><p class="B1Bullet"> &#8226; Does each record maintain a status flag field? If so, are the available status values Add, Modify, and Delete? How will you clear the status flags at the end of synchronization operations?</p>

  <a name="971912"> </a><p class="B1Bullet"> &#8226; Is there an easy way to detect modified records? A time stamp indicating the last modified date (with hours, minutes, and seconds) will work for this purpose. </p>

  <a name="971913"> </a><p class="B1Bullet"> &#8226; Is the concept of categories supported in the existing databases? If so, what is the limit on number of categories allowed? Will category information be synchronized? How will the desktop categories be mapped to the categories on the handheld?</p>

  <a name="971914"> </a><p class="B1Bullet"> &#8226; Is the possibility of downloading only a subset of field data to the handheld acceptable? If so, consider how to retain that data on the desktop computer during the synchronization process. </p>

  <a name="971915"> </a><p class="B1Bullet"> &#8226; Will the conduit need to synchronize more than one database on the handheld to one or more database(s) on the desktop computer (multi-database synchronization)? </p>

  <a name="971916"> </a><p class="B1Bullet"> &#8226; Is one-way database copying appropriate? </p>

  <a name="971917"> </a><p class="B1Bullet"> &#8226; Will the conduit behave differently during a fast sync than during a slow sync? </p>

  <a name="971918"> </a><p class="B1Bullet"> &#8226; Is the data to be synchronized at the record level, so that each record that has changed is updated on both sides? </p>

  <a name="971920"> </a><p class="B1Bullet"> &#8226; Will the conduit need to synchronize one database on the handheld to one database on the desktop computer (single database synchronization)? </p>

  <a name="971921"> </a><p class="B1Bullet"> &#8226; How well do the desktop computer record fields and handheld records map to each other?</p>

  <a name="971922"> </a><p class="B1Bullet"> &#8226; Does the third party application support the concept of multiple databases or multiple users? </p>

  <a name="971923"> </a><p class="B1Bullet"> &#8226; Will archiving be supported?</p>

  <a name="971924"> </a><p class="B1Bullet"> &#8226; Can you pre-process data for efficiency, to keep the synchronization time to a minimum, and to avoid timeouts? For example, if your conduit accesses information over the Internet, it is best to access that information prior to beginning the synchronization. </p>
&nbsp;<br>
<!--END CONTENT-->

</td>
<td width="5">&nbsp;&nbsp;</td>
</tr>

</table>

<!-- BEGIN FOOTER -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="15" rowspan="2"><img name="index_x" src="images/shim.gif" width="15" height="33" border="0" alt=""></td>
<td align="middle"><img name="dashes" src="images/dashes.gif" width="744" height="3" border="0" alt=""></td>
<td width="10" rowspan="2"><img name="index_x" src="images/shim.gif" width="10" height="33" border="0" alt=""></td>
</tr>
<tr>
<td align="center">
<p>&nbsp;</p>
<p class="footer">
Copyright © 1996 - 2002, PalmSource, Inc. and its affiliates. All rights reserved.<br>
<a href="http://www.palmsource.com/contact/">Write Us</a> | <a href="http://www.palmos.com/dev/training/">Training</a> | <a href="http://www.palmos.com/dev/support/kb/">Knowledge Base</a> | <a href="MCComp_Front.html" target="_blank">Legal</a></p>
<p>&nbsp;</p>
</td>
</tr>
<!-- END FOOTER -->

</body>
</html>