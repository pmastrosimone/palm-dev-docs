<HTML>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created on 2003-09-18 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<TITLE>Debugging with GDB: Emacs</TITLE>

<META NAME="description" CONTENT="Debugging with GDB: Emacs">
<META NAME="keywords" CONTENT="Debugging with GDB: Emacs">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY >

<A NAME="SEC199"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_198.html#SEC198"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_200.html#SEC200"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_12.html#SEC12"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_200.html#SEC200"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_284.html#SEC638">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<HR SIZE=1>
<H1> 22. Using GDB under GNU Emacs </H1>
<!--docid::SEC199::-->
<P>

<A NAME="IDX892"></A>
<A NAME="IDX893"></A>
A special interface allows you to use GNU Emacs to view (and
edit) the source files for the program you are debugging with
GDB.
</P><P>

To use this interface, use the command <KBD>M-x gdb</KBD> in Emacs.  Give the
executable file you want to debug as an argument.  This command starts
GDB as a subprocess of Emacs, with input and output through a newly
created Emacs buffer.
</P><P>

Using GDB under Emacs is just like using GDB normally except for two
things:
</P><P>

<UL>
<LI>
All "terminal" input and output goes through the Emacs buffer.
</UL>
<P>

This applies both to GDB commands and their output, and to the input
and output done by the program you are debugging.
</P><P>

This is useful because it means that you can copy the text of previous
commands and input them again; you can even use parts of the output
in this way.
</P><P>

All the facilities of Emacs' Shell mode are available for interacting
with your program.  In particular, you can send signals the usual
way--for example, <KBD>C-c C-c</KBD> for an interrupt, <KBD>C-c C-z</KBD> for a
stop.
</P><P>

<UL>
<LI>
GDB displays source code through Emacs.
</UL>
<P>

Each time GDB displays a stack frame, Emacs automatically finds the
source file for that frame and puts an arrow (<SAMP>`=&#62;'</SAMP>) at the
left margin of the current line.  Emacs uses a separate buffer for
source display, and splits the screen to show both your GDB session
and the source.
</P><P>

Explicit GDB <CODE>list</CODE> or search commands still produce output as
usual, but you probably have no reason to use them from Emacs.
</P><P>

<BLOCKQUOTE>
<EM>Warning:</EM> If the directory where your program resides is not your
current directory, it can be easy to confuse Emacs about the location of
the source files, in which case the auxiliary display buffer does not
appear to show your source.  GDB can find programs by searching your
environment's <CODE>PATH</CODE> variable, so the GDB input and output
session proceeds normally; but Emacs does not get enough information
back from GDB to locate the source files in this situation.  To
avoid this problem, either start GDB mode from the directory where
your program resides, or specify an absolute file name when prompted for the
<KBD>M-x gdb</KBD> argument.
<P>

A similar confusion can result if you use the GDB <CODE>file</CODE> command to
switch to debugging a program in some other location, from an existing
GDB buffer in Emacs.
</BLOCKQUOTE>
<P>

By default, <KBD>M-x gdb</KBD> calls the program called <TT>`gdb'</TT>.  If
you need to call GDB by a different name (for example, if you keep
several configurations around, with different names) you can set the
Emacs variable <CODE>gdb-command-name</CODE>; for example,
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(setq gdb-command-name "mygdb")
</FONT></pre></td></tr></table></P><P>

(preceded by <KBD>M-:</KBD> or <KBD>ESC :</KBD>, or typed in the <CODE>*scratch*</CODE> buffer, or
in your <TT>`.emacs'</TT> file) makes Emacs call the program named
"<CODE>mygdb</CODE>" instead.
</P><P>

In the GDB I/O buffer, you can use these special Emacs commands in
addition to the standard Shell mode commands:
</P><P>

<DL COMPACT>
<DT><KBD>C-h m</KBD>
<DD>Describe the features of Emacs' GDB Mode.
<P>

<DT><KBD>M-s</KBD>
<DD>Execute to another source line, like the GDB <CODE>step</CODE> command; also
update the display window to show the current file and location.
<P>

<DT><KBD>M-n</KBD>
<DD>Execute to next source line in this function, skipping all function
calls, like the GDB <CODE>next</CODE> command.  Then update the display window
to show the current file and location.
<P>

<DT><KBD>M-i</KBD>
<DD>Execute one instruction, like the GDB <CODE>stepi</CODE> command; update
display window accordingly.
<P>

<DT><KBD>M-x gdb-nexti</KBD>
<DD>Execute to next instruction, using the GDB <CODE>nexti</CODE> command; update
display window accordingly.
<P>

<DT><KBD>C-c C-f</KBD>
<DD>Execute until exit from the selected stack frame, like the GDB
<CODE>finish</CODE> command.
<P>

<DT><KBD>M-c</KBD>
<DD>Continue execution of your program, like the GDB <CODE>continue</CODE>
command.
<P>

<EM>Warning:</EM> In Emacs v19, this command is <KBD>C-c C-p</KBD>.
</P><P>

<DT><KBD>M-u</KBD>
<DD>Go up the number of frames indicated by the numeric argument
(see section `Numeric Arguments' in <CITE>The GNU Emacs Manual</CITE>),
like the GDB <CODE>up</CODE> command.
<P>

<EM>Warning:</EM> In Emacs v19, this command is <KBD>C-c C-u</KBD>.
</P><P>

<DT><KBD>M-d</KBD>
<DD>Go down the number of frames indicated by the numeric argument, like the
GDB <CODE>down</CODE> command.
<P>

<EM>Warning:</EM> In Emacs v19, this command is <KBD>C-c C-d</KBD>.
</P><P>

<DT><KBD>C-x &#38;</KBD>
<DD>Read the number where the cursor is positioned, and insert it at the end
of the GDB I/O buffer.  For example, if you wish to disassemble code
around an address that was displayed earlier, type <KBD>disassemble</KBD>;
then move the cursor to the address display, and pick up the
argument for <CODE>disassemble</CODE> by typing <KBD>C-x &#38;</KBD>.
<P>

You can customize this further by defining elements of the list
<CODE>gdb-print-command</CODE>; once it is defined, you can format or
otherwise process numbers picked up by <KBD>C-x &#38;</KBD> before they are
inserted.  A numeric argument to <KBD>C-x &#38;</KBD> indicates that you
wish special formatting, and also acts as an index to pick an element of the
list.  If the list element is a string, the number to be inserted is
formatted using the Emacs function <CODE>format</CODE>; otherwise the number
is passed as an argument to the corresponding list element.
</DL>
<P>

In any source file, the Emacs command <KBD>C-x SPC</KBD> (<CODE>gdb-break</CODE>)
tells GDB to set a breakpoint on the source line point is on.
</P><P>

If you accidentally delete the source-display buffer, an easy way to get
it back is to type the command <CODE>f</CODE> in the GDB buffer, to
request a frame display; when you run under Emacs, this recreates
the source buffer if necessary to show you the context of the current
frame.
</P><P>

The source files displayed in Emacs are in ordinary Emacs buffers
which are visiting the source files in the usual way.  You can edit
the files with these buffers if you wish; but keep in mind that GDB
communicates with Emacs in terms of line numbers.  If you add or
delete lines from the text, the line numbers that GDB knows cease
to correspond properly with the code.
</P><P>

<A NAME="Annotations"></A>
<HR SIZE=1>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_198.html#SEC198"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_200.html#SEC200"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_12.html#SEC12"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_200.html#SEC200"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_284.html#SEC638">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gdb_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>

</BODY>
</HTML>
